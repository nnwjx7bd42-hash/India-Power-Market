"use strict";(self.odspNextWebpackJsonp=self.odspNextWebpackJsonp||[]).push([["plt.odsp-common"],[(a,b,c)=>{c.d(b,{a:()=>h,b:()=>f.a});var d=c(77),e=c(11),f=c(36);let g=(0,d.a)({eventName:"Qos,",shortEventName:"Qos"},{name:{isKey:!0,isPrefixingDisabled:!0,type:e.a.String},startTimeOverride:{isPrefixingDisabled:!0,type:e.a.Number},resultCode:{isPrefixingDisabled:!0,type:e.a.String},resultType:{typeRef:f.a,isPrefixingDisabled:!0,type:e.a.Enum},error:{isPrefixingDisabled:!0,type:e.a.String},stackTrace:{isPrefixingDisabled:!0,type:e.a.String},extraData:e.a.Object,extraMetrics:{isPrefixingDisabled:!0,type:e.a.Object},privacyClassification:{isPrefixingDisabled:!0,type:e.a.String},objectType:{isPrefixingDisabled:!0,type:e.a.String},persistence:{isPrefixingDisabled:!0,type:e.a.Boolean}}).withData({privacyClassification:e.b.requiredService,privacyDataTypes:["productAndServicePerformance"]});class h extends g{end(a){return a&&a.extraData&&this.data.extraData&&(a={...a,extraData:{...this.data.extraData,...a.extraData}}),super.end(a)}}}
,(a,b,c)=>{c.d(b,{a:()=>d});function d(a){let b=window,c=b.__odsp_cdnConfig,d=b.__backupBaseUrl??"";return(d=c?(d=c.baseUrls[0]).replace(`/${c.key}/`,`/${c.libraryKey}/`):(d=b.require.toUrl("odsp-media")).slice(0,d.indexOf("/odsp-media"))).endsWith("/")||(d+="/"),`${d}odsp-media-f662c763/${a}`}}
,,,,,(a,b,c)=>{var d,e;c.d(b,{a:()=>g});let f=/^data:((?:\w+\/(?:(?!;).)+)?)((?:;[\w\W]*?[^;])*),(.+)$/;(e=d||(d={}))[e.absolute=0]="absolute",e[e.relative=1]="relative",e[e.serverRelative=2]="serverRelative",e[e.dataUrl=3]="dataUrl";class g{constructor(a="",b){const c=b?.allowDataUrl??!1,d=a.indexOf("//"),e=a.indexOf("/"),g=d>-1&&d<=e?d+2:-1,h=function(a,b){if(!(b>-1))return"";{let c=a.indexOf("/",b);return c>-1?a.slice(0,c):a}}(a,g),i=h&&h.slice(g),j=a.slice(h.length),k=h?0:c&&f.test(a)?3:"/"===j[0]?2:1,l=j.split("/");this.authority=h,this.domain=i,this.format=k,this.path=j,this.segments=l,this.value=a}}}
,,,(a,b,c)=>{let d,e,f,g,h,i,j,k,l,m,n;c.d(b,{a:()=>R,b:()=>Q,c:()=>S});var o=c(249);function p(a){window.setTimeout(()=>{o.c(O,q,{error:a})},0)}let q="error",r="Canceled",s=1;function t(){}function u(a,b){a._value=b,a._setState(O.isPromise(b)?f:j)}function v(a,b,c,d,e,f){return{exception:a,error:b,promise:c,handler:f,id:d,parent:e}}function w(a,b,c,d){let e=c?._isException;return v(e?b:null,e?null:b,a,c?._errorId,c,d)}function x(a,b,c){let d=c?._isException,e=c?._errorId;return a instanceof O&&G(a,e,d),v(d?b:null,d?null:b,a,e,c)}function y(a,b){let c=++s;return a instanceof O&&G(a,c),v(null,b,a,c)}function z(a,b){let c=++s;return a instanceof O&&G(a,c,!0),v(b,null,a,c)}function A(a,b,c){F(a,{c:b,e:c})}function B(a,b,c,d){a._value=b,E(a,b,c,d),a._setState(l)}function C(a,b){let c,d,e=a._value,g=a._listeners;if(g)for(c=0,a._listeners=null,d=g.length;c<d;c++){let d=g[c],h=d.c,i=d.promise;if(i){try{i._setCompleteValue(h?h(e):e)}catch(a){i._setExceptionValue(a)}i._state!==f&&i._listeners&&b.push(i)}else M.prototype.done.call(a,h)}}function D(a,b){let c,d,e=a._value,g=a._listeners;if(g)for(c=0,a._listeners=null,d=g.length;c<d;c++){let d=g[c],h=d.e,i=d.promise;if(i){try{h?(h.handlesOnError||E(i,e,w,a,h),i._setCompleteValue(h(e))):i._setChainedErrorValue(e,a)}catch(a){i._setExceptionValue(a)}i._state!==f&&i._listeners&&b.push(i)}else K.prototype.done.call(a,void 0,h)}}function E(a,b,c,d,e){b instanceof Error&&b.message===r||o.c(O,q,c(a,b,d,e))}function F(a,b){let c=a._listeners;c?c.push(b):c=[b],a._listeners=c}function G(a,b,c){a._isException=c||!1,a._errorId=b}function H(a,b,c,d){a._value=b,E(a,b,c,d),a._setState(m)}function I(a,b){let c;c=O.isPromise(b)?f:k,a._value=b,a._setState(c)}function J(a,b,c){let d=new P(a);return F(a,{promise:d,c:b,e:c}),d}d={name:"created",enter:a=>{a._setState(e)},cancel:t,done:t,then:t,_completed:t,_error:t,_notify:t,_setCompleteValue:t,_setErrorValue:t},e={name:"working",enter:t,cancel:a=>{a._setState(h)},done:A,then:J,_completed:u,_error:B,_notify:t,_setCompleteValue:I,_setErrorValue:H},f={name:"waiting",enter:a=>{let b=a._value;if(b instanceof P&&b._state!==m&&b._state!==k)F(b,{promise:a});else{let c=d=>{b._errorId?a._chainedError(d,b):(E(a,d,w,b,c),a._error(d))};c.handlesOnError=!0,b.then(a._completed.bind(a),c)}},cancel:a=>{a._setState(g)},done:A,then:J,_completed:u,_error:B,_notify:t,_setCompleteValue:I,_setErrorValue:H},g={name:"waiting_canceled",enter:a=>{a._setState(i);let b=a._value;O.is(b)&&b.cancel()},cancel:t,done:A,then:J,_completed:u,_error:B,_notify:t,_setCompleteValue:I,_setErrorValue:H},h={name:"canceled",enter:a=>{a._setState(i),a._cancelAction()},cancel:t,done:A,then:J,_completed:u,_error:B,_notify:t,_setCompleteValue:I,_setErrorValue:H},i={name:"canceling",enter:a=>{let b=Error(r);b.name=b.message,b._handled=!0,a._value=b,a._setState(l)},cancel:t,done:t,then:t,_completed:t,_error:t,_notify:t,_setCompleteValue:t,_setErrorValue:t},j={name:"complete_notify",enter:a=>{if(a._listeners){let b,c=[a];for(;c.length;)(b=c.shift())&&b._state._notify(b,c)}a._setState(k)},cancel:t,done:(a,b,c)=>M.prototype.done.call(a,b),then:(a,b,c)=>M.prototype.then.call(a,b,c),_completed:t,_error:t,_notify:C,_setCompleteValue:t,_setErrorValue:t},k={name:"success",enter:a=>{a._cleanupAction()},cancel:t,done:(a,b,c)=>M.prototype.done.call(a,b),then:(a,b,c)=>M.prototype.then.call(a,b),_completed:t,_error:t,_notify:C,_setCompleteValue:t,_setErrorValue:t},l={name:"error_notify",enter:a=>{if(a._listeners){let b,c=[a];for(;c.length;)(b=c.shift())&&b._state._notify(b,c)}a._setState(m)},cancel:t,done:(a,b,c)=>K.prototype.done.call(a,b,c),then:(a,b,c)=>K.prototype.then.call(a,b,c),_completed:t,_error:t,_notify:D,_setCompleteValue:t,_setErrorValue:t},m={name:"error",enter:a=>{a._cleanupAction()},cancel:t,done:(a,b,c)=>K.prototype.done.call(a,b,c),then:(a,b,c)=>K.prototype.then.call(a,b,c),_completed:t,_error:t,_notify:D,_setCompleteValue:t,_setErrorValue:t};class K{get[Symbol.toStringTag](){return"ErrorPromise"}cancel(){}done(a,b){let c=this._value;if(b)try{b.handlesOnError||E(this,c,w,this,b);let a=b(c);O.is(a)&&a.done();return}catch(a){c=a}c instanceof Error&&c.message===r||p(c)}then(a,b){let c;if(!b)return this;let d=this._value;try{b.handlesOnError||E(this,d,w,this,b),c=new M(b(d))}catch(a){c=a===d?this:new L(a)}return c}catch(a){return this.then(void 0,a)}finally(a){return this.then(b=>R.resolve(a?.()).then(()=>b),b=>R.resolve(a?.()).then(()=>{throw b}))}constructor(a,b=y){this._value=a,E(this,a,b)}}class L extends K{constructor(a){super(a,z)}}class M{get[Symbol.toStringTag](){return"CompletePromise"}cancel(){}done(a,b){if(a)try{let b=a(this._value);O.is(b)&&b.done()}catch(a){p(a)}}then(a,b){let c;try{let b=a?a(this._value):this._value;c=this._isSameValue(b,this)?this:new M(b)}catch(a){c=new L(a)}return c}catch(a){return this.then(void 0)}finally(a){return this.then(b=>R.resolve(a?.()).then(()=>b),b=>R.resolve(a?.()).then(()=>{throw b}))}_isSameValue(a,b){return a===this._value}constructor(a){if(O.isPromise(a)){const b=new P(null);return b._setCompleteValue(a),b}this._value=a}}function N(a){return()=>{for(let b of Object.keys(a))O.as(a[b]).cancel()}}class O{static get cancel(){return n||(n=new K(Error(r)))}static get[Symbol.species](){return this}static any(a){return new O((b,c)=>{let d=Object.keys(a),e=d.length;for(let f of(0===e&&b(),d)){let d=O.as(a[f]);d.then(()=>{b({key:f,value:d})},a=>{if(a instanceof Error&&a.name===r){0==--e&&b(O.cancel);return}c({key:f,value:d})})}},N(a))}static race(a){return new O((b,c)=>{let d=Object.keys(a),e=d.length;for(let f of(0===e&&b(),d))O.as(a[f]).then(b,a=>{if(a instanceof Error&&a.name===r){0==--e&&b(O.cancel);return}c(a)})},N(a))}static as(a){return O.is(a)?a:new M(a)}static is(a){return O.isPromise(a)&&"function"==typeof a.cancel}static isPromise(a){return!!a&&"object"==typeof a&&"function"==typeof a.then}static isCanceled(a){return a instanceof Error&&a.name===r}static all(a){return new O((b,c)=>{let d=Object.keys(a),e=Array.isArray(a)?[]:{},f=Array.isArray(a)?[]:{},g=d.length,h=()=>{if(0==--g){let a=Object.keys(e);0===a.length?b(f):a.every(a=>O.isCanceled(e[a]))?b(O.cancel):c(e)}};for(let b of d){let c=a[b];void 0===c?g--:O.then(c,a=>{f[b]=a,h()},a=>{e[b]=a,h()})}0===g&&b(f)},N(a))}static allSettled(a){return new O((b,c)=>{let d=Object.keys(a),e=Array.isArray(a)?[]:{},f=d.length,g=()=>{0==--f&&b(e)};for(let b of d){let c=a[b];void 0===c?f--:O.then(c,a=>{e[b]={status:"fulfilled",value:a},g()},a=>{e[b]={status:"rejected",reason:a},g()})}0===f&&b(e)},N(a))}static then(a,b,c){return O.as(a).then(b,c)}static thenEach(a,b,c){let d=Array.isArray(a)?[]:{};for(let e of Object.keys(a))d[e]=O.then(a[e],b,c);return O.all(d)}static serial(a){return a.reduce((a,b)=>a.then(b),O.wrap())}static timeout(a,b){let c,d,e=new O(b=>{c=window.setTimeout(b,a)},()=>{c&&window.clearTimeout(c)});return b?(d=()=>{e.cancel()},e.then(()=>{b.cancel()}),b.then(d,d),b):e}static wrap(a){return new M(a)}static resolve(a){return O.wrap(a)}static wrapError(a){return new K(a)}static reject(a){return O.wrapError(a)}get[Symbol.toStringTag](){return"CancelablePromise"}cancel(){this._state.cancel(this),this._run()}done(a,b){this._state.done(this,a,b)}then(a,b){return this._state.then(this,a,b)}catch(a){return this.then(void 0,a)}finally(a){return this.then(b=>R.resolve(a?.()).then(()=>b),b=>R.resolve(a?.()).then(()=>{throw b}))}_init(a,b){this._oncancel=b,this._setState(d),this._run();try{a?a(this._completed.bind(this),this._error.bind(this)):this._setExceptionValue(Error("No init value for Promise"))}catch(a){this._setExceptionValue(a)}}_cancelAction(){if(this._oncancel)try{this._oncancel()}catch(a){}}_cleanupAction(){this._oncancel=void 0}_chainedError(a,b){let c=this._state._error(this,a,x,b);return this._run(),c}_completed(a){let b=this._state._completed(this,a);return this._run(),b}_error(a){let b=this._state._error(this,a,y);return this._run(),b}_setState(a){this._nextState=a}_setCompleteValue(a){this._state._setCompleteValue(this,a),this._run()}_setChainedErrorValue(a,b){let c=this._state._setErrorValue(this,a,x,b);return this._run(),c}_setExceptionValue(a){let b=this._state._setErrorValue(this,a,z);return this._run(),b}_run(){for(;this._nextState;)this._state=this._nextState,this._nextState=void 0,this._state.enter(this)}_isSameValue(a,b){return a===this._value}constructor(a,b){this._init(a,b)}}o.a(O,q);class P extends O{_init(){}_cancelAction(){this._creator&&this._creator.cancel()}_cleanupAction(){this._creator=null}_initThen(){this._setState(d),this._run()}constructor(a){super(),this._creator=a,this._initThen()}}let Q=class extends O{_init(){}_cancelAction(){this._oncancel&&this._oncancel()}_cleanupAction(){this._oncancel=void 0}_initSignal(){this._setState(d),this._run()}constructor(a){super(),this._oncancel=a,this._initSignal()}},R=O,S=R}
,,(a,b,c)=>{c.d(b,{a:()=>i,b:()=>h});var d={};c.r(d),c.d(d,{optionalDiagnostic:()=>f,requiredDiagnostic:()=>e,requiredService:()=>g});let e="requiredDiagnostic",f="optionalDiagnostic",g="requiredService",h=d,i={String:1,Number:2,Boolean:3,Object:4,Array:5,Enum:6}}
,,(a,b,c)=>{c.d(b,{a:()=>g,b:()=>p,c:()=>k,d:()=>f});var d,e,f,g,h=c(6),i=c("odsp.util_126"),j=c(259);(d=f||(f={}))[d.sameSite=0]="sameSite",d[d.crossSite=1]="crossSite",d[d.unknown=2]="unknown",(e=g||(g={}))[e.sameGeo=0]="sameGeo",e[e.crossGeo=1]="crossGeo",e[e.unknown=2]="unknown";class k{get serverRelativeItemUrl(){return l(this._getServerRelativeItemUrl())}get serverRelativeListUrl(){return l(this._getServerRelativeListUrl())}get fullListUrl(){return this._getFullListUrl()}get normalizedListUrl(){return l(this._getNormalizedListUrl())}get fullItemUrl(){return this._getFullItemUrl()}get normalizedItemUrl(){return l(this._getNormalizedItemUrl())}get listRelativeItemUrl(){return this._getListRelativeItemUrl()}get webRelativeItemUrl(){return this._getWebRelativeItemUrl()}get fullWebUrl(){return this._getFullWebUrl()}get normalizedWebUrl(){return l(this._getNormalizedWebUrl())}get serverRelativeWebUrl(){return l(this._getServerRelativeWebUrl())}get inferredFullListUrl(){return l(this._getInferredFullListUrl())}get isCrossDomain(){return this._getIsCrossDomain()}get isCrossList(){return this._getIsCrossList()}get siteRelation(){return this._getSiteRelation()}get geoRelation(){return this._getGeoRelation()}get path(){return this._getPath()}get listUrl(){return this._getListUrl()}get webUrl(){return this._getWebUrl()}_getPath(){let a,b=this._rawPath;if(b)if("/"===b[0]||b.indexOf("://")>-1)a=m(b);else{let c=this._getListUrl()||this.defaultListUrl;c&&(a=`${c}/${b}`)}return this._getPath=()=>a,a}_getListUrl(){let a,b=this._rawListUrl;if(b)if("/"===b[0]||b.indexOf("://")>-1)a=m(b);else{let c=this._getWebUrl()||this.defaultFullWebUrl;c&&(a=`${c}/${b}`)}return this._getListUrl=()=>a,a}_getWebUrl(){let a,b=this._rawWebUrl;return b&&(a="/"===b[0]||b.indexOf("://")>-1?m(b):`${this.defaultFullWebUrl}/${b}`),this._getWebUrl=()=>a,a}_getCurrentAuthority(){let a=new h.a(this.defaultFullWebUrl).authority;return this._getCurrentAuthority=()=>a,a}_getNormalizedWebUrl(){let a,b=this._getFullWebUrl(),c=this.defaultFullWebUrl;if(void 0!==b&&!(0,i.UA)(b,c)){let c=new h.a(b);a=(0,i.UA)(c.authority,this._getCurrentAuthority())?c.path:b}return this._getNormalizedItemUrl=()=>a,a}_getNormalizedItemUrl(){let a,b=this._getFullItemUrl();if(void 0!==b){let c=new h.a(b);a=(0,i.UA)(c.authority,this._getCurrentAuthority())?c.path:b}return this._getNormalizedItemUrl=()=>a,a}_getNormalizedListUrl(){let a,b=this._getFullListUrl(),c=this._getDefaultListUrl();return void 0===b||(0,i.UA)(b,c)||(a=(0,i.UA)(new h.a(b).authority,this._getCurrentAuthority())?this._getServerRelativeListUrl():b),this._getNormalizedListUrl=()=>a,a}_getInferredFullListUrl(){let a,b=this._getFullListUrl();if(b)a=b;else{let b=this._getFullItemUrl(),c=this._getFullWebUrl();if(b&&c&&(0,j.a)(b,c)){let d=new h.a(b),e=new h.a(c);d.segments.length>e.segments.length&&(a=`${d.authority}${d.segments.slice(0,e.segments.length+1).join("/")}`)}}return this._getInferredFullListUrl=()=>a,a}_getServerUrl(){let a=this.path&&new h.a(this.path).authority||this.listUrl&&new h.a(this.listUrl).authority||this.webUrl&&new h.a(this.webUrl).authority||this.defaultListUrl&&new h.a(this.defaultListUrl).authority||new h.a(this.defaultFullWebUrl).authority;return this._getServerUrl=()=>a,a}_getServerRelativeListUrl(){let a;if(void 0!==this.listUrl)a=new h.a(this.listUrl).path;else{let b=this._getDefaultListUrl(),c=this.mayInferListUrl;if(void 0!==b||c){let d=this._getServerRelativePath(),e=new h.a(b).path;if(void 0===d&&(void 0===this.webUrl||e&&(0,j.a)(o(e),o(this._getServerRelativeWebUrl())))||e&&(0,j.a)(o(d),o(e)))a=e;else if(void 0!==d&&(""===this.defaultListUrl||c)){let b=this._getServerRelativeWebUrl();if((0,j.a)(o(d),o(b))){let c=new h.a(d).segments[new h.a(b).segments.length];a=`${o(b)}${c}`}}}}return this._getServerRelativeListUrl=()=>a,a}_getFullListUrl(){let a,b=this._getServerUrl(),c=this._getServerRelativeListUrl();return void 0!==c&&(a=`${b}${c}`),a}_getFullItemUrl(){let a,b=this._getServerUrl(),c=this._getServerRelativeItemUrl();return void 0!==c&&(a=`${b}${c}`),this._getFullItemUrl=()=>a,a}_getServerRelativeWebUrl(){let a,b;if(void 0!==this.webUrl)a=new h.a(this.webUrl).path;else if((this.defaultListUrl||this.listUrl)&&!this.mayInferListUrl&&void 0!==(b=this._getServerRelativeListUrl())){let c=new h.a(b);a=`${c.segments.slice(0,-1).join("/")}`}else this.defaultFullWebUrl&&(a=new h.a(this.defaultFullWebUrl).path);return this._getServerRelativeWebUrl=()=>a,a}_getServerRelativePath(){let a;return void 0!==this.path&&(a=new h.a(this.path).path),this._getServerRelativePath=()=>a,a}_getServerRelativeItemUrl(){let a;return this.path||this._rawPath?a=this._getServerRelativePath():this.listUrl?a=this._getServerRelativeListUrl():this.webUrl?a=this._getServerRelativeWebUrl():this.defaultListUrl?a=this._getServerRelativeListUrl():this.defaultFullWebUrl&&(a=this._getServerRelativeWebUrl()),this._getServerRelativeItemUrl=()=>a,a}_getListRelativeItemUrl(){let a,b,c=this._getServerRelativePath(),d=this._getServerRelativeListUrl();return void 0!==this.path&&void 0!==d&&(0,j.a)(o(c),b=o(d))&&(a=c&&c.substring(b.length)),this._getListRelativeItemUrl=()=>a,a}_getWebRelativeItemUrl(){let a,b,c=this._getServerRelativePath(),d=this._getServerRelativeWebUrl();return void 0!==this.path&&void 0!==d&&(0,j.a)(o(c),b=o(d))&&(a=c&&c.substring(b.length)),this._getWebRelativeItemUrl=()=>a,a}_getDefaultListUrl(){let a;return void 0!==this.defaultListUrl&&(a=new h.a(this.defaultListUrl).authority?this.defaultListUrl:`${this._getCurrentAuthority()}${this.defaultListUrl}`),this._getDefaultListUrl=()=>a,a}_getIsCrossDomain(){let a=this._getCurrentAuthority(),b=!(0,i.UA)(new h.a(this._getServerUrl()).authority,a);return this._getIsCrossDomain=()=>b,b}_getIsCrossList(){let a=this._getFullListUrl(),b=this._getDefaultListUrl(),c=!(0,i.UA)(a,b);return this._getIsCrossList=()=>c,c}_getSiteRelation(){let a=2;if(this._getIsCrossDomain())a=1;else if(void 0!==this.webUrl)a=+!(0,i.UA)(n(this.defaultFullWebUrl),n(this._getFullWebUrl()));else{let b=new h.a(this.defaultFullWebUrl).path,c=this._getServerRelativeListUrl()||this._getServerRelativePath();if(void 0!==c)if((0,j.a)(o(c),o(b))){let d=new h.a(n(c)),e=new h.a(n(b));a=2*(d.segments.length-1!==e.segments.length&&(d.segments.length-2!==e.segments.length||"Lists"!==d.segments[d.segments.length-2]))}else a=1}return this._getSiteRelation=()=>a,a}_getFullWebUrl(){let a,b=this._getServerUrl(),c=this._getServerRelativeWebUrl();return void 0!==c&&(a=`${b}${c}`),this._getFullWebUrl=()=>a,a}_getGeoRelation(){if(!this._getIsCrossDomain())return 0;let a=new h.a(this._getServerUrl()).authority;if(!a)return 2;let b=this._getCurrentGeo();if(!b)return 2;let c=this._getGeoByAuthority()[a.toUpperCase()];return c?+!(0,i.UA)(c,b):2}_getGeoByAuthority(){let a={},b={};function c(c,d,e){let f=new h.a(c).authority.toUpperCase();(e||!b[f])&&(a[f]=d),e&&(b[f]=!0)}if(this.multiGeoInfo)for(let a of this.multiGeoInfo){let b=a.InstanceId,d=a.IsDefaultDataLocation;if(c(a.MySiteHostUrl,b,d),c(a.PortalUrl,b,d),c(a.RootSiteUrl,b,d),c(a.TenantAdminUrl,b,d),a.AdditionalUrls)for(let e of a.AdditionalUrls)c(e,b,d);if(this.defaultFullWebUrl&&this.webAbsoluteUrlLegacy){let e=`${new h.a(this.webAbsoluteUrlLegacy).authority}/`;a.MySiteHostUrl===e&&c(`${new h.a(this.defaultFullWebUrl).authority}/`,b,d)}}return this._getGeoByAuthority=()=>a,a}_getCurrentGeo(){let a=this._getCurrentAuthority();if(!a)return;let b=this._getGeoByAuthority()[a.toUpperCase()];return this._getCurrentGeo=()=>b,b}constructor(a){const{defaultFullWebUrl:b,webAbsoluteUrlLegacy:c,defaultListUrl:d,multiGeoInfo:e,options:{path:f,listUrl:g,webUrl:h,mayInferListUrl:j=!1}={}}=a;this._rawPath=f||void 0,this._rawListUrl=g||void 0,this._rawWebUrl=h||void 0,this.defaultFullWebUrl=m(b||void 0);const k=!i.Ov.isActivated("EBF720CC-3C94-4AD7-9B65-1893741C8188");this.webAbsoluteUrlLegacy=k?m(c||void 0):void 0,this.defaultListUrl=m(d||void 0),this.multiGeoInfo=e,this.mayInferListUrl=j}}function l(a){return""===a?"/":a}function m(a){return"/"===a?"/":a}function n(a=""){return"/"===a[a.length-1]?a.substring(0,a.length-1):a}function o(a=""){return"/"===a[a.length-1]?a:`${a}/`}class p{getUrlParts(a){let{webAbsoluteUrl:b,webAbsoluteUrlLegacy:c,listUrl:d,multiGeoInfo:e}=this.itemUrlContext;return new this.itemUrlPartsType({defaultFullWebUrl:b,webAbsoluteUrlLegacy:c,defaultListUrl:d,multiGeoInfo:e,options:a})}constructor(a){const{context:b,itemUrlPartsType:c=k}=a;this.itemUrlPartsType=c,this.itemUrlContext=b}}}
,,,(a,b,c)=>{c.d(b,{a:()=>e,b:()=>k});var d,e,f=c(254),g=c("odsp.util_126");(d=e||(e={}))[d.scheme=0]="scheme",d[d.authority=1]="authority",d[d.path=2]="path",d[d.query=3]="query";let h=/[;\/?:@&=$,]/,i=/[\/?]/;function j(a){let b={};for(let c in a)a.hasOwnProperty(c)&&(b[c.toLowerCase()]=a[c].toLowerCase());return b}class k{static concatenate(...a){let b="";for(let c=0;c<a.length;c++){let d=a[c];c>0&&(d=k.ensureNoPrecedingSlash(d)),c<a.length-1&&(d=k.ensureTrailingSlash(d)),b+=d}return b}static ensureNoPrecedingSlash(a){return"/"===a[0]?a.substr(1):a}static ensureTrailingSlash(a){return"/"!==a[a.length-1]?a+"/":a}getScheme(){return this._scheme}setScheme(a){this._scheme=a}getAuthority(){return this._getAuthority(!1)}setAuthority(a){this._parseAuthority(a)}getUser(){return this._user}getHost(){return this._host}getPort(){return this._port}getPath(a){let b=this._path;return a&&null!==b&&b.lastIndexOf("/")===b.length-1&&(b=b.slice(0,-1)),b}getLeftPart(a){let b=this._scheme+"://";return 1===a&&(b+=this.getAuthority()),2===a&&(b+=this.getPath()),3===a&&(b+=this.getQuery()),b}setPath(a){"mailto"!==this.getScheme().toLowerCase()&&a&&"/"!==a[0]&&(a="/"+a),this._parsePath(a)}getPathSegments(){return this._pathSegments}getLastPathSegment(){let a=this._pathSegments;return a[a.length-1]||""}getQuery(a){return this._serializeQuery(a)}setQuery(a){this.setQueryFromObject(this._deserializeQuery(a))}getQueryAsObject(){return this._query}setQueryFromObject(a){for(let b in this._query={},a)a.hasOwnProperty(b)&&this.setQueryParameter(b,a[b])}getQueryParameter(a){let b=null,c=this._query;if(this._queryCaseInsensitive)for(let d in a=a.toLowerCase(),c)c.hasOwnProperty(d)&&d.toLowerCase()===a&&(b=c[d]);else b=c[a];return b||null}setQueryParameter(a,b,c=!0){let d=this._decodeQueryString(b);(d||c)&&(this._query[this._decodeQueryString(a)]=d)}removeQueryParameter(a){delete this._query[this._decodeQueryString(a)]}getFragment(){return this._fragment}setFragment(a){"#"===a[0]&&(a=a.substring(1)),this._fragment=this._decodeQueryString(a)}equals(a){return(0,g.UA)(this._scheme,a.getScheme())&&this._user===a.getUser()&&(0,g.UA)(this._host,a.getHost())&&this._port===a.getPort()&&this._fragment===a.getFragment()&&this._equalsCaseAppropriate(this.getPath(!0),a.getPath(!0),this._pathCaseInsensitive)&&this._equalsCaseAppropriate(this.getQuery(),a.getQuery(),this._queryCaseInsensitive)}equivalent(a){return(0,g.UA)(this._scheme,a.getScheme())&&(0,g.UA)(this._user,a.getUser())&&(0,g.UA)(this._host,a.getHost())&&(0,g.UA)(this._port,a.getPort())&&(0,g.UA)(this.getPath(!0),a.getPath(!0))&&(0,f.a)(j(this.getQueryAsObject()),j(a.getQueryAsObject()))&&(0,g.UA)(this._fragment,a.getFragment())}toString(a){return this._getStringInternal(!0,a)}getDecodedStringForDisplay(){return this._getStringInternal(!1)}getStringWithoutQueryAndFragment(){return this._getStringWithoutQueryAndFragmentInternal(!0)}_equalsCaseAppropriate(a,b,c){return c?(0,g.UA)(a,b):a===b}_getStringInternal(a,b){let c=this._getStringWithoutQueryAndFragmentInternal(a,b),d=this.getQuery(a);return d&&(c+="?"+d),this._fragment&&(c+="#"+(a?encodeURIComponent(this._fragment):this._fragment)),c}_getStringWithoutQueryAndFragmentInternal(a,b){let c="";this._scheme&&(c+=(a?encodeURIComponent(this._scheme):this._scheme)+":");let d=this._getAuthority(a,b);return d&&(c+="//"+d),this._pathEncoded&&(c+=a?this._pathEncoded:this._path),c}_deserializeQuery(a){let b={};for(let c of(0===a.indexOf("?")&&(a=a.substring(1)),a.split(/[;&]+/))){let a=c.indexOf("=");a<0&&(a=c.length),a>0&&(b[c.substr(0,a)]=c.substr(a+1))}return b}_serializeQuery(a){let b="";for(let c in this._query)if(this._query.hasOwnProperty(c)){let d=c,e=this._query[c];a&&(d=encodeURIComponent(d),e=encodeURIComponent(e)),null===e||""===e?b+=d+"=&":b+=d+"="+e+"&"}return""!==b&&(b=b.slice(0,-1)),b}_parseURI(a){let b=a,c=b.indexOf("#");if(c>=0){let a=b.substring(c+1);this.setFragment(a),b=b.substring(0,c)}let d=b.search(h);if(!(d>=0))return void this.setPath(b);":"===b[d]&&(this.setScheme(b.substring(0,d)),b=b.substring(d+1));let e="";if(0===b.indexOf("//")){let a=(b=b.substring(2)).search(i);if(a>=0?(e=b.substring(0,a),b=b.substring(a)):(e=b,b=""),this.setAuthority(e),!b)return void this.setPath("")}let f=b.indexOf("?");f>=0&&(this.setQuery(b.substring(f+1)),b=b.substring(0,f)),this.setPath(b)}_parseAuthority(a){this._host=a;let b=a.lastIndexOf("@");b>=0&&(this._host=this._host.substring(b+1));let c=this._host.indexOf(":");b<0&&c<0||(b<0?this._host=a:(this._user=a.substring(0,b),this._host=a.substring(b+1)),c>=0&&(this._port=this._host.substring(c+1),this._host=this._host.substring(0,c)),this._user=decodeURIComponent(this._user),this._host=decodeURIComponent(this._host))}_parsePath(a){try{this._path=decodeURIComponent(a)}catch(b){this._path=a}let b=this._pathSegments=[];this._pathEncoded=a;let c=a.split("/");for(let a=0;a<c.length;++a)try{b[a]=decodeURIComponent(c[a])}catch(d){b[a]=c[a]}""===b[0]&&b.shift(),""===b[b.length-1]&&b.pop()}_getAuthority(a,b={}){let c,d,e,f=b&&b.doNotPercentEncodeHost,g="";return a?(c=encodeURIComponent(this._user).replace("%3A",":"),d=f?this._host:encodeURIComponent(this._host),e=encodeURIComponent(this._port)):(c=this._user,d=this._host,e=this._port),""!==c&&(g=c+"@"),""!==this._host&&(g+=d),""!==this._port&&(g+=":"+e),g}_decodeQueryString(a){let b=a;try{b=decodeURIComponent(a.replace(/\+/g," "))}catch(a){}return b}constructor(a,b){this._scheme="",this._user="",this._host="",this._port="",this._path="",this._pathSegments=[],this._pathEncoded="",this._query={},this._fragment="",b&&(this._queryCaseInsensitive=!!b.queryCaseInsensitive,this._pathCaseInsensitive=!!b.pathCaseInsensitive),this._parseURI(a)}}}
,,,,,(a,b,c)=>{c.d(b,{a:()=>f});var d=c(29),e=c(11);let f=(0,d.a)({eventName:"Engagement,",shortEventName:"Engagement"},{name:{isKey:!0,isPrefixingDisabled:!0,type:e.a.String},isIntentional:{isPrefixingDisabled:!0,type:e.a.Boolean},scenario:{isPrefixingDisabled:!0,type:e.a.String},location:{isPrefixingDisabled:!0,type:e.a.String},usageType:{isPrefixingDisabled:!0,type:e.a.String},currentPage:{isPrefixingDisabled:!0,type:e.a.String},previousPage:{isPrefixingDisabled:!0,type:e.a.String},experiment:{isPrefixingDisabled:!0,type:e.a.Object},siteId:{isPrefixingDisabled:!0,type:e.a.String},webId:{isPrefixingDisabled:!0,type:e.a.String},listId:{isPrefixingDisabled:!0,type:e.a.String},groupId:{isPrefixingDisabled:!0,type:e.a.String},docId:{isPrefixingDisabled:!0,type:e.a.String},webTemplateId:{isPrefixingDisabled:!0,type:e.a.String},listTemplateId:{isPrefixingDisabled:!0,type:e.a.String},siteType:{isPrefixingDisabled:!0,type:e.a.String},feature:{isPrefixingDisabled:!0,type:e.a.String},component:{isPrefixingDisabled:!0,type:e.a.String},extraData:e.a.Object,objectType:{isPrefixingDisabled:!0,type:e.a.String},datasource:{isPrefixingDisabled:!0,type:e.a.String},action:{isPrefixingDisabled:!0,type:e.a.String},privacyClassification:{isPrefixingDisabled:!0,type:e.a.String}}).withData({privacyClassification:e.b.optionalDiagnostic,privacyDataTypes:["browsingHistory"]})}
,,(a,b,c)=>{c.d(b,{a:()=>e});var d=c(154);function e(a,b,c){let e="",f=!0;for(let g in b&&(a={...b,...a}),a){let b=a[g];if(!c||"object"!=typeof b&&b||"object"==typeof b&&b&&b.uriValue||"number"==typeof b||"boolean"==typeof b){let a;f?f=!1:e+="&",a="object"==typeof b&&b&&b.uriValue?b.uriValue:(0,d.b)(`${b}`),e+=`${g}=${a}`}}return e}}
,,,,,,(a,b,c)=>{c.d(b,{a:()=>g});var d=c(38);function e(a,b){return new this(a,d.b.Single,b)}function f(a){return new this(null,d.b.Single,a)}function g(a,b,c){class g extends d.c{}return g.logData=b?e:f,(0,d.d)(g.prototype,a,b||{},c),g}}
,(a,b,c)=>{let d;c.d(b,{a:()=>l,b:()=>k});var e=c("odsp.util_126");let f=new Set(e.Ov.isActivated("846423CC-E536-4164-A3AE-0EC1BB5F991D")?[]:["additionalpostdata","alttitle","applicationname","debugginginfo","debugmessage","deferredlistdata","error","errorcodes","errorinfo","errormessage","errorstack","fcilongtasks","fileid","filelisturl","host","message","name","nextlink","pathname","rawerror","rawurl","resourcelocation","result","serverfileref","serverlisturl","siteurls","source","stack","targetfield","trace","ttilongtasks","url","vnexttheme applied","vnexttheme","webabsoluteurl"]);function g(a,b,c){let d;if(!a)return a;for(let h of(d=Array.isArray(a)?[]:Object.create(Object.getPrototypeOf(a)),Object.keys(a))){let i=a[h];if(i=(0,e.dV)(i),e.Ov.isActivated("CF66205D-33E2-4FDD-BD4F-6CE443E89541")?void 0!==i&&(d[h]=i):void 0!==i&&-1===b.indexOf(i)&&(d[h]=i),"object"==typeof i){if(-1!==b.indexOf(i))continue;b.push(i),d[h]=g(i,b,"extraData"===h?f:c),b.pop()}else d[h]=i}return d}var h=c(876),i=c(877);class j{get startDate(){return window.performance&&window.performance.timing&&window.performance.timing.navigationStart?new Date(window.performance.timing.navigationStart):new Date}get startTime(){return this.startDate.getTime()}getTime(){return new Date().getTime()}cleanString(a){return a}addEventHandler(a){let{handler:b}=a,c=`${this._managerName}-${a.sourceName}`;if(j._handlerNameCounts[c]){let a=++j._handlerNameCounts[c];c+=`-${a}`}else j._handlerNameCounts[c]=1;if(this._eventHandlers.push({handleEvent:b,sourceName:c}),a.handleMissedEvents)for(let a of this._buffer.getAll())this._provideEvent(a,b,c);return()=>this.removeEventHandler(b)}removeEventHandler(a){let b=this._eventHandlers;for(let c=0;c<b.length;c++)if(b[c].handleEvent===a){b.splice(c,1);break}}logEvent(a,b){let c=this._buffer,d=this._startedEvents||new Map;b===i.a.End?d.delete(a):b===i.a.Start&&d.set(a,!0);let e=c.isFull,f=function(a){if(a.event.hasBeenProcessed)return a.event;let{event:b,eventType:c}=a;return{data:g(b.data,[b,b.data]),context:g(b.context,[b,b.context]),eventType:c,id:b.id,vector:b.vector,endTime:b.endTime,parentId:b.parentId,metadata:b.metadata,critical:b.critical,eventName:b.eventName,startTime:b.startTime,shortEventName:b.shortEventName,isEventTypePrefixingDisabled:b.isEventTypePrefixingDisabled,hasBeenProcessed:!0}}({event:a,eventType:b});c.push(f);let h=this._eventHandlers.length;!this._hasBufferOverflown&&e&&(this._hasBufferOverflown=!0,0===h&&m(Error("Logging buffer overflow hit before any logging handler was registered")));for(let a=0;a<h;a++)try{let b=this._eventHandlers[a];this._provideEvent(f,b.handleEvent,b.sourceName)}catch(a){m(a)}}isFeatureEnabled(a){return!0}addFeatureEnabler(a){}removeFeatureEnabler(a){}getStack(){let a;try{let a=window;a.______ExpectedError______&&a.______ExpectedError______()}catch(b){a=b}return a&&a.stack||void 0}addUnloadHandler(a){this._unloadHandlers.push(a)}removeUnloadHandler(a){let b=this._unloadHandlers,c=b.indexOf(a);c>-1&&b.splice(c,1)}addOnBeforeUnloadHandler(a){this._onBeforeUnloadHandlers.push(a)}removeOnBeforeUnloadHandler(a){let b=this._onBeforeUnloadHandlers,c=b.indexOf(a);c>-1&&b.splice(c,1)}clearOnBeforeUnloadHandlers(){this._onBeforeUnloadHandlers.length=0}registerCustomBeforeUnload(a){a.addCallback(this._onBeforeUnload)}dispose(){"undefined"!=typeof window&&window&&window.removeEventListener&&window.removeEventListener("beforeunload",this._onBeforeUnload),this._onBeforeUnload()}_provideEvent(a,b,c){a.context["Debug.EventSource"]=c,b(Object.freeze(a))}constructor(a){this._onBeforeUnload=()=>{try{for(let a of this._onBeforeUnloadHandlers)try{this._startedEvents.forEach((b,c)=>{a(c)})}catch{}}catch{}for(let a of(this._startedEvents.clear(),this._unloadHandlers))try{a()}catch{}},this._eventHandlers=[],this._unloadHandlers=[],this._onBeforeUnloadHandlers=[],this._startedEvents=new Map,this._buffer=new h.a(500),this._hasBufferOverflown=!1,this._managerName=a.sourceName,"undefined"!=typeof window&&window&&window.addEventListener&&window.addEventListener("beforeunload",this._onBeforeUnload)}}function k(a){return new j(a)}j._handlerNameCounts={};let l=(d=()=>k({sourceName:"Global"}),"undefined"!=typeof window?window.ODSP_TELEMETRY_MANAGER=window.ODSP_TELEMETRY_MANAGER||d():"undefined"!=typeof self?self.ODSP_TELEMETRY_MANAGER=self.ODSP_TELEMETRY_MANAGER||d():d());function m(a){console.error("Telemetry Manager:",a)}}
,(a,b,c)=>{c.d(b,{a:()=>f});var d={};c.r(d),c.d(d,{Empty:()=>e.gS,_guidRegEx:()=>e.gc,cryptoRandom:()=>e.Mi,generate:()=>e.uq,isValidGuid:()=>e.dy,normalizeDashes:()=>e.TJ,normalizeLower:()=>e.YR,normalizeUpper:()=>e.qO});var e=c("odsp.util_126");let f=d}
,(a,b,c)=>{c.d(b,{a:()=>d,b:()=>e});class d{static hasItemPermission(a,b){return a&&a.permissions&&d.hasPermission(a.permissions,b)}static hasPermission(a,b){return!!b&&!!a&&(b.Low&a.Low)>>>0===b.Low&&(b.High&a.High)>>>0===b.High}static hasAny(a,b){return(b||[]).some(b=>d.hasPermission(a,b))}static hasIdentityPermission(a,b){return b&&a.webPermMasks&&d.hasPermission(a.webPermMasks,b)}}d.viewListItems={High:0,Low:1},d.insertListItems={High:0,Low:2},d.editListItems={High:0,Low:4},d.deleteListItems={High:0,Low:8},d.approveItems={High:0,Low:16},d.openItems={High:0,Low:32},d.viewVersions={High:0,Low:64},d.deleteVersions={High:0,Low:128},d.cancelCheckout={High:0,Low:256},d.managePersonalViews={High:0,Low:512},d.manageLists={High:0,Low:2048},d.viewFormPages={High:0,Low:4096},d.reviewListItems={High:0,Low:16384},d.submitItems={High:0,Low:32768},d.open={High:0,Low:65536},d.viewPages={High:0,Low:131072},d.layoutsPage={High:0,Low:135168},d.addAndCustomizePages={High:0,Low:262144},d.applyThemeAndBorder={High:0,Low:524288},d.viewUsageData={High:0,Low:2097152},d.createSSCSite={High:0,Low:4194304},d.manageSubwebs={High:0,Low:8388608},d.managePermissions={High:0,Low:0x2000000},d.browseDirectories={High:0,Low:0x4000000},d.browseUserInfo={High:0,Low:0x8000000},d.addDelPrivateWebParts={High:0,Low:0x10000000},d.updatePersonalWebParts={High:0,Low:0x20000000},d.manageWeb={High:0,Low:0x40000000},d.useClientIntegration={High:16,Low:0},d.manageAlerts={High:64,Low:0},d.createAlerts={High:128,Low:0},d.editMyUserInfo={High:256,Low:0},d.viewItemsRequiresOpen={High:65536,Low:0},d.enumeratePermissions={High:0x40000000,Low:0},d.useRemoteAPIs={High:32,Low:0},d.fullMaskWithoutACP={High:0x7fffffff,Low:0xfffbffff},d.fullMask={High:0x7fffffff,Low:0xffffffff};let e=d}
,,,(a,b,c)=>{c.d(b,{a:()=>function a(b,c){let h=b||void 0,i=(0,d.b)(b?.stack);return{error:(0,e.a)(b),resultCode:h&&g(h)||b&&b.name||(b?"Unknown":void 0),...h?{..."boolean"==typeof h.isExpected?{resultType:h.isExpected?f.b.ExpectedFailure:f.b.Failure}:{resultType:f.b.Failure}}:{resultType:f.b.Success},...i?{stackTrace:i}:{},extraData:{...h?{..."object"==typeof h.innerError?{innerError:a(h.innerError)}:{},..."string"==typeof h.correlationId?{CorrelationId:h.correlationId}:{},..."object"==typeof h.extraData?{...h.extraData}:{}}:{},...c?.extraData||{}}}},b:()=>g});var d=c(258),e=c(443),f=c(0);function g(a){let b=[];return"object"==typeof a.extraData&&a.extraData&&void 0!==a.extraData.status&&b.push(`[${a.extraData.status}]`),"string"==typeof a.code&&b.push(`${a.code}`),b.join(" ")}}
,(a,b,c)=>{var d,e;c.d(b,{a:()=>d}),(e=d||(d={}))[e.Success=0]="Success",e[e.Failure=1]="Failure",e[e.ExpectedFailure=2]="ExpectedFailure"}
,,(a,b,c)=>{c.d(b,{a:()=>e,b:()=>k.a,c:()=>p,d:()=>n});var d,e,f=c(151),g=c("odsp.util_126"),h=c(30),i=c(11);class j{static _getCorrelationVector(){let a;return"undefined"!=typeof window?a=window.rootVector:"undefined"!=typeof self&&(a=self.rootVector),a||new j}toString(){return`${this.root}#${this.parent}#${this.current}`}constructor(a,b){a?(this.root=a.root,this.parent=a.current):this.root=this.parent=g.gS,b?this.current=b:this.current=g.uq()}}j.RootVector=j._getCorrelationVector();var k=c(877);let l=g.Ov.isActivated("9D29F193-421F-4A86-AD3F-FF9972DC09A1"),m=0;function n(a,b,c,d){(0,f.a)(a,b);let e={};for(let a in c)if(Object.prototype.hasOwnProperty.call(c,a)){let d=c[a],f=e[a]="number"==typeof d?{type:d}:d;f.definedInName=b.shortEventName,f.type===i.a.Number&&(f.isMetric=!0)}a.metadata=d?{...d.prototype.metadata,...e}:e}(d=e||(e={}))[d.Consumer=0]="Consumer",d[d.ConsumerAnonymous=1]="ConsumerAnonymous",d[d.Business=2]="Business",d[d.BusinessAnonymous=3]="BusinessAnonymous",d[d.Unknown=4]="Unknown",d[d.ConsumerOnSPO=5]="ConsumerOnSPO";let o=new WeakMap;class p{static isTypeOf(a){return a.eventName?a.eventName.indexOf(this.prototype.shortEventName+",")>=0:!!a.prototype&&a.prototype.shortEventName===this.prototype.shortEventName}static withManager(a){if(!a||a===h.a)return this;let b=o.get(a);b||(b=new WeakMap,o.set(a,b));let c=b.get(this);if(c)return c;class d extends this{}return d.prototype.manager=a,c=d,b.set(this,c),c}static withData(a){if(!a)return this;let b="function"!=typeof a?b=>({...a,...b}):a;return class extends this{addData(a){let c={...a,...b(a)};return{...c,...super.addData(c)}}}}static withContext(a){if(!a)return this;let b="function"!=typeof a?b=>({...a,...b}):a;return class extends this{addContext(a){let c={...a,...b(a)};return{...c,...super.addContext(c)}}}}static from(a){return a?this.withManager(a.prototype.manager).withContext(b=>a.prototype.addContext(b)).withData(b=>a.prototype.addData(b)):this}addContext(a){return r(this.manager,a,{})}addData(a){return a}_setData(a){let b={...this.addData(this.data),...a};!function(a,b,c,d){for(let e of Object.keys(c))if(e in b){let f=b[e];q(a,c,d,e,f)}}(this.manager,this.metadata,b,this.data)}_logEvent(a){this.manager.logEvent(this,a)}constructor(a,b,c){this.context={},this.data={},this.context={...this.addContext({})},this.id=m++,c&&(this.parentId=c.id),l?this.startTime=a&&a.startTimeOverride||h.a.getTime():this.startTime=(a&&a.startTimeOverride)??h.a.getTime(),this.vector=new j(c?c.vector:j.RootVector),a&&this._setData(a),(l||0!==this.startTime)&&this._logEvent(b)}}function q(a,b,c,d,e){let f=b[d];switch(typeof f){case"string":let h=a.cleanString(f,d,e);void 0!==h&&(c[d]=h);return;case"undefined":return;case"object":(0,g.oI)(f)?c[d]=f:f&&Object.getPrototypeOf(f)===Object.prototype?c[d]=r(a,f,{}):c[d]=f;return;default:c[d]=f;return}}function r(a,b,c){for(let d of Object.keys(b))q(a,b,c,d);return c}let s=p.prototype;s.eventName="EventBase,",s.shortEventName="EventBase",s.critical=!1,s.manager=h.a}
,(a,b,c)=>{c.d(b,{a:()=>A,b:()=>z,c:()=>y,d:()=>B});var d=c("odsp.util_126"),e=c(29),f=c(11);let g=(0,e.a)({eventName:"ExperimentFlight,",shortEventName:"ExperimentFlight"},{experimentId:{isPrefixingDisabled:!0,type:f.a.Number},variant:{isPrefixingDisabled:!0,type:f.a.Number},isAATest:{isPrefixingDisabled:!0,type:f.a.Boolean},isOverride:{isPrefixingDisabled:!0,type:f.a.Boolean},isLoggedAtExposure:{isPrefixingDisabled:!0,type:f.a.Boolean},serverTime:{isPrefixingDisabled:!0,type:f.a.String}});function h(a){let b=a.charCodeAt(0);return b>=65&&b<=90?b-65:b>=97&&b<=122?b-71:b>=48&&b<=57?b+4:43===b?62:63}function i(a,b){let c=b.toString(36);c=Array(4-c.length).join("0")+c;for(let b=0;b<a.length;b++)for(let d=0;d<a[b].length-2;d+=3)if(a[b].substring(d,d+3)===c)return b+4;return 0}function j(a,b){if(b>Math.floor(3*a.length/2)-1)return 0;let c=Math.floor(b/3*2);switch(b%3){case 0:return h(a[c])>>2;case 1:return(3&h(a[c]))<<2|h(a[c+1])>>4;case 2:return 15&h(a[c])}return 0}var k=c(512);let l="expOverrides",m="FeatureOverrides_experiments";function n(a){return"number"==typeof a}function o(a){return Array.isArray(a)&&2===a.length&&n(a[0])&&n(a[1])}function p(a){try{let b=a&&JSON.parse(a);if(Array.isArray(b))return b.filter(o)}catch(a){}return[]}function q(){let a=new Map;for(let b of p((0,k.b)(m)))a.set(b[0],b[1]);for(let b of window&&window.location&&window.location.search?p((0,d.pW)(window.location.search.substr(1))[l]):[])a.set(b[0],b[1]);return a}function r(a){let b=Array.from(a);return(0,k.c)(m,JSON.stringify(b)),b}function s(a,b){try{let c=q();return void 0!==a&&void 0!==b&&c.set(a,b),r(c)}catch(a){return[]}}class t{static get experimentOverrides(){return t._experimentOverridesData||(t._experimentOverridesData=s()),t._experimentOverridesData}static setExperimentOverrideByKey(a,b){return t._experimentOverridesData=s(a,b),t._experimentOverridesData}static removeExperimentOverrideByKey(a){return t._experimentOverridesData=function(a){try{let b=q();return b.delete(a),r(b)}catch(a){return[]}}(a),t._experimentOverridesData}static clear(){t._experimentOverridesData=void 0,(0,k.a)(m)}}t._experimentOverridesData=void 0,d.Ov.isActivated("A2048F93-C4E7-4ED1-B8DF-46FF48B7EA99")||(0,d.PZ)("experiments",{get:()=>({set:t.setExperimentOverrideByKey})});let u="experimentLogCacheTime",v="experimentLogCache",w=!d.Ov.isActivated("4F6F5B50-178E-40E9-B992-A49FC5B41195");class x{get variantToDisplay(){return this._shouldLogVariantPropertyAccess&&this._logInternal(!1),this._variantToDisplay}static getExperimentTags(a){if(void 0===a.experimentData||void 0===a.experimentDataLookup||void 0===a.serverTime)return[];let b=[];for(let c=9e4;c<=90499;c++){let d,e=c-9e4,f=j(a.experimentData,e);if(0!==f){if(f>=1&&f<=4)d=(f-1).toString();else{if(5!==f)continue;d=i(a.experimentDataLookup,e).toString()}if(void 0!==d){let a=`${c.toString()}-${d}`;-1===b.indexOf(a)&&b.push(a)}}}return b}static _getItemFromSessionStorageNoThrow(a){try{return sessionStorage.getItem(a)}catch(a){return null}}static _setItemInSessionStorageNoThrow(a,b){try{sessionStorage.setItem(a,b)}catch(a){}}logExposure(){this._logInternal(!0)}_saveExperiments(){window.ODSP_EXPERIMENTS=window.ODSP_EXPERIMENTS||{},window.ODSP_EXPERIMENTS[this._experimentId]=this}_logInternal(a){let b=void 0!==this._variantToLog&&(a&&!this._loggedExposure||!a&&!this._loggedPropertyAccess),c=null,d=null;if(b&&(c=x._getItemFromSessionStorageNoThrow(u),d=x._getItemFromSessionStorageNoThrow(v),b=c!==this._serverTime||!d||-1===d.indexOf(this._experimentId.toString()+a)),b&&void 0!==this._variantToLog){let b={experimentId:this._experimentId,variant:this._variantToLog,isAATest:this._isAATest,isOverride:this._isOverride,isLoggedAtExposure:a,serverTime:this._serverTime};g.logData(b),a?this._loggedExposure=!0:this._loggedPropertyAccess=!0,c===this._serverTime?x._setItemInSessionStorageNoThrow(v,(d??"")+this._experimentId.toString()+a):(x._setItemInSessionStorageNoThrow(u,this._serverTime),x._setItemInSessionStorageNoThrow(v,this._experimentId.toString()+a))}}_setProperties(a,b,c,d){this._variantToDisplay=a,this._variantToLog=b,this._isAATest=c,this._isOverride=d}constructor(a,b,c){if(this._isAATest=!1,this._isOverride=!1,this._serverTime="",this._shouldLogVariantPropertyAccess=!1,this._loggedPropertyAccess=!1,this._loggedExposure=!1,this._variantToDisplay=0,this._experimentId=a,this._shouldLogVariantPropertyAccess=c,this._serverTime=b?.serverTime??"",w){for(const b of t.experimentOverrides)if(b[0]===a)return void this._setProperties(b[1],b[1],!1,!0)}else if(window&&window.location&&window.location.search){const b=(0,d.pW)(window.location.search.substr(1))[l];if(b){let c;try{c=JSON.parse(b)}catch{c=[]}for(const b of c)if(b&&2===b.length&&b[0]===a)return void this._setProperties(b[1],b[1],!1,!0)}}if(!b||void 0===b.experimentData||void 0===b.experimentDataLookup||void 0===b.serverTime||this._experimentId<9e4){this._variantToDisplay=0,this._variantToLog=void 0;return}const e=a-9e4,f=j(b.experimentData,e);if(0===f)this._setProperties(0,void 0,!1,!1);else if(f>=1&&f<=4)this._setProperties(f-1,f-1,!1,!1);else if(5===f){const a=i(b.experimentDataLookup,e);this._setProperties(a,a,!1,!1)}else if(f>=6&&f<=9)this._setProperties(0,f-6,!0,!1);else if(10===f)this._setProperties(0,i(b.experimentDataLookup,e),!0,!1);else if(f>=11&&f<=14)this._setProperties(f-11,f-11,!1,!0);else{const a=i(b.experimentDataLookup,e);this._setProperties(a,a,!1,!0)}this._saveExperiments()}}function y(a,b){let c=new x(a,b,!1);return c.logExposure(),c.variantToDisplay}function z(a,b){return new x(a,b,!0)}function A(a,b){return new x(a,b,!1).variantToDisplay}function B(a){if(!a)return!1;if(!window.ODSP_EXPERIMENT_TAGS||0===window.ODSP_EXPERIMENT_TAGS.length){let b=x.getExperimentTags(a);if(0===b.length)return!1;window.ODSP_EXPERIMENT_TAGS=b}return!0}}
,(a,b,c)=>{var d,e,f;c.d(b,{a:()=>d,b:()=>i,c:()=>h}),(f=d||(d={}))[f.invalid=-1]="invalid",f[f.teamSite=1]="teamSite",f[f.meetings=2]="meetings",f[f.centralAdmin=3]="centralAdmin",f[f.wiki=4]="wiki",f[f.documentCenter=7]="documentCenter",f[f.blog=9]="blog",f[f.tenantAdmin=16]="tenantAdmin",f[f.app=17]="app",f[f.appCatalog=18]="appCatalog",f[f.mySite=21]="mySite",f[f.subgroup=39]="subgroup",f[f.publishingPortal=52]="publishingPortal",f[f.mySiteHost=54]="mySiteHost",f[f.enterpriseWiki=56]="enterpriseWiki",f[f.group=64]="group",f[f.pointPublishingPersonal=66]="pointPublishingPersonal",f[f.sitePagePublishing=68]="sitePagePublishing",f[f.teamChannel=69]="teamChannel",f[f.projectWebAppSite=6221]="projectWebAppSite",f[f.contentCenter=6001]="contentCenter",(e||(e={})).CatalogSiteSubType="CatalogSite";let g={};for(let a of Object.keys(d))"string"==typeof a&&(g[a.toUpperCase()]=d[a]);function h(a){return Object.keys(g).filter(b=>g[b]===a)[0]}let i=d}
,(a,b,c)=>{var d,e;c.d(b,{a:()=>f}),(e=d||(d={}))[e.none=0]="none",e[e.session=1]="session",e[e.local=2]="local",e[e.sharedMemory=3]="sharedMemory";let f=d}
,(a,b,c)=>{c.d(b,{a:()=>d});let d=c(6).a}
,,,,,(a,b,c)=>{c.d(b,{a:()=>f});var d=c(41);class e{static hasStorageType(a){switch(e.init(),a){case d.a.none:case d.a.sharedMemory:return!0;case d.a.session:return!!e._sessionStorage;case d.a.local:return!!e._localStorage;default:return!1}}static init(){if(!e._initialized){try{"localStorage"in window&&window.localStorage&&e.testStorage(window.localStorage)&&(e._localStorage=window.localStorage)}catch(a){}try{"sessionStorage"in window&&window.sessionStorage&&e.testStorage(window.sessionStorage)&&(e._sessionStorage=window.sessionStorage)}catch(a){}null==e._localStorage&&(e._localStorage=e._sessionStorage),e._initialized=!0}}static testStorage(a){let b="BrowserStorageTest",c=!1;try{a.setItem(b,"1"),"1"===a.getItem(b)&&(c=!0),a.removeItem(b)}catch(a){}return c}setValue(a,b,c,d=!0){a=d?this.normalizeKey(a):a,this.dataStore[a]=b;let e=this.getStorage(c);if(e)try{let c=[],d=JSON.stringify(b,function(a,b){if("object"==typeof b&&null!==b){if(-1!==c.indexOf(b))return;c.push(b)}return b});c=null,e.setItem(this.dataStoreKey+a,d)}catch(a){}}getValue(a,b,c=!0,d=!1){a=c?this.normalizeKey(a):a;let e=this.dataStore[a],f=this.getStorage(b);if((void 0===e||d)&&f){let b=f.getItem(this.dataStoreKey+a);if(b)try{e=JSON.parse(b),this.dataStore[a]=e}catch(a){e=void 0}}return e}remove(a,b,c=!0){a=c?this.normalizeKey(a):a;let d=this.getStorage(b);d&&d.removeItem(this.dataStoreKey+a),delete this.dataStore[a]}getStorage(a){switch(a||this.defaultCachingType){case d.a.none:case d.a.sharedMemory:return null;case d.a.session:return e._sessionStorage;case d.a.local:return e._localStorage;default:return null}}normalizeKey(a){return a&&a.toLowerCase()||""}constructor(a,b=d.a.none){e.init(),this.dataStoreKey=a,this.defaultCachingType=b,b===d.a.none?this.dataStore={}:(void 0===e._dataStore[this.dataStoreKey]&&(e._dataStore[this.dataStoreKey]={}),this.dataStore=e._dataStore[this.dataStoreKey])}}e._sessionStorage=null,e._localStorage=null,e._dataStore={},e._initialized=!1;let f=e}
,(a,b,c)=>{c.d(b,{a:()=>e,b:()=>f});var d=c(9);class e{get promise(){return this._promise}getPromise(){return this._promise}cancel(){this._promise.cancel()}complete(a){this._promise._completed(a)}error(a){this._promise._error(a)}constructor(a){this.resolve=a=>{this._promise._completed(a)},this.reject=a=>{this._promise._error(a)},this._promise=new d.b(a)}}let f=e}
,(a,b,c)=>{c.d(b,{a:()=>h});var d=c("odsp.util_126");let e={ODB:62293},f=d.lU.isFeatureEnabled,g=d.Ov.isActivated("b1e63d31-e2b9-4ff4-af96-b0b1c7b9bc61");function h(){return!g&&f(e)}d.Ov.isActivated("8554a1cb-8785-415a-8e7a-0efaedfb80fa")}
,(a,b,c)=>{c.d(b,{a:()=>g});var d=c(13),e=c("odsp.util_126");class f extends d.c{}class g extends d.b{getUrlParts(a){return super.getUrlParts(a)}getItemUrlParts(a){let b=(0,e.pW)(a);return this.getUrlParts({path:b.id,listUrl:b.listurl})}constructor(a,b){const{itemUrlPartsType:c=f}=b;super({context:b.pageContext,itemUrlPartsType:c})}}}
,,,,,,,,,(a,b,c)=>{c.d(b,{a:()=>h,b:()=>i});var d=c(9),e=c(252);c(226);var f=c(455),g=c("odsp.util_126");class h{static parseJSON(a){return a&&JSON.parse(a)||void 0}getData(a){let b,c,f=()=>{a.onBeforeRequest&&a.onBeforeRequest();let b=e.a.getRUMOneLogger(),c=Date.now();b&&!b.readTempData("appDataFetchStart")&&b.saveTempData("appDataFetchStart",c)};if(a.cancelToken)return d.c.resolve(this._dataRequestorNew.getData({...a,onBeforeRequest:f}));let h=new g.CC;return this._dataRequestorNew.getData({...a,onBeforeRequest:f,cancelToken:h.token}).then(a=>{b?.(a),h?.dispose()}).catch(a=>{c?.(a),h?.dispose()}),new d.c((a,d)=>{b=a,c=d},()=>{h.cancel()})}constructor(a,b){const c=b?b.pageContext:a.pageContext;this._dataRequestorNew=new f.a({...a,normalizeErrors:!!a.normalizeErrors},{...b||{},dataRequestorContext:c,noRedirect:b?.noRedirect??!!b?.tokenProvider})}}let i=h}
,(a,b,c)=>{c.d(b,{a:()=>f,b:()=>e});var d=c(154);class e{toString(){let a,b=[];this._parameters.length&&b.push(this._parameters.map(({name:a,serializedValue:b})=>`${a}=${b}`).join("&")),b.push(...this._rawParameters),a=b.length?`?${b.join("&")}`:"";let c=this._webUrl||this._webAbsoluteUrl||"",d=c.indexOf("?"),e=d>-1?c.slice(0,d):c,f=[this._encodeWebAbsoluteUrl?encodeURI(e):e,"_api",...this._segments];return`${f.join("/")}${a}`}segment(a){return this._extend({segments:[a]})}segments(...a){return this._extend({segments:a})}methodWithAliases(a,b){let c=this,d=[];for(let a of Object.keys(b)){let e=b[a],f=c._autoParameter(e);c=f.apiUrl,d.push(`${a}=${f.name}`)}return c.segment(`${a}(${d.join(",")})`)}method(a,...b){let c=this,d=[];for(let a of b){let b=c._autoParameter(a);c=b.apiUrl,d.push(b.name)}return c.segment(`${a}(${d.join(",")})`)}parameter(a,b){return this._parameter(a,b)}parameters(a){let b=this;for(let c of Object.keys(a)){let d=a[c];b=b.parameter(c,d)}return b}oDataParameter(a,b){return this.parameter(a,{raw:b})}rawParameter(a){return this._extend({rawParameters:[a]})}clone(){return new e({webAbsoluteUrl:this._webAbsoluteUrl,encodeWebAbsoluteUrl:this._encodeWebAbsoluteUrl})}_extend(a={}){let b=this.clone();return b._webUrl=this._webUrl,b._lastParameterId=this._lastParameterId,b._parameters.push(...this._parameters),b._segments.push(...this._segments),b._rawParameters.push(...this._rawParameters),"webUrl"in a&&(b._webUrl=a.webUrl),"lastParameterId"in a&&void 0!==a.lastParameterId&&(b._lastParameterId=a.lastParameterId),"parameters"in a&&void 0!==a.parameters&&b._parameters.push(...a.parameters),"rawParameters"in a&&void 0!==a.rawParameters&&b._rawParameters.push(...a.rawParameters),"segments"in a&&void 0!==a.segments&&b._segments.push(...a.segments),b}_autoParameter(a){let b=this._lastParameterId+1,c=`@a${b}`,d=this._extend({lastParameterId:b})._parameter(c,a);return{name:c,apiUrl:d}}_parameter(a,b){let c;return c=b&&"object"==typeof b&&"json"in b?d.a(JSON.stringify(b.json)):b&&"object"==typeof b&&"guid"in b?`guid'${b.guid}'`:b&&"object"==typeof b&&"raw"in b?b.raw:"number"==typeof b||"boolean"==typeof b?`${b}`:`'${d.a(b)}'`,this._extend({parameters:[{name:a,serializedValue:c}]})}constructor(a){const{webAbsoluteUrl:b,encodeWebAbsoluteUrl:c=!0}=a;this._webAbsoluteUrl=b,this._encodeWebAbsoluteUrl=c,this._segments=[],this._parameters=[],this._rawParameters=[],this._lastParameterId=0}}class f{get webAbsoluteUrl(){return this._webAbsoluteUrl}build(){return new this._apiUrlType}contextInfoUrl(a){let b,c=a.indexOf("/_layouts/");if(c>-1)b=a.substring(0,c);else{let c=a.lastIndexOf("/"),d=a.lastIndexOf(".");b=d>c?`${a.substring(0,d)}_${a.substring(d+1)}`:a}return`${b}/_api/contextinfo`}constructor(a){this._apiUrlType=class extends e{constructor(){super({webAbsoluteUrl:a.webAbsoluteUrl,encodeWebAbsoluteUrl:a.encodeWebAbsoluteUrl})}},this._webAbsoluteUrl=a.webAbsoluteUrl}}}
,(a,b,c)=>{function d(a){if(!a)return{};var b=decodeURIComponent(a).split(".")[1];if(!b)return{};try{let a=atob(b.replace(/-/g,"+").replace(/_/g,"/"));return JSON.parse(a)}catch(a){return{}}}function e(a,b=Date.now()){let c=b/1e3;if(!a)return!1;let d=a.exp,f=a.nbf;return("number"!=typeof f||c>=f)&&("number"!=typeof d||c<d)}c.d(b,{a:()=>e,b:()=>d})}
,(a,b,c)=>{c.d(b,{a:()=>e});class d{static invalidate(a){"undefined"!=typeof window&&(d.isRightToLeft=window.document&&"rtl"===document.documentElement.getAttribute("dir"),d.safeLeft=d.isRightToLeft?"right":"left",d.safeRight=d.isRightToLeft?"left":"right",d.language=(a=a||window._spPageContextInfo&&window._spPageContextInfo.currentUICultureName)||window.document&&(document.documentElement.getAttribute("lang")||document.documentElement.getAttribute("xml:lang"))||"en-us",d.cultureLCID=window._spPageContextInfo&&window._spPageContextInfo.currentCultureName||d.language)}}d.invalidate();let e=d}
,(a,b,c)=>{c.d(b,{a:()=>d});let d=c(78)}
,,,,,,,(a,b,c)=>{c.d(b,{a:()=>j,b:()=>i,c:()=>g,d:()=>f,e:()=>e,f:()=>h});var d=c("react-lib");function e(a,b){let c={...a};return Object.keys(c).forEach(a=>{b.has(a)&&delete c[a]}),c}function f(a,b){return e(a,b)}let g=a=>{let b={};return a&&(a.ariaLabel&&(b["aria-label"]=a.ariaLabel),a.ariaLabelledBy&&(b["aria-labelledby"]=a.ariaLabelledBy),a.ariaDescribedBy&&(b["aria-describedby"]=a.ariaDescribedBy),a["aria-live"]&&(b["aria-live"]=a["aria-live"])),b},h=()=>{let[a,b]=d.useState(null);return d.useEffect(()=>{if(!a)return;let b=a.parentElement,c=b?._virtual?.parent;c&&!document.contains(c)&&(b._virtual={parent:document.body})},[a]),b},i=["above-start","above","above-end","above","below-start","below","below-end","below","before-top","before","before-bottom","after-top","after","after-bottom"],j=["below-start","below","below-end","below","above-start","above","above-end","above","after-top","after","after-bottom","before-top","before","before-bottom"]}
,,(a,b,c)=>{c.d(b,{a:()=>j,b:()=>l,c:()=>k});var d=c("react-lib"),e=c("odsp.util_126");let f=[],g=new Set,h=d.createContext(void 0),i=e.Ov.isActivated("DA77ABE9-FDAB-49E0-8592-9514C02070B0");function j(a){return d.createElement(h.Provider,{value:a.resources},a.children)}function k(a){let b=d.useContext(h);if(!b&&!a?.suppressError)throw Error("No ResourceScope available in the current React context. Use ResourcesProvider to inject a ResourceScope.");return b}function l(a,b=[]){let{getResourcePack:c,initializeResources:h,options:j={owner:""}}=a,m=k(),[n]=function(a,b=f){let[c,h]=d.useMemo(()=>{let b=new e.XW;g.add(b);let c=a();for(let a of Object.keys(c))c[a]&&b.attach(c[a]);return[b,c]},b);return d.useLayoutEffect(()=>(g.delete(c),()=>{c.dispose()}),[c]),h}(()=>{let a=new e.ny(m,j);if(c)a.exposeFromPack(c());else if(h){let b=h(a);return[a,b]}return[a]},i?b:[m,...b]);return n}}
,,,(a,b,c)=>{c.d(b,{a:()=>q,b:()=>r,c:()=>f.a});var d=c(77),e=c(11),f=c(36),g=c(30),h=c(139),i=c("odsp.util_126");let j=!i.Ov.isActivated("F68B6171-BBD4-440F-9527-F56CE8D3EA2C","01/06/2024","collect flight and experiment"),k=!i.Ov.isActivated("2EFBCD63-564E-413D-AE65-39EFA104910B","06/12/2024","use end time override"),l=!i.Ov.isActivated("49bcbbce-f172-4626-8eef-1fd842a3af00","06/18/2024","Include isNucleusEnabled for customer promises"),m=i.Ov.isActivated("A3DFFC53-5DEF-4C11-B12C-84558BD15CBF"),n=i.Ov.isActivated("4279556e-e9cd-490e-a9b1-6046f6053f07"),o=!i.Ov.isActivated("f00a10d6-c80d-49a2-9636-1b349f88c198"),p="Missing Perf Goal",q=(0,d.a)({eventName:"CustomerPromise,",shortEventName:"CustomerPromise"},{scenario:{isKey:!0,isPrefixingDisabled:!0,type:e.a.String},errorCode:{isPrefixingDisabled:!0,type:e.a.String},resultType:{typeRef:f.a,isPrefixingDisabled:!0,type:e.a.Enum},resultCategory:{isPrefixingDisabled:!0,type:e.a.String},extraData:e.a.Object,httpStatus:{isPrefixingDisabled:!0,type:e.a.Number},perfGoalInMs:{isPrefixingDisabled:!0,type:e.a.Number},duration:{isPrefixingDisabled:!0,type:e.a.Number},pillar:{isPrefixingDisabled:!0,type:e.a.String},veto:{isPrefixingDisabled:!0,type:e.a.String},isStaging:{isPrefixingDisabled:!0,type:e.a.Boolean},product:{isPrefixingDisabled:!0,type:e.a.String},conversationId:{isPrefixingDisabled:!0,type:e.a.String},ashaFeature:{isPrefixingDisabled:!0,type:e.a.String},isNucleusEnabled:{isPrefixingDisabled:!0,type:e.a.Boolean},copilotFeatureActionType:{isPrefixingDisabled:!0,type:e.a.String}}),r=(class extends q{end(a){var b,d;if(a&&a.extraData&&this.data.extraData&&(a={...a,extraData:{...this.data.extraData,...a.extraData}}),a&&a.errorCode!==p&&(a=this._assessPerf(a)),a&&a.veto&&"None"!==a.veto&&(b=this.data,d=a,i.lU.isFeatureEnabled({ODB:62109})&&(console.info("ASHA failure trace"),console.trace(),console.info("ASHA failure start and end data"),console.info(b,d),c.e(3).then(c.bind(c,790)).then(({ashaAlert:a})=>{a(b,d)}).catch(()=>{}))),!j)try{let b=this._collectExperiments();b&&a&&(a.extraData={...a.extraData,experiments:b});let c=window._spPageContextInfo;if(a&&!c&&(c=a.spPageContext),this.data&&!c&&(c=this.data.spPageContext),c){let b=this._collectSPClientFlights(c);b&&a&&(a.extraData={...a.extraData,flights:b})}}catch{}return super.end(a)}_assessPerf(a){if(!this.endTime){let b=a.perfGoalInMs||this.data.perfGoalInMs;b&&a.resultType!==f.a.Failure&&b<(k&&a.endTimeOverride?a.endTimeOverride:g.a.getTime())-this.startTime&&(a={...a,resultType:!n&&a.isPerfGoalExpectedFailure?.()?f.a.ExpectedFailure:f.a.Failure,errorCode:p,veto:m?void 0:this.data.pillar?this._getMissingPerfGoalVeto(this.data.pillar):"None",extraData:a.errorCode?{...a.extraData,innerErrorCode:a.errorCode}:void 0})}return a}_collectExperiments(){let a,b=window.ODSP_EXPERIMENTS||{};for(let c in b)if(b.hasOwnProperty(c)){a=a||{};let d=b[c];d&&d._serverTime&&Date.now()-new Date(d._serverTime).getTime()<1296e6&&(a[c]=b[c])}return a}_collectSPClientFlights(a){let b,{ExpFeatures:c}=a;if(c)for(let a of(b="",c))b+=this._numberToBinString(a).split("").reverse().join("");if(o){let c=this._collectEcsClientFlights(a);c&&(b+=`|${c}`)}return b}_numberToBinString(a){let b=(a>>>0).toString(2);return`${Array(32-b.length+1).join("0")}${b}`}_collectEcsClientFlights(a){let{ECSClientFeatures:b}=a;return Object.keys(i.u9.EcsClientFlightInfo).map(a=>`ECS_${String(a)}_${(0,i.Us)(a,b)}`).join(",")}_getMissingPerfGoalVeto(a){switch(a){case"Create":return"perf goal miss (create)";case"Boot":return"perf goal miss (boot)";case"View":return"perf goal miss (view)";case"Edit":return"perf goal miss (edit)";case"Share":return"perf goal miss (share)";case"Freshness":return"perf goal miss (freshness)";case"Delete":return"perf goal miss (delete)";case"Social":return"perf goal miss (social)";case"Upload":return"perf goal miss (upload)";case"Search":return"perf goal miss (search)"}return"None"}constructor(a){super(function(a){return l&&a&&(a.isNucleusEnabled=!!window.__isListDataSyncEnabled),a}(a)),a&&a.perfGoalInMs&&this.setTimeout(a?.perfGoalInMs,{resultType:!n&&a.isPerfGoalExpectedFailure?.()?f.a.ExpectedFailure:f.a.Failure,errorCode:p,veto:m?void 0:this.data.pillar?this._getMissingPerfGoalVeto(this.data.pillar):"None",extraData:{...a}})}}).withManager((0,h.a)())}
,,(a,b,c)=>{c.d(b,{a:()=>j});var d=c("odsp.util_126"),e=c(38),f=c(30),g=c(11);let h=d.Ov.isActivated("9D29F193-421F-4A86-AD3F-FF9972DC09A1");class i extends e.c{setTimeout(a,b){this._clearTimeout(),this.timeoutId=window.setTimeout(()=>{this.end(b)},a)}end(a){if(!this.endTime){h?this.endTime=a&&a.endTimeOverride||f.a.getTime():this.endTime=(a&&a.endTimeOverride)??f.a.getTime();let b={duration:h||0!==this.startTime&&0!==this.endTime?this.endTime-this.startTime:0,...a};this._setData(b),this.data.error&&!(0,d.oI)(this.data.error)&&(this.data.error=(0,d.ve)(this.data.error,!1)),(h||0!==this.endTime)&&this._logEvent(e.b.End),this._clearTimeout()}}_clearTimeout(){this.timeoutId&&(window.clearTimeout(this.timeoutId),this.timeoutId=void 0)}constructor(a,b){super(a,e.b.Start,b)}}function j(a,b,c){class d extends i{}let f={...b,duration:{isPrefixingDisabled:!0,type:g.a.Number}};return(0,e.d)(d.prototype,a,f,c),d}}
,(a,b,c)=>{c.r(b),c.d(b,{getErrorMessage:()=>x,isExpectedError:()=>y,log:()=>w,logError:()=>v,verbose:()=>u});var d=c(29),e=c(11),f=c(227);let g=(0,d.a)({eventName:"CaughtError,Trace,",shortEventName:"CaughtError",critical:!0},{stack:e.a.String,extraData:e.a.Object,privacyClassification:{isPrefixingDisabled:!0,type:e.a.String}},f.a).withData({privacyClassification:e.b.requiredService});var h=c(36);let i=(0,d.a)({eventName:"QosError,CaughtError,Trace,",shortEventName:"QosError",critical:!0},{name:{isKey:!0,type:e.a.String},resultCode:e.a.String,resultType:{typeRef:h.a,type:e.a.Enum}},g).withData({privacyClassification:e.b.requiredDiagnostic});var j=c(146),k=c(876),l=c(103),m=c("odsp.util_126"),n=c(35),o=c(0),p=c(287);let q=m.Ov.isActivated("6C46088C-BA1D-4AA5-8FDC-4CF0FCF6A743"),r=m.Ov.isActivated("8124A385-5729-43AC-B1C9-D54AD0872A5D"),s="Canceled",t=new k.a(50);function u(a,b){t.push({name:b,message:a})}function v(a,b,c){try{var d;let e;if(!a||(d=a)===s||d?.name===s||d?.message===s||"object"==typeof a&&a.isExpected)return;if(!q){let{eventName:d,...e}=c||{};new o.a({name:`CaughtError${!r&&d?`.${d}`:""}`,startTimeOverride:0}).end((0,p.a)((0,n.a)(a),{extraData:b},...e?[e]:[]));return}let f=x(a),h=a?.stack??"";for(;e=t.popOldest();)j.a.logData(e);c&&c.eventName?i.logData({name:c.eventName,resultCode:c.resultCode,resultType:c.resultType,extraData:b||{},message:f,stack:h}):g.logData({extraData:b||{},message:f,stack:h})}catch{}}function w(a,b,c,d){v(a,void 0,{eventName:b,resultCode:c,resultType:d})}function x(a){return a?"object"==typeof a?a.message??a.description??(0,l.a)(a):a.toString():""}function y(a,b){if(!0===a.isExpected)return!0;void 0===a.message&&void 0===a.code&&console.error('Error message and code are both undefined. "error" must specify at least message or code');let c=(a,b)=>!!(a&&b)&&(0===a.localeCompare(b,void 0,{sensitivity:"base"})||a===b),d=!1;for(let e of b){let b=c(e.code,a.code),f=c(e.message,a.message);if(e.code&&a.code&&e.message&&a.message?d=b&&f:e.code&&a.code?d=b:e.message&&a.message&&(d=f),d)break}return d}}
,,(a,b,c)=>{c.d(b,{a:()=>f});var d=c(249);function e(a){setTimeout(()=>{throw a},0)}class f{static raise(a,b,c,e){return d.c(a,b,c,e)}static isObserved(a,b){let c=a&&a.__events__;return!!c&&!!c[b]}static isDeclared(a,b){let c=a&&a.__declaredEvents;return!!c&&!!c[b]}static stopPropagation(a){a.stopPropagation&&a.stopPropagation()}dispose(){this._isDisposed||(this._isDisposed=!0,this.off(),this._parent=null)}onAll(a,b,c){for(let d in b)this.on(a,d,b[d],c)}on(a,b,c,e){if(b.indexOf(",")>-1){let d=b.split(/[ ,]+/);for(let b=0;b<d.length;b++)this.on(a,d[b],c,e)}else{let g=this._parent,h={target:a,eventName:b,parent:g,callback:c,objectCallback:null,elementCallback:null,useCapture:e},i=a.__events__=a.__events__||{};if(i[b]=i[b]||{count:0},i[b][this._id]=i[b][this._id]||[],i[b][this._id].push(h),i[b].count++,d.b(a)){let d=(...a)=>{let b;if(!this._isDisposed){try{if(b=c.apply(g,a),!1===b&&a[0]&&a[0].preventDefault){let b=a[0];b.preventDefault(),f.stopPropagation(b)}}catch(a){this._onError(a)}return b}};h.elementCallback=d,a.addEventListener(b,d,e)}else h.objectCallback=(...a)=>{if(!this._isDisposed)return c.apply(g,a)};this._eventRecords.push(h)}}off(a,b,c,d){for(let e=0;e<this._eventRecords.length;e++){let f=this._eventRecords[e];if((!a||a===f.target)&&(!b||b===f.eventName)&&(!c||c===f.callback)&&("boolean"!=typeof d||d===f.useCapture)){let a=f.target.__events__,b=a[f.eventName],d=b?b[this._id]:null;d&&(1!==d.length&&c?(b.count--,d.splice(d.indexOf(f),1)):(b.count-=d.length,delete a[f.eventName][this._id]),b.count||delete a[f.eventName]),f.elementCallback&&f.target.removeEventListener&&f.target.removeEventListener(f.eventName,f.elementCallback,f.useCapture),this._eventRecords.splice(e--,1)}}}raise(a,b,c){return f.raise(this._parent,a,b,c)}declare(a){let b=this._parent.__declaredEvents=this._parent.__declaredEvents||{};if("string"==typeof a)b[a]=!0;else for(let c=0;c<a.length;c++)b[a[c]]=!0}constructor(a,b=e){this._id=f._uniqueId++,this._parent=a,this._onError=b,this._eventRecords=[]}}f._uniqueId=0}
,(a,b,c)=>{c.d(b,{a:()=>i,b:()=>h,c:()=>f,d:()=>g});var d=c(525),e=c("odsp.util_126");function f(a){let b=a.lastIndexOf("/");return b>=0?a.substring(b+1):a}function g(a){return decodeURI(a)}function h(a){let b;try{b=decodeURI(a)}catch(c){b=a}return b===a?a=(0,d.a)(a,!0):(a=a.replace("#","%23"),!e.Ov.isActivated("589c6b39-fbce-42b5-bff1-125e13e2367a","05/19/2021","encode url with %number in the name")&&!e.B3.isFeatureEnabled({ECS:83959})&&a.indexOf("%25")&&(a=(0,d.a)(a,!0))),a}function i(a){return a&&0>a.indexOf("?")&&(a=(a=encodeURI(a)).replace(/#/g,"%23")),a}}
,,(a,b,c)=>{c.d(b,{a:()=>e});var d=c("react-lib");function e(a){let b=d.useRef(a);b.current=a;let c=d.useRef();return c.current||(c.current=(...a)=>b.current.apply(null,a))}}
,,,,,,,,,,,,(a,b,c)=>{var d,e;c.d(b,{a:()=>d}),(e=d||(d={}))[e.none=0]="none",e[e.view=1]="view",e[e.edit=2]="edit",e[e.owner=3]="owner",e[e.limitedView=4]="limitedView",e[e.limitedEdit=5]="limitedEdit",e[e.review=6]="review",e[e.restrictedview=7]="restrictedview",e[e.submit=8]="submit",e[e.manageList=9]="manageList"}
,(a,b,c)=>{c.d(b,{a:()=>h,b:()=>g.a});var d=c(77),e=c(11),f=c(0),g=c(36);let h=(0,d.a)({eventName:"Api,Qos,",shortEventName:"Api"},{url:e.a.String,privacyClassification:{isPrefixingDisabled:!0,type:e.a.String}},f.a).withData({privacyClassification:e.b.requiredService})}
,,,,,(a,b,c)=>{c.d(b,{a:()=>d});class d{once(a,b){let c,d=a=>{b(a),this._removeRemovalCallback(c)};c=()=>{this._eventTarget.removeEventListener(a,d)},this._eventTarget.addEventListener(a,d,{once:!0}),this._removals.push(c)}subscribe(a,b){let c=this._eventTarget;c.addEventListener(a,b);let d=()=>{c.removeEventListener(a,b)};return this._removals.push(d),()=>{d(),this._removeRemovalCallback(d)}}publish(a,b){this._eventTarget.dispatchEvent(new CustomEvent(a,{detail:b}))}dispose(){for(let a of this._removals)a();this._removals=[]}_removeRemovalCallback(a){let b=this._removals.indexOf(a);b>=0&&this._removals.splice(b,1)}constructor(){this._eventTarget=new EventTarget,this._removals=[]}}}
,(a,b,c)=>{c.d(b,{a:()=>k,b:()=>g,c:()=>j,d:()=>h,e:()=>i});var d,e,f=c(150);function g(a){return Number(a)===e.DocumentLibrary}function h(a){return a===f.a.genericList||a===f.a.announcements||a===f.a.issueTracking||a===f.a.contacts||a===f.a.customGrid}function i(a){return Number(a)===f.a.promotedLinks}function j(a){return Number(a)===f.a.events}(d=e||(e={}))[d.invalidType=-1]="invalidType",d[d.GenericList=0]="GenericList",d[d.DocumentLibrary=1]="DocumentLibrary",f.a.mySiteDocumentLibrary,f.a.documentLibrary,f.a.pictureLibrary,f.a.xmlFormLibrary,f.a.webPageLibrary,f.a.publishingPageLibrary,f.a.publishingAsset,f.a.documentLibrary,f.a.contentCenterPrimeLibrary;let k=f.a}
,(a,b,c)=>{c.d(b,{a:()=>d});function d(a){let b;try{let c=[];b=JSON.stringify(a,(a,b)=>b===window?"[window]":b instanceof HTMLElement?"[HTMLElement]":"function"==typeof b?"[function]":"object"!=typeof b||null===b?b:-1===c.indexOf(b)?(c.push(b),b):"[circular]")}catch(a){b=JSON.stringify("[object]")}return b}}
,(a,b,c)=>{c.d(b,{a:()=>e,b:()=>f});var d=c(59);class e{getDataSourceName(){return this.dataSourceName}needsRequestDigest(a){return!0}getData(a,b,c,d,e="POST",f,g,h,i,j,k,l,m,n,o,p,q){let r=a(),s=d&&d(),t=this.needsRequestDigest(r);return this.dataRequestor.getData({url:r,parseResponse:b,qosName:c,additionalPostData:s,method:e,additionalHeaders:f,contentType:g,maxRetries:h,noRedirect:i,crossSiteCollectionCall:j,telemetryHandler:k,qosExtraData:l,needsRequestDigest:t,authToken:m,webAbsoluteUrl:n,useExactAuthToken:o,skipSyncClient:p,customerPromise:q})}constructor(a,b){const c=this._pageContext=b.pageContext,e=b.tokenProvider,f=b.noRedirect,g=b.normalizeErrors,{dataRequestorType:h=class extends d.b{constructor(a){super(a,{pageContext:c,tokenProvider:e,noRedirect:f})}}}=b,{dataSourceName:i="DataSource"}=a;this.dataRequestor=new h({qosName:i,normalizeErrors:g})}}let f=e}
,(a,b,c)=>{function d(){}function e(a){setTimeout(()=>{throw a},0)}c.d(b,{a:()=>f});class f{dispose(){if(!this._isDisposed){if(this._isDisposed=!0,this._parent=null,this._timeoutIds){for(let a of Object.keys(this._timeoutIds))this.clearTimeout(Number(a));this._timeoutIds=null}if(this._immediateIds){for(let a of Object.keys(this._immediateIds))this.clearImmediate(Number(a));this._immediateIds=null}if(this._intervalIds){for(let a of Object.keys(this._intervalIds))this.clearInterval(Number(a));this._intervalIds=null}if(this._animationFrameIds){for(let a of Object.keys(this._animationFrameIds))this.cancelAnimationFrame(Number(a));this._animationFrameIds=null}}}setTimeout(a,b){let c=0;if(!this._isDisposed){let d=this._timeoutIds||(this._timeoutIds={}),e=this._parent;d[c=setTimeout(()=>{try{delete d[c],a.apply(e)}catch(a){this._logError(a)}},b)]=!0}return c}clearTimeout(a){let b=this._timeoutIds;b&&b[a]&&(clearTimeout(a),delete b[a])}setImmediate(a){let b=0;if(!this._isDisposed){let c=this._immediateIds||(this._immediateIds={}),d=this._parent,e=()=>{try{delete c[b],a.apply(d)}catch(a){this._logError(a)}};c[b=window.setImmediate?window.setImmediate(e):window.setTimeout(e,0)]=!0}return b}clearImmediate(a){let b=this._immediateIds;b&&b[a]&&(window.clearImmediate?window.clearImmediate(a):window.clearTimeout(a),delete b[a])}setInterval(a,b){let c=0;if(!this._isDisposed){this._intervalIds||(this._intervalIds={});let d=this._parent;c=setInterval(()=>{try{a.apply(d)}catch(a){this._logError(a)}},b),this._intervalIds[c]=!0}return c}clearInterval(a){this._intervalIds&&this._intervalIds[a]&&(clearInterval(a),delete this._intervalIds[a])}throttle(a,b,c={}){let e,f;if(this._isDisposed)return d;let g=b||0,{leading:h=!0,trailing:i=!0}=c,j=0,k=null,l=this._parent,m=b=>{let c=new Date().getTime(),d=c-j;return d>=g&&(!b||h)?(j=c,k&&(this.clearTimeout(k),k=null),e=a.apply(l,f)):null===k&&i&&(k=this.setTimeout(m,h?g-d:g)),e};return(...a)=>(f=a,m(!0))}debounce(a,b,c={}){let e,f;if(this._isDisposed)return d;let g=b||0,{leading:h=!1,trailing:i=!0,maxWait:j=NaN}=c,k=0,l=new Date().getTime(),m=null,n=this._parent,o=b=>{let c=new Date().getTime(),d=!1;b&&(h&&c-k>=g&&(d=!0),k=c);let p=c-k,q=g-p,r=c-l,s=!1;return isNaN(j)||(r>=j&&m?s=!0:q=Math.min(q,j-r)),p>=g||s||d?(m&&(this.clearTimeout(m),m=null),l=c,e=a.apply(n,f)):(null===m||!b)&&i&&(m=this.setTimeout(o,q)),e};return(...a)=>(f=a,o(!0))}requestAnimationFrame(a){let b=0;if(!this._isDisposed){let c=this._animationFrameIds||(this._animationFrameIds={}),d=this._parent,e=()=>{try{delete c[b],a.apply(d)}catch(a){this._logError(a)}};c[b=window.requestAnimationFrame?window.requestAnimationFrame(e):window.setTimeout(e,0)]=!0}return b}cancelAnimationFrame(a){let b=this._animationFrameIds;b&&b[a]&&(window.cancelAnimationFrame?window.cancelAnimationFrame(a):window.clearTimeout(a),delete b[a])}_logError(a){this._onErrorHandler&&this._onErrorHandler(a)}constructor(a,b=e){this._isDisposed=!1,this._parent=a||null,this._onErrorHandler=b,this._timeoutIds=null,this._immediateIds=null,this._animationFrameIds=null,this._intervalIds=null}}}
,(a,b,c)=>{let d,e,f,g,h,i;c.d(b,{a:()=>m});let j=[];async function k(){if(!h&&(h=c.e(11).then(c.bind(c,792)),i=(await h).tools,j.length)){for(let a of j)await a(i);j=[]}}function l(a){i?a(i):j.push(a)}function m(){return window.$copilot||(window.$copilot={availability:{},loadDebugTools:k,get tools(){if(!i)throw Error("Call `await $copilot.loadDebugTools()` first to load the tools");return i},context:{},get perfCounters(){return{featuresOn:d,featuresOff:e,killSwitchesOn:f,killSwitchesOff:g}},internal:{onDebugToolsLoaded:l}}),window.$copilot}}
,,(a,b,c)=>{var d,e;c.d(b,{a:()=>d,b:()=>f}),(e=d||(d={}))[e.download=0]="download",e[e.open=1]="open",e[e.textContent=2]="textContent",e[e.viewInBrowser=3]="viewInBrowser",e[e.bingClickInstrumentation=4]="bingClickInstrumentation",e[e.original=5]="original",e[e.shortcutTarget=6]="shortcutTarget",e[e.video=7]="video",e[e.downloadAsZip=8]="downloadAsZip",e[e.itemUrl=9]="itemUrl",e[e.mediaBaseUrl=10]="mediaBaseUrl",e[e.immersiveReaderUrl=11]="immersiveReaderUrl",e[e.thumbnailSpriteBaseUrl=12]="thumbnailSpriteBaseUrl",e[e.downloadUrlNoAuth=13]="downloadUrlNoAuth";let f=d}
,(a,b,c)=>{c.d(b,{a:()=>e,b:()=>d});let d="share",e="recoverMainLinkFileRename"}
,(a,b,c)=>{var d,e;c.d(b,{a:()=>f}),(e=d||(d={}))[e.File=0]="File",e[e.Folder=1]="Folder",e[e.Media=2]="Media",e[e.OneNote=3]="OneNote",e[e.Unknown=4]="Unknown",e[e.Error=5]="Error",e[e.App=6]="App",e[e.Subsite=7]="Subsite",e[e.Shortcut=8]="Shortcut",e[e.Album=9]="Album",e[e.MultiShare=10]="MultiShare";let f=d}
,(a,b,c)=>{c.d(b,{a:()=>t,b:()=>s,c:()=>v,d:()=>u});var d,e,f,g,h,i,j,k,l,m,n,o,p=c("odsp.util_126");(d=j||(j={}))[d.none=0]="none",d[d.standard=1]="standard",d[d.compact=2]="compact",d[d.minimal=3]="minimal",d[d.extended=4]="extended",(e=k||(k={}))[e.left=0]="left",e[e.middle=1]="middle",e[e.right=2]="right",(f=l||(l={}))[f.right=0]="right",f[f.middle=1]="middle",f[f.left=2]="left",(g=m||(m={}))[g.unknown=-1]="unknown",g[g.white=0]="white",g[g.black=1]="black",g[g.lightGradient=2]="lightGradient",g[g.darkGradient=3]="darkGradient",(h=n||(n={}))[h.topToBottom=0]="topToBottom",h[h.bottomToTop=1]="bottomToTop",h[h.leftToRight=2]="leftToRight",h[h.rightToLeft=3]="rightToLeft";let q=p.Ov.isActivated("F9624ACA-9230-4329-9616-969638C4D4CB","05/08/2022","Include Personal Site Id in generated Server Url for Freemium lists"),r="undefined"!=typeof window&&p.lU.isFeatureEnabled({ODB:1737});function s(a){let{webAbsoluteUrl:b,webServerRelativeUrl:c,isSiteListsHost:d}=a;return"/"===c||""===c||!q&&d||r&&a?.isUnifiedAdminUrl?b:b.substring(0,b.lastIndexOf(c))}function t(a){return"/"===a.webServerRelativeUrl?"":a.webServerRelativeUrl}function u(a){return a&&!!a.groupId&&a.webAbsoluteUrl===a.siteAbsoluteUrl}function v(a){return!!(a.isAnonymousGuestUser||a.isExternalGuestUser||a.isEmailAuthenticationGuestUser||a.isNativeFederatedUser)}(i=o||(o={}))[i.FooterEnabled=2]="FooterEnabled",i[i.MegaMenuEnabled=128]="MegaMenuEnabled",i[i.FooterEmphasis0=256]="FooterEmphasis0",i[i.FooterEmphasis1=512]="FooterEmphasis1",i[i.FooterLayout0=1024]="FooterLayout0",i[i.FooterLayout1=2048]="FooterLayout1",i[i.HideTitleInHeader=0x2000000]="HideTitleInHeader",i[i.HorizontalQuickLaunch=1]="HorizontalQuickLaunch"}
,(a,b,c)=>{c.d(b,{a:()=>d});function d(a){return!!a&&!!(a.isExternalGuestUser||a.isAnonymousGuestUser||a.isEmailAuthenticationGuestUser)}}
,,(a,b,c)=>{c.d(b,{a:()=>f});var d=c(286),e=c(9);class f{static start(a){let b=new d.a(a);return new e.c((a,c)=>{b.start(a,c)},()=>{b.abort(!0)})}static startAndPostProcess(a,b){let c=new d.a(a);return new e.c((a,d)=>{c.start((c,d)=>{a(b(c,d))},d)},()=>{c.abort(!0)})}}}
,(a,b,c)=>{c.d(b,{a:()=>g});var d=c(13),e=c(60);class f extends e.b{webByUrl(a){return this.webByItemUrl(this._itemUrlHelper.getUrlParts(a))}webByItemUrl(a){let{siteRelation:b,isCrossDomain:c,fullItemUrl:e}=a,f=this;return(c||b===d.d.crossSite)&&(f=f.method("SP.RemoteWeb",e)),f.segment("web")}listById(a,b){return this.webByItemUrl(a).segment("lists").method("GetById",b)}clone(){return new f({webAbsoluteUrl:this._pageContext.webAbsoluteUrl},{pageContext:this._pageContext,itemUrlHelper:this._itemUrlHelper,encodeWebAbsoluteUrl:this._shouldEncodeWebAbsoluteUrl})}constructor(a,b){super({webAbsoluteUrl:b.pageContext.webAbsoluteUrl,encodeWebAbsoluteUrl:b.encodeWebAbsoluteUrl}),this._pageContext=b.pageContext,this._shouldEncodeWebAbsoluteUrl=b.encodeWebAbsoluteUrl,this._itemUrlHelper=b.itemUrlHelper}}class g extends e.a{build(){return new this._apiUrlType}constructor(a,b){super({webAbsoluteUrl:b&&b.pageContext?b.pageContext.webAbsoluteUrl:"",encodeWebAbsoluteUrl:b.encodeWebAbsoluteUrl});const{itemUrlHelper:c,pageContext:d,encodeWebAbsoluteUrl:e}=b,{apiUrlType:g=class extends f{constructor(){super({},{itemUrlHelper:c,pageContext:d,encodeWebAbsoluteUrl:e})}}}=b;this._apiUrlType=g}}}
,(a,b,c)=>{c.d(b,{a:()=>d,b:()=>e});let d={Active:0,Restricted:1,RestrictedICN:2,ConditionalAccessBlocked:3,ConditionalAccessViewOnly:4},e=d}
,,,(a,b,c)=>{c.d(b,{a:()=>f,b:()=>h,c:()=>g,d:()=>i});var d=c("odsp.util_126"),e=c(298);let f=".research";function g(a,b=!1){return(a=b?`.${a}`:a)===f}function h(a,b=!1){return d.lU.isFeatureEnabled(e.e)&&g(a,b)}function i(a){return h(a?.split(".").pop(),!0)}}
,(a,b,c)=>{c.d(b,{a:()=>p});var d=c("react-lib"),e=c("odsp.util_126"),f=c(304);let g=e.Ov.isActivated("CBA5A12E-A62B-4DB7-B7D2-DC0B63E3D359"),h=new WeakMap,i=new WeakMap,j=new WeakMap,k=g?function(a){let b=i.get(a);return b||i.set(a,b=a().then(b=>(h.set(a,b),b)).catch(b=>(i.delete(a),Promise.reject(b)))),b}:function(a){let b=j.get(a);if(b)return b.promise;{let b={promise:a().then(a=>(b.result={value:a},a),a=>{throw b.error=a,a}),result:void 0,error:void 0};return j.set(a,b),b.promise}},l=g?function(a){if(h.has(a))return{value:h.get(a)}}:function(a){let b=j.get(a);if(b)return b.result};var m=c(83);let n=new Map;var o=c(305);function p(a,b={}){let{useChildrenAsPlaceholder:c=!1}=b;function g(b){let{placeholder:g,children:p,barrier:q,onRenderError:r,...s}=b,t=(0,f.a)(()=>s,s),[u,v,w]=function(a,b){let c,f=d.useMemo(()=>a,b?.deps),g=d.useRef();g.current=f;let p=(c=d.useState(()=>({})),d.useLayoutEffect(()=>()=>{n.delete(c)},[c]),d.useLayoutEffect(()=>{if(n.size>0){let a=[];for(let b of(n.forEach(b=>{a.push(b)}),n.clear(),a))try{b()}catch{}}}),(0,m.a)(a=>{n.set(c,()=>{a()}),(async()=>{await (0,e.uo)(0);let a=n.get(c);a&&(n.delete(c),a())})()})),q=d.useRef();q.current=b?.barrier;let r=(0,o.a)(),s=d.useRef(),t=(0,m.a)(a=>{s.current?.value!==a&&(s.current={value:a},r())}),u=d.useRef(),v=(0,m.a)(a=>{u.current!==a&&(u.current=a,r())});if(d.useMemo(()=>{s.current=void 0,u.current=void 0},[f]),!s.current){let a=l(f);a&&(s.current=a)}let w=(0,m.a)(a=>{b?.onLoad?.(a)}),x=(0,m.a)(a=>{b?.onError?.(a)});d.useLayoutEffect(()=>{s.current||u.current||(async()=>{let a,b;try{let b=q.current;b&&await b,a={value:await k(f)}}catch(a){b=a}p(()=>{g.current===f&&(a?(t(a.value),w(a.value)):b&&(v(b),x(b)))})})()},[s,u,f,t,v,p,w,x]);let y=(0,m.a)(()=>{i.delete(f),h.delete(f),j.delete(f),v(void 0)});return[s.current,u.current,y]}(a,{barrier:q}),x=u?(0,e.aT)(u.value):void 0;return d.useMemo(()=>{if(v){if(r)return d.createElement(d.Fragment,null,r({error:v,retry:w}));throw v}return x?d.createElement(x,t,p):c?d.createElement(d.Fragment,null,p):g?d.createElement(d.Fragment,null,g):null},[t,g,p,x,v,r,w])}return g.asAsync={load:async()=>(0,e.aT)(await k(a)),getComponent:()=>{let b=l(a)?.value;return b?(0,e.aT)(b):void 0},options:b},g}}
,,,,,,,,,,,,,,,(a,b,c)=>{c.d(b,{a:()=>k,b:()=>m,c:()=>j,d:()=>n,e:()=>l,f:()=>o.a,g:()=>o.b,h:()=>o.d,i:()=>o.e,j:()=>o.f,k:()=>o.g,l:()=>o.h,m:()=>o.i,n:()=>o.j,o:()=>o.k,p:()=>o.l});var d=c("odsp.util_126");let e={ODB:61606},f={ODB:61904},g={ODB:62699},h={ODB:62833},i={ODB:61403},j=()=>d.lU.isFeatureEnabled(g),k=()=>d.lU.isFeatureEnabled(i),l=()=>d.lU.isFeatureEnabled(e),m=()=>d.lU.isFeatureEnabled(f),n=()=>d.lU.isFeatureEnabled(h);var o=c(221)}
,,,(a,b,c)=>{c.d(b,{a:()=>m,b:()=>i});var d=c(16),e=c("odsp.util_126"),f=c(478);let g=!e.Ov.isActivated("F834A9BA-87BE-487C-BB7D-141AB22CAEA1"),h=!e.Ov.isActivated("35A76B1F-89F5-403B-A002-47D487412EE4"),i=!e.Ov.isActivated("E765194C-0589-4A4C-BF5D-E14F426B254E"),j="/_layouts/15/SignOut.aspx";window.FilesConfig&&window.FilesConfig.SuiteNavConfig&&window.FilesConfig.SuiteNavConfig.Urls&&!window.FilesConfig.SuiteNavConfig.Urls.SignOut&&(window.FilesConfig.SuiteNavConfig.Urls.SignOut=j);let k=window?._spPageContextInfo,l=window&&window.FilesConfig||{...k?.userHexCid?{hcid:window._spPageContextInfo.userHexCid}:{},...f.b&&k?{env:k.cloudType,df:k.cloudType&&("prodbubble"===k.cloudType||"spdf"===k.cloudType||"edog"===k.cloudType),SuiteNavConfig:{Locale:k.currentUICultureName,...!i||!k.isAnonymousGuestUser?{UserId:k.userPuid}:{},Urls:{SignOut:j},UserDisplayName:k.userDisplayName}}:{},...k?.mpcUrl?{mpcDomain:k.mpcUrl}:{},...g?{appId:"1141147648"}:{}};l.skyDrivePickerOAuth||(l.skyDrivePickerOAuth="oauth"),!l.oauthToken&&window&&(l.oauthToken=new d.b(window.location.href).getQueryParameter("access_token")),h&&(l.skyApiDomain||(l.skyApiDomain="https://skyapi.onedrive.live.com"),l.storageDomain||(l.storageDomain="https://storage.live.com"));let m=l}
,(a,b,c)=>{c.d(b,{a:()=>e});var d=c(30);function e(){let a=()=>(0,d.b)({sourceName:"CustomerPromise"});return"undefined"!=typeof window?window.CUSTOMERPROMISE_MANAGER=window.CUSTOMERPROMISE_MANAGER||a():"undefined"!=typeof self?self.CUSTOMERPROMISE_MANAGER=self.CUSTOMERPROMISE_MANAGER||a():a()}}
,,,,(a,b,c)=>{c.d(b,{a:()=>e});let d=!c("odsp.util_126").Ov.isActivated("FFE6FDD3-51F4-4F44-A2C6-C4B920D392C3");function e(a){return d?a?.siteSubscriptionId==="9188040d-6c67-4c5b-b112-36a304b66dad":!!a&&(0===a.webAbsoluteUrl.indexOf("https://my.microsoftpersonalcontent.com")||0===a.webAbsoluteUrl.indexOf("https://onedrive.live.com"))}}
,(a,b,c)=>{c.d(b,{a:()=>d});let d={Files:0,Recent:1,DocumentLibraries:2,SharedWithMe:3,DocsInCommon:4,RecycleBin:5,Photos:6,Search:7,AllMyPhotos:8,AccountChooserPicker:9,AccountChooserMobileSDK:10,Popular:11,RecentUnpopular:12,SecondStageRecycleBin:13,Apps:14,Subsites:15,RecentActivity:18,ExternallyShared:19,SharedByMe:20,Favorites:21,DetailsPane:22,Channels:24,PhotoStream:25,PhoneLink:26,DefaultDocLib:27,ListSyncIssues:28,OneDriveHome:29,TeamsDownloads:30,MyLists:31,Selection:32,People:33,Meetings:34,RecentLists:35,MyOrganizationAssets:36,LargestFiles:37,StockImages:38,Bing:39,Local:40,ChannelSharedList:41,SharedByUser:42,FromALink:43,Lists:44}}
,,(a,b,c)=>{c.d(b,{a:()=>g});var d=c(29),e=c(11),f=c(227);let g=(0,d.a)({eventName:"Verbose,Trace,",shortEventName:"Verbose"},{name:{isKey:!0,type:e.a.String},privacyClassification:{isPrefixingDisabled:!0,type:e.a.String}},f.a).withData({privacyClassification:e.b.requiredService})}
,,,(a,b,c)=>{c.d(b,{a:()=>m,b:()=>n});var d=c(23),e=c(362),f=c("odsp.util_126");let g=!f.Ov.isActivated("CA685475-5CA5-4F1B-A593-57ED607FE166"),h=g&&!f.Ov.isActivated("D1B37036-D290-4A41-AEFA-B9C7B51C46FF");var i=c(144);let j=!f.Ov.isActivated("1E25E207-2FA1-4BF6-A34E-85E74D1C18DC"),k=!f.Ov.isActivated("D5F9AE40-B066-4B81-9D3E-FC46E390BE13");class l{getEffectiveViewParamState(a){let{currentPathname:b,actualViewParams:c,actualViewParamsString:e}=a,f=this._getViewFromPathname({pathname:b,routingKey:void 0});if(void 0!==c.p){let a={...c};return delete a.view,{viewParams:a,viewParamsString:(0,d.a)(a)}}if(g&&f===i.a.Recent&&void 0===c.p&&void 0===c.parent&&void 0===c.parentview&&(void 0!==c.id||void 0!==c.remoteItem)){if(void 0===c.view){let a={...c,view:`${i.a.Files}`};return{viewParams:a,viewParamsString:(0,d.a)(a)}}if(c.view===`${i.a.Recent}`){let a={...c};return delete a.id,delete a.remoteItem,{viewParams:a,viewParamsString:(0,d.a)(a)}}}if(void 0!==f&&void 0===c.view&&void 0===c.p&&void 0===c.parent&&void 0===c.parentview){let a=!!c.listurl,b=!!c.remoteItem,e=!!c.cid,g=!!c.mcid,h=(a&&!b||j&&e&&!g)&&f===i.a.SharedWithMe,k={...c,view:`${h?i.a.Files:f}`};return{viewParams:k,viewParamsString:(0,d.a)(k)}}return{viewParams:c,viewParamsString:e}}getUpdatedUrl(a){let{currentPathname:b,viewParams:c,viewParamsString:f,clearPath:g}=a,h,k=this._getPathSegments(b);if(!this._isPathSegmentsEligibleForPrettyPaths({pathSegments:k,routingKey:h})||g)return(0,e.a)({pathname:b,viewParamsString:f,clearPath:g});let{updatedViewParams:l,newPrettyPathSegment:m,effectiveView:n,effectiveParentView:o}=this._getNewPrettyPathSegmentAndUpdatedViewParamsForUpdatedUrl({viewParams:c,currentPathname:b,routingKey:h}),p=!!l.listurl,q=!!l.remoteItem,r=!!l.cid,s=!!l.mcid,t=(Number(n)===i.a.Files||void 0===n&&Number(o)===i.a.Files)&&(p&&!q||j&&r&&!s)&&void 0===l.p,u=(0,d.a)(l);return(0,e.a)({pathname:t?`/${this._getPrettySegmentPathForView(i.a.SharedWithMe)}`:`/${m||""}`,viewParamsString:u})}isPathEligibleForPrettyPaths(a){let b=this._getPathSegments(a);return this._isPathSegmentsEligibleForPrettyPaths({pathSegments:b,routingKey:void 0})}getPrettySegmentFromOcdiPathWithRoutingKey(a){let{pathname:b,routingKey:c}=a,d=this._getPathSegments(b);if(this._isPathSegmentsPrefixedByRoutingKey({pathSegments:d,routingKey:c}))return this._getPrettySegmentFromPathname(a)}_isPathSegmentsPrefixedByRoutingKey(a){let{pathSegments:b,routingKey:c}=a;return!!c&&b[1]===c}_getNewPrettyPathSegmentAndUpdatedViewParamsForUpdatedUrl(a){var b;let c={..."string"==typeof(b=a.viewParams)?(0,f.pW)(b):b},d=h?c.parentview??(void 0!==c.parent?i.a.Files:void 0):c.parentview,e=void 0!==d?`${d}`:void 0;if(void 0!==c.view){let a=`${c.view}`;if(void 0!==c.parentview)return{updatedViewParams:c,newPrettyPathSegment:void 0,effectiveView:a,effectiveParentView:e};let b=this._getPrettySegmentPathForView(a);return void 0!==b?(delete c.view,{updatedViewParams:c,newPrettyPathSegment:b,effectiveView:a,effectiveParentView:e}):{updatedViewParams:c,newPrettyPathSegment:void 0,effectiveView:a,effectiveParentView:e}}if(void 0===c.view&&void 0===c.p&&void 0===c.parent&&void 0===c.parentview){if(g&&(void 0!==c.id||void 0!==c.remoteItem))return{updatedViewParams:c,newPrettyPathSegment:this._getPrettySegmentPathForView(i.a.Files),effectiveView:`${i.a.Files}`,effectiveParentView:e};if(!g){let b=this._getPrettySegmentFromPathname({pathname:a.currentPathname,routingKey:a.routingKey}),d=void 0!==b?this._getViewForPrettyPath(b):void 0;return{updatedViewParams:c,newPrettyPathSegment:b,effectiveView:void 0!==d?`${d}`:void 0,effectiveParentView:e}}}let j=void 0===c.view&&void 0!==e?this._getPrettySegmentPathForView(e):void 0;return void 0!==j?{updatedViewParams:c,newPrettyPathSegment:j,effectiveView:void 0,effectiveParentView:e}:{updatedViewParams:c,newPrettyPathSegment:void 0,effectiveView:void 0,effectiveParentView:e}}_isPathSegmentsEligibleForPrettyPaths(a){return void 0!==this._getPrettySegmentFromPathSegments(a)}_getPrettySegmentFromPathSegments(a){let{pathSegments:b,routingKey:c}=a,d=this._isPathSegmentsPrefixedByRoutingKey({pathSegments:b,routingKey:c}),e=d?3:2,f=b[d?2:1];return b.length===e&&""===b[0]&&void 0!==this._getViewForPrettyPath(f)?f:d&&b.length===e-1&&void 0!==this._getViewForPrettyPath("")?"":void 0}_getPrettySegmentPathForView(a){return this._queryTypeToPrettyPathMap[a]}_getPrettySegmentFromPathname(a){let{pathname:b,routingKey:c}=a,d=this._getPathSegments(b);return this._getPrettySegmentFromPathSegments({pathSegments:d,routingKey:c})}_getViewFromPathname(a){let b=this._getPrettySegmentFromPathname(a);return void 0!==b?this._getViewForPrettyPath(b):void 0}_getViewForPrettyPath(a){return this._prettyPathToQueryTypeMap[a]??(k?this._prettyPathAliasesToQueryTypeMap[a]:void 0)}_getPathSegments(a){return a.toLowerCase().split("/")}constructor(a,b){for(const b of(this._prettyPathToQueryTypeMap=a,this._queryTypeToPrettyPathMap={},Object.keys(a))){if(b!==b.toLowerCase())throw Error(`Unsupported casing used in PrettyPathMap key: '${b}'`);const c=a[b];if(void 0!==this._queryTypeToPrettyPathMap[c])throw Error(`Duplicate view value in PrettyPathMap: '${b}'`);this._queryTypeToPrettyPathMap[c]=b}for(const a of(this._prettyPathAliasesToQueryTypeMap={},Object.keys(b))){if(a!==a.toLowerCase())throw Error(`Unsupported casing used in PrettyPathAliasMap key: '${a}'`);if(void 0!==this._prettyPathToQueryTypeMap[a])throw Error(`Alias key already present in PrettyPathMap: '${a}'`);this._prettyPathAliasesToQueryTypeMap[a]=b[a]}}}let m={my:i.a.Files,"":i.a.Recent,libraries:i.a.DocumentLibraries,shared:i.a.SharedWithMe,ourfiles:i.a.DocsInCommon,recycle:i.a.RecycleBin,query:i.a.Search,media:i.a.AllMyPhotos,secondstagerecyclebin:i.a.SecondStageRecycleBin,places:i.a.Subsites,sharedbyyou:i.a.SharedByMe,favorites:i.a.Favorites,defaultdoclib:i.a.DefaultDocLib,listsyncissues:i.a.ListSyncIssues,people:i.a.People,meetings:i.a.Meetings,largestfiles:i.a.LargestFiles,home:i.a.Recent,recent:i.a.Recent,photos:i.a.AllMyPhotos};function n(a){let{forceView8ForPhotos:b,preferPhotos:c}=a;return new l({my:i.a.Files,"":i.a.Recent,libraries:i.a.DocumentLibraries,shared:i.a.SharedWithMe,ourfiles:i.a.DocsInCommon,recycle:i.a.RecycleBin,query:i.a.Search,secondstagerecyclebin:i.a.SecondStageRecycleBin,places:i.a.Subsites,sharedbyyou:i.a.SharedByMe,favorites:i.a.Favorites,defaultdoclib:i.a.DefaultDocLib,listsyncissues:i.a.ListSyncIssues,people:i.a.People,meetings:i.a.Meetings,largestfiles:i.a.LargestFiles,...b?{}:c?{photos:i.a.AllMyPhotos}:{media:i.a.AllMyPhotos}},{home:i.a.Recent,recent:i.a.Recent,...b?{media:i.a.AllMyPhotos,photos:i.a.AllMyPhotos}:c?{media:i.a.AllMyPhotos}:{photos:i.a.AllMyPhotos}})}}
,(a,b,c)=>{var d,e;c.d(b,{a:()=>d}),(e=d||(d={}))[e.invalidType=-1]="invalidType",e[e.noListTemplate=0]="noListTemplate",e[e.genericList=100]="genericList",e[e.documentLibrary=101]="documentLibrary",e[e.survey=102]="survey",e[e.links=103]="links",e[e.announcements=104]="announcements",e[e.contacts=105]="contacts",e[e.events=106]="events",e[e.tasks=107]="tasks",e[e.pictureLibrary=109]="pictureLibrary",e[e.webTemplateCatalog=111]="webTemplateCatalog",e[e.webPartCatalog=113]="webPartCatalog",e[e.listTemplateCatalog=114]="listTemplateCatalog",e[e.xmlFormLibrary=115]="xmlFormLibrary",e[e.masterPageCatalog=116]="masterPageCatalog",e[e.webPageLibrary=119]="webPageLibrary",e[e.customGrid=120]="customGrid",e[e.solutionCatalog=121]="solutionCatalog",e[e.themeCatalog=123]="themeCatalog",e[e.designCatalog=124]="designCatalog",e[e.appDataCatalog=125]="appDataCatalog",e[e.ganttTasks=150]="ganttTasks",e[e.promotedLinks=170]="promotedLinks",e[e.tasksWithTimelineAndHierarchy=171]="tasksWithTimelineAndHierarchy",e[e.meetings=200]="meetings",e[e.externalList=600]="externalList",e[e.mySiteDocumentLibrary=700]="mySiteDocumentLibrary",e[e.publishingPageLibrary=850]="publishingPageLibrary",e[e.publishingAsset=851]="publishingAsset",e[e.issueTracking=1100]="issueTracking",e[e.contentCenterModelLibrary=1328]="contentCenterModelLibrary",e[e.contentCenterPrimeLibrary=1329]="contentCenterPrimeLibrary",e[e.contentCenterSampleLibrary=1330]="contentCenterSampleLibrary",e[e.contentCenterModelUsageList=1331]="contentCenterModelUsageList",e[e.contentCenterExplanationList=1332]="contentCenterExplanationList",e[e.corporateCatalog=330]="corporateCatalog",e[e.siteCollectionCorporateCatalog=336]="siteCollectionCorporateCatalog",e[e.SyntexModernTemplateLibrary=4e3]="SyntexModernTemplateLibrary",e[e.SyntexSnippetLibrary=4200]="SyntexSnippetLibrary",e[e.SyntexFieldsLibrary=4201]="SyntexFieldsLibrary"}
,(a,b,c)=>{c.d(b,{a:()=>e});var d=c("tslib_533");function e(a,b){return(0,d.q5)(a,b)}}
,,(a,b,c)=>{c.d(b,{a:()=>e,b:()=>f,c:()=>k,d:()=>l,e:()=>j,f:()=>i});let d=window.performance,e=!!d&&"function"==typeof d.mark&&"function"==typeof d.clearMarks&&"function"==typeof d.now,f="EUPL.",g=0,h=window._perfMarks=window._perfMarks||[];function i(a,b){let c=m(a);(null==b||g<b)&&(e?d.mark(c):h.push({name:c,startTime:Date.now()}),g++)}function j(a,b=!0){let c=b?m(a):a;if(e){let a=d.getEntriesByName(c,"mark");return a&&a.length>0?Math.round(a[0].startTime):NaN}{let a=h.filter(a=>a.name===c)[0];return a&&a.startTime}}function k(a){let b=[];a&&(b=a.map(m)),e?d.getEntriesByType("mark").filter(a=>b.length>0?b.indexOf(a.name)>=0:0===a.name.lastIndexOf(f,0)).forEach(a=>{d.clearMarks(a.name)}):h=[]}function l(){return e?d.getEntriesByType("mark").filter(a=>0===a.name.lastIndexOf(f,0)):h}function m(a){return 0===a.lastIndexOf(f,0)?a:f+a}}
,(a,b,c)=>{function d(a,b,c,d){let e="",f=0;if(!a)return"";let g=a.length;for(f=0;f<g;f++){let g=a.charCodeAt(f),h=a.charAt(f);if(b&&("#"===h||"?"===h)){e+=a.substr(f);break}if(c&&"&"===h){e+=h;continue}g<=127?d||g>=97&&g<=122||g>=65&&g<=90||g>=48&&g<=57||b&&g>=32&&g<=95&&0>" \"%<>'&".indexOf(h)?e+=h:g<=15?e+="%0"+g.toString(16).toUpperCase():g<=127&&(e+="%"+g.toString(16).toUpperCase()):g<=2047?(e+="%"+(192|g>>6).toString(16).toUpperCase(),e+="%"+(128|63&g).toString(16).toUpperCase()):(64512&g)!=55296?(e+="%"+(224|g>>12).toString(16).toUpperCase(),e+="%"+(128|(4032&g)>>6).toString(16).toUpperCase(),e+="%"+(128|63&g).toString(16).toUpperCase()):f<a.length-1&&(g=(1023&g)<<10,f++,g|=1023&a.charCodeAt(f),g+=65536,e+="%"+(240|g>>18).toString(16).toUpperCase(),e+="%"+(128|(258048&g)>>12).toString(16).toUpperCase(),e+="%"+(128|(4032&g)>>6).toString(16).toUpperCase(),e+="%"+(128|63&g).toString(16).toUpperCase())}return e}function e(a){return a&&(a=d(a=(a=a.replace(/'/g,"''")).replace(/%27/g,"%27%27"))),a}c.d(b,{a:()=>e,b:()=>d})}
,,,,,(a,b,c)=>{c.d(b,{a:()=>e});var d=c(61);function e(a,b=0){if(!a.expiry){var c;let b=(c=a.authToken,(0,d.b)(c));a.expiry=b&&function(a){try{return new Date(parseInt(a+"000",10))}catch(a){}}(b.exp)}return(a.expiry?a.expiry.getTime():0)-Date.now()<b}}
,(a,b,c)=>{c.d(b,{a:()=>d,b:()=>e});class d{static areEqual(a,b,c=1e-6){return Math.abs(a.x-b.x)<c&&Math.abs(a.y-b.y)<c}static getCenter(a){return a.reduce((a,b)=>a.add(b),d.ORIGIN).scale(1/a.length)}scale(a){return new d(this.x*a,this.y*a)}add(a){return new d(this.x+a.x,this.y+a.y)}subtract(a){return new d(this.x-a.x,this.y-a.y)}distance(a){let b=this.x-a.x,c=this.y-a.y;return Math.sqrt(b*b+c*c)}negate(){return new d(-this.x,-this.y)}abs(){return Math.sqrt(this.x*this.x+this.y*this.y)}unit(){let a=this.abs();return this.scale(a&&1/a||0)}toString(){return`[Point ${this.x}, ${this.y}]`}constructor(a=0,b=0){a instanceof d?(this.x=a.x,this.y=a.y):(this.x=a,this.y=b)}}d.ORIGIN=new d;let e=d}
,(a,b,c)=>{let d;c.d(b,{a:()=>m,b:()=>p,c:()=>n,d:()=>o});var e,f,g=c(110),h=c("odsp.util_126");let i={accdb:{extensions:["accdb","mdb"]},agent:{extensions:["copilot","agent"]},aipage:h.Ov.isActivated("57D24CB5-1F07-4CD4-9120-7CED51B5DEB5")?{}:{extensions:["page"]},archive:{type:g.a.Unknown,extensions:["7z","ace","arc","arj","dmg","gz","iso","lzh","pkg","rar","sit","tgz","tar","z"]},audio:{type:g.a.Unknown,extensions:["aif","aiff","aac","amr","au","awb","dct","dss","dvf","flac","gsm","m4a","m4p","mid","mmf","mp3","ogg","oga","ra","rm","wav","wma","wv"]},clipchamp:{extensions:["clipchamp"]},code:{extensions:["abap","ada","adp","ahk","as","as3","asc","ascx","asm","asp","awk","bash","bash_login","bash_logout","bash_profile","bashrc","bat","bib","bsh","build","builder","c","c++","capfile","cc","cfc","cfm","cfml","cl","clj","cls","cmake","cmd","coffee","config","cpp","cpt","cpy","cs","cshtml","cson","csproj","css","ctp","cxx","d","ddl","di","disco","dml","dtd","dtml","el","emakefile","erb","erl","f","f90","f95","fs","fsi","fsscript","fsx","gemfile","gemspec","gitconfig","go","groovy","gvy","Hcp","h","h++","haml","handlebars","hbs","hh","hpp","hrl","hs","htc","hxx","idl","iim","inc","inf","ini","inl","ipp","irbrc","jade","jav","java","js","json","jsp","jsx","l","less","lhs","lisp","log","lst","ltx","lua","m","mak","make","manifest","master","md","markdn","markdown","mdown","mkdn","ml","mli","mll","mly","mm","mud","nfo","opml","osascript","p","pas","patch","php","php2","php3","php4","php5","phtml","pl","pm","pod","pp","profile","ps1","pss","pt","py","pyw","r","rake","rb","rbx","rc","rdf","re","reg","rest","resw","resx","rhtml","rjs","rprofile","rpy","rss","rst","ruby","rxml","s","sass","scala","scm","sconscript","sconstruct","script","scss","sgml","sh","sh","shtml","sml","svn-base","sql","sql","sty","tcl","tex","textile","tld","tli","tmpl","tpl","vb","vi","vim","vmg","webpart","wsp","wsdl","xhtml","xoml","xsd","xslt","yaml","yaws","yml","zsh"]},copilot:{extensions:["copilot","agent"]},research:{extensions:["research"]},css:{},csv:{extensions:["csv"]},docset:{type:g.a.Folder,iconType:"svg"},docx:{extensions:["doc","docm","docx","docb"]},dotx:{extensions:["dot","dotm","dotx"]},email:{type:g.a.Unknown,extensions:["eml","msg","ost","pst"]},exe:{type:g.a.Unknown,extensions:["application","appref-ms","apk","app","appx","exe","ipa","msi","xap"]},loop:{extensions:["fluid","loop"]},folder:{type:g.a.Folder,iconType:"svg"},form:{extensions:["form"]},font:{type:g.a.Unknown,extensions:["ttf","otf","woff"]},genericfile:{type:g.a.Unknown},html:{extensions:["htm","html","mht"]},link:{type:g.a.Unknown,extensions:["lnk","link","url","website","webloc"]},splist:{type:g.a.Unknown,extensions:["listitem"]},model:{extensions:["3ds","3mf","blend","cool","dae","df","dwfx","dwg","dxf","fbx","glb","gltf","holo","layout","max","off","ply","skp","stp","stl","t","thl","x"]},mpp:{extensions:["mpp"]},mpt:{extensions:["mpt"]},one:{type:g.a.OneNote,extensions:["note","one"]},onetoc:{type:g.a.OneNote,extensions:["ms-one-stub","onetoc","onetoc2","onepkg"]},pdf:{extensions:["pdf"]},powerbi:{extensions:["pbix"]},photo:{type:g.a.Media,extensions:["arw","bmp","cr2","crw","dcr","dds","dib","dng","erf","gif","heic","heif","ico","jfi","jfif","jif","jpe","jpeg","jpg","kdc","mrw","nef","orf","pct","pict","png","pns","psd","raw","tga","tif","tiff","wdp"]},photo360:{},potx:{extensions:["pot","potm","potx"]},ppsx:{extensions:["pps","ppsm","ppsx"]},pptx:{extensions:["ppt","pptm","pptx","sldx","sldm"]},presentation:{extensions:["odp","gslides","key"]},pub:{extensions:["pub"]},spo:{extensions:["aspx"]},sponews:{},rtf:{extensions:["epub","gdoc","odt","rtf","wri","pages"]},sharedfolder:{type:g.a.Folder,iconType:"svg"},linkedfolder:{type:g.a.Shortcut,iconType:"svg"},spreadsheet:{extensions:["ods","gsheet","numbers","tsv"]},sysfile:{type:g.a.Unknown,extensions:["bak","bin","cab","cache","cat","cer","class","dat","db","dbg","dl_","dll","ithmb","jar","kb","kdc","ldt","lrprev","ppa","ppam","pdb","rom","thm","thmx","vsl","xla","xlam","xll"]},txt:{extensions:["dif","diff","readme","out","plist","properties","text","txt"]},vector:{type:g.a.Unknown,extensions:["ai","dgn","gdraw","pd","emf","eps","fig","indd","indt","ps","svg","svgz","wmf","oxps","xps","xd","sketch"]},video:{type:g.a.Media,extensions:["3g2","3gp","3gp2","3gpp","asf","avi","dvr-ms","flv","m1v","m4v","mkv","mod","mov","mm4p","mp2","mp2v","mp4","mp4v","mpa","mpe","mpeg","mpg","mpv","mpv2","mts","ogg","qt","swf","ts","vob","webm","wlmp","wm","wmv","wmx"]},video360:{},vsdx:{extensions:["vsd","vsdm","vsdx","vdw"]},vssx:{extensions:["vss","vssm","vssx"]},vstx:{extensions:["vst","vstm","vstx"]},whiteboard:{extensions:["whiteboard"]},xlsx:{extensions:["xls","xlsb","xlsm","xlsx"]},xltx:{extensions:["xlt","xltm","xltx"]},xml:{extensions:["xaml","xml","xsl"]},xsn:{extensions:["xsn"]},zip:{type:g.a.Unknown,extensions:["zip"]}};(e=f||(f={}))[e.Invalid=0]="Invalid",e[e.File=1]="File",e[e.FileVersion=2]="FileVersion",e[e.ListItem=3]="ListItem",e[e.List=4]="List",e[e.Folder=5]="Folder",e[e.FolderWithLists=6]="FolderWithLists",e[e.Attachment=7]="Attachment",e[e.ListItemVersion=8]="ListItemVersion",e[e.CascadeParent=9]="CascadeParent",e[e.Web=10]="Web",e[e.App=11]="App";var j=c(276);let k=!h.Ov.isActivated("81AE1C58-2BDA-49C9-A189-1298C8EF7B0D"),l="genericfile",m=l;function n(a){let b="";if(a.type===g.a.Folder){var c;b=void 0===(c=a.sharingType)||c===j.a.Private||c===j.a.Unknown?"folder":"sharedfolder",a.isDocSet?b="docset":a.isMountPoint&&(b="linkedfolder")}else b=a.type===g.a.OneNote?"one":a.recycleBinProperties&&a.recycleBinProperties.itemType===f.List?"splist":a.listItem?"listitem":"text/typescript"===a.textEditorMimeType?"code":a.panorama?"photo360":p(a.extension);return b}function o(a){let b;try{if(a){let c=p(a);if(i[c]){let a=i[c].type;void 0===a&&(a=g.a.File),b=a}}}catch(a){}return void 0===b&&(b=g.a.Unknown),b}function p(a){if(!d)for(let a in d={},i){let b=i[a].extensions;if(b)for(let c=0;c<b.length;c++)d[b[c]]=a}return k&&!a?l:d[a=a.replace(".","").toLowerCase()]||l}}
,,,(a,b,c)=>{c.d(b,{a:()=>e});var d=c("odsp.util_126");d.XW.prototype.attached=function(a){let b=this;return class extends a{constructor(...a){super(...a),b.attach(this)}}};let e=d.XW}
,(a,b,c)=>{function d(a){return a?"gallatin"===a:location.origin.indexOf(".cn")===location.origin.length-3}function e(a){return a?"blackforest"===a:location.origin.indexOf(".de")===location.origin.length-3}function f(a){return"pathfinder"===a||"trailblazer"===a}function g(a){return"ag08"===a||"ag09"===a}function h(a){return"pathfinder"===a}function i(a){return"trailblazer"===a}function j(a){return"US_2_Content"===a||"US_86_Content"===a||"US_96_Content"===a||"US_105_Content"===a||"US_265_Content"===a||"US_266_Content"===a||"US_267_Content"===a||"US_268_Content"===a||"US_269_Content"===a||"US_270_Content"===a}function k(a){let b=a.env2||a.env;return b&&"prodbubble"===b&&a.farmLabel&&"MSIT_SPDF_1_Content"===a.farmLabel?"spdf":b}function l(a){switch(a){case"gcc":return"prod";case"dod":return"pathfinder";case"gcch":return"trailblazer";case"chn":return"gallatin";default:return a}}function m(a){return!function(a){switch(a.toLowerCase()){case"devbox":case"edog":case"prodbubble":case"spdf":return!0;default:return!1}}(a)?"Production":"Dogfood"}function n(a,b){if(!a.cloudType)return!1;let c=l(a.cloudType);return d(c)||e(c)||f(c)||g(c)||!!b&&j(a.farmLabel)||a.farmSettings?.ExternalService_videousecdnenabled==="0"}c.d(b,{a:()=>m,b:()=>k,c:()=>l,d:()=>g,e:()=>e,f:()=>n,g:()=>j,h:()=>d,i:()=>f,j:()=>h,k:()=>i})}
,(a,b,c)=>{c.d(b,{a:()=>e,b:()=>f,c:()=>g,d:()=>d});let d="{.mediaBaseUrl}/transform/zip?cs={.callerStack}",e={accessToken:".accessToken",callerStack:".callerStack",correlationId:".correlationId",mediaBaseUrl:".mediaBaseUrl",mediaBaseUrlSecondary:".mediaBaseUrlSecondary",pushChannelBaseUrl:".pushChannelBaseUrl",driveAccessCode:".driveAccessCode",driveAccessCodeV21:".driveAccessCodeV21",driveAccessToken:".driveAccessToken",driveAccessTokenV21:".driveAccessTokenV21",driveUrl:".driveUrl",driveUrlV21:".driveUrlV21",pdfConversionUrl:".pdfConversionUrl",thumbnailUrl:".thumbnailUrl",transformUrl:".transformUrl",videoManifestUrl:".videoManifestUrl",zipUrl:".zipUrl",officeBundleGenerate:".officeBundleGenerate",officeBundleGetFragment:".officeBundleGetFragment",resourceUrl:".spResourceUrl",fileType:".fileType",itemUrl:".spItemUrl",itemUrlLegacy:".spItemUrlLegacy",cTag:".ctag",hasBxf:".hasBxf",hasOfficePreview:".hasOfficePreview",hasPdf:".hasPdf",hasThumbnail:".hasThumbnail",hasVideoManifest:".hasVideoManifest",analyzeUrl:".analyzeUrl"},f=[e.accessToken,e.callerStack,e.mediaBaseUrl,e.mediaBaseUrlSecondary,e.pushChannelBaseUrl,e.driveAccessCode,e.driveAccessToken,e.driveUrl,e.driveAccessCodeV21,e.driveAccessTokenV21,e.driveUrlV21,e.zipUrl,e.pdfConversionUrl,e.thumbnailUrl,e.transformUrl,e.videoManifestUrl,e.officeBundleGenerate,e.officeBundleGetFragment],g=[e.callerStack,e.correlationId,e.mediaBaseUrl,e.resourceUrl]}
,(a,b,c)=>{c.d(b,{a:()=>d});let d={ODB:620}}
,,,,,,,,,,,,,,,,,,,,(a,b,c)=>{c.d(b,{A:()=>j,B:()=>l,C:()=>s,D:()=>p,a:()=>n,b:()=>t,c:()=>k,d:()=>H,e:()=>w,f:()=>f,g:()=>g,h:()=>v,i:()=>u,j:()=>E,k:()=>D,l:()=>G,m:()=>o,n:()=>i,o:()=>F,p:()=>z,q:()=>r,r:()=>B,s:()=>y,t:()=>C,u:()=>e,v:()=>q,w:()=>h,x:()=>x,y:()=>A,z:()=>m});var d=c("odsp.util_126");function e(){return d.Ov.isActivated("f6c0b3d3-2a6b-4b1f-8d6b-0d0c8c9e4a3b")}function f(){return d.Ov.isActivated("a7d3d5c3-5e7d-4f3d-8f6c-1f2d8b3b2b7d")}function g(){return d.Ov.isActivated("5e49e708-9893-49f1-a434-07833cc41dcc")}function h(){return d.Ov.isActivated("a4c46f85-d94f-41d7-b9f9-86437989792a")}function i(){return d.Ov.isActivated("710bab74-f80c-4f50-b853-8d0d7ae93186")}function j(){return d.Ov.isActivated("d5e73238-2054-4c48-a2db-45f7462595cd")}function k(){return d.Ov.isActivated("5ec705de-f67b-46db-a457-ad6ba7ef60b7")}function l(){return d.Ov.isActivated("92e88bd1-dedb-4988-9e37-783d41a71dfd")}function m(){return d.Ov.isActivated("392c1359-2b0e-48b3-b0d5-1e793002a418")}function n(){return d.Ov.isActivated("b3ddc769-eab6-4053-a52a-c6124e05be2b")}function o(){return d.Ov.isActivated("9f145ae1-f3c7-4fb0-83f1-d90c8ad50139")}function p(){return d.Ov.isActivated("b9cc8531-15a5-439b-bfc7-b543be0504cf")}function q(){return d.Ov.isActivated("a515b31b-4c80-464e-a28d-3bcab7ecd7c5")}function r(){return d.Ov.isActivated("85173d7b-5726-49d6-a312-43726f103e64")}function s(){return d.Ov.isActivated("6d1c6dbf-40d1-4c01-9e8b-47284b5c1936")}function t(){return d.Ov.isActivated("a4d743ce-4d8e-4df6-8882-547d878ce7b2")}function u(){return d.Ov.isActivated("3a0c64a2-59f1-4318-bea2-a00abd1c197e")}function v(){return d.Ov.isActivated("9e042d7b-92c2-49ca-bde9-5e26945a60fa")}function w(){return d.Ov.isActivated("aa157aab-3f3e-463f-9fa0-251a0c84b728")}function x(){return d.Ov.isActivated("8abebb04-6c54-4f2b-a8ab-3ce170450588")}function y(){return d.Ov.isActivated("90f566ae-9719-4d2f-b776-6a3a04ebb33b")}function z(){return d.Ov.isActivated("cf39f912-61ac-4187-9de4-f8c35fd36584")}function A(){return d.Ov.isActivated("f8d64a40-039f-4319-b037-5a8ec43c3bc7")}function B(){return d.Ov.isActivated("c62ee607-4f4e-4c28-9536-6df31763edcd")}function C(){return d.Ov.isActivated("3447119c-99a9-47f2-a893-bc36e7ac1f13")}function D(){return d.Ov.isActivated("4cfbba00-000d-49e8-8e7c-ece06bb136bb")}function E(){return d.Ov.isActivated("7634ce7f-1fa8-40bb-9c89-6b71f6c77113")}function F(){return d.Ov.isActivated("f974e508-791a-4799-be8d-eb8946370c87")}function G(){return d.Ov.isActivated("9b77d191-10f1-4418-a3b1-3a91bb9b134c")}function H(){return d.Ov.isActivated("9FE50496-B56B-4B34-847B-8A4CAD75AD87")}}
,,,,,,,(a,b,c)=>{c.d(b,{a:()=>j});var d=c(38),e=c("odsp.util_126"),f=c(675);function g(a,b){let{Session:c,Version:d,OSName:g,OSVersion:h,Market:i,UserId:j,Manifest:k,...l}=b,m=a.getSemanticContext();if(c&&a.setContext("AppInfo.Session",c),k&&a.setContext("AppInfo.Manifest",k),d&&m.setAppVersion(d),m.setUserLanguage(i||""),j){let a=j&&j.replace(/(membership\|urn(%3a|:)spo(%3a|:)guest#)([^@]+)(@[^@]+)$/i,(a,b,c,d,e,g)=>`${b}${(0,f.a)(e)}${g}`);m.setUserId(a)}for(let b in g&&m.setDeviceOsName(g),h&&m.setDeviceOsVersion(h),l)if(Object.prototype.hasOwnProperty.call(l,b)){if(null==l[b])continue;let c=(0,e.jd)(b);a.setContext(c,l[b])}}var h=c(78),i=c(894);class j{attach(a){return this._createLogHandler(),a.addEventHandler({sourceName:"AriaTelemetryHandler",handler:this.logEvent,handleMissedEvents:!0})}updateContext(a){this._getLogger().then(([b])=>g(b,a))}flush(){return this._getAria().then(a=>{a.LogManager.flush()})}constructor(a){this.logEvent=a=>{let b=this._onLogEvent?this._onLogEvent(a):a;this._createLogHandler().then(a=>a(b))},this._getAria=k(()=>a.ariaLoader().then(b=>(b.LogManager.isInitialized()||(b.LogManager.initialize(a.tenantToken,{disableCookies:a.disableCookies,...a.offlineCache?{browserOverrides:{onGetData:a.offlineCache.getData,onSaveData:a.offlineCache.saveData}}:{},...a.ariaLogConfiguration||{}}),"undefined"!=typeof window&&"function"==typeof window.addEventListener&&window.addEventListener("beforeunload",()=>{b.LogManager.flush()})),b.LogManager.addCallbackListener((b,c,d,e)=>{d===a.tenantToken&&a.ariaQos&&a.ariaQos.reportQos({result:b,statusCode:c,events:e})}),b))),this._getLogger=k(()=>this._getAria().then(b=>{let d=function(a,b,c={}){let d=new a.Logger(b);return g(d,c),d}(b,a.tenantToken,a.context),e=a.offlineDetection;return i.a&&e?c.e(44).then(c.bind(c,856)).then(c=>(this._offlineEventQueue=c.makeOfflineAriaEventQueue(d,a.tenantToken,e),[d,b])):Promise.resolve([d,b])})),this._createLogHandler=k(()=>this._getLogger().then(([b,c])=>(function(a,b,c=!0,f,g){return j=>{try{if((j.eventType!==d.b.Start||c)&&!(f&&f.isQosEvent(j))){let c=function(a,b,c){var f;let{name:g,values:h}=function(a){let b={CorrelationVector:a.vector.toString(),WebLog_FullName:a.eventName,WebLog_EventType:d.b[a.eventType]},c=a.eventName.split(",");for(let a of c)a&&(b[`WebLog_Type_${a}`]=1);let{data:f,context:g}=a;if(g){for(let a in g)if(Object.prototype.hasOwnProperty.call(g,a)){let c=g[a];if(null==c)continue;b[(0,e.jd)(a)]=c}}if(f){for(let c in f)if(Object.prototype.hasOwnProperty.call(f,c)){let d=f[c];if(null==d)continue;let g=a.metadata[c];if(g){let a=g.isPrefixingDisabled?(0,e.jd)(c):`${(0,e.jd)(g.definedInName)}_${c}`,f=g.type;if(4===f){for(let c in d)if(Object.prototype.hasOwnProperty.call(d,c)){let e=d[c];if(null!=e&&""!==e){let d;if("object"==typeof e)try{d=JSON.stringify(e)}catch(a){d=e}else d=e;b[`${a}_${c.replace(/\./g,"_")}`]=d}}}else b[a]=6===f?g.typeRef[d]:d}}}return{name:a.isEventTypePrefixingDisabled?c[c.length-2]:`ev_${c[c.length-2]}`,values:b}}(b),i=new a.EventProperties;return i.name=g,e.Ov.isActivated("2657d5a5-7313-42a0-ab20-287781f44d1b")||(f=h.Name,"AppChrome.PageOpenedInTeamsVivaConnections1PAppContext"!==f&&"SPO.DashboardWebPart.Load"!==f&&"AdaptiveCardExtension.CardAction"!==f&&"TeamsNavigation.Navigation.ClickedInTeamsviva1pAppContext"!==f&&"TeamsSiteHeader.RefreshButtonClicked"!==f&&"TeamsSiteHeader.CopyLinkButtonClicked.successful"!==f&&"TeamsSiteHeader.GoToBrowserButtonClicked"!==f)||(i.eventType="VivaAnalytics"),function(a,b,c,d){let e;try{for(let a in c)Object.prototype.hasOwnProperty.call(c,a)&&(e=a,b.setProperty(a,c[a]))}catch(f){let b,c;throw f instanceof a.Exception&&(b=f.ErrorCode(),c=Error(`Aria error: ${f.toString()}`)),c&&(f.handled=!0,d&&d.logError(c,{errorCode:b,propertyKey:e})),f}}(a,i,h,c),i}(a,j,h);i.a&&g?.storeEventIfNecessary(c)||b.logEvent(c)}}catch(c){let b;c instanceof a.Exception&&(b=Error(`Aria error: ${c.toString()}`)),c&&c.handled||h.log(b||c)}}})(c,b,a.logStartEvents,a.ariaQos,this._offlineEventQueue))),this._onLogEvent=a.onLogEvent}}function k(a){let b;return()=>(b||(b=a()),b)}}
,(a,b,c)=>{c.d(b,{a:()=>f,b:()=>e});var d=c("odsp.util_126");let e={ppe:"3620e5572cf04917bf4993285ebe4e15-d5c60963-35a1-45e2-9430-928e0656b9cd-6718",prod:"a9e9a63d9df4411ebbf89297947d7666-b5f0498b-a808-4b74-bb7b-2b33f7971660-7417"},f={ppe:"f74c101dfd474d06a7b40fed2051df7e-edb10b9a-779e-4b75-b0cc-ee0cee0f831b-7189",prod:d.Ov.isActivated("648CEEB2-700E-415E-A13B-73AC6B2DADD5")?d.Ov.isActivated("78ca8746-93f0-43aa-a2b8-c77ba4fbd019")?"af7114704a204580909f08c904c5ac6f-6f6f4c13-294c-4a00-8e55-71180ed7d627-7044":"af7114704a204580909f08c904c5ac6f-b3ae09c2-296c-4bf3-81c0-7c7f59f4644d-7161":"af7114704a204580909f08c904c5ac6f-57579cfd-1741-4e07-9f63-8f5c227f3b20-6813"}}
,,,,,,(a,b,c)=>{c.d(b,{a:()=>f.a,b:()=>e,c:()=>g.a,d:()=>g.b,e:()=>l,f:()=>h.a}),c(78),c(38);var d,e,f=c(21),g=c(0);c(36),c(11),c(30),(d=e||(e={})).outOfBox="outOfBox",d.custom="custom",d.Unknown="Unknown",c(77),c(29);var h=c(35);c(239);var i=c("odsp.util_126");let j=new Set(["onedrive.cloud.microsoft","edog.onedrive.cloud.microsoft","onedrive.cloud.dev.microsoft"]),k=i.Ov.isActivated("265f44fc-1615-4d58-8ed1-ef6a21350404");function l(a,b){let c=[],d=0,e=0,f=0,g=0,h=0,i=0,l=new Set,m=new Set;if(b)for(let a of b)a.MySiteHostUrl&&l.add(a.MySiteHostUrl.replace(/\/$/,"")),a.RootSiteUrl&&m.add(a.RootSiteUrl.replace(/\/$/,""));function n(a){let n=a.type,o=a.url||a.Url||a.webUrl||a.siteUrl||a.listUrl||a.serverUrl||void 0;if("File"===n?(d++,a.name&&a.name.indexOf(".")>-1&&c.push(a.name.split(".").pop())):"Folder"===n?e++:"Site"===n?g++:"List"===n&&f++,o&&b&&!k)try{let a=new URL(o),b=a.origin,c=a.hostname.toLowerCase();l.has(b)||j.has(c)?h++:m.has(b)&&i++}catch{}}a?.capabilities&&a.capabilities.forEach(a=>{a.items_by_sharepoint_ids&&a.items_by_sharepoint_ids.forEach(a=>{n(a)}),a.items_by_url&&a.items_by_url.forEach(a=>{n(a)})});let o={topLevelFileExtensions:c,topLevelfileSourcesCount:d,siteSourcesCount:g,docLibSourcesCount:f,folderSourcesCount:e};return b&&!k&&(o.sourcesInOD=h,o.sourcesInSP=i),o}}
,,,,,(a,b,c)=>{c.d(b,{a:()=>d.pW,b:()=>e.a});var d=c("odsp.util_126"),e=c(23)}
,,,,(a,b,c)=>{c.d(b,{a:()=>g});var d=c(75),e=c(0);let f=c("odsp.util_126").Ov.isActivated("DE6C2A7A-FDAB-4578-B4F8-76AC5AABCF2D");function g(a,b=d.b){return class extends a{end(a){this._customerPromise&&(a?.resultType===e.b.Success?this._customerPromise.end({resultType:a?.resultType,errorCode:a?.resultCode,extraData:{...a?.extraData,isFromQosEvent:!0}}):f||a?.resultType!==e.b.ExpectedFailure?this._customerPromise.end({resultType:a?.resultType,errorCode:a?.resultCode,veto:this._computeVeto?this._computeVeto(a):"None",extraData:{...a?.extraData,isFromQosEvent:!0}}):this._customerPromise.end({resultType:e.b.Success,errorCode:a?.resultCode,extraData:{...a?.extraData,isFromQosEvent:!0}})),super.end(a)}constructor(a){super(a),a.pillar&&(this._customerPromise=new b({scenario:a.name,pillar:a.pillar,extraData:{...a?.extraData,isFromQosEvent:!0}}),a.veto&&(this._computeVeto=a.veto))}}}}
,,,,,(a,b,c)=>{c.d(b,{a:()=>e});let d=!c("odsp.util_126").Ov.isActivated("682BEBB8-F1C8-486D-8B3F-0C75B53F6DC3","12/01/2022","Skip convert if driveId/cid is from sharepoint");function e(a){return d&&RegExp("^b!").test(a)?a:a?a.replace(/^0+/,"").toLowerCase():void 0}}
,,,,,,(a,b,c)=>{c.d(b,{a:()=>o,b:()=>i,c:()=>l,d:()=>m,e:()=>h,f:()=>g,g:()=>j,h:()=>e,i:()=>p,j:()=>f,k:()=>n,l:()=>k});var d=c("odsp.util_126");let e=!d.Ov.isActivated("0E548291-B819-49E6-B593-6D4680E33B19","03/08/2024","Should enable and disable OneUp command buttons according to eSign panel state."),f=!d.Ov.isActivated("9914F34E-F99F-4E53-8D90-A7816CD6C04D","03/18/2024","Determines if the new eSign image generation code should be used"),g=!d.Ov.isActivated("06F5F18D-6DD4-43C6-B574-15BE475563D1","04/03/2024","Killswitch to parent folder error message to show on unexpected scenarios."),h=!d.Ov.isActivated("BBA1A6BC-8514-4545-B9E3-B2039B1E9DB9","04/02/2024","Determines if e-sign should fetch the item sharing information"),i=!d.Ov.isActivated("01767F3B-3477-4B9E-BBA8-3AA9CB54A713","05/14/2024","Determines if eSign should check if the document has existing signatures."),j=!d.Ov.isActivated("47566495-9538-4981-B501-AA4FB7EC790B","02/21/2024","Determines if eSign should use additional headers for SP requests."),k=!d.Ov.isActivated("39229D97-4EDF-4E25-8039-124FB5ED0716","06/20/2024","Determines if eSign should use v9 persona."),l=!d.Ov.isActivated("2373462B-F906-4EB5-A9A5-ED99B6424C06","10/22/2024","Determines if e-sign providers should be decoupled so they can be used independently."),m=!d.Ov.isActivated("7F4EE3B8-AA17-4B9A-9E2B-DF0EB62A1C46","03/03/2025","Determines if e-sign button should be hidden from users with no email."),n=!d.Ov.isActivated("AF5D79A6-5CE7-45B0-841D-38CBF621D483","10/22/2024","Determines if new component should be used for review flow."),o=!d.Ov.isActivated("8273B363-B7EE-479B-8E71-250B48B3224B","04/25/2025","Add validation for chars exceed 255 in email addresses in people picker."),p=!d.Ov.isActivated("a48287e2-bff0-4703-94d2-54dadb1f9192","01/24/2025","Determines if async create should use resilient polling with error handling and retry logic.")}
,(a,b,c)=>{let d,e,f,g,h,i,j,k,l;c.d(b,{a:()=>a_,b:()=>a1});var m,n=c(0),o=c(29),p=c(11);let q=(0,o.a)({eventName:"UnhandledError,",shortEventName:"UnhandledError",critical:!0},{message:p.a.String,stack:p.a.String,builtStack:p.a.String,line:p.a.Number,col:p.a.Number,url:p.a.String,privacyClassification:{isPrefixingDisabled:!0,type:p.a.String}}).withData({privacyClassification:p.b.requiredService,privacyDataTypes:["productAndServicePerformance"]});var r=c(258),s=c("odsp.util_126"),t=c(35),u=c(78),v=c(287);let w=0,x=s.Ov.isActivated("77D2C451-10BD-4FF5-B5F0-A71B162640D5"),y=s.Ov.isActivated("BD012595-DBE3-469D-ACAA-33494B9805E1"),z=s.Ov.isActivated("6C46088C-BA1D-4AA5-8FDC-4CF0FCF6A743"),A=s.Ov.isActivated("8124A385-5729-43AC-B1C9-D54AD0872A5D"),B=s.Ov.isActivated("36B91871-323F-47AE-856A-593D771BB6C5"),C=[a=>"string"==typeof a&&0===a.indexOf("ResizeObserver loop limit exceeded"),a=>"string"==typeof a&&0===a.indexOf("ResizeObserver loop completed with undelivered notifications")];function D(a,b,c){if(!z){let d;!A&&a&&"object"==typeof a&&a.extraData&&"object"==typeof a.extraData&&"string"==typeof a.extraData.qosName&&(d=a.extraData.qosName);let e=new n.a({name:`UnhandledError${d?`.${d}`:""}`,startTimeOverride:0}),f=(0,u.getErrorMessage)(b);w<100?e.end((0,v.a)((0,t.a)(a),{...f?{error:f}:{},...c?{extraData:c}:{}})):100===w&&e.end((0,v.a)((0,t.a)(a),{resultCode:"MaxErrorCountLimit",...f?{error:f}:{},...c?{extraData:c}:{}})),w++}}window.onerror=function a(b,c,d,e,f){let g=C.some(a=>a(b,f));if(!y&&g)return;try{window.parent&&window.parent.opener&&"LogOnError"in window.parent.opener&&!g&&Function.prototype.apply.call(window.parent.opener.LogOnError,window.parent.opener,[b,c,d,e,f])}catch(a){}if(!z)return void D(f,(0,u.getErrorMessage)(b),{url:c,line:d,col:e});let h=f&&f.stack,i=(function b(){let c,d=[];try{for(c=arguments.callee;c===a||c===b;)c=c?c.caller:c}catch(a){c=null}let e=0;try{for(;c&&e<10;)d.push(function(a){let b;if(a){let d=a&&a.toString?a.toString():"InvalidMethod()",e=9*(8===d.indexOf(" ")),f=d.indexOf(")")+1;if(0===(b=d.substring(e,f)).indexOf("function")||3>b.indexOf("(")){var c;let a=f+50;(c=d=d.replace(/\s\s*/g," "))&&c.length>a&&(c=c.substr(0,a-3)+"..."),b=c+(a<d.length?"}":"")}}return b}(c)),c=c.caller,e++}catch(a){}return d})().join("\n");h=h?h.replace(/[ \t]{2,}/g," "):"",i=i.replace(/[ \t]{2,}/g," ");let j=!1;if(x)j=!0;else for(let a of(0,r.a)())if(-1!==c.indexOf(a)){j=!0;break}let k={message:b,url:j?c:"<dropped-url-string>",line:d,col:e,stack:h,builtStack:i};w<100?q.logData(k):100===w&&q.logData({message:"Hit max error limit of 100",url:"NA",line:0,col:0,stack:"",builtStack:""}),w++},B||window.addEventListener("unhandledrejection",a=>{D(a.reason,void 0,void 0)}),c(237);var E=c(63),F=c(105),G=c(9),H=c(80),I=c(103);let J=(0,o.a)({eventName:"UnhandledPromise,",shortEventName:"UnhandledPromise"},{message:p.a.String,extraData:p.a.String}).withData({privacyClassification:p.b.requiredService,privacyDataTypes:["productAndServicePerformance"]}),K=new class{log(a){let b=a.id;if(a.parent){a.handler&&delete this._outstandingPromiseErrors[b];return}this._outstandingPromiseErrors[b]=a,1===Object.keys(this._outstandingPromiseErrors).length&&this._async.setTimeout(()=>{let a=this._outstandingPromiseErrors;this._outstandingPromiseErrors={},Object.keys(a).forEach(b=>{let c=a[b],d=c.exception?c.exception:c.error;if(d instanceof Error||d&&d.stack?G.c.isCanceled(c)||E.a.log(d):J.logData({message:"Promise with no error callback",extraData:(0,I.a)(d)}),window.console&&console.log){let a="Promise with no error callback:"+c.id;console.warn?console.warn(a):console.log(a),console.log(c),d&&d.stack&&console.log(d.stack)}})},0)}constructor(){this._outstandingPromiseErrors={},this._async=new F.a}};new H.a(K).on(G.c,"error",K.log);class L extends n.a{send(){super.end()}constructor({chunkId:a,error:b}){super({name:"chunkLoadError",resultType:n.b.Failure,resultCode:a,error:b})}}s.Ov.isActivated("36B91871-323F-47AE-856A-593D771BB6C5")&&!s.Ov.isActivated("6FA6188C-D5C4-4714-93E0-90339B6F2F07")&&window.addEventListener("unhandledrejection",function(a){a.reason?.name==="ChunkLoadError"&&new L({chunkId:a.reason.chunkId,error:a.reason.message}).send()});var M=c(30);let N=(0,o.a)({eventName:"PageInit,",shortEventName:"PageInit"},{screenWidth:p.a.Number,screenHeight:p.a.Number,availableScreenWidth:p.a.Number,availableScreenHeight:p.a.Number,renderWidth:p.a.Number,renderHeight:p.a.Number,browserWidth:p.a.Number,browserHeight:p.a.Number,devicePixelRatio:p.a.Number,referrer:p.a.String});var O=c(223),P=c(38);let Q=(0,c(77).a)({eventName:"Beacon,",shortEventName:"Beacon"},{name:p.a.String,status:p.a.String,success:p.a.Boolean,retryCount:p.a.Number,totalRetries:p.a.Number,eventCount:p.a.Number});var R=c(286);class S{get endpointUrl(){return this._endpointUrl}get dataCompletenessJson(){return this._dataCompletenessJson}send(){new R.a({method:"POST",url:this._endpointUrl,json:this._dataCompletenessJson,requestTimeoutInMS:1e3}).start((a,b)=>{},(a,b,c)=>{})}constructor(a,b,c,d,e){this._endpointUrl=a.callbackEndpoint.authority+a.callbackEndpoint.path;const f={};if(e)for(let a=0;a<e.length;++a)f[e[a].EventType]=f[e[a].EventType]+1||1;const g={TelemetryTenantId:a.telemetryTenantToken.substring(0,32),AppVersion:a.appVersion,EventType:b,StatusCode:c,EventCount:e?e.length:0,Timestamp:d,Environment:a.environment||"",DatapointSchemaVersion:"1.0",TelemetrySource:"Aria",EventSummary:f,Workload:a.workload||"",FarmLabel:a.farmLabel||"",FarmName:a.farmName||""};this._dataCompletenessJson=JSON.stringify(g)}}var T=c(6),U=c(194);class V{attach(a){let b,c=!1;return this._getHandler().then(d=>{c||(b=d.attach(a))}),()=>{c=!0,b&&b()}}_getHandler(){let a=this._handlerLoader();return this._getHandler=()=>a,a}constructor(a){this._handlerLoader=a}}var W=c(384),X=c(389);function Y(a){try{return"string"==typeof a&&0!==a.length&&isNaN(Number(a))&&"true"!==a&&"false"!==a}catch{return!1}}class Z{shouldScan(a){return this._scanned++,!0}sanitize(a){return this._sanitized++,`SANITIZED - ${this.identifier}`}warn(a){return`WARNING - ${this.identifier} - ${a}`}flushSummary(){let a={scanned:this._scanned,sanitized:this._sanitized,sanitizedRatio:0===this._scanned?0:this._sanitized/this._scanned};return this._scanned=0,this._sanitized=0,a}constructor(a){this._scanned=0,this._sanitized=0}}var $=c(390);let _=/(?:^|[^A-Za-z0-9_-])[A-Za-z0-9_-]{20,}\.[A-Za-z0-9_-]{3,}\.[A-Za-z0-9_-]{20,}/,aa=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9"],ab=["Mozilla","AppleWebKit","Gecko","Safari","Chrome","Edg"],ac=/\d+\.\d+(\.\d+)?(\.\d+)?/,ad=/\b\d{1,2}\/\d{1,2}\/(\d{4}|\d{2})\b/,ae=/^\/\d+\/\d+\/\d+\/?$/,af=Array(128).fill(!1);function ag(a,b,c){if(b>0&&"/"===a[b-1]||" "===a[b+1]||c<a.length-1&&" "===a[c+1])return!1;for(let d=b+1;d<c;d++){let b=a.charCodeAt(d);if(!(b>=128)&&!af[b])return!1}return c>b+1}[...aa,"%","-",".","_","~",":","?","#","[","]","@","!","$","&","(",")","*","+",";"," ","=","'"].forEach(a=>{af[a.charCodeAt(0)]=!0});let ah=/<soap:Envelope/i,ai=/%[0-9A-Fa-f]{2}/,aj=/_sp0[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}/i;class ak extends Z{scan(a){for(let b of["https://","http://"]){let c=a.indexOf(b);if(-1!==c){let d=c+b.length;if(" "!==a[d]){if(a.substring(d).includes("{ length:"))return!1;return!0}}}return!1}warn(a){return`WARNING: aka.ms/ODSPSanitizerURL - ${a}`}constructor(...a){super(...a),this.identifier=$.a.URLOld}}let al=new Set(["/"," ","	","\n","\r","{","}"]),am="http://",an="https://",ao=new Set([...aa,".","-","_","#"]),ap=new Set([...aa,".","-"]),aq=new Set(aa),ar=["@","%40","_at_"],as=new Set([...aa,".","-","_","#"]),at=new Set([...aa,".","-"]),au=new Set(aa),av=/(?:^|[^A-Za-z0-9_-])[A-Za-z0-9_-]{20,}\.[A-Za-z0-9_-]{3,}\.[A-Za-z0-9_-]{20,}/,aw=/\bey[A-Za-z0-9_-]{18,}\.(?:[A-Za-z0-9_-]*)\.[A-Za-z0-9_-]{43,}\b/g,ax=/ey[A-Za-z0-9_-]{18,}\./i,ay={SPOPassword:class extends Z{shouldScan(a){return super.shouldScan(a),-1!==a.toLowerCase().indexOf("_sp0")}scan(a){let b=a.match(aj);return!!b&&0!==b.length}constructor(...a){super(...a),this.identifier=$.a.SPOPassword}},Soap:class extends Z{scan(a){if(ah.test(a))return!0;if(ai.test(a))try{let b=decodeURIComponent(a);return ah.test(b)}catch(a){}return!1}constructor(...a){super(...a),this.identifier=$.a.Soap}},KnownString:class extends Z{scan(a){let b=a.toLowerCase();return this._targets.some(a=>-1!==b.indexOf(a))}constructor(...a){super(...a),this.identifier=$.a.KnownString,this._targets=["accesstoken:","password=",".files.1drv.com/",".s2s-files.1drv.com/",".livefilestore.com/","shares/u!","shares/b!","shares('u!","shares('b!","shares(u!","shares(b!","shares(@","shares(%40"]}},QueryParam:class extends Z{shouldScan(a){return super.shouldScan(a),this._delimiters.some(b=>a.includes(b))}scan(a){let b=a.toLowerCase();return this._targets.some(a=>-1!==b.indexOf(a))}constructor(){for(const a of(super(),this.identifier=$.a.QueryParam,this._params=["access_token=","accesstoken=","auth_key=","authkey=","auth_token=","authtoken=","challengetoken=","email=","guestaccesstoken=","jwt=","login_hint=","originalpath=","password=","pageinfo=","patqp=","prooftoken=","querytemplate=","querytemplatepropertiesurl=","querytext=","redeem=","rwurl=","selectproperties=","share=","sig=","tempauth=","username=","wd="],this._delimiters=["&","?"],this._targets=[],this._params))for(const b of this._delimiters)this._targets.push(`${b}${a}`)}},SitePath:class extends Z{shouldScan(a){return super.shouldScan(a),a.indexOf("/")>-1}scan(a){return function(a){if(a.includes("W3SVC")||ab.some(b=>a.includes(b))||ac.test(a)||ad.test(a)||ae.test(a))return!1;let b=a.length;for(let c=0;c<b;c++)if("/"===a[c]){let b=c,d=a.indexOf("/",b+1);if(-1===d||d-b<=1||!ag(a,b,d))continue;let e=a.indexOf("/",d+1);if(-1===e)return!0;if(e-d<=1)continue;if(ag(a,d,e))return!0}return!1}(a)}warn(a){return`WARNING: aka.ms/ODSPSanitizerSitePath - ${a}`}constructor(...a){super(...a),this.identifier=$.a.SitePath}},JWT:class extends Z{shouldScan(a){return super.shouldScan(a),-1!==a.toLowerCase().indexOf("ey")}scan(a){return _.test(a)}constructor(...a){super(...a),this.identifier=$.a.JWT}},JWTOld:class extends Z{shouldScan(a){return super.shouldScan(a),-1!==a.toLowerCase().indexOf("eyj0exaioijkv1qilc")}scan(a){return av.test(a)}constructor(...a){super(...a),this.identifier=$.a.JWTOld}},JWTInDepth:class extends Z{shouldScan(a){return super.shouldScan(a),ax.test(a)}scan(a){let b,c;try{b=decodeURIComponent(a)}catch(c){b=a}for(aw.lastIndex=0;null!==(c=aw.exec(b));)if(this._isValidJWT(c[0]))return!0;return!1}_isValidJWT(a){let b=a.split(".");if(3!==b.length)return!1;let[c,d,e]=b;return this._isValidBase64Url(c)&&(0===d.length||this._isValidBase64Url(d))&&this._isValidBase64Url(e)}_isValidBase64Url(a){try{let b=a.replace(/-/g,"+").replace(/_/g,"/");if(b.length%4==1)return!1;let c=(4-b.length%4)%4,d=b+"=".repeat(c);return atob(d),!0}catch{return!1}}constructor(...a){super(...a),this.identifier=$.a.JWTInDepth}},URL:class extends ak{shouldScan(a){return super.shouldScan(a),a.includes(am)||a.includes(an)}scan(a){let b,c=this._findUrls(a),d=!1,e=c.next();for(;!e.done;){if(b=e.value,!a.includes("{ length:",b)){let c=this._extractDomain(a,b);if(c&&!this._trustedDomainsSet.has(c)&&!this._wwwTrustedDomainsSet.has(c)){d=!0;break}}e=c.next()}return d}*_findUrls(a){let b=0;for(;b<a.length;){let c=-1,d=a.indexOf("https://",b);if(-1!==d)c=d+an.length;else{let d=a.indexOf("http://",b);-1!==d&&(c=d+am.length)}if(-1===c)break;yield c,b=c}}_extractDomain(a,b){let c=a.length;for(let d=b;d<a.length;d++)if(al.has(a[d])){c=d;break}return a.substring(b,c).toLowerCase()}constructor(a){super(a),this.identifier=$.a.URL;const b=a.trustedDomains?.map(a=>a.toLowerCase())||[];this._trustedDomainsSet=new Set(b),this._wwwTrustedDomainsSet=new Set(b.map(a=>`www.${a}`))}},URLOld:ak,Email:class extends Z{shouldScan(a){return super.shouldScan(a),null!==this._findAtCharacter(a.toLowerCase(),0)}scan(a){let b=a.toLowerCase(),c=this._findEmails(b),d=!1,e=c.next();for(;!e.done;){let a=e.value,f=this._isUserPartValid(b,a),g=this._extractDomain(b,a);if(f&&void 0!==g&&!this._trustedDomainsSet.has(g.toLowerCase())){d=!0;break}e=c.next()}return d}warn(a){return`WARNING: aka.ms/ODSPSanitizerEmail - ${a}`}_findAtCharacter(a,b){let c=null;for(let d of ar){let e=a.indexOf(d,b);-1!==e&&(null===c||e<c.index)&&(c={index:e,variant:d})}return c}*_findEmails(a){let b=0;for(;b<a.length;){let c=this._findAtCharacter(a,b);if(null===c)break;yield c,b=c.index+c.variant.length}}_isUserPartValid(a,b){let c=b.index;if(c<3)return!1;for(let b=3;b>0;b--){let d=a.charCodeAt(c-b);if(!(d>=128)&&!ao.has(String.fromCharCode(d)))return!1}return!0}_extractDomain(a,b){let c=b.index+b.variant.length;if(b.index<0||c>=a.length)return;let d=a.indexOf(".",c);if(-1===d||d-c>255||"-"===a[c])return;for(let b=c;b<d;b++){let c=a.charCodeAt(b);if(!(c>=128)&&!aq.has(String.fromCharCode(c)))return}let e=d+1,f=e;for(;f<a.length&&128>a.charCodeAt(f)&&ap.has(a[f]);)f++;if(!(f-e<2))return a.substring(c,f).toLowerCase()}constructor(a={}){super(),this.identifier="Email";const b=a.trustedDomains?.map(a=>a.toLowerCase())||[];this._trustedDomainsSet=new Set(b)}},EmailOld:class extends Z{shouldScan(a){return super.shouldScan(a),-1!==a.indexOf("@")}scan(a){let b,c=this._findEmails(a),d=!1,e=c.next();for(;!e.done;){b=e.value;let f=this._isUserPartValid(a,b),g=this._extractDomain(a,b);if(f&&void 0!==g&&!this._trustedDomainsSet.has(g.toLowerCase())){d=!0;break}e=c.next()}return d}warn(a){return`WARNING: aka.ms/ODSPSanitizerEmail - ${a}`}*_findEmails(a){let b=0;for(;b<a.length;){let c=a.indexOf("@",b);if(-1===c)break;yield c,b=c+1}}_isUserPartValid(a,b){if(b<3)return!1;for(let c=3;c>0;c--){let d=a.charCodeAt(b-c);if(!(d>=128)&&!as.has(String.fromCharCode(d)))return!1}return!0}_extractDomain(a,b){if(b<0||b>=a.length-1)return;let c=a.indexOf(".",b);if(-1===c||c-b-1>255||"-"===a[b+1])return;for(let d=b+1;d<c;d++){let b=a.charCodeAt(d);if(!(b>=128)&&!au.has(String.fromCharCode(b)))return}let d=c+1,e=d;for(;e<a.length&&128>a.charCodeAt(e)&&at.has(a[e]);)e++;if(!(e-d<2))return a.substring(b+1,e).toLowerCase()}constructor(a={}){super(),this.identifier="EmailOld";const b=a.trustedDomains?.map(a=>a.toLowerCase())||[];this._trustedDomainsSet=new Set(b)}},CustomString:class extends Z{shouldScan(a){return super.shouldScan(a),this._patterns.length>0&&a.length>0}scan(a){let b=a.toLowerCase();return this._patterns.some(a=>b.includes(a))}warn(a){return`WARNING: Custom pattern detected - ${a}`}constructor(a){super(a),this.identifier=$.a.CustomString,this._patterns=a?.customPatterns?.map(a=>a.toLowerCase())||[]}}},az={};function aA(a,b){let c=new Map;for(let d of a)if("function"==typeof d){let a=d();c.set(a.identifier,a)}else c.set(d,new ay[d](b?.[d]||az));return c}class aB{addExclusion(a){this._excludedPaths.add(a)}addWarningPath(a){this._warningPaths.add(a)}flushSummary(){let a={sanitizedObjectCount:this._sanitizedObjectCount,viewedObjectCount:this._viewedObjectCount};return this._sanitizedObjectCount=0,this._viewedObjectCount=0,this._fieldScanners.forEach(b=>{a[b.identifier]=b.flushSummary()}),a}sanitizeOld(a,b,c){let d=!1;return this._fieldScanners.forEach(e=>{a=aC(a,(a,c)=>{try{if(this._shouldSanitize(e,c,a)){b?.(e.identifier,c),d=!0;let f=a;return this._warningScanners.has(e.identifier)&&(f=e.warn(f)),this._sanitizeScanners.has(e.identifier)&&(f=e.sanitize(f)),f}return a}catch(d){return b?.(e.identifier,`${c}!SanitizerError!`),a}},{...this._traversalContext,...c})}),this._viewedObjectCount++,d&&this._sanitizedObjectCount++,a}sanitize(a,b,c){if(null==a)return this._viewedObjectCount++,a;let d=!1,e=aC(a,(a,c)=>{if(!Y(a))return a;let e=a,f=!1;return this._fieldScanners.forEach((a,g)=>{try{if(f||!a.shouldScan(e)||!a.scan(e))return;if(b?.(g,c),d=!0,this._warningPaths.has(c)){e=a.warn(e);return}if(this._sanitizeScanners.has(g)){e=a.sanitize(e),f=!0;return}this._warningScanners.has(g)&&(e=a.warn(e))}catch(a){b?.(g,`${c}!SanitizerError!`)}}),e},{...this._traversalContext,...c});return this._viewedObjectCount++,d&&this._sanitizedObjectCount++,e}_shouldSanitize(a,b,c){return Y(c)&&a.shouldScan(c)&&a.scan(c)}constructor(a){if(this._excludedPaths=new Set,this._warningPaths=new Set,this._warningScanners=new Set,this._sanitizeScanners=new Set,this._fieldScanners=new Map,this._viewedObjectCount=0,this._sanitizedObjectCount=0,this._excludedPaths=new Set(a.excludedPaths||[]),this._warningPaths=new Set(a.warningPaths||[]),this._traversalContext={excludedPaths:this._excludedPaths,parseJsonStrings:a.parseJsonStrings||!1,parseArrayStrings:a.parseArrayStrings??(a.parseJsonStrings||!1),skipObjectKeys:a.skipObjectKeys||!1},a.isExternalScannerSupportKSActive){const b=[...a.warn||[],...a.sanitize||[]];this._fieldScanners=aA(b,a.scannerOptions),this._warningScanners=new Set(a.warn||[]),this._sanitizeScanners=new Set(a.sanitize||[]);return}const b=aA(a.sanitize||[],a.scannerOptions),c=aA(a.warn||[],a.scannerOptions);b.forEach(a=>{this._fieldScanners.set(a.identifier,a),this._sanitizeScanners.add(a.identifier)}),c.forEach(a=>{this._fieldScanners.set(a.identifier,a),this._warningScanners.add(a.identifier)})}}function aC(a,b,c){let{excludedPaths:d,parseJsonStrings:e,parseArrayStrings:f,skipObjectKeys:g}=c||{},h=c?.currentPath||"";if(d?.has(h))return a;if(Array.isArray(a))return a.map((a,d)=>aC(a,b,{...c,currentPath:`${h}[${d}]`}));if("object"==typeof a&&null!==a){let e={};for(let f of Object.keys(a)){let i=`${h}#`;g||d?.has(i)||(f=b(f,i)),e[f]=aC(a[f],b,{...c,currentPath:h?`${h}.${f}`:f})}return e}if("string"!=typeof a||!e||"{"!==a.charAt(0)&&(!f||"["!==a.charAt(0)))return b(a,h);try{let d=JSON.parse(a),e=aC(d,b,{...c,currentPath:`${h}$`});return JSON.stringify(e)}catch{return b(a,h)}}let aD=["gcc","dod","gcch","ag08","ag09","chn"];function aE(a){return!!a&&aD.includes(a.toLowerCase())}let aF=new Set(["accounttype","appname","appid","browserismobile","browsermajver","browserminver","browsername","browseruseragent","clientname","cloudtype","environment","farmlabel","farmname","isauthenticated","issharedcontrol","market","manifest","osname","osversion","session","sitesubscriptionid","userid","version","workload","appinfo.language","appinfo.session","appinfo.manifest","appinfo.version","userinfo.language","userinfo.id","deviceinfo.id","deviceinfo.osname","deviceinfo.osversion","debug.isworker","debug.isoffline","isnucleusenabled","webtemplateid","weblog_type_qos","weblog_fullname","weblog_eventtype","webid","useragent","tenantid","siteid","sessionid","resourcetenantid","privacyclassification","originalsession","name","hometenantid","debug.eventsource","correlationvector","browserispwa","weblog_type_pageusage","eupl","failure","feature","result","weblog_type_engagement","usagetype","sitetype","listid","isintentional","docid","currentpage","component","weblog_type_rumonedataupload","rumonedataupload_dictionary_eupl","rumonedataupload_dictionary_fcp","rumonedataupload_dictionary_emergencyuploaded","rumonedataupload_dictionary_pagetransitiontype","rumonedataupload_dictionary_scenarioid","rumonedataupload_dictionary_tti","rumonedataupload_dictionary_sw_isgenerated","rumonedataupload_dictionary_sw_bypassed","rumonedataupload_streamname","persistence","weblog_type_customerpromise","duration","pillar","resulttype","ring","scenario","servergu","tenantid"]),aG=(a,b=aF)=>(Object.keys(a).forEach(c=>{b.has(c.toLowerCase())||delete a[c]}),a),aH="AriaBeacon",aI={logStartEvents:!1,Init:function(a,b,c,d={}){try{let f;aI.logStartEvents=!0;let g=aM(b,d.platformDetection),h=new T.a(b.completenessCallbackEndpoint),i={telemetryTenantToken:a,appVersion:b.version,environment:b.environment,workload:b.workload,farmLabel:b.farmLabel,farmName:b.farmName,callbackEndpoint:h},j={ariaLoader:()=>G.c.resolve(c),context:g,tenantToken:a,disableCookies:b.disableCookies,ariaLogConfiguration:{collectorUrl:b.collectorUrl},logStartEvents:aI.logStartEvents,offlineDetection:d.offlineDetection,offlineCache:d.offlineCache,ariaQos:{isQosEvent:a=>Q.isTypeOf(a)&&!!a.data&&a.data.name===aH,reportQos:a=>{let{result:b,statusCode:c,events:d}=a;new Q({name:aH,retryCount:0,totalRetries:0,eventCount:d?d.length:0}).end({success:0===b,status:c+""}),""!==h.authority&&new S(i,b,c,new Date().getTime(),d).send()}}},k=b.getAuthToken?new V(async()=>{let a;try{a=await b.getAuthToken()}catch{}return e=new aK({userAuthToken:a,...j})}):e=new aJ(j);return f=d.customManager?k.attach(d.customManager):k.attach(M.a),()=>{f(),e=void 0}}catch(a){return a instanceof c.Exception&&(a=Error(`Aria error: ${a.toString()}`)),E.a.log(a),e=void 0,()=>{}}},updateContext:function(a,b={}){if(e){let c=aM(a,b.platformDetection);e.updateContext(c)}},isInitialized:function(a){return!!e},flushTelemetry:aL},aJ=(m=p.b.requiredService,a=>{let b="function"==typeof m?m:()=>m;return class extends a{constructor(a){const{onLogEvent:c}=a;super({...a,onLogEvent:a=>{let d=c?c(a):a;if(d.data)return{...d,data:{...d.data,privacyClassification:b(d)}}}})}}})(s.Ov.isActivated("1FC93BFB-D44C-4A37-BB6A-4E061AFB0D52")?U.a:(i=U.a,j=class extends i{updateContext(a){if(!this._sanitizer)return void super.updateContext(a);let b=this._sanitizer.sanitize(a);super.updateContext(b)}constructor(a){let b;const c=(0,X.a)()||{};if(c.disable||!c.sanitize||0===c.sanitize.length)return void super(a);try{b=new aB(c)}catch(b){super(a);return}const{onLogEvent:d,context:e}=a;super({...a,context:b.sanitize(e),onLogEvent:a=>{let c=d?d(a):a;return(c.data||c.context)&&(c={...c,data:b.sanitize(c.data),context:b.sanitize(c.context)}),c}}),this._sanitizer=b}},class extends j{updateContext(a){aE(a.Environment||a.CloudType||a.Ring)&&aG(a),super.updateContext(a)}constructor(a){if(!aE(a.context?.Environment||a.context?.CloudType||a.context?.Ring))return void super(a);const{onLogEvent:b,context:c}=a;c["Debug.StrictContextRequired"]=!0,aG(c),super({...a,context:c,onLogEvent:a=>{let c=b?b(a):a;return c.data&&aG(c.data),c.context&&aG(c.context),c}})}})),aK=(0,W.a)()(aJ);async function aL(){e&&await e.flush()}function aM(a,b=new s.Ey){return{AccountType:P.a[a.accountType],BrowserIsMobile:b.isMobile,BrowserIsPWA:b.isPWA,BrowserMajVer:b.browserMajor,BrowserMinVer:b.browserMinor,BrowserName:b.browserName,BrowserUserAgent:b.userAgent,CloudType:a.cloudType,Environment:a.environment,FarmLabel:a.farmLabel,FarmName:a.farmName,IsAuthenticated:+!!a.isAuthenticated,Market:a.market,Manifest:a.manifest,OSName:b.osName,OSVersion:b.osVersion,Session:a.session,SiteSubscriptionId:a.siteSubscriptionId||"",UserId:a.userId,Version:a.version,Workload:a.workload,SiteId:a.siteId,WebId:a.webId,WebTemplateId:a.webTemplateId,pageCorrelationId:a.pageCorrelationId,originalSession:a.originalSession,ResourceTenantId:a.resourceTenantId,listId:a.listId,product:a.product,SessionId:a.session,TenantId:a.siteSubscriptionId,UserAgent:b.userAgent,ServerGU:a.sideBySideToken,...a.context||{}}}var aN=c(139);function aO(){return c.e(2).then(c.t.bind(c,213,23))}let aP={ODB:-990,ODC:"ForceEnableAria"},aQ={ODB:1607,ODC:"EnableAll1DSTelemetry"};class aR{static Init(a,b,c=aO,d,e){a&&aS(b)&&(f=c().then(c=>{aI.Init(a,b,c,{offlineDetection:d,customManager:e})},a=>{}))}static InitCustomerPromise(a,b,c=aO,d){a&&aS(b)&&(g=c().then(c=>{aI.Init(a,b,c,{offlineDetection:d,customManager:(0,aN.a)()})},a=>{}))}static UpdateContext(a){f&&f.then(()=>{aI.updateContext(a)}).catch(()=>{}),g&&g.then(()=>{aI.updateContext(a)}).catch(()=>{})}static get logStartEvents(){return aI.logStartEvents}static set logStartEvents(a){aI.logStartEvents=a}static async flushTelemetry(){if(f)try{await aI.flushTelemetry()}catch{}}static getAriaTimeZone(a){let b=Math.abs(a),c=b%60,d=Math.floor(b/60);return`${a>0?"-":"+"}${d>=10?d:`0${d}`}:${c>=10?c:`0${c}`}`}}function aS(a){let{version:b,env2:c}=a,d=!1;return s.Ov.isActivated("5C0A45DF-2014-4FE8-9D90-180A716AC309")||(d="onebox"===c),!(!s.Ov.isActivated("010437DC-D681-4308-A21E-8BD4ADE3783C","11/12/2021","Use session storage TAB test running flag to bypass client-side logging.")&&aT("_isRunningTABTest"))&&("dev"!==b&&!d||!!s.lU.isFeatureEnabled(aP)||aT("enableAriaUpload")||aT("enableTelemetryUpload"))}function aT(a){let b=!s.Ov.isActivated("6DC50D29-3FD6-465C-9E8D-80A877497A9D","10/10/2022","Ensure that a boolean value is returned and not undefined.");try{if("sessionStorage"in window&&window.sessionStorage){let c=window.sessionStorage[a],d=c&&"true"===c.toLowerCase();if(b)return!!d&&"undefined"!=typeof console&&!!console;return d&&"undefined"!=typeof console&&!!console}}catch(a){}return!1}var aU=c(16);let aV=/[a-f0-9]{8}(?:-[a-f0-9]{4}){3}-[a-f0-9]{12}/gi,aW=["guestaccesstoken","access_token","prooftoken","tempauth","share","auth_token","auth_key","originalPath","querytext","querytemplate","selectproperties","hithighlightedproperties","refiners","sortlist","refinementfilters","collapsespecification","hiddenconstraints","querytemplatepropertiesurl","zerotermsuggestions","pageinfo","immediacyquerystring","immediacytitle","immediacyurl","k","q","InplaceSearchQuery","Default"],aX=["/_api/search/","/_api/searchsetting/","/results.aspx","/osssearchresults.aspx","/peopleresults.aspx","/conversationresults.aspx","/videoresults.aspx","/sharepoint.aspx","/search.aspx","RenderListDataAsStream"];var aY=c(31);let aZ=s.Ov.isActivated("C3E59A6A-1D1B-479E-A536-AD846D2EBE39","5/18/2023","Use accountType from options, if available, or a better default logic"),a$=s.Ov.isActivated("B0493589-74F3-4204-AFC6-2B77AA14095B");function a_(a={}){let b,c,{pageContext:d=window._spPageContextInfo||{},spModuleLink:e=window._spModuleLink}=a,f=d.env||"devbox",g=d.cloudType||f,h=d.env2,i="",j="",k=!1,l=g;switch(l.toLowerCase()){case"devbox":case"edog":case"prodbubble":case"spdf":b="ppe";break;default:l="prod",b="prod"}return"onebox"!==h||s.Ov.isActivated("C7635348-9E0C-4AD6-A922-EECF98EB3CB6")||(b="ppe"),e&&(i=e.buildNumber,j=e.manifestName,e.usingRedirectCookie?i="dev":(c=e.targetBuildNumber,k=e.isBuildAsExperimentRunning)),{version:i,manifest:j,appEnvironment:l,ariaEnvironment:b,isBuildAsExperimentRunning:k,buildAsExperimentTargetVersion:c}}function a0(a){return a&&a.length>36&&(a=a.replace(/[{}]/g,"")),a}function a1(a){let b=()=>{},c=function(a){let b,c;if(h)return h;let{pageContext:d=window._spPageContextInfo||{}}=a,{version:e,manifest:f,appEnvironment:g}=a_(a),{isAnonymousGuestUser:i,currentUICultureName:j,systemUserKey:k,userLoginName:l,siteSubscriptionId:m,farmLabel:n,farmName:o,siteId:p,webTemplate:q,webId:r,ariaCollectorUrl:t,oneDsCollectorUrl:u,CorrelationId:v,cloudType:w,getAuthToken:x,tokenProvider:y,homeTenantId:z,aadTenantId:A,listId:B,SideBySideToken:C,env2:D}=d;b=aZ?l?P.a.Business:P.a.BusinessAnonymous:void 0!==a.accountType?a.accountType:i?P.a.BusinessAnonymous:P.a.Business;let E=s.Ov.isActivated("2B916BE9-50BE-4939-BFE2-C8740954C1F8")||"undefined"==typeof localStorage?void 0:localStorage?.getItem("nucleus.offlineModeStatus");return a$?x&&(c=async()=>x()):y?.getAuthToken&&(c=async()=>{let a=await y.getAuthToken({url:window.location.href,disallowCookies:!0,apiQosName:"AriaUtils.getAriaContext"});return"object"==typeof a?a.authToken:a}),h={isAuthenticated:!i,market:j,session:a.sessionId||aY.a.generate(),version:e,manifest:f,userId:k,accountType:b,siteSubscriptionId:m,farmLabel:n,farmName:o,collectorUrl:t,oneDsCollectorUrl:u,environment:g,env2:D,workload:a.workload,disableCookies:i,siteId:a0(p),webTemplateId:q,webId:a0(r),context:a.context,pageCorrelationId:v,cloudType:w,getAuthToken:c,listId:a0(B),sideBySideToken:C,product:a.product,homeTenantId:z||A,resourceTenantId:A,offlineModeStatus:E}}(a);if(!c)return;let d=function(a){let{ariaEnvironment:b="ppe"}=a_(a);return b&&a.tokens[b]}(a);if(a.initOneDS||s.lU.isFeatureEnabled(aQ)){let e=`spo-core-${a.sourceName}`;k=new O.a({sourceName:e,tenantToken:d,context:c,offlineDetection:a.offlineDetection}),a.initCustomerPromise&&(l=new O.a({sourceName:e,tenantToken:d,context:c,offlineDetection:a.offlineDetection}));let f=k.attach(a.customManager??M.a),g=()=>{};a.initCustomerPromise&&(g=l.attach((0,aN.a)())),b=()=>{f(),g()}}else k=void 0,aR.Init(d,c,a.ariaLoader,a.offlineDetection,a.customManager),a.initCustomerPromise&&(l=void 0,aR.InitCustomerPromise(d,c,a.ariaLoader,a.offlineDetection));return{dispose:()=>{b?.()}}}M.a.cleanString=function(a,b,c){return function(a,b={}){let c,{keyDeclaration:d,pathsToSanitize:e=[],keysToSanitize:f=[]}=b;if(d&&d.isKey&&(a=a.replace(aV,"<guid>")),0>a.indexOf("http"))return a;try{c=new aU.b(a)}catch(b){return a}if(""===c.getAuthority())return a;let g=!1;for(let a=0;a<e.length;a++)if(c.getPath().indexOf(e[a])>=0){g=!0;break}if(g)a=`${c.getScheme()}://${c.getAuthority()}${c.getPath()}<scrubbedquerystring>...`;else{let b=c.getQueryAsObject();for(let a=0;a<f.length;a++){let c=f[a];b[c]&&(b[c]="<scrubbed>")}c.setQueryFromObject(b),a=c.getDecodedStringForDisplay()}return a}(a,{key:b,keyDeclaration:c,keysToSanitize:aW,pathsToSanitize:aX})},(class{static init(){return d||(d=N.logData({screenWidth:window.screen.width,screenHeight:window.screen.availHeight,availableScreenWidth:window.screen.availWidth,availableScreenHeight:window.screen.availHeight,renderWidth:window.innerWidth,renderHeight:window.innerHeight,browserWidth:window.outerWidth,browserHeight:window.outerHeight,devicePixelRatio:window.devicePixelRatio?window.devicePixelRatio:0})),d}}).init()}
,(a,b,c)=>{c.d(b,{a:()=>s});var d=c(38),e=c(386),f=c("odsp.util_126");function g(a){try{return window?.sessionStorage?.getItem(a)}catch(a){return null}}let h={ODB:61528},i=a=>g(a)?.toLowerCase()==="true"&&"undefined"!=typeof console&&!!console;function j(a){let b=!!window?._spModuleLink?.usingRedirectCookie,c=a?.env2==="onebox",d=i("_isRunningTABTest"),e=!function(){if(f.Ov.isActivated("eb8ae4df-cb8a-40a5-81c2-6661ce536968"))return!1;let a=f.lU.isFeatureEnabled(h),b=window.location.pathname.indexOf("/search.aspx")>-1;return a&&b}()&&/[?&]debug=true/.test(window?.location?.href||""),j=!!g("spfx-debug"),k=/[?&]alTest=/.test(window?.location?.href||"");return b||d||e||j||c||k}function k(a,b=new f.Ey){let c=(0,e.a)(b),g={AccountType:void 0!==a.accountType?d.a[a.accountType]:void 0,CloudType:a.cloudType,Environment:a.environment,FarmLabel:a.farmLabel,FarmName:a.farmName,IsAuthenticated:void 0===a.isAuthenticated?void 0:+!!a.isAuthenticated,IsNucleus:void 0===a.isNucleus?void 0:+!!a.isNucleus,isFoundation:a.isFoundation,Market:a.market,Manifest:a.manifest,OneDriveDeviceId:a.oneDriveDeviceId,Session:a.session,SiteSubscriptionId:a.siteSubscriptionId,UserId:a.userId,Version:a.version,Workload:a.workload,SiteId:a.siteId,WebId:a.webId,WebTemplateId:a.webTemplateId,pageCorrelationId:a.pageCorrelationId,originalSession:a.originalSession,listId:a.listId,Product:a.product,HomeTenantId:a.homeTenantId,ResourceTenantId:a.resourceTenantId,SessionId:a.session,TenantId:a.siteSubscriptionId,UserAgent:c.BrowserUserAgent,ServerGU:a.sideBySideToken,isNucleusEnabled:void 0===a.isNucleusEnabled?void 0:a.isNucleusEnabled?"true":"false",offlineModeStatus:a.offlineModeStatus,...c||{},...a.context||{}};if(!f.Ov.isActivated("388B4981-7643-45D6-9E3B-08596F5F529F")&&j(a)&&(g.Version="dev"),void 0===window.__debugLoggerContext&&(window.__debugLoggerContext=[]),window.__debugLoggerContext.push({session:g.SessionId||"",workload:g.Workload||"",product:g.Product||"None"}),!window.__wroteSessionId)try{console.log("Session ID:",g.SessionId),console.log("Time in UTC: ",new Date().toUTCString()),window.__wroteSessionId=!0}catch{}return g}function l(){return c.e("odsp.1ds.lib").then(c.bind(c,"1ds-lib"))}let m="enableTelemetryUpload",n={ODB:-990,ODC:"ForceEnableAria"},o="enableTelemetryDebug";function p(a=!0){sessionStorage.setItem(m,`${a}`)}(0,f.VY)("enableTelemetryDebug",function(a=!0){sessionStorage.setItem(o,`${a}`),p(a)}),(0,f.VY)("enableTelemetryUpload",p);let q={ODB:62107};var r=c(389);class s{updateContext(a){let b=k(a);this._updateContextPromises.push(this._logger.then(a=>{a.updateContext(b)}))}flush(){return this._logger.then(a=>{a.flush()})}attach(a){let b=a.addEventHandler({sourceName:`OneDS-${this._params.sourceName}`,handleMissedEvents:!0,handler:this.logEvent});return this._handlerDisposers.push(b),b}dispose(){this._handlerDisposers.forEach(a=>a()),this._handlerDisposers=[]}_initOfflineDetection(){let{offlineDetection:a}=this._params;a&&this._logger.then(b=>{b.setOffline(a.offline),a.onChange(a=>{b.setOffline(a)})})}constructor(a){this._getOneDS=l,this._handlerDisposers=[],this.logEvent=a=>{Promise.all([this._logger,...this._updateContextPromises]).then(([b])=>{let{onLogEvent:c,shouldLogEvent:d}=this._params;c&&(a=c(a)),(!d||d(a))&&(b.logEvent(a),this._updateContextPromises=[])})},this._params=a;const b=k(a.context);this._loggerConfig={endpointUrl:a.context.oneDsCollectorUrl,isDebug:"true"===g(o)||"true"===g("EnableConsoleTelemetryDebug"),disableTelemetry:!(!j(a.context)||i(m)||i("enableAriaUpload")||f.lU.isFeatureEnabled(n)),enableStorageChannel:!!a.offlineDetection,propertyConfiguration:{scrubIpOnly:!0},...{isDisableEventTimingsKSActive:f.Ov.isActivated("80DFF50F-3524-4803-AEC5-3EC5582EEBBE")},enablePrivacyGuard:(a=>{let b=f.Ov.isActivated("FAE1CF3A-D031-498D-9CDE-EA1151B19F0F");return("3d697adc11914fa4991f1c3870255788-1afd84c4-bb01-494a-bfb0-0216ab2771c6-6977"===a||"f74c101dfd474d06a7b40fed2051df7e-edb10b9a-779e-4b75-b0cc-ee0cee0f831b-7189"===a||"3620e5572cf04917bf4993285ebe4e15-d5c60963-35a1-45e2-9430-928e0656b9cd-6718"===a)&&!b})(a.tenantToken),disableStrictContextPlugin:!(()=>{let a=f.Ov.isActivated("c43b2cff-263b-4f2b-b0a5-559428677402");return f.lU.isFeatureEnabled(q)&&!a})(),scrubberConfig:(0,r.a)(),...a.loggerConfig},this._logger=this._getOneDS().then(c=>new c._OneDSLogger(a.tenantToken,b,this._loggerConfig)),this._initOfflineDetection(),this._updateContextPromises=[]}}}
,(a,b,c)=>{c.d(b,{a:()=>d});let d={access:["accdb"],delve:[],excel:["csv","ods","xls","xlsx","xltx","xlsb","xlsm","xlt","xltm"],infopath:["xsn"],loop:["fluid","loop"],office:[],onedrive:[],onenote:["one","onepkg","onetoc","onetoc2"],outlook:[],powerpoint:["odp","potx","ppsx","pptx"],project:["mpp","mpt"],publisher:["pub"],sharepoint:[],clipchamp:["video"],sway:[],teams:[],visio:["vsd","vsdm","vsdx","vdw","vss","vssm","vssx","vst","vstm","vstx"],word:["docx","dotx","odt","doc","docm","docb","dot","dotm"]}}
,(a,b,c)=>{c.d(b,{a:()=>f});var d=c(29),e=c(11);let f=(0,d.a)({eventName:"RUMOneDataUpload,",shortEventName:"RUMOneDataUpload"},{streamName:e.a.String,dictionary:e.a.Object,privacyClassification:{isPrefixingDisabled:!0,type:e.a.String},persistence:{isPrefixingDisabled:!0,type:e.a.String}}).withData({privacyClassification:e.b.requiredService})}
,(a,b,c)=>{c.d(b,{a:()=>f});var d=c(0),e=c("odsp.util_126");function f(a,b){return(c,f,g)=>{let{eventData:h}=c,{extraData:i={}}=h,j={performanceEntry:i&&i.performanceEntry,httpStatus:i&&i.HttpStatus,responseHeaders:c.serverData?.getResponseHeadersDictionary(),correlationId:i&&i.CorrelationId,succeeded:h&&h.resultType===d.b.Success||!1,resultCode:h&&h.resultCode,extraData:i},k=b&&b(c),l=e.Ov.isActivated("97E1912E-09BC-4111-9A67-EEA52ACC4BF3")?a.onRequestComplete(f,j):g(j);return i.dataSyncQos=a.getQosInfo(),{...k||{},eventData:{...k?k.eventData:h,extraData:{...k?k.eventData.extraData:h.extraData,...a.getQosInfo()}},canRetry:l&&(!k||k.canRetry)}}}}
,(a,b,c)=>{c.d(b,{a:()=>f});var d=c(29),e=c(11);let f=(0,d.a)({eventName:"Trace,",shortEventName:"Trace"},{message:e.a.String,privacyClassification:{isPrefixingDisabled:!0,type:e.a.String}}).withData({privacyClassification:e.b.requiredService,privacyDataTypes:["browsingHistory"]})}
,,,,,(a,b,c)=>{c.d(b,{a:()=>y});var d=c(9),e=c(114),f=c(96),g=c("odsp.util_126"),h=c(16),i=c(256),j=c(243),k=c(31),l=c(78),m=c(42),n=c(62);let o="Authorization";var p=c(257);function q(a){let b=a.getAllResponseHeaders()?.toLowerCase()??"";return b.indexOf("sprequestguid")>=0&&a.getResponseHeader("sprequestguid")||b.indexOf("request-id")>=0&&a.getResponseHeader("request-id")||void 0}function r(a){return(a.getAllResponseHeaders()?.toLowerCase()??"").indexOf("ms-cv:")>=0&&a.getResponseHeader("MS-CV")||void 0}let s=!g.Ov.isActivated("884C4D49-FAA1-41DA-AB27-76D985D391FF"),t=g.Ov.isActivated("E70D6CFA-D257-4F72-9045-2BF6BB243817"),u=g.Ov.isActivated("32629518-3CBD-4B34-8DAC-52AC471DCC11"),v=window&&window.performance,w={activityLimitReached:!0,malwareDetected:!0,nameAlreadyExists:!0,resourceModified:!0,resyncRequired:!0,quotaLimitReached:!0,accessRestricted:!0,childItemCountExceeded:!0,entityTagDoesNotMatch:!0,fragmentOutOfOrder:!0,fragmentOverlap:!0,hipCheckRequired:!0,insufficientVaultQuota:!0,lockMismatch:!0,lockNotFoundOrAlreadyExpired:!0,lockOwnerMismatch:!0,maxDocumentCountExceeded:!0,maxFileSizeExceeded:!0,maxFolderCountExceeded:!0,maxItemCountExceeded:!0,nameContainsInvalidCharacters:!0,pathIsTooLong:!0,pathTooDeep:!0,pathIsTooDeep:!0,propertyNotUpdateable:!0,resyncApplyDifferences:!0,resyncUploadDifferences:!0,serviceReadOnly:!0,throttledRequest:!0,unlockRequired:!0,versionNumberDoesNotMatch:!0,virusSuspicious:!0,authFailure:!1},x="Bearer";class y{send(a){let b=b=>{let{headers:c={},driveUrl:y,driveId:z,apiName:A,disableLogging:B=!1,timeout:C,onProgress:D,onUploadProgress:E,qosExtraData:F,apiVersion:G="v2.0",needsAuthorization:H=!0,useStrongAuthToken:I=!1,postProcessQos:J,breakCache:K,allowCookies:L,hasContentType:M=!0,useMultiPart:N=!1,getErrorAsMessage:O=!1,expectedErrors:P,disallowSelfIssuedToken:Q}=a,{endpoint:R}=a,{path:S,accessToken:T,forceContentType:U=!1,useExactAuthToken:V=!1,headers:W}=b;if(!R){let a="v2.1"===G?G:void 0;R=this._urlDataSource?"function"==typeof this._urlDataSource.getApiBaseUrl?this._urlDataSource.getApiBaseUrl({apiVersion:a,driveId:z}):this._urlDataSource.getVroomApiBaseUrl?.():void 0}let X=this._urlDataSource?.getRoutingKey?.();if(this._driveIdUrlCheckEnabled&&y&&z&&("me"!==z?`${R}/drives/${z}`:y)!==y)throw new g.lM({code:"DriveIdAndDriveUrlMismatch"});let Y={...w,...a.expectedErrorCodes||{}},{requestType:Z="GET"}=a,$=this._cookieOrigin,_=new m.a(S).authority?S:`${R}${S}`,aa=b=>{let m,s,t,w="",x={};N?(w=k.a.generate(),x={"Content-Type":`multipart/form-data;boundary=${w}`}):x={Accept:"application/json",...(a.postData||this._alwaysSendContentType)&&M||U?{"Content-Type":"application/json"}:{},...b.useCookies&&b.digestValue?{"x-requestdigest":b.digestValue}:{},...X?{"X-FDROUTEKEYHEADER":X}:{},...O?{prefer:"rich-error-as-message"}:{},...!g.Ov.isActivated("99EE4BC8-A7CF-47FA-9104-3CBB7479E126","01/10/2024","Killswitch to enable locale for accept language")?{"Accept-Language":n.a.language}:{},...c,...!this._sendSyncClientHeadersKs?W:{}},b.sessionToken&&b.sessionToken.tokenUrl&&0===S.indexOf("/drive/")?m=new h.b(`${b.sessionToken.tokenUrl}/${S.substring(7)}`):(m=new h.b(S),R&&!m.getScheme()&&(m=new h.b(R+S))),N&&(m.setQueryParameter("ump","1"),"POST"!==Z&&(c["X-HTTP-Method-Override"]=Z),Z="POST");let y=function(a){let{sessionToken:b,useExactAuthToken:c}=a;if(b){let{accessToken:a,proofToken:d,wlidToken:e,isBadger:f}=b;if(e)return{name:o,value:`wlid1.1 ${e}`};if(a)return{name:o,value:c?a:`${f?"badger":"bearer"} ${a}`};if(d)return{name:"X-PROOF_TOKEN",value:d}}}({sessionToken:b.sessionToken,useExactAuthToken:V});if(!N&&y&&(x={...x,[y.name]:y.value}),N){if(s=`--${w}\r
Content-Disposition: form-data;name=data\r
`,c)for(let a of Object.keys(c))s+=`${a}: ${c[a]}\r
`;s+="Content-Type: application/json\r\n",y&&(s+=`${y.name}: ${y.value}\r
`),O&&(s+="prefer: rich-error-as-message\r\n"),s+=`\r
${void 0!==a.postData?a.postData:""}\r
--${w}--`}K&&m.setQueryParameter("r",Math.random().toFixed(8)),b.sessionToken?.authKey&&m.setQueryParameter("authKey",b.sessionToken.authKey);let z=`${this._apiName}DataRequest.${A}`;if(!B){let a={url:(0,p.a)(m.toString()),name:z,extraData:F};t=new this._apiEvent(a)}let G=m.toString(),H=v&&v.now();return e.a.start({url:G,headers:x,method:Z,json:s||a.postData||"",requestTimeoutInMS:C,withCredentials:b.useCookies,onProgress:D,onUploadProgress:E,responseType:a.responseType||void 0}).then(b=>{let c=(0,i.a)(G,H);if(t){let a=q(b),d={resultType:f.b.Success,extraData:{...F||{},rawRequestDuration:c.duration,performanceEntry:JSON.stringify(c),requestId:a,CorrelationId:a,MSCorrelationVector:r(b)}};t.end(d)}return a.parseResponse?a.parseResponse(b):0===b.responseText.length?null:JSON.parse(b.responseText)},async a=>{let c=(a,b)=>(J&&(a=J(a,b)),t&&t.end(a),d.c.reject(b)),e=(0,i.a)(G,H);if(a instanceof Error){let b=d.c.isCanceled(a),g=b?f.b.ExpectedFailure:f.b.Failure;return c({error:a.message,resultCode:b?"Canceled":"",resultType:g,extraData:{rawRequestDuration:e.duration,performanceEntry:JSON.stringify(e)}},a)}{let g;if(("text"===a.responseType||""===a.responseType)&&a.responseText)try{g=JSON.parse(a.responseText)}catch(a){}if(!u&&"blob"===a.responseType&&a.response&&a.response.size>0)try{g=JSON.parse(await a.response.text())}catch(a){}if(O)try{let a=g?.error?.message;"string"==typeof a&&(g={error:this._encodingFixEnabled?JSON.parse(decodeURIComponent(escape(atob(a)))):JSON.parse(atob(a))})}catch(a){}let{status:h,statusText:i}=a,{error:{message:k="",innerError:{stackTrace:n="",debugMessage:o=""}={}}={}}=g||{};return(h||!this._isOffline?d.c.resolve(!1):this._isOffline()).then(d=>{let p=q(a),s=d||!!(0,j.b)(g,h,a=>Y[a]||!!(P&&(0,l.isExpectedError)({code:`${a}`,message:k},P))||void 0),t=function(a){let{error:b,isOffline:c}=a,d=b?.message||"";return("string"!=typeof d&&d.value?d.value:d)||(c?"Offline":"")}({error:g?.error,isOffline:d}),u=new j.a(Error(t),{response:g,status:h,request:a,correlationId:p,isExpected:s,extraData:{apiEventName:z}});return c({resultType:s?f.b.ExpectedFailure:f.b.Failure,error:k,resultCode:u.code,extraData:{...F||{},...(0,j.d)(u),stack:n,httpStatus:h,httpStatusText:i,requestId:p,CorrelationId:p,MSCorrelationVector:r(a),debugMessage:o,accessTokenLength:b.sessionToken&&b.sessionToken.accessToken?b.sessionToken.accessToken.length:-1,urlLength:m.toString().length,useCookies:!!b.useCookies,isOffline:d,rawRequestDuration:e.duration,performanceEntry:JSON.stringify(e)}},u)})}})},ab=this._sessionManagementProvider;if(H){if(T)return aa({sessionToken:T});if(s&&I&&ab&&ab.getToken)return ab.getToken({apiVersion:G,path:_,apiQosName:A,useStrongAuthToken:!0}).then(a=>aa({sessionToken:a}));let a=new m.a(_).authority;if(L&&a&&$&&a===$){if("GET"===Z)return aa({useCookies:!0});else if(ab&&ab.getFormDigest)return ab.getFormDigest({url:_}).then(a=>aa({digestValue:a,useCookies:!0}))}if(ab&&ab.getSessionToken){let a={apiVersion:G,endpoint:R,driveUrl:y,path:_,apiQosName:A,disallowSelfIssuedToken:t?void 0:Q};return d.c.resolve(ab.getSessionToken(a)).then(b=>aa({sessionToken:b}).catch(c=>ab.getSessionToken&&b&&function(a){if(a instanceof j.a){let{request:b}=a,c=b&&b.getResponseHeader("WWW-Authenticate");if(c&&c.slice(0,x.length)===x&&c.indexOf('error="insufficient_claims"')>-1)return!0}return!1}(c)?ab.getSessionToken({...a,claimsChallenge:{sessionToken:b,claims:function(a){let b=a.request&&a.request.getResponseHeader("WWW-Authenticate"),c='claims="';if(b){let a=b.indexOf(c);if(a>-1){let d=b.indexOf('"',a+c.length);if(d>-1){let e=b.slice(a+c.length,d);return g.Ov.isActivated("93E9F77D-7B3B-4760-B58F-1154E9E530ED","06/02/2022","Decode claims from base64")?e:atob(e)}}}}(c),error:c}}).then(a=>a.accessToken!==b.accessToken?aa({sessionToken:a}):d.c.reject(c)):d.c.reject(c)))}if(ab&&ab.getToken)return ab.getToken({apiVersion:G,path:_,apiQosName:A,disallowSelfIssuedToken:Q}).then(a=>aa({sessionToken:a}))}return aa({})},c={...a};return!g.Ov.isActivated("83F9234E-0E49-4110-943D-2F0394E9F9FF","5/24/2022","Route graph calls to Nucleus")&&this._dataSyncClient?function(a){let{dataSyncClient:b,options:c,getData:e}=a,f=()=>e(c);return d.c.resolve(b).then(b=>b?b.getData({url:c.path,method:c.requestType},({endpoint:b,headers:c,onComplete:d})=>e({...a.options,path:b.url,accessToken:{accessToken:b.authToken},forceContentType:!0,useExactAuthToken:!0,headers:c,onComplete:d}),f):f())}({dataSyncClient:this._dataSyncClient,options:c,getData:b}):b(c)}constructor(a,b){this._sendSyncClientHeadersKs=g.Ov.isActivated("00babe87-7679-4e02-94f0-4c05915282ca","3/29/2023");const{alwaysSendContentType:c=!1}=a,{sessionManagementProvider:d,urlDataSource:e,apiEvent:h=f.a,cookieOrigin:i,isOffline:j,dataSyncClient:k}=b;this._sessionManagementProvider=d,this._alwaysSendContentType=c,this._apiEvent=h,this._apiName=e&&"function"==typeof e.getApiName?e.getApiName():"Vroom",this._urlDataSource=e,this._cookieOrigin=i,this._isOffline=j,this._dataSyncClient=k,this._encodingFixEnabled=!g.Ov.isActivated("179f8622-1596-43df-a186-a4b42e1d7917","08/04/2020","Decode unicode characters in graph errors")&&!g.lU.isFeatureEnabled({ODC:"GraphEncodingFixKillswitch"}),this._driveIdUrlCheckEnabled=!g.Ov.isActivated("16BE6F20-C2C6-46AF-8EA5-6D43B30F7112","06/09/2022","Validate driveUrl against driveId")}}}
,(a,b,c)=>{c.r(b),c.d(b,{GraftOperationType:()=>d,backup:()=>g,default:()=>function a(b,c){if(!i(b))throw Error("Value for 'base' passed to 'graft' is not an object.");if(!i(c))throw Error("Value for 'extension' passed to 'graft' is not an object");if(c===b)return b;for(let e of Object.keys(c)){let f,g=c[e],h=b[e];if(g===h)continue;let k=g;if(i(k)&&k.graftOperationType)if(k.graftOperationType===d.replace){let{value:a}=k;h=void 0,g=a}else if(k.graftOperationType===d.backup){let{value:a}=k;if(void 0!==b[e])continue;g=a}else if(k.graftOperationType===d.optional){let{value:a}=k;if(void 0===a)continue;g=a}else if(k.graftOperationType===d.remove){delete b[e];continue}else throw Error("Unknown patch specified for grafting. Only use exported functions from Graft to create patches.");if(g instanceof Date)f=new Date(g.getTime());else if(j(g)){let a=h;j(a)||(a=[]),a.splice(0,a.length,...g),f=a}else if(i(g)){let b=h;i(b)||(b={}),a(b,g),f=b}else f=g;b[e]=f}return b},optional:()=>f,remove:()=>e,replace:()=>h});let d={none:0,replace:1,optional:2,remove:3,backup:4};function e(){return{graftOperationType:d.remove}}function f(a){return{graftOperationType:d.optional,value:a}}function g(a){return{graftOperationType:d.backup,value:a}}function h(a){return{graftOperationType:d.replace,value:a}}function i(a){return"object"==typeof a&&!!a}function j(a){return Array.isArray(a)}}
,,,(a,b,c)=>{var d,e;c.d(b,{a:()=>d}),(e=d||(d={}))[e.AMD=0]="AMD",e[e.ESM=1]="ESM"}
,(a,b,c)=>{c.d(b,{a:()=>l});var d=c(47),e=c(41),f=c(29),g=c(11);let h=(0,f.a)({eventName:"RequireJSError,",shortEventName:"RequireJSError",critical:!0},{message:g.a.String,requireModules:g.a.Array,requireType:g.a.String,stack:g.a.String});var i=c(63);let j=new d.a("RequireJS",e.a.session),k="error";class l{static log(a){h.logData(a);let b=j.getValue(k)||[];b.push(a.message),j.setValue(k,b),a&&("define"===a.requireType||"require"===a.requireType)&&a.stack&&a.requireModules&&i.a.log(a)}static registerRequireOnError(){if(window.requirejs&&"function"==typeof window.requirejs){let a=window.requirejs.onError;window.requirejs.onError=b=>{l.log(b),a&&!b.isTest&&a(b)}}}}l.registerRequireOnError()}
,,(a,b,c)=>{c.d(b,{a:()=>function a(b,c){let f=b||void 0,g="object"==typeof f?.extraData?f.extraData:void 0,h=b?f&&(0,e.b)(f)||b&&b.name||(b?"Unknown":void 0):void 0,{computeVeto:i,qosEndSchema:j}=c||{},k=b?i?i(j??(0,e.a)(b)):"None":void 0;return{errorCode:h,httpStatus:g?.status?Number(g?.status):void 0,resultCategory:g?.resultCategory?.toString(),...f?{..."boolean"==typeof f.isExpected?{resultType:f.isExpected?d.b.ExpectedFailure:d.b.Failure}:{resultType:d.b.Failure}}:{resultType:d.b.Success},extraData:{...f?{..."object"==typeof f.innerError?{innerError:a(f.innerError)}:{},..."string"==typeof f.correlationId?{correlationId:f.correlationId}:{},...f.extraData||{}}:{}},...k?{veto:k}:{}}}});var d=c(0),e=c(35)}
,,(a,b,c)=>{c.d(b,{a:()=>d});let d=-6}
,(a,b,c)=>{c.d(b,{a:()=>s,b:()=>r,c:()=>l,d:()=>k});var d,e,f=c(533),g=c(160);(d=e||(e={}))[d.cover=0]="cover",d[d.center=1]="center",d[d.fit=2]="fit",d[d.fitExpand=3]="fitExpand",d[d.fitExpandHeight=4]="fitExpandHeight",d[d.fitExpandWidth=5]="fitExpandWidth",d[d.fitWidth=6]="fitWidth",d[d.fitHeight=7]="fitHeight",d[d.top=8]="top";class h{constructor(a,b){this.name=a,this.getTransform=b}}function i(...a){return new h(a.map(a=>a.name).join("-"),(b,c)=>{let d=f.b.IDENTITY;for(let e of a){let a={width:b.width*d.scale,height:b.height*d.scale};d=e.getTransform(a,c).multiply(d)}return d})}let j=new h(e[1],(a,b)=>{let c=new g.b((b.width-a.width)/2,(b.height-a.height)/2);return new f.b(c)}),k=new h(e[8],(a,b)=>{let c=new g.b((b.width-a.width)/2,0);return new f.b(c)}),l=new h(e[6],(a,b)=>{let c=b.width/a.width;return new f.b(g.b.ORIGIN,Math.min(c,1))}),m=new h(e[7],(a,b)=>{let c=b.height/a.height;return new f.b(g.b.ORIGIN,Math.min(c,1))}),n=new h(e[2],(a,b)=>(a.width/a.height>b.width/b.height?l:m).getTransform(a,b)),o=new h(e[5],(a,b)=>{let c=b.width/a.width;return new f.b(g.b.ORIGIN,c)}),p=new h(e[4],(a,b)=>{let c=b.height/a.height;return new f.b(g.b.ORIGIN,c)}),q=new h(e[3],(a,b)=>(a.width/a.height>b.width/b.height?o:p).getTransform(a,b)),r=new h(e[0],(a,b)=>(a.width/a.height>b.width/b.height?m:l).getTransform(a,b));i(n,j),i(q,j);let s=i(r,j)}
,(a,b,c)=>{c.d(b,{a:()=>e,b:()=>j,c:()=>h,d:()=>f,e:()=>i,f:()=>g});var d=c("odsp.util_126");class e extends d.lM{constructor(a,b){const{response:{error:{innerError:{stackTrace:c=""}={}}={}}={},response:d,request:e,status:f,code:g=j(d,f,a=>`${a}`)||"unhandled"}=b;super({innerError:a,code:g,...b}),this.name="GraphError",this.response=d,this.status=f,this.serverStack=c,this.request=e,this.error=a}}function f(a){let b={};if(b.errorMessage=a.message,g(a)){b.vroomStatus=a.status;let{response:c}=a;if(c&&c.error){let a=c.error;b.vroomErrorCode=a.code,b.vroomErrorMessage=a.message;let d=a.innerError||a.innererror;d&&(b.vroomErrorInnerCode=d.code,b.vroomErrorInnerMessage=d.message,b.vroomErrorInnerDebugMessage=d.debugMessage,b.vroomErrorInnerStack=d.stackTrace)}}return b}function g(a){return!!a&&a instanceof e}function h(a,b){if(a&&g(a)){let{response:c,status:d}=a;return j(c,d,c=>b(c,a))}}function i(a){return h(a,a=>`${a}`)||"unhandled"}function j(a,b,c){if(a){let b=[],d=a.error;for(;d;)b.push(d),d=d.innerError||d.innererror;for(;d=b.pop();)if(void 0!==d.code){let a=c(d.code);if(void 0!==a)return a}}return c(b)}}
,,,(a,b,c)=>{c.d(b,{a:()=>u,b:()=>v});var d=c(63),e=c(105);class f{static init(){this._initialized||(this._initialized=!0,this._originalBeforeUnload=window.onbeforeunload,window.onbeforeunload=window.__onbeforeunload=a=>this._handleBeforeUnload(a))}static registerHandler(a){this._handlers.push(a)}static unRegisterHandler(a){for(let b=0;b<this._handlers.length;b++)if(this._handlers[b]===a){this._handlers.splice(b,1);break}}static registerOnContinueHandler(a){this._onContinueHandler=a}static unRegisterOnContinueHandler(a){this._onContinueHandler=null}static dispose(){this._originalBeforeUnload?window.onbeforeunload=this._originalBeforeUnload:window.onbeforeunload=null}static _handleBeforeUnload(a){let b;if(!this._allowNavs){for(let a=0;a<this._handlers.length;a++)try{if(b=this._handlers[a](!0))break}catch(a){d.a.log(a)}if(!b&&this._originalBeforeUnload)try{b=this._originalBeforeUnload(a)}catch(a){d.a.log(a)}}return b||void 0}registerAsyncHashNavHandler(a){this._asyncHashNavHandlers.push(a)}unregisterAsyncHashNavHandler(a){let b=this._asyncHashNavHandlers.indexOf(a);-1!==b&&this._asyncHashNavHandlers.splice(b,1)}registerHashNavDialogCallback(a){this._hashNavDialogCallback=a}registerHashNavDialogHandler(a){if(this._hashNavDialogHandler)throw Error("Registering HashNavDialogHandler when one is already set");this._hashNavDialogHandler=a}unregisterHashNavDialogHandler(){this._hashNavDialogHandler=void 0}isHashNavDialogHandlerRegistered(){return!!this._hashNavDialogHandler}async allowHashNavAsync(a,b){if(0===this._asyncHashNavHandlers.length)return a(),!0;try{for(let a of this._asyncHashNavHandlers)if(!await a())return b?.(),!1;return a(),!0}catch(a){return b?.(),!1}}allowHashNav(a,b){let c;if(!f._isDialogOpen&&!f._allowNavs){for(let a=0;a<f._handlers.length;a++)try{if(c=f._handlers[a](!1))break}catch(a){d.a.log(a)}c&&(f._isDialogOpen=!0,this._hashNavDialogCallback(c).then(()=>{f._isDialogOpen=!1,f._allowNavs=!0,f._blockNavsAgainId||(f._blockNavsAgainId=f._async.setImmediate(()=>{f._allowNavs=!1,f._blockNavsAgainId=null})),a&&a()},()=>{f._isDialogOpen=!1,b&&b()}))}return!c&&!f._isDialogOpen}blockHashNav(a,b){let c=null;if(this._dialogWasJustDismissed)return this._dialogWasJustDismissed=!1,!1;for(let a=0;a<f._handlers.length;a++)try{if(c=f._handlers[a](!1))break}catch(a){d.a.log(a)}return!!c&&!!this._hashNavDialogHandler&&(this._hashNavDialogHandler(c,()=>{f._onContinueHandler?f._onContinueHandler().then(()=>{this._dialogWasJustDismissed=!0,a()}).catch(()=>{}):(this._dialogWasJustDismissed=!0,a())},b),!0)}registerHandler(a){this._localHandlers.push(a),f.registerHandler(a)}unRegisterHandler(a){for(let b=0;b<this._localHandlers.length;b++)if(this._localHandlers[b]===a){this._localHandlers.splice(b,1);break}f.unRegisterHandler(a)}registerOnContinueHandler(a){f.registerOnContinueHandler(a)}unRegisterOnContinueHandler(a){f.unRegisterOnContinueHandler(a)}hasActiveBlock(){return 0!==this._localHandlers.length}dispose(){for(let a of this._localHandlers)f.unRegisterHandler(a)}constructor(){this._localHandlers=[],this._asyncHashNavHandlers=[]}}f._handlers=[],f._async=new e.a,f._initialized=!1,f.init();var g=c("odsp.util_126"),h=c(80),i=c(164),j=c(23);function k(a){return"string"==typeof a?a:(0,j.a)(a)}var l=c(362);let m=window.history,n=window.applicationCache,o=new g.Ey,p=!g.Ov.isActivated("DE394832-0B5E-447E-B070-CFB40B970AFE"),q=g.Ov.isActivated("a6d295af-8283-417b-85ed-1090c39b73cf"),r=g.Ov.isActivated("74b52c7a-41cb-4a56-a4d3-836e5320e6fd"),s=!g.Ov.isActivated("E2B6560C-7D5A-4493-ABF2-F2DE0CA09EEE"),t=!g.Ov.isActivated("49B2EAF5-4526-4E43-A44D-AE26B0BBE483");class u{get _history(){return this._overrideHistory?this._overrideHistory:history}dispose(){this.setNavEventListeners("off"),this.scope.dispose()}get viewParams(){return this._viewParams}navigateTo(a){r?this._doNavigate(a):(async()=>{await this.beforeUnload.allowHashNavAsync(()=>this._doNavigate(a))})().catch(()=>{})}updateViewParams(a,b={}){let c="string"==typeof a?(0,g.pW)(a):a,d={...b.clearOtherParams?{}:this._viewParams,...c};!q&&b.paramsToDelete&&b.paramsToDelete.forEach(a=>{delete d[a]}),b.ignoreHistory?this._replaceState(d,b.clearPath,void 0,b.UNSAFE_suppressChangeEvent):this._pushState(d,void 0,b.UNSAFE_suppressChangeEvent)}updateViewParamsWithoutHistoryChange(a,b){this._updateUrlState({type:"popstate",state:{viewParams:a,useViewParamsFromState:!0}},b)}getUrlFromViewParams(a){let b=k(a),c=this._getStateUrl(a,b);return`${window.location.origin}${c}`}reload(){window.location.reload()}setNavEventListeners(a){let b=("on"===a?this._events.on:this._events.off).bind(this._events);b(window,"hashchange",this._updateUrlState),b(window,"popstate",this._updateUrlState)}_updateUrlState(a,b){let c=!1;if(p?!this.beforeUnload.blockHashNav(()=>this._updateUrlState(a,b),()=>this._resetBeforeNavBlock()):this._dontBlockNextNav||this.beforeUnload.allowHashNav(()=>this._updateUrlState(a,b),()=>this._resetBeforeNavBlock())){this._dontBlockNextNav=!1;let{viewParams:d,usingHashParams:e,viewParamsString:f}=function(a){let{event:b,prettyPathMap:c,paramsPreference:d}=a||{},e=!1,f="";(!d||"hash"===d)&&location?.href?.indexOf("#")>-1?(f=location.hash.substr(1),e=!0):(!d||"search"===d)&&location?.search?.length&&(f=location.search.substr(1));let h=(0,g.pW)(f);c&&({viewParams:h,viewParamsString:f}=c.getEffectiveViewParamState({currentPathname:location?.pathname||"",actualViewParams:h,actualViewParamsString:f}));let i=function(a){let b="";if(a&&"popstate"===a.type&&a.state){let{useViewParamsFromState:c,viewParams:d}=a.state;c&&d&&(b=k(d))}return b}(b),j=(0,g.pW)(i),l=j,m=i;for(let a in h)if(j[a]!==h[a]){l=h,m=f;break}return{viewParams:l,viewParamsString:m,usingHashParams:e}}({event:a,prettyPathMap:this._prettyPathMap,...t?{paramsPreference:this._paramsPreference}:{}});f!==this._viewParamsString&&(this._viewParamsString=f||"",this._viewParams=d,c=!0),a&&this._shouldReloadOnNavigate&&this._shouldReloadOnNavigate()&&window.location.reload(),e&&this._performHashConversion&&this._supportsHistoryApi&&this._replaceState(f,void 0,void 0,b),c&&!b&&this._events.raise("change"),this._prevHash=s?window.location.hash:window.document.location.hash}else c=!1,a&&a.preventDefault();return c}_resetBeforeNavBlock(){if(this._dontBlockNextNav=!0,this._supportsHistoryApi)try{history.forward()}catch(a){this._hashNav(this._prevHash)}else this._hashNav(this._prevHash)}_pushState(a,b,c){let d=k(a);if(this._supportsHistoryApi)try{let b=this._getStateUrl(a,d,void 0);this._history.pushState({},"",b)}catch(a){this._hashNav(d)}else this._hashNav(d);this._updateUrlState(void 0,c),b&&this._setMaskUrl(b)}_replaceState(a,b,c,d){let e=k(a);if(this._supportsHistoryApi)try{let c=this._getStateUrl(a,e,b);this._history.replaceState({},"",c)}catch(a){this._supportsHistoryApi=!1,this._hashNav(e)}else this._hashNav(e);this._updateUrlState(void 0,d),c&&this._setMaskUrl(c)}_setMaskUrl(a){if(a&&this._supportsHistoryApi){let b={useViewParamsFromState:!0,viewParams:this._viewParams};this._history.replaceState(b,"",a)}}_getStateUrl(a,b,c){let d=s?window.location.pathname:document.location.pathname;return this._prettyPathMap?this._prettyPathMap.getUpdatedUrl({currentPathname:d,viewParams:a,viewParamsString:b,clearPath:c}):(0,l.a)({pathname:d,viewParamsString:b,clearPath:c})}_hashNav(a){s?window.location.hash=a:document.location.hash=a}_doNavigate(a){if(p||this.beforeUnload.allowHashNav(()=>this.navigateTo(a))){let b,c,d="string"==typeof a?{url:a}:a,e=d.url,f=a.hasOwnProperty("viewParams")?a.viewParams:void 0,g=a.hasOwnProperty("directOpen")?a.directOpen:void 0;if(f&&"#"===f[0]?(b=f.substr(1),c=e):(b="#"===e[0]?e.substr(1):void 0,c=void 0),void 0===d.frameId&&o.isPWA&&"#"!==e&&(d.frameId="_blank"),void 0!==b)d.ignoreHistory??this._history?.ignore?this._replaceState(b,!1,c,d.UNSAFE_suppressChangeEvent):this._pushState(b,c,d.UNSAFE_suppressChangeEvent);else{let a,b=!1;if(d&&d.frameId&&"_self"!==d.frameId)try{(a=window.open(g?e:"",d.frameId))&&"_blank"===d.frameId&&(a.opener=null),a&&!g&&(this._disableNavigationEventListeners&&"#"===e?this.updateViewParams("",{ignoreHistory:d.ignoreHistory,clearOtherParams:!0,UNSAFE_suppressChangeEvent:d.UNSAFE_suppressChangeEvent}):a.location.href=e),b=!0}catch(a){}if(!a&&!b)try{d.ignoreHistory??this._history?.ignore?window.location.replace(e):window.location.href=e}catch(a){}}}}constructor(a={}){this._viewParamsString="",this._dontBlockNextNav=!1;const{disableHashConversion:b=!1,disableNavigationEventListeners:c=!1,shouldReloadOnNavigate:d,history:e,prettyPathMap:g}=a;this._overrideHistory=e,this._shouldReloadOnNavigate=d,this._performHashConversion=!b,this._disableNavigationEventListeners=a.disableNavigationEventListeners,this._viewParams={},this._prettyPathMap=g,this._paramsPreference=a.paramsPreference,this.scope=new i.a,this._prevHash=window.location.hash,this._supportsHistoryApi=m&&!!m.pushState&&(!n||n.status===n.UNCACHED),this.beforeUnload=new f,this.scope.attach(this.beforeUnload),this._events=this.scope.attach(new h.a(this)),this._events.declare("change"),c||this.setNavEventListeners("on"),this._updateUrlState()}}let v=u}
,(a,b,c)=>{c.d(b,{a:()=>p,b:()=>t,c:()=>u,d:()=>v,e:()=>o});var d,e,f=c("odsp.util_126"),g=c("fui.util_178"),h=c(875);let i={neutralDark:"#201f1e",neutralPrimary:"#323130",neutralPrimaryAlt:"#3b3a39",neutralSecondary:"#605e5c",neutralSecondaryAlt:"#8a8886",neutralTertiary:"#a19f9d",neutralTertiaryAlt:"#c8c6c4",neutralQuaternary:"#d2d0ce",neutralQuaternaryAlt:"#e1dfdd",neutralLight:"#edebe9",neutralLighter:"#f3f2f1",neutralLighterAlt:"#faf9f8"},j="#3d3e66",k="#e9eaf6",l="#616161",m="#ebebeb",n={black:"#242424",neutralDark:"#424242",neutralPrimary:l,neutralPrimaryAlt:l,neutralSecondary:"#8a8a8a",neutralTertiary:"#bdbdbd",neutralTertiaryAlt:"#d1d1d1",neutralQuaternary:m,neutralQuaternaryAlt:m,neutralLight:"#f0f0f0",neutralLighter:"#f5f5f5",neutralLighterAlt:"#fafafa",white:"#fff",themeDarker:"#323348",themeDark:j,themeDarkAlt:j,themePrimary:"#5b5fc7",themeSecondary:"#9092c1",themeTertiary:"#a5a7cf",themeLight:"#385dc2",themeLighter:k,themeLighterAlt:k,accent:"#137ad1"};function o(a,b,c,d){let e,h={...a};if(u(b)){let b,c=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light";(b=(void 0)??window._spPageContextInfo)&&(f.B3.initSPExpFeatures(b.ExpFeatures),f.B3.initSPEcsClientFeatures(b.ECSClientFeatures)),f.lU.isFeatureEnabled({ODB:62512})&&v(a.themeSchemaVersion)&&c!==a.displayMode&&a.otherMode&&(h.palette={...h.palette,...a.otherMode?.palette},h.otherMode={...h.otherMode,palette:{...a.palette},isInverted:a.isInverted,displayMode:a.displayMode},h.isInverted=a.otherMode?.isInverted,h.displayMode=a.otherMode?.displayMode)}return g.K7.applyBatchedUpdates(()=>{e=(0,g.fK)(p(h,b,d))}),e}function p(a,b,c){var d;let e;return f.Ov.isActivated("0d6cef16-2b13-4ef6-94c6-60e57e73d2a3")?(d=a,b&&(f.B3.initSPExpFeatures(b.ExpFeatures),f.B3.initSPEcsClientFeatures(b.ECSClientFeatures)),f.lU.evaluateCanOverride(),h.b||(d=s({palette:{themePrimary:"#03787c",themeLighterAlt:"#f0f9fa",themeLighter:"#c5e9ea",themeLight:"#98d6d8",themeTertiary:"#49aeb1",themeSecondary:"#13898d",themeDarkAlt:"#026d70",themeDark:"#025c5f",themeDarker:"#014446"}},d)),(e=d.palette)&&(e.black||e.neutralPrimary||e.white||e.neutralQuaternary)&&(!e.black||!e.white||!e.neutralPrimary||!e.neutralQuaternary||0!==e.black.indexOf("#000")||0!==e.white.toLowerCase().indexOf("#fff")||0!==e.neutralPrimary.indexOf("#333")||0!==e.neutralQuaternary.toLowerCase().indexOf("#d0d0d0"))||(d.palette={...d.palette,...i}),d):(b&&(f.B3.initSPExpFeatures(b.ExpFeatures),f.B3.initSPEcsClientFeatures(b.ECSClientFeatures)),f.lU.evaluateCanOverride(),function(a,b){switch(a){case 0:return q(b);case 1:return q(s({palette:n},b));default:return q(s(r,b))}}(h.b?0:(!c||!b?.themedCssFolderUrl)&&function(a){if(f.Ov.isActivated("a7baa93c-d9fa-4e23-aa22-5f51ad9fab63")||!a)return!1;{let b=a.featureInfo?.VivaBackendFeature;return b?b.Enabled:a.isCurrentSiteAVivaBackendSite}}(b)?1:2,a))}function q(a){let b,c;return c=!(b=a.palette).black&&!b.neutralPrimary&&!b.white&&!b.neutralQuaternary||b.black&&b.white&&b.neutralPrimary&&b.neutralQuaternary&&0===b.black.indexOf("#000")&&0===b.white.toLowerCase().indexOf("#fff")&&0===b.neutralPrimary.indexOf("#333")&&0===b.neutralQuaternary.toLowerCase().indexOf("#d0d0d0"),(!b||c)&&(a.palette={...a.palette,...i}),a}let r={palette:{themePrimary:"#03787c",themeLighterAlt:"#f0f9fa",themeLighter:"#c5e9ea",themeLight:"#98d6d8",themeTertiary:"#49aeb1",themeSecondary:"#13898d",themeDarkAlt:"#026d70",themeDark:"#025c5f",themeDarker:"#014446"}};function s(a,b){return{...a,...b,effects:{...a.effects,...b.effects},fonts:{...a.fonts,...b.fonts},palette:{...a.palette,...b.palette}}}function t(a){let b=f.Ov.isActivated("17d606aa-a12a-4d3e-b988-db14e6dc370f")?window._spPageContextInfo:a??window._spPageContextInfo;return b&&(f.B3.initSPExpFeatures(b.ExpFeatures),f.B3.initSPEcsClientFeatures(b.ECSClientFeatures)),f.B3.isFeatureEnabled({ODB:61259})}function u(a){let b=a??window._spPageContextInfo;return b&&(f.B3.initSPExpFeatures(b.ExpFeatures),f.B3.initSPEcsClientFeatures(b.ECSClientFeatures)),f.B3.isFeatureEnabled({ODB:61852})}function v(a){if(a){let b=/^([0-9]+)\.([0-9]+)(?:\.([0-9]+)(?:\.([0-9]+))?)?$/g.exec(a);if(b)return 2===parseInt(b[1],10)}return!1}(d=e||(e={}))[d.noDefault=0]="noDefault",d[d.vivaHomeDefault=1]="vivaHomeDefault",d[d.spDefault=2]="spDefault"}
,,(a,b,c)=>{function d(a){return!!a&&"function"==typeof a.addEventListener}function e(a,b){let c=a.__declaredEvents=a.__declaredEvents||{};if("string"==typeof b)c[b]=!0;else for(let a=0;a<b.length;a++)c[b[a]]=!0}function f(a,b,c,e){let f,g=a;if(d(g)){if(document.createEvent){let a=document.createEvent("HTMLEvents");a.initEvent(b,e,!0),a.args=c,f=g.dispatchEvent(a)}}else for(;g&&!1!==f;){var h;if((h=g)&&h.__events__){let a=g.__events__[b];for(let b in a)if(Object.prototype.hasOwnProperty.call(a,b)){let d=a[b];for(let a=0;!1!==f&&a<d.length;a++){let b=d[a];b.objectCallback&&(f=b.objectCallback.call(b.parent,c))}}g=e?g.parent:null}else g=null}return f}c.d(b,{a:()=>e,b:()=>d,c:()=>f})}
,(a,b,c)=>{function d(a){return a&&"object"==typeof a&&"default"in a?a.default:a}c.d(b,{a:()=>d})}
,,(a,b,c)=>{let d;c.d(b,{a:()=>X});var e,f,g,h,i=c(105),j=c(253),k=c(225),l=c("odsp.util_126"),m=c(153);async function n(a){let b={...a,requiredMainThreadCPUIdleDurationInMilliseconds:1e3};return(await c.e(71).then(c.bind(c,789))).getFirstCPUIdle(b)}var o=c(16);(e=g||(g={}))[e.own=0]="own",e[e.cors=1]="cors";class p{constructor(a,b,c,d,e,f,g){this.url=a,this.duration=b,this.correlationId=c,this.status=d,this.startTime=e,this.endTime=f,this.name=g,this.clientDurationInMilliseconds=new Date(f).getTime()-new Date(e).getTime(),this.origin=a&&new o.b(a).getHost()}}let q="undefined"==typeof window?self:window;class r{reset(){this.apis=[],this._apiBuffer={}}startTracking(a){let{ignore:b=a=>!1,getAPIName:c=a=>void 0}=a,d=a=>{let{id:b,request:c,type:d}=a,e=new p;e.startTime=new Date().toISOString(),e.startTimeRelative=this._now(),"fetch"===d&&(e.url="string"==typeof c?c:c.url),this._apiBuffer[b]=e},e=a=>{try{let{response:d,id:e}=a,f=this._apiBuffer[e];if(f&&!b(f.url)){let a,b,e;try{a=d.headers.get("SPClientServiceRequestDuration"),b=d.headers.get("SPSQLQueryCount")}catch(a){}try{e=d.headers.get("SPRequestGuid")}catch(a){}f.name=c(f.url),f={...f,...{endTime:new Date().toISOString(),endTimeRelative:this._now(),clientDurationInMilliseconds:this._now()-f.startTimeRelative,status:d.status,...a?{duration:Number(a)}:{},...b?{sqlRT:Number(b)}:{},...e?{correlationId:e}:{}}},this.apis.push(f)}}catch(a){}},f=a=>{try{let{request:d,id:e}=a,f=this._apiBuffer[e],g=d.responseURL||d.requestUrl;if(f&&!b(g)){let a=d.getAllResponseHeaders()?.toLowerCase()??"",b=a.indexOf("spclientservicerequestduration:")>=0&&d.getResponseHeader("SPClientServiceRequestDuration"),e=a.indexOf("spsqlquerycount:")>=0&&d.getResponseHeader("SPSQLQueryCount"),h=a.indexOf("sprequestguid:")>=0&&d.getResponseHeader("SPRequestGuid");f.name=c(g),f={...f,...{endTime:new Date().toISOString(),endTimeRelative:this._now(),clientDurationInMilliseconds:this._now()-f.startTimeRelative,status:d.status,...b?{duration:Number(b)}:{},...e?{sqlRT:Number(e)}:{},...h?{correlationId:h}:{},url:g}},this.apis.push(f)}}catch(a){}};return this._instrument({fetch:{onRequest:d,onResponse:e},xhr:{onRequest:d,onResponse:f}}),()=>{this.stopTracking()}}stopTracking(){q.__RUMOneAPITrackerInstrumented=!1,this._originalXhrOpen&&(XMLHttpRequest.prototype.open=this._originalXhrOpen),this._originalXhrSend&&(XMLHttpRequest.prototype.send=this._originalXhrSend),this._originalFetch&&(q.fetch=this._originalFetch)}getData(){let a=0,b=0,c=[];for(let d of this.apis)if(d){a++,b+=d.duration,d.origin||(d.origin=new o.b(d.url).getHost()),d.hostType=new o.b(window.location.href).getHost()===d.origin?g.own:g.cors;let e={...d};delete e.url,c.push(e)}return{count:a,duration:b,calls:JSON.stringify(c)}}_instrument(a){if(q.__RUMOneAPITrackerInstrumented)return;q.__RUMOneAPITrackerInstrumented=!0;let{fetch:b,xhr:c}=a;if("XMLHttpRequest"in q&&"undefined"!=typeof XMLHttpRequest){this._originalXhrSend=XMLHttpRequest.prototype.send,this._originalXhrOpen=XMLHttpRequest.prototype.open;let a=this;XMLHttpRequest.prototype.open=function(...b){return this.requestUrl=b[1],a._originalXhrOpen.apply(this,b)},XMLHttpRequest.prototype.send=function(...b){let d=a._requestIdGenerator();return c.onRequest({request:this,id:d,type:"xhr"}),this.addEventListener("readystatechange",()=>{4===this.readyState&&c.onResponse({request:this,id:d,type:"xhr"})}),a._originalXhrSend.apply(this,b)}}"fetch"in q&&void 0!==q.fetch&&(this._originalFetch=q.fetch.bind(q),q.fetch=(a,c)=>new Promise((d,e)=>{let f=this._requestIdGenerator();b.onRequest({request:a,id:f,type:"fetch"}),this._originalFetch(a,c).then(a=>{b.onResponse({response:a,id:f,type:"fetch"}),d(a)},a=>{e(a)})}))}_now(){return performance&&performance.now?Math.round(performance.now()):NaN}constructor(){this._requestIdGenerator=function(){let a=0;return()=>(a++).toString()}(),this.apis=[],this._apiBuffer={}}}var s=c(42);c(477);var t=c(80);let u=["navigationStart","unloadEventStart","unloadEventEnd","fetchStart","redirectStart","redirectEnd","domainLookupStart","domainLookupEnd","connectStart","secureConnectionStart","connectEnd","requestStart","responseStart","responseEnd","domLoading","domComplete","loadEventStart","loadEventEnd"];function v(){let[a]=performance.getEntriesByType("navigation");if(a)return a}function w(a){try{let b=window._spPageContextInfo,c=a.name;if(b?.cdnPrefix){let a=b.cdnPrefix.replace(/bld$/,"");if(0===c.search(window.location.protocol+"//"+a))return!0}if(b?.cdnBaseUrl&&0===c.search(b.cdnBaseUrl))return!0;return/(cdn(ppe)?|static(ppe)?)\.sharepointonline\.com|\.akamaihd\.net|akamai\.odsp\.cdn\.office\.net/i.test(c)}catch(a){return!1}}function x(a,b){let c=[];for(let d=0;d<a.length;d++){let e=a[d];(!b.from||b.from(e))&&(!b.requestType||b.requestType(e))&&c.push(e)}return c}let y={CDN:w,SharePoint:a=>0===a.name.search(window.location.protocol+"//"+window.location.host),ThirdParty:a=>!y.SharePoint(a)&&y.CDN(a)},z={HTML:a=>/html/i.test(a.initiatorType),ASPX:a=>/\.aspx/i.test(a.name),JS:a=>/script/i.test(a.initiatorType),CSS:a=>/link|css/i.test(a.initiatorType),IMG:a=>/img/i.test(a.initiatorType)};function A(a,b){return b in a?{[b]:Math.round(a[b])}:{}}var B=c(101),C=c(255);let D=l.Ov.isActivated("baffdece-5d6e-4a68-a576-dcf23dd0b94d"),E=["EUPL","TTI"],F="ComponentPerformanceTracker";function G(a){let{id:b,instanceId:c}=a;return c?`${b}.${c}`:b}function H(a){let{components:b,instanceId:c}=a,d=[];for(let a of b)"string"==typeof a?d.push(G({id:a,instanceId:c})):d.push(G({id:a.id,instanceId:a.instanceId||c}));return d}class I{reset(){this._data={},this._metadata={},this._error=void 0,this._stageReadyMap={EUPL:!1,TTI:!1};let a=this._signals;this._signals={EUPL:new l.G7,TTI:new l.G7},a.EUPL.promise.catch(()=>{}),a.TTI.promise.catch(()=>{}),a.EUPL.reject(new l.CE({code:"Interrupted"})),a.TTI.reject(new l.CE({code:"Interrupted"})),this._eventMC&&(this._eventMC.publish("reset",{publisher:F}),this._eventMC.publish("all",{publisher:F}))}subscribe(a,b){return this._eventMC?this._eventMC.subscribe(a,b):()=>{}}getPerformanceData(){let a=[];for(let b of Object.keys(this._data))a.push(this._data[b]);return a}expectComponent(a){this._expectComponent(a)&&this._checkStages()}expectComponents(a){let{stage:b}=a,c=H(a),d=!1;for(let a of c)d=this._expectComponent({id:a,stage:b})||d;d&&this._checkStages()}updateExpectedStage(a){let{stage:b}=a,c=G(a);this._metadata[c]&&(this._metadata[c].stage=b),this._data[c]&&(this._data[c].ignoreForEUPL="EUPL"!==b,this._checkStages())}isExpectingComponent(a){return!!this._metadata[a]}getMissingComponents(a){let{stage:b}=a,c=[];for(let a of Object.keys(this._metadata))"All"!==b&&this._metadata[a].stage!==b||this._data[a]?.renderTime||c.push(a);return c}isStageReady({stage:a}){return"All"===a?this._isStageReady({stage:a}):this._stageReadyMap[a]}reportComponentData(a){let{data:b}=a;if(this._data[b.controlId])return;if(!b.renderTime){try{b.renderTimeRequiredDataChecker(b)&&(b.renderTime=b.renderTimeCalculator(b))}catch(a){this._setError("Error calculating render time for component",b),b.renderTime=-1}(!b.renderTime||b.renderTime<0)&&(this._setError("Invalid render time for component",b),b.renderTime=-1)}let c=this._metadata[b.controlId];c&&(b.ignoreForEUPL="EUPL"!==c.stage),this._data[b.controlId]=b,b.renderTime&&this._checkStages()}reportComponent(a){let{id:b,instanceId:c,startTime:d,endTime:e}=a,f=G({id:b,instanceId:c}),g=new C.a({controlId:f,startTime:d,endTime:e});this.reportComponentData({data:g})}async waitForStageReady({stage:a}){if(!D)return new Promise(()=>{});{let b=!1;for(;!b;)try{await this._signals[a].promise,b=!0}catch(a){if((0,l.nm)(a)&&"Interrupted"===a.code)continue;throw a}}}getError(){return this._error}removeComponents(a){for(let b of H(a))delete this._data[b],delete this._metadata[b];this._checkStages()}areComponentsReady(a){return H(a).every(a=>this._data[a]?.renderTime!==void 0)}dispose(){this._eventMC&&this._eventMC.dispose()}_expectComponent(a){let{stage:b}=a,c=G(a);this._metadata[c]?this._metadata[c].stage=b:this._metadata[c]={id:c,stage:b};let d=!1;if(this._data[c]){let a="EUPL"!==b;this._data[c].ignoreForEUPL!==a&&(this._data[c].ignoreForEUPL=a,d=!0)}return this._stageReadyMap[b]&&(this._stageReadyMap[b]=!1,"EUPL"===b&&this._stageReadyMap.TTI&&(this._stageReadyMap.TTI=!1),d=!0),d}_setError(a,b){!this._error&&(this._error=a,b&&(this._error+=` (${JSON.stringify({controlId:b.controlId,startTime:b.startTime,endTime:b.endTime,renderTime:b.renderTime})})`))}_checkStages(){let a=[];for(let b of E)!this._stageReadyMap[b]&&this._isStageReady({stage:b})&&(this._stageReadyMap[b]=!0,D?this._signals[b].resolve():a.push(b));if(this._eventMC){for(let b of a)this._eventMC.publish(b,{publisher:F});this._eventMC.publish("update",{publisher:F}),this._eventMC.publish("all",{publisher:F})}}_isStageReady(a){let{stage:b}=a;if("TTI"===b&&!this._stageReadyMap.EUPL)return!1;let c=0;for(let a of Object.keys(this._metadata))if("All"===b||this._metadata[a].stage===b)if(!this._data[a]?.renderTime)return!1;else c++;return"EUPL"!==b||c>=1}constructor(a={}){this._data={},this._metadata={},this._stageReadyMap={EUPL:!1,TTI:!1},this._signals={EUPL:new l.G7,TTI:new l.G7},D||(this._eventMC=new B.a)}}let J=!l.Ov.isActivated("141F57D6-0313-495D-9340-47DBE127B468"),K=!l.Ov.isActivated("F74D763D-85D9-4290-A358-67EB10506661"),L=!l.Ov.isActivated("3BA48823-0380-4A47-9075-1C887CC226C5"),M=!l.Ov.isActivated("AF517CC4-FA3B-4673-BB0E-BC3F2E55157F"),N=l.Ov.isActivated("0d09f7d6-976a-4c50-b9b9-415c0c9f45b1"),O=l.Ov.isActivated("8022108e-d4e4-457f-bdaf-13bdd1ebb564"),P="__default_rumone__",Q={checkInterval:100,error_timeout:3e4,max_markers:200};function R(a,b){k.a.logData({streamName:a,dictionary:b,persistence:"Critical"})}(f=h||(h={}))[f.Incomplete=1]="Incomplete",f[f.ReadyToUpload=2]="ReadyToUpload",f[f.Uploaded=3]="Uploaded",f[f.TimeOut=4]="TimeOut",f[f.Skipped=5]="Skipped";let S=["EUPL","ScenarioId"],T=/^[a-zA-Z0-9](([a-zA-Z0-9|_|\.]){0,98}[a-zA-Z0-9])?$/,U=/(?:\/api\/|\/_api\/)(.*?)(?:\(|\?|sharePoint\:|$)/;function V(a){return null==a}let W="perftest";class X{static getRUMOneLogger(a,b){let{name:c=P,config:d=Q,onLog:e=R}=a||{};if(!X._loggers[c]){let{componentPerformanceTracker:a=new I}=b||{};try{let b=new X({name:c,onLog:e,config:d},{componentPerformanceTracker:a});X._loggers[c]=b}catch(a){}}return X._loggers[c]}registerLoggingFunc(a){let b=this._loggingFunctions.indexOf(a);return b<0&&this._loggingFunctions.push(a),()=>{b>=0&&this._loggingFunctions.splice(b,1)}}get KeyMetrics(){return this._isTtiEnabled()&&this.addExpectedKeyMetric("TTI"),this._keyMetrics}getPerformanceData(){return this._rumoneData}skipLoggingSessionsInBackground(){J&&(this._skipLoggingSessionsInBackground=!0)}startAPIMeasurement(a){return this._apiTracker.startTracking(a)}undoAPIInstrument(){this._apiTracker.stopTracking()}dispose(){this.components.reset(),this._dataStartTime=0,this._dataState=1,this._apiTracker.reset(),this._isW3cTimingCollected=!1,this._isW3cResourceTimingCollected={},this._tempData={},this._rumoneData={},this._settings={},this._keyMetrics=S.slice(0),this.clearPerfDataTimer(),this._euplBreakDown={},this._ttiBreakDown={},this._serverMetrics={},this.clearResourceTimings(),(0,m.c)(this._getOwnMakers().map(a=>a.name)),X._markers[this._name]=[],this._unhookUnloadEvent(),this._fciPromise=void 0,d=void 0,this._resetBackgroundVisibilityStatus()}resetLogger(){O?(this.components.reset(),this._emergencyUpload(),this._dataStartTime=new Date().getTime(),this._dataState=1,this._apiTracker.reset(),this._isW3cTimingCollected=!1,this._isW3cResourceTimingCollected={},this._tempData={},this._rumoneData={},this._settings={},this._keyMetrics=S.slice(0),this.clearPerfDataTimer(),this.setPerfDataTimer(),this._euplBreakDown={},this._ttiBreakDown={},this._serverMetrics={},this.clearResourceTimings(),(0,m.c)(this._getOwnMakers().map(a=>a.name)),X._markers[this._name]=[],this._unhookUnloadEvent(),this._hookUnloadEvent(),this._fciPromise=void 0,d=void 0,this._resetBackgroundVisibilityStatus()):(this._emergencyUpload(),this.dispose(),this._dataStartTime=new Date().getTime(),this._hookUnloadEvent(),this.setPerfDataTimer()),this.logMessageInConsole("Reset performance Logger Done"),t.a.raise(this,"reset",{})}setSettings(a){this._settings={...this._settings,...a}}setTimeout(a){this._config.error_timeout=a}excludePageForPerfData(){this.setSettings({excludePageData:!0})}writeToBackgroundScenarioIdForPerfData(){this.setSettings({writeToBackgroundScenarioId:!0})}getPerformanceDataPropertyValue(a){return a&&this._rumoneData[a]}setPerformanceDataPropertyValue(a,b){return a&&T.test(a)?(this._rumoneData[a]=b,!0):(console.error(`key ${a} does not confrim to the Regex ${T}`),!1)}addExpectedControl(a){let b=this._normalizeControl(a);return this.components.expectComponent({id:b.controlId,stage:b.ignoreForEUPL?"TTI":"EUPL"})}ignoreExpectedControl(a){let b=this._normalizeControl(a);return this.components.updateExpectedStage({id:b.controlId,stage:"TTI"})}expectingControl(a){let b=this._normalizeControl(a);return this.components.isExpectingComponent(b.controlId)}writeServerCorrelationId(a){this._rumoneData.ServerCorrelationId=this._rumoneData.ServerCorrelationId||a}writeServerUrl(){this._rumoneData.ServerUrl=this._processEUIIUrl(location.href)}writeServerSideLatency(a,b){this.isCollected("ServerRequestDuration")||(this._rumoneData.ServerRequestDuration=a,this._rumoneData.IISLatency=b)}writeControlPerformanceData(a){if(a)return this.components.reportComponentData({data:a})}writeAPICallPerformanceData(a){a&&this._apiTracker.apis.push(a)}readAPICallPerformanceData(){return this._apiTracker.apis}writeAppCache(a){this.isCollected("AppCache")||(this._rumoneData.AppCache=a)}writePageTransitionType(a,b){(!this.isCollected("PageTransitionType")||b)&&(a===j.a.fullPageLoad||a===j.a.none||a===j.a.pageToPageNavigation||a===j.a.onePageAppNavigation)&&(this._rumoneData.PageTransitionType=a)}writeScenarioId(a,b){(!this.isCollected("ScenarioId")||b)&&(this._rumoneData.ScenarioId=a)}collectW3CPerfTimings(){if(!this._isW3cTimingCollected){let a=function(){let a=performance&&performance.timing;if(a){let c=[];for(let d=0;d<u.length;d++){var b;let e=a[u[d]];e&&c.push(["secureConnectionStart"!==(b=u[d])?"W3c"+b.charAt(0).toUpperCase()+b.slice(1):"W3cSecureConnectStart",Number(e)])}return c}}();if(a)for(let b of a)this._logRUMOneData(...b);this._isW3cTimingCollected=!0,this._logRUMOneData("navigation",function(){let a=v();if(a&&a.toJSON){let b=a.toJSON();return delete b.name,b}}())}}collectW3cResourceTimings(a={}){let{logSummery:b=!0,start:c=0,end:d=Math.round(this.now()),columnNameOverride:e=a=>a}=a,f=`logSummery=${b}|start=${c}|end=${d}|columnNameOverride=${e}`;if(!this._isW3cResourceTimingCollected[f]){let a=function(a){let{logSummery:b,start:c,end:d,columnNameOverride:e}=a;if(!window.document||!performance?.getEntriesByType)return;let f=function(a,b){let c=performance.getEntriesByType("resource"),d=document.getElementsByTagName("iframe");for(let a=0;a<d.length;a++){let b=null;try{b=d[a].contentWindow.performance}catch(a){}b&&b.getEntriesByType&&(c=c.concat(b.getEntriesByType("resource")))}return c.filter(c=>c.startTime>=a&&c.startTime<=b)}(c,d),g=[],h=Object.keys(y);for(let a=0;a<h.length;a++){let c=h[a],d=x(f,{from:y[c],requestType:null});b&&g.push({key:e(c+"RequestCountTotal"),value:d.length});let i=Object.keys(z);for(let a=0;a<i.length;a++){let f=i[a];b&&g.push({key:e(c+"RequestCount"+f),value:x(d,{from:null,requestType:z[f]}).length})}if(d.length>0&&(b&&g.push({key:e(c+"RequestDownloadTime"),value:Math.round(d.reduce((a,b)=>a+b.duration,0)/d.length)}),"CDN"===c)){let a=JSON.stringify(d.map(a=>({name:a.name.split("/").map(a=>a.split("?")[0]).filter(a=>a&&a.length>0).slice(-1)[0].replace(/\(.*?\)/g,"()"),startTime:Math.round(a.startTime),duration:Math.round(a.duration),transferSize:a.transferSize||0,fetchStart:Math.round(a.fetchStart),requestStart:Math.round(a.requestStart),connect:Math.round(a.connectEnd-a.connectStart),domainLookup:Math.round(a.domainLookupEnd-a.domainLookupStart),redirect:Math.round(a.redirectEnd-a.redirectStart),...A(a,"workerStart"),...A(a,"responseStart"),...A(a,"responseEnd"),...A(a,"secureConnectionStart")})));g.push({key:e(c+"RequestNames"),value:a})}}return g}({columnNameOverride:e,logSummery:b,start:c,end:d});if(a){for(let b of a)this._logRUMOneData(b.key,b.value);this._isW3cResourceTimingCollected[f]=!0}}}saveTempData(a,b){this._tempData[a]=b}readTempData(a){return this._tempData[a]}writeRenderTime(a,b){(!this.isCollected("RenderTime")||b)&&(this._rumoneData.RenderTime=a)}writePreRenderTime(a){this.isCollected("PreRender")||(this._rumoneData.PreRender=a)}writePostRenderTime(a){this.isCollected("PostRender")||(this._rumoneData.PostRender=a)}writeDataFetchTime(a,b){(!this.isCollected("DataFetch")||b)&&(this._rumoneData.DataFetch=a)}writeAppInfo(a,b){(!this.isCollected("AppInfo")||b)&&(this._rumoneData.AppInfo=a)}isRunning(){return 3!==this._dataState&&4!==this._dataState&&5!==this._dataState}writeEUPLBreakdown(a,b){return this._writeBreakdown(this._euplBreakDown,a,b)}addEUPLBreakdown(a,b,c){return this._addBreakdown(this._euplBreakDown,a,b,c)}readEUPLBreakdown(a){return this._readBreakdown(this._euplBreakDown,a)}writeTTIBreakdown(a,b){return this._writeBreakdown(this._ttiBreakDown,a,b)}addTTIBreakdown(a,b,c){return this._addBreakdown(this._ttiBreakDown,a,b,c)}readTTIBreakdown(a){return this._readBreakdown(this._ttiBreakDown,a)}getStartTime(){let{getStartTime:a}=this._settings;return a?a():0}addFlights(a){if(a&&a.length>0){let b=JSON.parse(this.getPerformanceDataPropertyValue("Flights")||"[]");for(let c=0;c<a.length;c++){let d=a[c];d&&-1===b.indexOf(d)&&b.push(d)}this._rumoneData.Flights=JSON.stringify(b)}}addPerfFlights(a){this._rumoneData.PerfFlights=a}collectSPClientFlights(a){let{ExpFeatures:b}=a,c="";if(b&&b.length)for(let a of b)c+=this._numberToBinString(a).split("").reverse().join("");if(!l.Ov.isActivated("f00a10d6-c80d-49a2-9636-1b349f88c198")){let b=this._collectEcsClientFlights(a);b&&(c+=`|${b}`)}this._rumoneData.Flights=c}collectODCClientRamps(a,b){let{Ramps:c={}}=a,d=[];for(let a of b)a.ODC&&"boolean"!=typeof a.ODC&&c[a.ODC]&&d.push(a.ODC);this._rumoneData.Flights=JSON.stringify(d)}addServerMetrics(a,b){if(a)for(let c in a)c&&!V(a[c])&&(V(this._serverMetrics[c])||b)&&(this._serverMetrics[c]=a[c])}writeServerVersion(a){this._rumoneData.SharePointServerVersion=a}getComponentPerformanceData(){return this.components.getPerformanceData()}mark(a){(X._markers[this._name]=X._markers[this._name]||[]).push(a),(0,m.f)(a)}now(){return performance&&performance.now?Math.round(performance.now()):NaN}registerPreUploadDataHandler(a){this._preUploadDataHandler=a}getMarkerTime(a){return(0,m.e)(a)}addExpectedKeyMetric(a){this._keyMetrics&&-1===this._keyMetrics.indexOf(a)&&this._keyMetrics.push(a)}set waitOnAddingExpectedControl(a){this.setSettings({waitOnAddingExpectedControl:a})}get waitOnAddingExpectedControl(){return this._settings.waitOnAddingExpectedControl}_measureTTI(){let{getStartTime:a}=this._settings,{getAbsoluteEUPL:b}=this._settings.TTISettings,c=b?b(this._rumoneData.EUPL):this.now(),e=a?a():0,f=NaN,g=v();if(g&&(f=Math.round(function(a){let b=0;for(let c of a)c>0&&(0===b||c<b)&&(b=c);return b}([g.redirectStart,g.workerStart,g.fetchStart])),e>0&&f<e&&(f=e)),this._isTtiEnabled()&&!this._fciPromise){let a,b,g;this.logMessageInConsole("Starting TTI measurement");let h=(a=window.__tti&&window.__tti.e||[],window.__fci?.o&&window.__fci.o.disconnect(),window.__fci?.e&&(window.__fci.e=[]),b=window.__tti&&window.__tti.e,g=window.__tti&&window.__tti.o,b&&(window.__tti.e=[]),g&&g.disconnect(),a);this._fciPromise=n({measurementStartTime:c,initialEntries:h,measureName:"TTI"}),this._fciPromise.then(a=>{let{fci:b,longTasks:g}=a||{},h=V(b)?NaN:Math.round(b)-e,i=d;i&&(this._rumoneData.CLS=i.cls,this._rumoneData.CLSFullResult=JSON.stringify(i)),this.collectW3cResourceTimings({logSummery:!1,start:e,end:b,columnNameOverride:a=>`${a}OfTTI`}),this._rumoneData.TTI=h,this.logMessageInConsole(`Calculated TTI ${h}`);let j=Math.round(b);this._logRUMOneData("actionableTti",j-f),this._logRUMOneData("TtiData",{longTaskMinimum:c,ttiStartTime:e,ttiEndTime:j,actionableStartTime:f,isTtiSupported:"PerformanceLongTaskTiming"in window,hasHighResolutionTiming:m.a,isPerformanceNavigationSupported:"PerformanceNavigationTiming"in window}),g&&(this._rumoneData.TTILongTasks=JSON.stringify(g),this._rumoneData.TTILongTasksPostFMPCount=g.filter(a=>a.end>this._rumoneData.EUPL).length),this._skipLoggingSessionsInBackground&&document?.visibilityState==="hidden"&&(L?this.writeToBackgroundScenarioIdForPerfData():this.excludePageForPerfData()),this._skipLoggingSessionsInBackground&&K&&this._hasPageGoneIntoBackground&&(L?this.writeToBackgroundScenarioIdForPerfData():this.excludePageForPerfData()),this._logLastRequestBeforeTTI(h,g),this.logMessageInConsole("Sending 'measureTTI' event"),t.a.raise(this,"measureTTI",this._rumoneData),this.logMessageInConsole("Completed TTI measurement")})}}_logLastRequestBeforeTTI(a,b){let c=performance.getEntriesByType("resource");if(a&&b&&b.length>0&&c&&c.length>0){let a,d,e=b[b.length-1].start,f=c[0];for(let a of c)a.responseEnd<e&&a.responseEnd>f.responseEnd&&(f=a);a=w(f)?f.name:this._processLastNetworkUrl(f.name),d=/\.aspx/i.test(f.name)?"ASPX":/\.js/i.test(f.name)?"JS":/\.css/i.test(f.name)?"CSS":/img/i.test(f.initiatorType)||/\.jpg|\.jpeg|\.png|\.gif/i.test(f.name)?"IMG":/aria\.microsoft\.com/i.test(f.name)?"Aria":/_api/i.test(f.name)?"API":"Other",this._rumoneData.TTILastRequestName=a,this._rumoneData.TTILastRequestType=d,this._rumoneData.TTILastRequestStartTime=f.startTime,this._rumoneData.TTILastRequestEndTime=f.responseEnd}}_numberToBinString(a){let b=(a>>>0).toString(2);return`${Array(32-b.length+1).join("0")}${b}`}_logRUMOneData(a,b){a&&(this._rumoneData[a]=b)}_resetBackgroundVisibilityStatus(){this._visibilityChangeAbortController&&this._visibilityChangeAbortController.abort(),this._hasPageGoneIntoBackground=!1}clearResourceTimings(){performance&&performance.clearResourceTimings&&performance.clearResourceTimings()}_isBreakdownValue(a){return void 0!==a.needFlatten}collectMarks(){let a={},b=0;this._getOwnMakers().forEach(c=>{b<this._config.max_markers&&(a[c.name.substr(m.b.length)+`.mark${b++}`]=Math.round(c.startTime))}),this.writeEUPLBreakdown(JSON.stringify(a))}_getOwnMakers(){let a=X._markers,b=[].concat(...Object.keys(a).filter(b=>a.hasOwnProperty(b)&&b!==this._name).map(b=>a[b]));return(0,m.d)().filter(a=>-1===b.indexOf(a.name))}logMessageInConsole(a){this.isRUMOneDebuggingEnabled&&console.log(a)}get isRUMOneDebuggingEnabled(){try{if("sessionStorage"in window&&window.sessionStorage){let a=window.sessionStorage.enableRUMOneDebugging;return a&&"true"===a.toLowerCase()&&"undefined"!=typeof console&&!!console}}catch(a){}return!1}logObjectForDebugging(a,b){this.isRUMOneDebuggingEnabled&&console.log(`${this._name} ${a} : `+JSON.stringify(b))}isCollected(a){return!V(this.getPerformanceDataPropertyValue(a))}_normalizeControl(a){return"string"==typeof a?{controlId:a,ignoreForEUPL:!1}:a}setPerfDataTimer(){this._perfDataTimer=this._async.setTimeout(()=>{this.loopForDataCompleteness()},this._config.checkInterval)}clearPerfDataTimer(){V(this._perfDataTimer)||(this._async.clearTimeout(this._perfDataTimer),this._perfDataTimer=null)}_hookUnloadEvent(){window.addEventListener&&window.addEventListener("beforeunload",this._emergencyUpdateFunc)}_unhookUnloadEvent(){window.removeEventListener&&window.removeEventListener("beforeunload",this._emergencyUpdateFunc)}_setFCP(){let a=NaN,b=performance&&performance.getEntriesByType&&performance.getEntriesByType("paint");if(b&&b.length>0){let c=b.filter(a=>"first-contentful-paint"===a.name);if(c&&1===c.length)a=c[0].startTime;else{let c=b.filter(a=>"first-paint"===a.name);c&&1===c.length&&(a=c[0].startTime)}}isNaN(a)||(this._rumoneData.FCP=Math.round(a))}collectSupplementaryData(){this._setFCP(),this.setAPIDataToRUMOne(),this.collectMarks(),this.writeServerUrl(),this.setBrowserInfo(),this.setReferrer(),this._collectMemoryData(),this._collectPageServerData(),this._setAppInfo(),this._setTestName(),this._collectExperiments(),this._rumoneData.DOMElements=document&&document.querySelectorAll("*").length,this._rumoneData.ServerMetrics=JSON.stringify(this._serverMetrics),this._rumoneData.EUPLBreakdown=JSON.stringify(this._euplBreakDown),this._rumoneData.TTIBreakdown=JSON.stringify(this._ttiBreakDown)}_collectExperiments(){let a=window.ODSP_EXPERIMENTS||{},b={};for(let c in a)if(a.hasOwnProperty(c)){let d=a[c];d&&d._serverTime&&Date.now()-new Date(d._serverTime).getTime()<1296e6&&(b[c]=a[c])}this._rumoneData.SPExperiments=JSON.stringify(b)}_setTestName(){let a=new o.b(location.href).getQueryParameter(W);if(!l.Ov.isActivated("F7E4291F-F19B-472F-8CBB-CD0D4FFA7939")&&"sessionStorage"in window&&window.sessionStorage){let a=window.sessionStorage.getItem(W);a?.length>0&&(this._rumoneData.TestName=a)}a&&!this._rumoneData.TestName&&(this._rumoneData.TestName=a)}loopForDataCompleteness(){if(this.clearPerfDataTimer(),!this._settings.waitOnAddingExpectedControl){if(this.isRUMOneDebuggingEnabled&&(this.logMessageInConsole("===================================================================="),this.logObjectForDebugging("RUMONE: ",this._rumoneData),this.logObjectForDebugging("RUMOne DataState: ",String(this.getReadableDataState(this._dataState))),this.logObjectForDebugging("Controls: ",this.getComponentPerformanceData()),this.logObjectForDebugging("API Performance Data: ",this._apiTracker.apis),this.logObjectForDebugging("Temp Data: ",this._tempData),this.logObjectForDebugging("EUPLBreakdown: ",this._euplBreakDown),this.logObjectForDebugging("TTIBreakdown: ",this._ttiBreakDown),this.logObjectForDebugging("ServerMetrics: ",this._serverMetrics),this.logMessageInConsole("====================================================================\n\n")),!this.isRunning())return;this._updateState()}this._checkTimeout(),this.isRunning()&&this.setPerfDataTimer()}_updateState(){switch(this._dataState){case 1:this.components.isStageReady({stage:"EUPL"})&&!this.waitOnAddingExpectedControl&&this.setEUPL();let a=this.components.isStageReady({stage:"TTI"});this._isTtiEnabled()&&this.isCollected("EUPL")&&a&&this._measureTTI(),0===this._getMissedKeyMetrics().length&&(!N||a)&&(this._dataState=2);break;case 2:this._uploadPerfData({emergency:!1})}}_checkTimeout(){if(!this.isRunning()||2===this._dataState)return;let a=Date.now();1===this._dataState&&a-this._dataStartTime<=this._config.error_timeout||(this._setError({reason:"TimeOut",details:{MissingMetrics:this._getMissedKeyMetrics(),MissingControls:this.components.getMissingComponents({stage:"All"})}}),this._dataState=4,this._uploadPerfData({emergency:!1}))}_setError(a){this._rumoneData.RUMOneError||(this._rumoneData.RUMOneError=JSON.stringify(a))}_getMissedKeyMetrics(){let a=[];for(let b=0;b<this.KeyMetrics.length;b++)V(this.getPerformanceDataPropertyValue(this.KeyMetrics[b]))&&a.push(this.KeyMetrics[b]);return a}_emergencyUpload(){this.isRunning()&&this._uploadPerfData({emergency:!0})}_uploadPerfData(a){this.writeControlDataToRUMOne(),this.collectSupplementaryData();let{emergency:b}=a;this._rumoneData.EmergencyUploaded=!!b;try{if(this._settings.excludePageData)this._dataState=5,this._resetBackgroundVisibilityStatus(),this.logMessageInConsole("Uploading perf data skipped as requested by the consumer");else if(b||2===this._dataState||4===this._dataState)if(this._loggingFunctions&&this._loggingFunctions.length>0)if(this._rumoneData){let a=this.getPerformanceData();L&&this._settings.writeToBackgroundScenarioId&&a.ScenarioId&&(a.ScenarioId+="_background"),this._loggingFunctions.forEach(b=>{b("RUMOne",a)}),this._dataState=3,this._preUploadDataHandler?.(),t.a.raise(this,"dataUploaded"),this.isRUMOneDebuggingEnabled&&(this.logMessageInConsole("Final Data uploaded"),this.logObjectForDebugging("RUMONE: ",a),this.logObjectForDebugging("RUMOne DataState: ",this.getReadableDataState(this._dataState)))}else console.error("Error: Uploading perf data called but perf data is not available");else console.error("Uploading perf data skipped as loggingFunc is not defined");else console.error(`Error: Uploading perf data called with wrong data state ${this._dataState}`)}catch(a){var c;c=`PerformanceLogger error writing RUMOne data: ${a}`,"undefined"!=typeof console&&console&&console.error(c)}finally{this.isRunning()||(this._unhookUnloadEvent(),this.undoAPIInstrument())}}_isTtiEnabled(){return!!this._settings.TTISettings?.enabled}getReadableDataState(a){for(let b in h)if(a===Number(h[b]))return b;return"NaN"}writeControlDataToRUMOne(){let a=this.components.getPerformanceData();if(a.length){let b=a.filter(a=>!!a.renderTime&&!a.ignoreForEUPL);b.sort((a,b)=>b.renderTime-a.renderTime);for(let a=0;a<10&&a<b.length;a++)this._logRUMOneData(`Control${a+1}Id`,b[a].controlId),this._logRUMOneData(`Control${a+1}RenderTime`,b[a].renderTime);let c={};a.filter(a=>!!a.renderTime&&!!a.ignoreForEUPL).forEach(a=>{c[a.controlId]={data:a.renderTime,needFlatten:a.needFlatten}}),Object.keys(c).length>0&&this.writeEUPLBreakdown(JSON.stringify(c),!0)}let b=this.components.getError();b&&this._setError({reason:"ControlPerformanceFailure",details:b})}setEUPL(){if(!this.isCollected("EUPL")){let a=Date.now()-this.now(),b=this._settings.getStartTime?this._settings.getStartTime():0,c=b,d=0,e=this.components.getPerformanceData(),f=l.Ov.isActivated("d9016302-003d-432b-83ef-c585c62612fe")||this._settings.ignoreStartTimeForEupl;for(let b of e)!b.ignoreForEUPL&&(f?(b.renderTime&&d<b.renderTime&&(d=b.renderTime),b.endTime>c&&(c=b.endTime)):b.endTime>c&&(c=b.endTime>31536e6?b.endTime-a:b.endTime));f?this._rumoneData.EUPL=d:this._rumoneData.EUPL=Math.round(c-b),this._logRUMOneData("euplData",{euplStartTime:b,euplEndTime:c}),this._skipLoggingSessionsInBackground&&document?.visibilityState==="hidden"&&(L?this.writeToBackgroundScenarioIdForPerfData():this.excludePageForPerfData()),this._skipLoggingSessionsInBackground&&K&&this._hasPageGoneIntoBackground&&(L?this.writeToBackgroundScenarioIdForPerfData():this.excludePageForPerfData()),t.a.raise(this,"eupl",d)}}setBrowserInfo(){this._rumoneData.Browser=this._platformDetection.browserName+this._platformDetection.browserMajor,this._rumoneData.BrowserIsMobile=this._platformDetection.isMobile}_collectMemoryData(){this.isCollected("UsedJSHeapSize")||"undefined"==typeof performance||void 0===performance.memory||(this._rumoneData.UsedJSHeapSize=performance.memory.usedJSHeapSize,this._rumoneData.TotalJSHeapSize=performance.memory.totalJSHeapSize)}_collectPageServerData(){this.addServerMetrics({cpuDuration:window.g_cpuDuration,duration:window.g_duration,iisLatency:window.g_iisLatency,queryCount:window.g_queryCount,queryDuration:window.g_queryDuration,spPageContextDuration:window.g_pageContextDuration,deferred_cpuDuration:window.g_deferred_cpuDuration,deferred_duration:window.g_deferred_duration,deferred_iisLatency:window.g_deferred_iisLatency,deferred_queryCount:window.g_deferred_queryCount,deferred_queryDuration:window.g_deferred_queryDuration})}setAPIDataToRUMOne(){let a=this._apiTracker.getData();this._rumoneData.APICallCount=a.count,this._rumoneData.APICallDurationSum=a.duration,this._rumoneData.APICalls=a.calls}setReferrer(){this._rumoneData.Referrer=this._processEUIIUrl(document.referrer)}_setAppInfo(){if(!this._rumoneData.AppInfo){let a=window._spModuleLink;if(a){let{buildNumber:b,manifestName:c,scenarioName:d}=a,e=JSON.stringify({buildNumber:b,manifestName:c,scenarioName:d});this._rumoneData.AppInfo=e}}}_writeBreakdown(a,b,c){if(b)try{let d=JSON.parse(b);for(let b in d)d.hasOwnProperty(b)&&this._addBreakdown(a,b,d[b],c)}catch(a){this.logMessageInConsole("Failed to write EUPL breakdown data:"+a.toString())}}_addBreakdown(a,b,c,d){if(b&&!V(c)){if(V(a[b])||d){let d=this._isBreakdownValue(c)?c.data:c;a[b]=d??void 0}this._isBreakdownValue(c)&&c.needFlatten&&(!this.isCollected(b)||d)&&this._logRUMOneData(b,c.data)}}_readBreakdown(a,b){return b?a[b]:a}_processEUIIUrl(a){let b=new s.a(a||"");return`${b.authority}/{ length: ${b.path.length}, segments: ${b.segments.length} }`}_processLastNetworkUrl(a){let b=new s.a(a||"");if(b.authority.indexOf("lpcres")>0||b.authority.indexOf("shell.cdn.office")>0)return a;let c=U.exec(a),d="";return c&&c.length>0&&(d=`${c[0]}`),`${b.authority}${d}`}_collectEcsClientFlights(a){let{ECSClientFeatures:b}=a;return Object.keys(l.u9.EcsClientFlightInfo).map(a=>`ECS_${String(a)}_${(0,l.Us)(a,b)}`).join(",")}constructor(a,b){const{name:c,config:d,onLog:e}=a;this._dataStartTime=Date.now(),this._name=c,this._config=d,this._keyMetrics=S.slice(0),this._rumoneData={},this._dataState=1,this._loggingFunctions=[],this._euplBreakDown={},this._ttiBreakDown={},this._serverMetrics={},this._isW3cTimingCollected=!1,this._isW3cResourceTimingCollected={},this._tempData={},this._settings={},this._emergencyUpdateFunc=this._emergencyUpload.bind(this),this._async=new i.a,this._apiTracker=new r,this._platformDetection=new l.Ey,this._skipLoggingSessionsInBackground=!1,K&&document&&(this._visibilityChangeAbortController=new AbortController,this._hasPageGoneIntoBackground="hidden"===document.visibilityState,document.addEventListener("visibilitychange",()=>{"hidden"===document.visibilityState&&(this._hasPageGoneIntoBackground=!0,this._visibilityChangeAbortController.abort())},{signal:this._visibilityChangeAbortController.signal})),this.components=b.componentPerformanceTracker,this.registerLoggingFunc(e),this.setPerfDataTimer(),this._hookUnloadEvent()}}M&&((0,l.PZ)("rumOneLoggers",{get:()=>X._loggers}),(0,l.PZ)("rumOne",{get:()=>X._loggers[P]})),X._loggers={},X._markers={}}
,(a,b,c)=>{var d,e;c.d(b,{a:()=>f}),(e=d||(d={}))[e.none=0]="none",e[e.viewChange=1]="viewChange",e[e.inPageNavigation=2]="inPageNavigation",e[e.pageToPageNavigation=3]="pageToPageNavigation",e[e.fullPageLoad=4]="fullPageLoad",e[e.onePageAppNavigation=5]="onePageAppNavigation";let f=d}
,(a,b,c)=>{c.d(b,{a:()=>d});function d(a,b,c){let d=[],e=[],f=c||((a,b)=>a===b);return function a(b,c){if(b===c)return!0;if(null===b||null===c||"object"!=typeof b||"object"!=typeof c)return!1;{let g=Object.keys(b).sort(),h=Object.keys(c).sort();if(g.length!==h.length||!g.every((g,i)=>{if(g!==h[i])return!1;if("function"==typeof b[g]||"function"==typeof c[g]||f(b[g],c[g]))return!0;if("object"!=typeof b[g])return!1;if(-1!==d.indexOf(b[g]))throw Error(`Cannot perform DeepCompare() because a circular reference was encountered, object: ${b}, property: ${g}`);if(d.push(b[g]),-1!==e.indexOf(c[g]))throw Error(`Cannot perform DeepCompare() because a circular reference was encountered, object: ${c}, property: ${g}`);return e.push(c[g]),!!a(b[g],c[g])&&(d.pop(),e.pop(),!0)}))return!1}return!0}(a,b)}}
,(a,b,c)=>{c.d(b,{a:()=>g,b:()=>d});let d=c("odsp.util_126").Ov.isActivated("117dc17d-2ad5-4b71-b395-89cf0580f8c5");function e(a){return a?a.endTime-a.startTime:0}function f(a){return!!a&&(!!a.startTime||0===a.startTime)&&(!!a.endTime||0===a.endTime)&&a.endTime>a.startTime}class g{constructor(a){const{controlId:b,startTime:c,endTime:g,ignoreForEUPL:h,needFlatten:i,renderTimeCalculator:j=e,renderTimeRequiredDataChecker:k=f}=a;this.controlId=b,this.startTime=c,this.endTime=g,this.renderTimeCalculator=d?j:e,this.renderTimeRequiredDataChecker=d?k:f,this.ignoreForEUPL=void 0===h||h,this.needFlatten=void 0!==i&&i}}}
,(a,b,c)=>{c.d(b,{a:()=>e});var d=c(6);function e(a,b,c){try{let e,f=c||window;if(!f||!f.performance||!a||!b)return{duration:-1};let g=performance.getEntriesByType("resource");new d.a(a).authority||(a=(f.location&&new d.a(f.location.href).authority)+a);for(let c=g.length-1;c>=0;c--){let d=g[c];if(d.startTime<b)break;decodeURIComponent(d.name)===decodeURIComponent(a)&&(e=d)}if(e)return(({connectEnd:a,connectStart:b,decodedBodySize:c,domainLookupend:d,domainLookupStart:e,duration:f=-1,encodedBodySize:g,fetchStart:h,nextHopProtocol:i,redirectEnd:j,redirectStart:k,requestStart:l,responseEnd:m,responseStart:n,secureConnectionStart:o,startTime:p,transferSize:q,workerStart:r})=>({connectEnd:a,connectStart:b,decodedBodySize:c,domainLookupend:d,domainLookupStart:e,duration:f,encodedBodySize:g,fetchStart:h,nextHopProtocol:i,redirectEnd:j,redirectStart:k,requestStart:l,responseEnd:m,responseStart:n,secureConnectionStart:o,startTime:p,transferSize:q,workerStart:r}))(e);return{duration:-1}}catch(a){return{duration:-1}}}}
,(a,b,c)=>{c.d(b,{a:()=>e});var d=c(6);function e(a,b){try{let c={...globalThis.window&&window.location.origin?{[window.location.origin]:"<location.origin>"}:{},...globalThis.window&&window._spPageContextInfo?.webAbsoluteUrl?{[window._spPageContextInfo.webAbsoluteUrl]:"<pageContext.webAbsoluteUrl>"}:{},...b||{}},{authority:e,path:f}=new d.a(a),g=f,h=e;for(let b of Object.keys(c))if(a.slice(0,b.length)===b){g=a.slice(b.length),h=c[b];break}let i=g.split("/");return`${h}/{ length: ${g.length}, segments: ${i.length} }`}catch{return"ErrorWhileScrubbingUrl"}}}
,(a,b,c)=>{let d;c.d(b,{a:()=>h,b:()=>i});var e=c(6),f=c("odsp.util_126");let g="cdn.office.net";function h(){if(!d){d=[g];let a=c.p||"undefined"!=typeof window&&window.require?.toUrl("");a&&0>a.indexOf(g)&&new e.a(a).authority&&d.push(new e.a(a).authority)}return d}function i(a){try{let b=a.stack??("string"==typeof a?a:void 0);if(!b)return;let c=[],d=!1,e=b.split("\n"),g=h();for(let a=1;a<e.length;a++){let b=e[a],f=!1;for(let a of g)if(b.includes(a)){f=!0;break}f?(d=!0,c.push(b)):c.push("<scrubbed-stack-line>")}if(!d)return(0,f.ve)("<scrubbed-stack>");return(0,f.ve)(c.join("\n"))}catch{return}}}
,(a,b,c)=>{c.d(b,{a:()=>d});function d(a,b){let c=a.toUpperCase(),d=b&&b.toUpperCase();return c.substring(0,d&&d.length||0)===d}}
,(a,b,c)=>{let d,e;c.d(b,{a:()=>o,b:()=>p});let f={any:0,file:1,"!file":-1,folder:2,"!folder":-2,media:3,"!media":-3,photo:4,"!photo":-4,video:5,"!video":-5,document:6,"!document":-6,audio:7,"!audio":-7,word:8,"!word":-8,powerpoint:9,"!powerpoint":-9,excel:10,"!excel":-10,onenote:11,"!onenote":-11,zip:12,"!zip":-12,pdf:13,"!pdf":-13,text:14,"!text":-14,listItem:15,"!listItem":-15,published:16,"!published":-16};e={},Object.keys(f).forEach(a=>{e[f[a]]=a});var g=c(13),h=c("odsp.util_126");let i="ViewFields",j="Query",k="Where";function l(a){let b;try{b=d.parseFromString(a,"application/xml")}catch(a){throw Error("Invalid XML (exception thrown)")}if(!b.documentElement)throw Error("Invalid XML (documentElement does not exist)");if(b.querySelector("parsererror"))throw Error("Invalid XML (parsererror found)");return b}window.DOMParser&&(d=new DOMParser);let m=()=>{let a=new window.XMLSerializer;return m=()=>a,a},n=!h.Ov.isActivated("5C15B666-477B-47A6-9539-26B37D93446C");function o(a,b,c){return JSON.stringify({parameters:function(a){let{context:b,listContext:c,pageSize:d}=a,{viewXml:e,firstGroupOnly:f,expandGroups:n,allowMultipleValueFilterForTaxonomyFields:o,groupByOverride:p,requestDatesInUtc:q,groupReplace:r,additionalFiltersXml:s,mergeDefaultView:t,showStubFile:u,modernListBoot:v,requireFolderColoringFields:w}=b,x=("undefined"!=typeof _spPageContextInfo&&_spPageContextInfo&&_spPageContextInfo.webTemplate&&(b.webTemplate=_spPageContextInfo.webTemplate),function(a){let{disableAutoHyperlink:b,fieldNames:c=[],needsSchema:d,needsContentTypes:e,needsListAvailableContentTypes:f,needsContentTypeOrder:g,needsGridInitInfo:h,needsForms:i,needsQuickLaunch:j,needsSpotlight:k,needsViewMetadata:l,needsParentInfo:m,needsMountPoint:n,requestToken:o,isListDataRenderOptionChangeFeatureEnabled:p,isSpotlightFeatureEnabled:q,needUpdatePageContext:r,needClientSideComponentManifest:s,renderCustomActions:t,renderSpfxCustomActions:u,preAuthorizedDownloadUrl:v,requireDownloadUrlNoAuth:w,needsContextInfo:x}=a,y=0;return(d||o)&&(d?(y|=7,p&&(y|=4096)):y|=2,c.indexOf("name.FileSystemItemId")>-1&&(y|=32)),x&&(y|=1),e&&(y|=16),f&&(y|=65536),g&&(y|=131072),h&&(y|=262144),q&&k&&(y|=258),i?y|=64:p&&(y|=4098),j&&(y|=128),l&&(y|=1536),m&&(y|=8192),n&&(y|=1048576),r&&(y|=16384),s&&(y|=32768),b&&(y|=2048),t&&(y|=4194304),u&&(y|=2097152),v&&(y|=8388608),w&&(y|=0x1000000),a.needsFileSystemId&&(y|=32),a.disableSortBehavior&&(y|=0x4000000),y}(b)),y=!(c&&c.urlParts&&c.urlParts.siteRelation===g.d.crossSite),z=p||s||"number"==typeof d?function(a){let b="",c="",{groupByField:d,disableGrouping:e,fetchNextGroupXml:f,additionalFiltersXml:g,pageSize:h}=a;e?b="<GroupBy />":d&&(b=`<GroupBy Collapse="FALSE"><FieldRef Name="${d}"/></GroupBy>`);let i="";return(f&&(i=f),g&&(i=i?`<And>${i}${g}</And>`:g),i&&(b+=`<Where>${i}</Where>`),h&&(c=`<RowLimit>${h}</RowLimit>`),b&&(b=`<Query>${b}</Query>`),c||b)?`<View>${b}${c}</View>`:""}({groupByField:p,additionalFiltersXml:e?void 0:s,pageSize:d}):void 0;e&&s&&(e=function(a){let{viewXml:b,additionalFiltersXml:c}=a;if(b&&c)try{let a=function(a="<View/>"){let b,c,d,e,f,g,h,m,n,o,p,q,r=l(a),s=r.documentElement;if("View"!==s.tagName)throw Error('View XML outer element tag name must be "View" (case-sensitive)');for(let a=0,k=s.childNodes.length;a<k;a++){let k=s.childNodes[a];k.nodeType===Node.ELEMENT_NODE&&(k.tagName!==i||b?k.tagName!==j||c?"RowLimit"!==k.tagName||d?"NewDocumentTemplates"===k.tagName?e=k:"Aggregations"===k.tagName?f=k:"ViewType2"===k.tagName?g=k:"GridLayout"===k.tagName?h=k:"AssociatedContentTypeId"===k.tagName?m=k:"ViewData"===k.tagName?n=k:"CustomOrder"===k.tagName?o=k:"CalendarViewStyles"===k.tagName?p=k:"JSLink"===k.tagName&&(q=k):d=k:c=k:b=k)}b||(b=r.createElement(i),s.appendChild(b)),c||(c=r.createElement(j),s.appendChild(c)),f&&s.appendChild(f);let t={xmlDoc:r,view:s,query:c,viewFields:b,rowLimit:d,newDocumentTemplates:e,aggregations:f,viewType2:g,gridLayout:h,associatedContentTypeId:m,viewData:n,customOrder:o,viewStyles:p,jsLink:q};for(let a=0,b=c.childNodes.length;a<b;a++){let b=c.childNodes[a];b.nodeType===Node.ELEMENT_NODE&&("OrderBy"!==b.tagName||t.orderBy?"GroupBy"!==b.tagName||t.groupBy?b.tagName!==k||t.where||(t.where=b):t.groupBy=b:t.orderBy=b)}return t}(b),d=a.where;if(d||(d=a.xmlDoc.createElement(k),a.query.appendChild(d)),h.Ov.isActivated("A87EA41A-CD8C-42DB-908F-ACEFFB8CB988","4/30/2021","Get CombinedViewXml without using innerHTML as innerHTML property has some problems in IE"))d.innerHTML=d.innerHTML?"<And>"+d.innerHTML+c+"</And>":c;else{let a=d.childElementCount?"<And>"+m().serializeToString(d.firstElementChild)+c+"</And>":c,b=l(a).documentElement;d.childElementCount?d.replaceChild(b,d.firstElementChild):d.appendChild(b)}b=m().serializeToString(a.view)}catch(a){}return b}({viewXml:e,additionalFiltersXml:s}));let A={__metadata:{type:"SP.RenderListDataParameters"},RenderOptions:x>0?x:void 0,ViewXml:e||void 0,OverrideViewXml:z||void 0,AllowMultipleValueFilterForTaxonomyFields:o||void 0,AddRequiredFields:y||void 0,MergeDefaultView:t||void 0,FilterOutChannelFoldersInDefaultDocLib:b.filterOutChannelFoldersInDefaultDocLib||void 0};return v&&(A.ModernListBoot=!0),u&&(A.ShowStubFile=!0),q&&(A.DatesInUtc=!0),r&&(A.ReplaceGroup=!0),n&&(A.ExpandGroups=!0),f&&(A.FirstGroupOnly=!0),w&&(A.RequireFolderColoringFields=!0),A}({context:a,listContext:b,pageSize:c})})}function p(a){let b,{sortField:c,itemIds:d,itemRefs:e,isAscending:g,pageSize:i,fetchNextGroup:j,lastGroup:k,recurseInFolders:l,recurseOnlyFiles:m,typeFilter:n={filters:[]},fieldNames:o=[],groupBy:p=[],userIsAnonymous:z=!1,requestMetaInfo:A=!1,requestCommentFlags:B=!1,fileTypeIconMap:C}=a,D="",E="",F="",G="",H=!1;if(i||(i=1),p&&p.length>0){let a=p.map(a=>`<FieldRef Name="${a}"/>`).join("");D=`<GroupBy Collapse="FALSE">${a}</GroupBy>`}if(j&&(b=function(a){let b=a.fieldSchema.Name,c=!h.Ov.isActivated("69f4bf91-aa36-4e53-9659-8d083662b4ab","2/22/2021","Use ResultType as type if possible")&&!!a.fieldSchema.ResultType&&a.fieldSchema.ResultType||a.fieldSchema.Type,d=a.fieldSchema.Ascending&&"false"===a.fieldSchema.Ascending.toLowerCase(),e=d?"Lt":"Gt",f=a.groupingId;if("DateTime"===c){if("(null)"===f&&!d)return`<IsNotNull><FieldRef Name="${b}" /></IsNotNull>`;if(a.fieldFilterByValue)f=a.fieldFilterByValue;else if("(null)"!==f)try{let a=new Date(f);f=`${a.getUTCFullYear()}-${a.getUTCMonth()+1}-${a.getUTCDate()}T00:00:00Z`}catch(a){}}else"Boolean"===c&&""===f&&(f="-1");let g=`<${e}><FieldRef Name="${b}" /><Value Type="${c}"><![CDATA[${f}]]></Value></${e}>`;return d&&("(null)"!==f||""!==a.fieldFilterByValue)&&(g=`<Or><IsNull><FieldRef Name="${b}" /></IsNull>${g}</Or>`),g}(k)),d&&d.length>0||e&&e.length>0){let a=[],c=[];if(d)for(let b of d)isNaN(Number(b))?a.push(b):c.push(b);b=w([y("ID",1===c.length?"Number":"Counter",c),y("UniqueId","Guid",a),y("FileRef","Text",e&&e.map(a=>`<![CDATA[${a}]]>`))]),l&&(G='Scope="RecursiveAll"')}else F=c?`<OrderBy><FieldRef Name="${c}" Ascending="${g}"></FieldRef></OrderBy>`:"",H=!0,m&&(G='Scope="Recursive"');return n.filters.length&&(b=function(a,b={}){let{fileTypeIconMap:c}=b,d=[],e=[],g=[],h=[],i=0;for(let b of a.filters)if("string"==typeof b){let a=b,j=!1;"!"===a[0]&&(a=a.slice(1),j=!0);let k="."===a[0],l=k?a.slice(1):a;if(k){let a='<Value Type="Text">${extType}</Value>'.replace("${extType}",l);j?h.push(a):g.push(a)}else switch(f[l]){case f.photo:c&&(j?e.push(y("File_x0020_Type","String",c.photo.extensions,!0)):d.push(y("File_x0020_Type","String",c.photo.extensions,!1)));break;case f.video:c&&(j?e.push(y("File_x0020_Type","String",c.video.extensions,!0)):d.push(y("File_x0020_Type","String",c.video.extensions,!1)));break;case f.audio:c&&(j?e.push(y("File_x0020_Type","String",c.audio.extensions,!0)):d.push(y("File_x0020_Type","String",c.audio.extensions,!1)));break;case f.folder:i+=j?-1:1;break;case f.onenote:j?e.push(...t):d.push(...s);break;case f.published:j?e.push(...u):d.push(...v)}}else switch(b){case f.listItem:case f.file:return"";case f.photo:case f["!photo"]:c&&(b<0?e.push(y("File_x0020_Type","String",c.photo.extensions,!0)):d.push(y("File_x0020_Type","String",c.photo.extensions,!1)));break;case f.video:case f["!video"]:c&&(b<0?e.push(y("File_x0020_Type","String",c.video.extensions,!0)):d.push(y("File_x0020_Type","String",c.video.extensions,!1)));break;case f.audio:case f["!audio"]:c&&(b<0?e.push(y("File_x0020_Type","String",c.audio.extensions,!0)):d.push(y("File_x0020_Type","String",c.audio.extensions,!1)));break;case f.folder:case f["!folder"]:i+=b<0?-1:1;break;case f.onenote:case f["!onenote"]:b<0?e.push(...t):d.push(...s);break;case f.published:b<0?e.push(...u):d.push(...v)}return g.length>0&&d.push(y("File_x0020_Type","",g,!1)),h.length>0&&e.push(y("File_x0020_Type","",h,!0)),w([...i>0?q:[],x([w(d),...e,...i<0?r:[]])])}(n,{fileTypeIconMap:C})),b&&(E=`<Where>${b}</Where>`),function({viewParams:a,query:b,pageSize:c=30,includeFields:d,fieldNames:e=[],userIsAnonymous:f=!1,requestMetaInfo:g=!1,requestCommentFlags:i=!1}){if(d){if(e=["_ip_UnifiedCompliancePolicyUIAction","ItemChildCount","FolderChildCount","SMTotalFileCount","SMTotalSize",...e],g){let a=["MediaServiceFastMetadata","MediaServiceOCR"];h.B3.isFeatureEnabled({ODB:1208})&&a.push("MediaServiceTranscript"),e=[...a,...e]}i&&(e=["_CommentFlags",...e]),f||(e=["SharedWith",...e]),e=["DocIcon","LinkFilename","Modified","Editor","FileSizeDisplay",...e]}e=function(a){let b;if(a){let c;for(let d of(b=[],c={},a))c[d]||(c[d]=!0,b.push(d))}return b}(e);let j="";return e.length&&(j=`<ViewFields>${e.map(a=>`<FieldRef Name="${a}"/>`).join("")}</ViewFields>`),`<View ${a}><Query>${b}</Query>`+j+`<RowLimit Paged="TRUE">${c}</RowLimit>`+"</View>"}({viewParams:G,query:F+D+E,pageSize:i,includeFields:H,fieldNames:o,userIsAnonymous:z,requestMetaInfo:A,requestCommentFlags:B})}let q=n?[x(['<Eq><FieldRef Name="FSObjType" /><Value Type="Text">1</Value></Eq>','<Eq><FieldRef Name="SortBehavior" /><Value Type="Text">1</Value></Eq>']),'<Eq><FieldRef Name="ProgId" /><Value Type="Text">AddToOneDrive.MountPoint</Value></Eq>','<Eq><FieldRef Name="ProgId" /><Value Type="Text">SharePoint.DocumentSet</Value></Eq>']:[x(['<Eq><FieldRef Name="FSObjType" /><Value Type="Text">1</Value></Eq>','<Eq><FieldRef Name="SortBehavior" /><Value Type="Text">1</Value></Eq>']),'<Eq><FieldRef Name="ProgId" /><Value Type="Text">AddToOneDrive.MountPoint</Value></Eq>'],r=n?['<Neq><FieldRef Name="FSObjType" /><Value Type="Text">1</Value></Neq>','<Neq><FieldRef Name="ProgId" /><Value Type="Text">AddToOneDrive.MountPoint</Value></Neq>','<Neq><FieldRef Name="ProgId" /><Value Type="Text">SharePoint.DocumentSet</Value></Neq>']:['<Neq><FieldRef Name="FSObjType" /><Value Type="Text">1</Value></Neq>','<Neq><FieldRef Name="ProgId" /><Value Type="Text">AddToOneDrive.MountPoint</Value></Neq>'],s=['<Eq><FieldRef Name="ProgId" /><Value Type="Text">OneNote.Notebook</Value></Eq>'],t=['<Neq><FieldRef Name="ProgId" /><Value Type="Text">OneNote.Notebook</Value></Neq>'],u=['<IsNull><FieldRef Name="vti_CAAE_LastPublishedVersion" /></IsNull>','<BeginsWith><FieldRef Name="vti_CAAE_LastPublishedVersion" /><Value Type="Text">0</Value></BeginsWith>'],v=['<IsNotNull><FieldRef Name="vti_CAAE_LastPublishedVersion" /></IsNotNull>',...["1","2","3","4","5","6","7","8","9"].map(a=>`<BeginsWith><FieldRef Name="vti_CAAE_LastPublishedVersion" /><Value Type="Text">${a}</Value></BeginsWith>`)];function w(a){return a.reduce((a,b)=>a&&b?`<Or>${a}${b}</Or>`:b||a,"")}function x(a){return a.reduce((a,b)=>a&&b?`<And>${a}${b}</And>`:b||a,"")}function y(a,b,c,d){if(!c||0===c.length)return"";let e=`<FieldRef Name="${a}" />`,f=b?c.map(a=>`<Value Type="${b}">${a}</Value>`):c;return`${1===f.length?`${d?"<Neq>":"<Eq>"}${e}${f[0]}${d?"</Neq>":"</Eq>"}`:`<In>${e}<Values>${f.join("")}</Values></In>`}`}}
,(a,b,c)=>{c.d(b,{a:()=>e});var d=c(39);function e(a){return(0,d.c)(a,window._spPageContextInfo)}}
,(a,b,c)=>{c.d(b,{a:()=>d});function d(a){let b=a.split("!")[1];if(b)if(b.startsWith("s"))return{itemUniqueId:b.substring(1)};else return{itemId:b};return{}}}
,(a,b,c)=>{c.d(b,{a:()=>d});class d{static encodeURIComponent(a,b,c,d){let e="",f=0;if(!a)return"";let g=a.length;for(f=0;f<g;f++){let g=a.charCodeAt(f),h=a.charAt(f);if(b&&("#"===h||"?"===h)){e+=a.substr(f);break}if(c&&"&"===h){e+=h;continue}g<=127?d||g>=97&&g<=122||g>=65&&g<=90||g>=48&&g<=57||b&&g>=32&&g<=95&&0>" \"%<>'&".indexOf(h)?e+=h:g<=15?e+="%0"+g.toString(16).toUpperCase():g<=127&&(e+="%"+g.toString(16).toUpperCase()):g<=2047?(e+="%"+(192|g>>6).toString(16).toUpperCase(),e+="%"+(128|63&g).toString(16).toUpperCase()):(64512&g)!=55296?(e+="%"+(224|g>>12).toString(16).toUpperCase(),e+="%"+(128|(4032&g)>>6).toString(16).toUpperCase(),e+="%"+(128|63&g).toString(16).toUpperCase()):f<a.length-1&&(g=(1023&g)<<10,f++,g|=1023&a.charCodeAt(f),g+=65536,e+="%"+(240|g>>18).toString(16).toUpperCase(),e+="%"+(128|(258048&g)>>12).toString(16).toUpperCase(),e+="%"+(128|(4032&g)>>6).toString(16).toUpperCase(),e+="%"+(128|63&g).toString(16).toUpperCase())}return e}static escapeUrlForCallback(a){let b=a.indexOf("#"),c=a.indexOf("?");if(b>0&&(-1===c||b<c)){let d=a.substr(0,b);c>0&&(d+=a.substr(c)),a=d}return d.encodeURIComponent(a,!0,!1,!0)}static encodeRestUriStringToken(a,b){return a&&(a=(a=a.replace(/'/g,"''")).replace(/%27/g,"%27%27"),b||(a=d.encodeURIComponent(a))),a}}}
,,,(a,b,c)=>{c.d(b,{a:()=>d});let d=()=>{try{return!!window.sessionStorage.getItem("_isRunningTABTest")}catch(a){return console.log("No session storage accessible: "+a),!1}}}
,,,,(a,b,c)=>{c.d(b,{a:()=>f,b:()=>e});var d=c(6);function e(a){let b=new d.a(a);return`${b.authority}${b.segments.map(a=>encodeURIComponent(a)).join("/")}`}function f(a){let b=new d.a(a);return`${b.authority}${b.segments.map(a=>decodeURIComponent(a)).join("/")}`}}
,(a,b,c)=>{c.d(b,{a:()=>g,b:()=>f,c:()=>e});let d="CheckedOutUserId";function e(a){return!!a.properties[d]}function f(a,b){let c=Number(b);return!isNaN(c)&&Number(a.properties[d])===c}function g(a,b){return e(a)&&!f(a,b)}}
,(a,b,c)=>{c.d(b,{a:()=>f});var d=c(42);class e{get endpoint(){return this._getEndpoint()}get driveId(){return this._getDriveId()}get itemId(){return this._getItemId()}_getEndpoint(){let a,b=`${this._url}/`.indexOf("/drives/"),c=`${this._url}/`.indexOf("/drive/"),d=`${this._url}/`.indexOf("/me/");return b>-1?a=this._url.substring(0,b):d>-1&&c>-1&&c>d?a=this._url.substring(0,d):c>-1&&(a=this._url.substring(0,c)),a&&0===a.indexOf("https:")&&(a=a.replace(":443/","/")),this._getEndpoint=()=>a,a}_getDriveId(){let a,b=this._getIndexOfDrivesSegment(),c=this._getIndexOfDriveSegment();return b>-1?a=this._getPathSegments()[b+1]:c>-1&&"me"===this._getPathSegments()[c-1]&&(a="me"),this._getDriveId=()=>a,a}_getItemId(){let a,b=this._getIndexOfItemsSegment();if(b>-1){let c=(a=this._getPathSegments()[b+1])?a.indexOf("?"):-1;-1!==c&&(a=a.substring(0,c))}else{let b=this._getIndexOfDrivesSegment(),c=this._getIndexOfDriveSegment(),d=this._getPathSegments();b>-1?"root"===d[b+2]&&(a="root"):c>-1&&"root"===d[c+1]&&(a="root")}return this._getItemId=()=>a,a}_getPathSegments(){let a,b=this._url;return a=b?new d.a(b).segments:[],this._getPathSegments=()=>a,a}_getIndexOfDriveSegment(){let a=this._getPathSegments().indexOf("drive");return this._getIndexOfDriveSegment=()=>a,a}_getIndexOfDrivesSegment(){let a=this._getPathSegments().indexOf("drives");return this._getIndexOfDrivesSegment=()=>a,a}_getIndexOfItemsSegment(){let a=this._getPathSegments().indexOf("items");return this._getIndexOfItemsSegment=()=>a,a}constructor(a){this._url=a}}function f(a){return new e(a)}}
,(a,b,c)=>{c.d(b,{a:()=>h,b:()=>i});let d=["ai","pdf"],e=["doc","docx","odt","rtf","ods","xls","xlsm","xlsx","odp","ppt","pptx","pps","ppsx","tiff","tif","epub","htm","html","eml","msg","md","markdown"],f=["dwg","dxf"];function g(a,b){return!!b&&a.indexOf(("."===b[0]?b.slice(1):b).toLowerCase())>=0}function h(a,b){return g(e,a)||!!b&&g(f,a)}function i(a){return g(d,a)}}
,(a,b,c)=>{c.d(b,{a:()=>g,b:()=>h});let d=["glb","gltf"],e=["cool","fbx","obj","ply","stl","3mf"];function f(a,b){return!!b&&a.indexOf(("."===b[0]?b.slice(1):b).toLowerCase())>=0}function g(a){return f(e,a)}function h(a){return f(d,a)}}
,(a,b,c)=>{c.d(b,{a:()=>d});function d(a,b){let c=b?{High:0x7fffffff,Low:0x7fffffff}:{High:0,Low:0},d=a&&a.match(/^(0x)?([0-9a-f]*)$/i);if(d){let b,e;(a=(a=d[2]||"0").slice(-16)).length<=8?(b=0,e=parseInt(a,16)):(b=parseInt(a.slice(0,-8),16),e=parseInt(a.slice(-8),16)),isNaN(b)||isNaN(e)||(c.High=b,c.Low=e)}return c}}
,(a,b,c)=>{var d,e;c.d(b,{a:()=>f}),(e=d||(d={}))[e.Public=0]="Public",e[e.PublicUnlisted=2]="PublicUnlisted",e[e.Shared=3]="Shared",e[e.Private=4]="Private",e[e.Unknown=5]="Unknown";let f=d}
,(a,b,c)=>{c.d(b,{a:()=>m,b:()=>n,c:()=>k,d:()=>j,e:()=>l,f:()=>i});let d="ms-word",e="onenote|UsePlain",f="ms-powerpoint",g="ms-excel",h="ms-visio",i=d,j=f,k=g,l=h,m={"ms-access":["accdb"],"ms-word":["doc","docm","docx","dot","dotm","dotx","odt"],"ms-project":["mpp"],"onenote|UsePlain":["one","onepkg","onetoc2","notebook","oneNote"],"ms-powerpoint":["odp","pot","potm","potx","ppa","ppam","pps","ppsm","ppsx","ppt","pptm","pptx"],"ms-publisher":["pub"],"ms-excel":["csv","ods","xla","xlam","xll","xls","xlsb","xlsm","xlsx","xlt","xltm","xltx"],"ms-visio":["vdw","vsd","vsdm","vsdx","vsl","vss","vssm","vssx","vst","vstm","vstx"]},n={accdb:"ms-access",csv:g,doc:d,docm:d,docx:d,dot:d,dotm:d,dotx:d,odp:f,ods:g,odt:d,one:e,onepkg:e,onetoc2:e,mpp:"ms-project",notebook:e,pot:f,potm:f,potx:f,ppa:f,ppam:f,pps:f,ppsm:f,ppsx:f,ppt:f,pptm:f,pptx:f,pub:"ms-publisher",vdw:h,vsd:h,vsdm:h,vsdx:h,vsl:h,vss:h,vssm:h,vssx:h,vst:h,vstm:h,vstx:h,xla:g,xlam:g,xll:g,xls:g,xlsb:g,xlsm:g,xlsx:g,xlt:g,xltm:g,xltx:g}}
,(a,b,c)=>{c.d(b,{a:()=>g,b:()=>h,c:()=>i,d:()=>j,e:()=>k});var d=c(542),e=c(279);let f=new WeakMap;class g{apply(){}constructor(){this.isDelete=!0}}class h{constructor(){this.isPatch=!0}}function i(a,b){return(function(a={}){let{freeze:b=!1}=a,c=new Map,i=new Map;function l(a){return c.set(a,!0),a}return function(a){let m=a(function a(m,n){let o=c.get(m)?m:void 0;if(n){if(i.get(n))throw Error("Encountered a circular reference in patch supplied to graft().");for(let p of(i.set(n,!0),Object.keys(n))){let i=m[p],q=n[p];if(!(0,e.a)(q,i)){let n;if(q&&j(q)?n=q:q&&k(q)?n=q.apply(i,{graft:a,unlock:l}):q&&"object"==typeof q&&Object.getPrototypeOf(q)!==Object.prototype?n=q:q&&"object"==typeof q&&i&&"object"==typeof i?n=a(i,q):"object"==typeof q&&q&&function a(b,c){let{ancestors:d}=c;if(d.get(b))throw Error("Encountered circular reference in patch supplied to graft().");let e=f.get(b);if(void 0!==e)return e;d.set(b,!0);let i=!1;for(let d in b)if(Object.prototype.hasOwnProperty.call(b,d)){let e=b[d];if(e&&e instanceof g||e&&e instanceof h||e&&"object"==typeof e&&Object.getPrototypeOf(e)===Object.prototype&&a(e,c)){i=!0;break}}return d.delete(b),f.set(b,i),i}(q,{ancestors:new Map})?(n=a(l({}),q),b&&n&&"object"==typeof n&&!c.get(n)&&(0,d.a)(n)):n=q,!(0,e.a)(n,i)||!(p in m)){if(!o)for(let a of(o=l({}),Object.keys(m)))o[a]=m[a];j(n)?delete o[p]:o[p]=n}}}i.delete(n)}let p=o||m;return p&&f.set(p,!1),p},{unlock:l});return b&&c.forEach((a,b)=>{(0,d.a)(b)}),m}})()(c=>c(a,b))}function j(a){return a instanceof g}function k(a){return a instanceof h}}
,(a,b,c)=>{c.d(b,{a:()=>d});function d(a,b){return a===b?0!==a||1/a==1/b:a!=a&&b!=b}}
,,,,,(a,b,c)=>{let d;c.d(b,{a:()=>s});var e=c("fui.util_178"),f=c("odsp.util_126"),g=c(0);class h{gatherNetworkNotificationAccuracyTelemetry(a,b){let c=new g.a({name:"offlineDetection.networkNotificationAccuracy"});this._logger?.log(`ID: ${this._transitionId}, Event: ${a}, Current: ${this._logger.offlineToString(!b)}, New: ${this._logger.offlineToString(b)}`),fetch(this._telemetryUrl,{cache:"no-store"}).then(d=>{let e;e=this._statusAndTypeCheckKS||0!==d.status||"error"!==d.type?!b:b,this._reportReliability(a,b,e,c)}).catch(()=>this._reportReliability(a,b,b,c))}sendNetworkTransitionTelemetry(a,b,c){new g.a({name:"offlineDetection.networkTransition"}).end({extraData:{eventName:a,transitionToOffline:b},resultType:g.b.Success}),c&&this.gatherNetworkNotificationAccuracyTelemetry(a,b)}_reportReliability(a,b,c,d){this._logger?.log(`ID: ${this._transitionId}, Event: ${a}, Reliability: ${c?"success":"failure"}`),this._transitionId<1e3?this._transitionId++:this._transitionId=0,d.end({extraData:{eventName:a,offline:b},resultType:c?g.b.Success:g.b.Failure})}constructor(a){this._telemetryEndpoint="/_layouts/15/images/BLANK.gif",this._statusAndTypeCheckKS=f.Ov.isActivated("828f5168-1dc2-4aa0-8e72-51441433d0b6","7/24/2024"),this._transitionId=0,this._telemetryUrl=window.location.origin+this._telemetryEndpoint,this._logger=a}}class i{log(a){this._logFn&&this._logFn(a)}offlineToString(a){return void 0===a?"undefined":a?"offline":"online"}constructor(){this._nucleusLogToConsoleFlag="sharepoint.datasync.nucleus.logToConsole";try{const a=window.localStorage?.getItem(this._nucleusLogToConsoleFlag);a&&"TRUE"===a.toUpperCase()&&(this._logFn=a=>{let b=new Date().toISOString(),c=`[offline detector][${b}] ${a}`;console.log(c)})}catch{}}}let j="nucleusoffline",k="nucleusonline";class l{onChange(a){return this._ensureInitialized(),this._listeners.push(a),()=>{let b=this._listeners.indexOf(a);-1!==b&&this._listeners.splice(b,1)}}dispose(){this._logger?.log("Offline detector disposing"),this._events&&this._events.dispose()}get offline(){return this._useNucleusNetworkNotifications()?void 0!==this._offline?this._offline:this._swOffline():this._browserOffline||this._swOffline()&&!this._ignoreSWOffline}_createNucleusDebouncer(){return new m(l.NucleusDebounceDelay)}_createBrowserDebouncer(){return new m(!this._longBrowserDebounceDelayKS?l.BrowserDebounceDelay2:!this._differentDebounceDelayForBrowserKS?l.BrowserDebounceDelay:l.NucleusDebounceDelay)}_ensureInitialized(){!this._initialized&&(this._logger&&this._logger.log(`Offline detector initializing. Initial state: ${this._logger.offlineToString(this.offline)}`),this._initialized=!0,this._listeners=[],this._events=new e.NR(window),this._events.on(window,"online",this._browserDebouncer.debounce(this._onStateChange.bind(this,!1,"online"),!1)),this._events.on(window,"offline",this._browserDebouncer.debounce(this._onStateChange.bind(this,!0,"offline"),!0)),this._events.on(window,"swonline",this._onStateChange.bind(this,!1,"swonline")),this._events.on(window,"swoffline",this._onStateChange.bind(this,!0,"swoffline")),this._useNucleusNetworkNotifications()&&(this._events.on(window,k,this._nucleusDebouncer.debounce(this._onStateChange.bind(this,!1,k),!1)),this._events.on(window,j,this._nucleusDebouncer.debounce(this._onStateChange.bind(this,!0,j),!0))))}_onStateChange(a,b){if(this._useNucleusNetworkNotifications())if(this._offline!==a)this._reliabilityTelemetryLoggingKS&&this._logger&&this._logger.log(`Event: ${b}, Current: ${this._logger.offlineToString(this._offline)}, New: ${this._logger.offlineToString(a)}`),this._telemetry?.sendNetworkTransitionTelemetry(b,a,!0),this._offline=a;else{this._logger&&this._logger.log(`Event: ${b}, offline state unchanged: ${this._logger.offlineToString(this._offline)}`);return}else{let c=this.offline;this._swOffline()&&"online"===b&&(this._ignoreSWOffline=!0),"online"===b?this._browserOffline=!1:"offline"===b&&(this._browserOffline=!0),this._telemetry&&c!==this.offline&&this._telemetry.sendNetworkTransitionTelemetry(b,a,!0)}let c=this.offline;this._listeners&&this._listeners.forEach(a=>{try{a(c)}catch(a){}})}_swOffline(){return!!window.__swstats&&void 0!==window.__swstats.offline&&window.__swstats.offline}_useNucleusNetworkNotifications(){return f.lU.isFeatureEnabled({ODB:1235})}constructor(a){this._reliabilityTelemetryLoggingKS=f.Ov.isActivated("113f8f8f-700a-4c7c-9de7-9da1d7941868","8/13/2024"),this._enableDiagnosticsParamKS=f.Ov.isActivated("9d87a3bf-4d22-4fbf-a877-d131429d0d91","8/15/2024"),this._differentDebounceDelayForBrowserKS=f.Ov.isActivated("987bf2d5-399e-47fd-b101-eab6ed615ab0","8/28/2024"),this._longBrowserDebounceDelayKS=f.Ov.isActivated("93bfb463-5396-4022-ba60-81d11fad3ecf","9/10/2024"),this._initialized=!1,this._ignoreSWOffline=!1,this._offline=void 0,this._browserOffline=!1,(this._enableDiagnosticsParamKS||a)&&(this._logger=new i,this._telemetry=new h(!this._reliabilityTelemetryLoggingKS?this._logger:void 0)),this._nucleusDebouncer=this._createNucleusDebouncer(),this._browserDebouncer=this._createBrowserDebouncer()}}l.NucleusDebounceDelay=5e3,l.BrowserDebounceDelay=7e3,l.BrowserDebounceDelay2=15e3;class m{debounce(a,b){return 0===this._millisecondDelay?a:()=>{b!==this._lastOfflineNotification&&(clearTimeout(this._timer),this._lastOfflineNotification=b,this._timer=setTimeout(()=>{this._lastOfflineNotification=void 0,a()},this._millisecondDelay))}}constructor(a){this._millisecondDelay=a}}class n{startDebouncing(a){return new Promise(b=>{this._resolveDebouncePromise=b,this._resetDebounce(a)})}debounceNewNotification(a){a!==this._lastOfflineNotification&&this._resetDebounce(a)}dispose(){clearTimeout(this._timer),this._lastOfflineNotification=void 0}_resetDebounce(a){clearTimeout(this._timer),this._lastOfflineNotification=a,this._timer=setTimeout(()=>{let a=this._lastOfflineNotification;this._lastOfflineNotification=void 0,this._resolveDebouncePromise(a)},this._millisecondDelay)}constructor(){this._millisecondDelay=5e3}}class o{validateNotificationWithPing(a){return fetch(this._pingUrl,{cache:"no-store"}).then(b=>0===b.status&&"error"===b.type?a:!a).catch(()=>a)}attemptToReconnect(){return new Promise(a=>{this._logger.log("Starting to retry pings to see if we reconnected");let b=0,c=()=>{b<o.retryIntervals.length?(this._logger.log(`Retry attempt ${b} in ${o.retryIntervals[b]}ms`),this._retryTimer=setTimeout(()=>{this._logger.log(`Retry attempt ${b}. Pinging the network`),this.validateNotificationWithPing(!1).then(d=>{this._retryTimer=void 0,d?(this._logger.log(`Retry attempt ${b} successful. We're online`),a(!0)):(this._logger.log(`Retry attempt ${b} failed.`),b++,c())})},o.retryIntervals[b])):(this._logger.log(`Retries failed after ${b} attempts. We're still offline`),this._retryTimer=void 0,a(!1))};c()})}stopTryingToReconnect(){this._retryTimer&&(this._logger.log("Stopping retry pings"),clearTimeout(this._retryTimer),this._retryTimer=void 0)}dispose(){this.stopTryingToReconnect()}constructor(a){this._pingUrl=window.location.origin+o._pingEndpoint,this._logger=a}}o.retryIntervals=[7500,15e3,3e4],o._pingEndpoint="/_layouts/15/images/BLANK.gif";class p{onChange(a){return this._listeners.push(a),()=>{let b=this._listeners.indexOf(a);-1!==b&&this._listeners.splice(b,1)}}dispose(){this._logger.log("Offline detector disposing"),this._listeners=[],this._events.dispose(),this._currentDebouncer&&(this._currentDebouncer.dispose(),this._currentDebouncer=void 0),this._pinger.dispose(),this._pinger=void 0}get offline(){return this._offline}_initializeNotificationListeners(){this._listeners=[],this._events=new e.NR(window),this._events.on(window,"swonline",this._onNotification.bind(this,!1,"swonline")),this._events.on(window,"swoffline",this._onNotification.bind(this,!0,"swoffline")),this._events.on(window,"online",this._onNotification.bind(this,!1,"online")),this._events.on(window,"offline",this._onNotification.bind(this,!0,"offline")),this._events.on(window,"nucleusonline",this._onNotification.bind(this,!1,"nucleusonline")),this._events.on(window,"nucleusoffline",this._onNotification.bind(this,!0,"nucleusoffline")),this._pageResumeNotificationKS||this._events.on(window,"resume",this._onPageResume.bind(this),{capture:!0})}_onNotification(a,b){!this._verifySwNotificationsKS||this._notificationRequiresDebounce(b)?this._handleDebouncing(a,b)?.then(a=>{this._offline!==a&&(this._logger.log(`Validating ${b} notification with ping`),this._pinger.validateNotificationWithPing(a).then(c=>{c?(this._logger.log(`Ping matched ${b} notification`),this._handleStateChange(a,b)):this._logger.log(`Ping did not match ${b} notification. Dropping notification`)}))}):this._handleStateChange(a,b)}_notificationRequiresDebounce(a){switch(a){case"swonline":case"swoffline":return!1;default:return!0}}_handleDebouncing(a,b){if(!this._notificationRequiresDebounce(b))return Promise.resolve(a);if(this._currentDebouncer)this._currentDebouncer.debounceNewNotification(a);else if(this._offline!==a)return this._currentDebouncer=new n,this._currentDebouncer.startDebouncing(a).then(a=>(this._currentDebouncer=void 0,a)).catch(()=>(this._currentDebouncer=void 0,!1))}_onStateChange(a,b){this._telemetry.sendNetworkTransitionTelemetry(b,a),this._logger.log(`Event: ${b}, Current: ${this._logger.offlineToString(this._offline)}, New: ${this._logger.offlineToString(a)}`),this._offline=a;let c=this.offline;this._listeners.forEach(a=>{try{a(c)}catch(a){}})}_handleStateChange(a,b){this._offline!==a?(this._onStateChange(a,b),a?this._pinger.attemptToReconnect().then(a=>{a&&this._onStateChange(!1,"pingRetry")}):this._pinger.stopTryingToReconnect()):this._logger.log(`Event: ${b}, offline state unchanged: ${this._logger.offlineToString(this._offline)}`)}_onPageResume(){let a=!this.offline;this._logger.log(`Page resumed. Check if the page is ${this._logger.offlineToString(a)}`),this._pinger.validateNotificationWithPing(a).then(b=>{b?(this._logger.log("Offline state changed while the page was frozen"),this._handleStateChange(a,"resume")):this._logger.log("Offline state did not change while the page was frozen")})}constructor(){this._pageResumeNotificationKS=f.Ov.isActivated("76aced53-5aed-40a2-9a9d-1d65e0c57d3e","11/11/24"),this._startOfflineRetryKS=f.Ov.isActivated("3a2c2405-a47a-4015-bb2b-544055311c2c","11/13/24"),this._validateStartStateKS=f.Ov.isActivated("b0cd0220-0be4-47b2-8b7d-9cac9d1d2321","12/13/24"),this._verifySwNotificationsKS=f.Ov.isActivated("3a6d44e7-5bf5-4d40-818b-9e206d158087","12/17/24"),this._offline=window.__swstats?.offline??!1,this._logger=new i,this._telemetry=new h(this._logger),this._pinger=new o(this._logger),this._initializeNotificationListeners(),this._logger.log(`Offline detector initialized. Initial state: ${this._logger.offlineToString(this.offline)}`),this._validateStartStateKS&&(this._startOfflineRetryKS||!this._offline)||(this._logger.log(`Validating initial ${this._logger.offlineToString(this._offline)} state with a ping`),this._pinger.validateNotificationWithPing(!this._offline).then(a=>{a?this._handleStateChange(!this._offline,"initialPing"):this._logger.log(`Initial state was correct. We are ${this._logger.offlineToString(this._offline)}`)}))}}let q=f.lU.isFeatureEnabled({ODB:62167}),r=f.Ov.isActivated("fc7b922a-f61d-498c-ae7b-9ad1f1a1e3de");function s(a){return r&&!q?new l(a):(d||(d=q?new p:new l(!0)),d)}}
,(a,b,c)=>{var d,e;c.d(b,{a:()=>d}),(e=d||(d={}))[e.anonymous=1]="anonymous",e[e.msa=2]="msa",e[e.aad=3]="aad"}
,(a,b,c)=>{c.d(b,{a:()=>g});var d=c(105),e=c(63),f=c(103);class g{abort(a){this._abortRequest()&&!a&&this._callFailureCallback(this._request,-3,!1)}start(a,b){this._successCallback=a,this._failureCallback=b;let{_method:c,_headers:d}=this;try{this._request=this._getRequest();let{_progressCallback:a,_uploadProgressCallback:b,_request:f,_responseType:g}=this;for(let h in a&&(f.onprogress=b=>{try{a(b)}catch(a){e.a.logError(a)}}),b&&(f.upload.onprogress=a=>{try{b(a)}catch(a){e.a.logError(a)}}),this._async.setTimeout(()=>{this._completed||this._timeoutCallback()},this._requestTimeoutInMS),f.onreadystatechange=()=>{if(!this._completed){let a=4;try{a=f.DONE||4}catch(a){}f.readyState===a&&this._requestEndCallback()}},f.open(c,this._url,!0),"withCredentials"in f&&(f.withCredentials=this._withCredentials),f.responseType=g,d)f.setRequestHeader(h,d[h]);f.send(this._postData)}catch(a){e.a.logError(a,{origin:location?location.origin:"unknown",withCredentials:this._withCredentials,requestUrl:this._url,headers:(0,f.a)(d),method:c}),this._abortRequest(),this._callFailureCallback(this._request,-1,!1)}}_getRequest(){if(!this._needsCors||!window.XDomainRequest)return new XMLHttpRequest;let a=new XDomainRequest;return a.setRequestHeader=()=>{},a.onprogress=()=>{},a.ontimeout=()=>{},a.onload=()=>{this._requestEndCallback()},a}_abortRequest(){let a=!1;if(!this._completed){this._completed=!0,this._async.dispose();try{this._request&&this._request.abort()}catch(a){}a=!0}return a}_timeoutCallback(){this._completed||(this._abortRequest(),this._callFailureCallback(this._request,-2,!0))}_callSuccessCallback(a,b){try{this._successCallback&&this._successCallback(a,b)}catch(a){e.a.log(a)}}_callFailureCallback(a,b,c){try{this._failureCallback&&this._failureCallback(a,b,c)}catch(a){e.a.log(a)}}_requestEndCallback(){if(!this._completed){this._completed=!0;let a=-1;try{this._async.dispose();try{a=this._request.status}catch(a){}}catch(b){a=-1,e.a.log(b)}a<400&&a>0?this._callSuccessCallback(this._request,a):this._callFailureCallback(this._request,a,!1)}}constructor(a){this._async=new d.a(this);const{url:b,requestTimeoutInMS:c=g.DEFAULT_TIMEOUT_MS,json:e,responseType:f="",headers:h={},withCredentials:i=!1,needsCors:j=!1,onProgress:k,onUploadProgress:l}=a,{method:m=e?"POST":"GET"}=a;this._url=b,this._requestTimeoutInMS=c,this._postData=e,this._headers=h,this._method=m,this._withCredentials=i,this._needsCors=j,this._responseType=f,this._progressCallback=k,this._uploadProgressCallback=l}}g.DEFAULT_TIMEOUT_MS=3e4}
,(a,b,c)=>{c.d(b,{a:()=>d});function d(a,...b){return b.reduce((a,b)=>({...a,...b,...a.extraMetrics||b.extraMetrics?{extraMetrics:{...a.extraMetrics||{},...b.extraMetrics||{}}}:{},...a.extraData||b.extraData?{extraData:{...a.extraData||{},...b.extraData||{}}}:{}}),a)}}
,,,(a,b,c)=>{c.d(b,{a:()=>j,b:()=>h});var d=c("odsp.util_126"),e=c(166),f=c(167),g=c(291);let h=d.Ov.isActivated("79c1df67-19f8-4729-b45e-cbdfa58d1041","07/27/2021","Add cTag for item url to update the cache for the item content"),i=d.Ov.isActivated("5c26aaea-7b53-4bb1-84af-2d863044bda1","02/06/2025","Drive access code for mediaTA");class j{getCommonAuthData(){return this._authData}getCommonProperty(a){return this._properties[a]}parseCommonData(a){return(0,g.d)(this._properties,a.data,this._env),this._authData=this._getCurrentAuthData(a.allowCookies&&this._allowCookies),{authData:this._authData,mediaUrl:this._properties[e.a.mediaBaseUrl]}}getUniqueKey(){let a=this._properties[e.a.driveUrl]||this._properties[e.a.driveUrlV21],b=this._userID;return b&&a?`${b}-${a}`:""}generateUrl(a,b,c,d){let f=this.getNormalUrl(a,b,c)||this.getFallbackUrl(a,b,c),g=b[e.a.cTag];return!h&&g&&f&&f.indexOf("?")>-1&&(f+=`&cTag=${encodeURIComponent(g)}`),f&&d?.isMeTATempAuthDeprecationEnabled&&(f=f.replace(/&(?:access_|proof)token=[^&]*/g,"")),f}getAnalyzeUrl(a,b){return(0,g.c)({".analyzeUrl":`{.mediaBaseUrl}/analyze?provider=spo&profile=${a}&extension={.fileType}&docid={.spItemUrl}&{.driveAccessToken${d.lU.isFeatureEnabled(f.a)?"V21":""}}`,...this._properties},e.a.analyzeUrl,b)}getNormalUrl(a,b,c){return(0,g.c)(this._properties,a,b,c,this._isViewOnly,this._authData&&this._authData.supportsCookies)}getFallbackUrl(a,b,c){let d=b[a];if(d){for(let a of(d=d.replace("{.method}",c),e.c)){let c=b[a];if(a===e.a.mediaBaseUrl&&(c=(0,g.a)(c,this._env)),!c){if(a===e.a.correlationId){d=d.replace("&correlationId={.correlationId}","");continue}return}a===e.a.resourceUrl&&(c=encodeURIComponent(c)),d=d.replace(`{${a}}`,c)}return this._isViewOnly&&(d+="&nocache=true"),d}}_getCurrentAuthData(a){let b=k(this._properties[e.a.driveAccessToken]),c=k(this._properties[e.a.driveAccessTokenV21]),d=this._properties[e.a.driveAccessCode]||this._properties[e.a.driveAccessCodeV21];if((!c||!b)&&(i||!d))return;let f=new Date;return{authToken:b?.authToken,proofToken:b?.proofToken,tokenUrl:this._properties[e.a.driveUrl],driveAccessCode:this._properties[e.a.driveAccessCode],authTokenV21:c?.authToken,proofTokenV21:c?.proofToken,tokenUrlV21:this._properties[e.a.driveUrlV21],driveAccessCodeV21:this._properties[e.a.driveAccessCodeV21],timeReceived:f,expirationTime:new Date(f.getTime()+216e5),supportsCookies:a}}constructor(a,b){this._properties={},this._authData=void 0,this._allowCookies=!b.platformDetection.isSafari;const{env:c,userEmail:d,viewOnlyExperienceEnabled:e}=b.pageContext;this._env=c,this._isViewOnly=!!e,this._userID=d}}function k(a){if(!a)return;let b=(0,d.pW)(a);if(b&&b.access_token)return{authToken:b.access_token,proofToken:b.prooftoken}}}
,(a,b,c)=>{c.d(b,{a:()=>h,b:()=>i,c:()=>j,d:()=>k});var d=c("odsp.util_126"),e=c(166);let f=!d.Ov.isActivated("C878B277-2E63-4022-8B23-1CE6863F1A76"),g=!d.Ov.isActivated("8E019974-8DE2-4D0B-93C0-82EDC9A29F09");function h(a,b){if("https://media.cloudapp.net"===a)if("edog"===b)return"https://centralus1-mediad.svc.ms";else return"https://northcentralus1-medias.svc.ms";return a}function i(a,b){let c=a.toLowerCase();if(c.indexOf("access_token=")>-1||c.indexOf("tempauth=")>-1)return a;let d=-1===a.indexOf("?")?"?":"&";return`${a}${d}${b.indexOf("access_token")>-1?b:`access_token=${b}`}`}function j(a,b,c,d,h,i){let j,k={...a,..."string"==typeof d?{".method":d}:{},...b===e.a.zipUrl?{[e.a.fileType]:"zipfile"}:{},...c||{}},l=(j=k[b],f&&(b===e.a.thumbnailUrl||b===e.a.videoManifestUrl||b===e.a.transformUrl||g&&b===e.a.zipUrl)&&j&&j.includes("{.spItemUrl}")&&c?.[".spItemUrlLegacy"]?j.replace(/{.spItemUrl}/g,"{.spItemUrlLegacy}"):j);if(l)try{let a=function a(b,c,d,f){return b.replace(/{([^\}]*)}/g,(b,g)=>{if(g in d){let a=d[g];if(void 0!==a)return a;throw Error(` URI template contains recursion on variable ${g}`)}let h=c[g];if(void 0===h)throw Error(`URI template contains unknown variable ${g}`);if(g===e.a.itemUrl||g===e.a.itemUrlLegacy||g===e.a.resourceUrl){if(function(a,b){if(b)return!1;let c=a.indexOf("/",8);return a.substring(c).length>215}(h,f))throw Error(`URI template variable ${g} is too long: ${h}`);return d[g]=encodeURIComponent(h)}return d[g]=void 0,d[g]=a(h,c,d,f)})}(l,k,{[b]:void 0},!!i);return h?`${a}&nocache=true`:a}catch(a){return}}function k(a,b,c){for(let c of(a[e.a.zipUrl]=e.d,e.b))b[c]&&(a[c]=b[c]);a[e.a.mediaBaseUrl]=h(a[e.a.mediaBaseUrl],c),a[e.a.mediaBaseUrlSecondary]=h(a[e.a.mediaBaseUrlSecondary],c)}}
,,,,,,(a,b,c)=>{c.d(b,{a:()=>q,b:()=>g,c:()=>o,d:()=>k,e:()=>j,f:()=>n,g:()=>h,h:()=>p,i:()=>m,j:()=>f,k:()=>e,l:()=>i,m:()=>d});let d="v2.1",e="SiteAssets",f="Copilots",g="Approved",h="Copilot Studio Agents",i="/_api/siteiconmanager/getsitelogo",j=".copilot",k=".agent",l="Documents",m="Shared Documents",n=`${e}/${f}`,o=`${e}/${f}/${g}`,p=`${l}/${l}`,q=`${l}/${l}/Agents`}
,(a,b,c)=>{c.d(b,{a:()=>h,b:()=>f,c:()=>e,d:()=>g,e:()=>d});let d={ODB:62575},e={ODB:62711},f={ODB:-0x2b284c00},g={ODB:62756},h={ODB:-0x804f028}}
,,,,(a,b,c)=>{c.d(b,{a:()=>d});function d(a){let b=a.document;b.body||b.createElement("body");let c=b.createElement("form");c.action=a.url,c.method="POST",c.style.visibility="hidden",c.target="_self";let d=a.postdata;for(let a in d)if(d.hasOwnProperty(a)){let e=b.createElement("input");e.type="hidden",e.name=a,e.value=d[a],c.appendChild(e)}b.body.appendChild(c),c.submit()}}
,,(a,b,c)=>{c.d(b,{a:()=>f});var d=c("react-lib"),e=c(560);function f(a,b){let c=d.useRef();return(0,e.a)(c.current,b,{debug:!0})&&(c.current=b),d.useMemo(a,[c.current])}}
,(a,b,c)=>{c.d(b,{a:()=>e});var d=c("react-lib");function e(){let[,a]=d.useReducer(a=>a+1,0);return a}}
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,(a,b,c)=>{c.d(b,{a:()=>s});var d=c("react-lib"),e=c("fui.core_517"),f=c(609),g=c(3),h=c(185),i=c(70);let j=d.createElement(d.Fragment,null),k=[0,300,500],l=new Set([...Array.from(new Set(["componentRef","calloutProps","content","onRenderContent","delay","maxWidth","targetElement","directionalHint","directionalHintForRTL","theme","styles"])),"closeDelay","setAriaDescribedBy","onTooltipToggle","hostClassName","hostStyles"]),m=(0,g.a)({useStaticStyles:!0}),n=(0,g.a)({useStaticStyles:!0}),o=(0,g.a)({useStaticStyles:!0}),p=new Set(["calloutProps","className","closeDelay","componentRef","content","delay","directionalHint","directionalHintForRTL","hostClassName","id","onTooltipToggle","overflowMode","setAriaDescribedBy","styles","theme","tooltipProps"]);var q=c(187);let r=(0,e.n94)({root:{display:"inline"}}),s=a=>{let b,[c,g]=d.useState(),{hostClassName:s,children:t,...u}=function(a,b){let{id:c,content:f,tooltipProps:g,calloutProps:q,setAriaDescribedBy:r=!0,hostClassName:s="",directionalHint:t,closeDelay:u,children:v,styles:w,onTooltipToggle:x}=a;return function(a){let{content:b=j,className:c,hostClassName:f="",id:g,styles:h,hostStyles:p,calloutProps:q,delay:r,children:s,closeDelay:t,setAriaDescribedBy:u=!0,directionalHint:v,onTooltipToggle:w}=a,x=m(h),y=n(q?.styles),z=o(p),A=d.createElement("div",{className:(0,e.tlm)(c,x.root,x.content,y.calloutMain)},a?.onRenderContent?a.onRenderContent(a,a=>a?.content?d.createElement(d.Fragment,null,a.content):null)||j:b);return{content:(0,e.eqf)(A,{defaultProps:{role:"tooltip",id:g,className:y.beakCurtain},required:!0}),children:s,appearance:q?.styles?"normal":void 0,withArrow:!0,hostClassName:(0,e.tlm)(f,z.root),relationship:u?"description":"inaccessible",positioning:v?i.b[v]:"above",showDelay:r?k[r]:250,hideDelay:t||250,onVisibleChange:(a,b)=>w?.(b.visible),...(0,i.d)(a,l)}}({id:c,content:f,children:v,calloutProps:q,hostClassName:s,closeDelay:u,setAriaDescribedBy:r,directionalHint:t,hostStyles:w,targetElement:function(a,b){if(!b)return;let{overflowMode:c}=a;if(void 0!==c)switch(c){case h.a.Parent:return b.parentElement;case h.a.Self:}return b}(a,b),onTooltipToggle:x,...g,...(0,i.d)(a,p)})}(a,c),v=r(),w=(b=u.content.children.props.children)===j||null==b||""===b;return d.useEffect(()=>{if(!(0,q.u)()){let a=c?.getAttribute("aria-describedby"),b=c?.getAttribute("aria-labelledby"),d=c?.firstElementChild;d&&(a&&(c?.removeAttribute("aria-describedby"),d.setAttribute("aria-describedby",a)),b&&(c?.removeAttribute("aria-labelledby"),d.setAttribute("aria-labelledby",b)))}},[c,t]),w?d.createElement("div",{className:(0,e.tlm)("ms-TooltipHost ms-TooltipHostShim",s,v.root)},t):d.createElement(f.a,u,d.createElement("div",{className:(0,e.tlm)("ms-TooltipHost ms-TooltipHostShim",s,v.root),ref:g},t))};s.displayName="TooltipHostShim"}
,,,,,,,,,(a,b,c)=>{c.d(b,{a:()=>d});let d={...c("fui.core_517").u1A,vivaConnectionsSoftBackground:"var(--vivaConnectionsSoftBackground)",semanticPrimaryButtonText:"var(--semanticPrimaryButtonText)",semanticPrimaryButtonTextHovered:"var(--semanticPrimaryButtonTextHovered)",semanticPrimaryButtonBackgroundHovered:"var(--semanticPrimaryButtonBackgroundHovered)",semanticButtonBackgroundDisabled:"var(--semanticButtonBackgroundDisabled)",semanticPrimaryButtonBackgroundDisabled:"var(--semanticPrimaryButtonBackgroundDisabled)",semanticButtonTextDisabled:"var(--semanticButtonTextDisabled)",semanticDisabledBackground:"var(--semanticDisabledBackground)",semanticButtonTextHovered:"var(--semanticButtonTextHovered)",semanticButtonBackgroundHovered:"var(--semanticButtonBackgroundHovered)",semanticPrimaryButtonBackgroundPressed:"var(--semanticPrimaryButtonBackgroundPressed)",semanticPrimaryButtonTextPressed:"var(--semanticPrimaryButtonTextPressed)",semanticDisabledText:"var(--semanticDisabledText)",semanticActionLink:"var(--semanticActionLink)",semanticBodyText:"var(--semanticBodyText)",semanticDisabledBodyText:"var(--semanticDisabledBodyText)",semanticDisabledBodySubtext:"var(--semanticDisabledBodySubtext)",semanticInputBackground:"var(--semanticInputBackground)",semanticInputText:"var(--semanticInputText)",semanticPrimaryButtonTextDisabled:"var(--semanticPrimaryButtonTextDisabled)",semanticPrimaryButtonBackground:"var(--semanticPrimaryButtonBackground)",semanticButtonBackground:"var(--semanticButtonBackground)",semanticButtonBorder:"var(--semanticButtonBorder)",semanticButtonBackgroundPressed:"var(--semanticButtonBackgroundPressed)",semanticErrorText:"var(--semanticErrorText)"}}
,,(a,b,c)=>{c.d(b,{a:()=>e,b:()=>m});var d,e,f=c("react-lib"),g=c(160),h=c(533),i=c(83);function j(a){let[,b]=f.useState(0),c=f.useRef(a),d=(0,i.a)(a=>{let d="function"==typeof a?a(c.current):a;d!==c.current&&b(a=>a+1),c.current=d});return[c,d]}let k={0:a=>a,1:a=>18*a,2:a=>.5*window.innerHeight},l=navigator?.pointerEnabled||"PointerEvent"in window;function m(a){let{isEnabled:b=!0,mayStartPan:c=n,constrainScale:d=o,allowedModes:e=15,useNativePan:m=!1,ref:p}=a,[q,r]=j(h.a.IDENTITY),[s,t]=j(!1),u=f.useRef(0),v=f.useRef({}),w=f.useRef(0),[x,y]=j(h.a.IDENTITY),[z,A]=j(h.a.IDENTITY),[B,C]=j(),[D,E]=j(),[F,G]=j(0),H=f.useRef(),I=f.useRef(),J=f.useRef(),K=f.useRef(),[L,M]=f.useState({});f.useEffect(()=>{M(({...a})=>(l&&7&e?a.onPointerDown=ae:(a.onPointerDown=void 0,1&e?a.onTouchStart=_:a.onTouchStart=void 0,6&e?a.onMouseDown=W:a.onMouseDown=void 0),8&e?a.onWheel=U:a.onWheel=void 0,a.onContextMenu=N,a.onDragCapture=O,a))},[e]);let N=(0,i.a)(a=>{b&&(4&e)!=0&&(a.preventDefault(),a.stopPropagation())}),O=(0,i.a)(a=>{b&&(7&e)!=0&&(a.preventDefault(),a.stopPropagation())}),P=z.current,Q=f.useMemo(()=>{let a=H.current??g.a.ORIGIN;return new h.a(new g.a(P.translate.x/a.x,P.translate.y/a.y),P.scale)},[P]),R=f.useRef(Q);R.current=Q,f.useEffect(()=>{B.current||(y(q.current),A(h.a.IDENTITY))},[B.current,q.current]),f.useEffect(()=>{s.current&&r(Q.multiply(x.current))},[s.current,R.current]);let S=f.useRef(),T=(0,i.a)(()=>{S.current&&clearTimeout(S.current),S.current=setTimeout(()=>{S.current=void 0,8===F.current&&(G(0),ak(),t(!1))},300)}),U=(0,i.a)(a=>{b&&(a.preventDefault(),a.stopPropagation(),aq(),V(ar(a),k[a.deltaMode](a.deltaY)))}),V=(0,i.a)((a,b)=>{let c=Math.pow(2,-b/300);if(!B.current){G(8);let b=H.current??g.a.ORIGIN;am([a.add(b.scale(-.5)),a.add(b.scale(.5))])}let d=h.a.zoom(a.subtract(B.current??g.a.ORIGIN),a,c);8===F.current&&al((K.current??[]).map(a=>d.apply(a))),T()}),W=(0,i.a)(a=>{if(!b||0!==a.button)return;a.stopPropagation(),aq();let c=ar(a);G(4),a.ctrlKey&&(v.current[0]=(H.current??g.a.ORIGIN).subtract(c)),am(v.current[0]?[v.current[0],c]:[c]),M(({...a})=>(a.onMouseDown=void 0,a.onMouseDownCapture=W,a.onMouseUpCapture=Z,a.onClickCapture=Y,a.onMouseMoveCapture=X,a.onMouseLeave=$,a))}),X=(0,i.a)(a=>{a.preventDefault(),aq(!1);let b=ar(a);v.current[0]&&(v.current[0]=(H.current??g.a.ORIGIN).subtract(v.current[0]));let c=v.current[0]?[v.current[0],b]:[b];4===F.current&&al(c)}),Y=(0,i.a)(a=>{Date.now()-(J.current??0)<100&&a.stopPropagation()}),Z=(0,i.a)(a=>{0===a.button&&(s.current&&(J.current=Date.now(),a.preventDefault()),aq(!1),4===F.current&&(delete v.current[0],ak(),G(0)),t(!1),M(({...a})=>(a.onMouseDownCapture=void 0,a.onMouseUpCapture=void 0,a.onMouseMoveCapture=void 0,a.onMouseLeave=void 0,a.onMouseDown=W,a)))}),$=(0,i.a)(a=>{aq(!1),4===F.current&&(ak(),G(0)),t(!1),M(({...a})=>(a.onMouseDownCapture=void 0,a.onMouseUpCapture=void 0,a.onMouseMoveCapture=void 0,a.onMouseLeave=void 0,a.onMouseDown=W,a))}),_=(0,i.a)(a=>{if(!b)return;s.current&&(!m||a.touches.length>1)&&a.preventDefault(),aq(0===u.current);let c=u.current;u.current+=a.changedTouches.length,!c&&u.current?(G(1),M(({...a})=>(a.onTouchStart=void 0,a.onTouchStartCapture=_,a.onTouchMoveCapture=aa,a.onTouchEndCapture=ab,a.onTouchCancelCapture=ac,a))):1===F.current&&ak(),1===F.current&&am(ao(a.touches))}),aa=(0,i.a)(a=>{(!m||a.touches.length>1)&&a.preventDefault(),aq(!1),al(ao(a.touches))}),ab=(0,i.a)(a=>{s.current&&a.preventDefault(),aq(!1),ad(a)}),ac=(0,i.a)(a=>{aq(!1),ad(a)}),ad=(0,i.a)(a=>{let b=u.current;u.current-=a.changedTouches.length,1===F.current&&ak(),b&&!u.current?(1===F.current&&G(0),t(!1),M(({...a})=>(a.onTouchStartCapture=void 0,a.onTouchMoveCapture=void 0,a.onTouchEndCapture=void 0,a.onTouchCancelCapture=void 0,a.onTouchStart=_,a))):1===F.current&&am(ao(a.touches))}),ae=(0,i.a)(a=>{if(!b)return;let c=a.pointerType,d="mouse"===c?4:"pen"===c?2:1;if(!(e&d)||(a.stopPropagation(),v.current[a.pointerId]))return;let f=0===w.current;!s.current||m&&f||a.preventDefault(),aq(f),v.current[a.pointerId]=ar(a),w.current++,f?(a.ctrlKey&&(v.current[0]=(H.current??g.a.ORIGIN).subtract(v.current[a.pointerId])),G(d),M(({...a})=>(a.onPointerDown=void 0,a.onPointerDownCapture=ae,a.onPointerMoveCapture=af,a.onPointerUpCapture=ag,a.onPointerCancelCapture=ai,a.onLostPointerCaptureCapture=ai,a.onGotPointerCapture=ah,a))):as()&&ak(),as()&&am(ap())}),af=(0,i.a)(a=>{v.current[a.pointerId]&&((!m||w.current>1)&&a.preventDefault(),aq(!1),v.current[a.pointerId]=ar(a),v.current[0]&&(v.current[0]=(H.current??g.a.ORIGIN).subtract(v.current[a.pointerId])),as()&&al(ap()))}),ag=(0,i.a)(a=>{s.current&&a.preventDefault(),ai(a)}),ah=(0,i.a)(a=>{aq(!1)}),ai=(0,i.a)(a=>{aq(!1),aj(a)}),aj=(0,i.a)(a=>{v.current[a.pointerId]&&(delete v.current[a.pointerId],w.current--,as()&&ak(),0===w.current?(delete v.current[0],as()&&G(0),t(!1),M(({...a})=>(a.onPointerDownCapture=void 0,a.onPointerMoveCapture=void 0,a.onPointerUpCapture=void 0,a.onPointerCancelCapture=void 0,a.onLostPointerCaptureCapture=void 0,a.onPointerDown=ae,a.onGotPointerCapture=void 0,a))):as()&&am(ap()))}),ak=(0,i.a)(()=>{K.current=void 0,C(void 0)}),al=(0,i.a)(a=>{let b;K.current=a,B.current||am(a);let e=g.a.getCenter(a),f=an(a,e),i=D.current;b=0!==f&&"number"==typeof i&&0!==i?f/i:1;let j=x.current.scale*b,k=d({scale:j})/j,l=h.a.zoom(g.a.ORIGIN,B.current??g.a.ORIGIN,b*k);A(new h.a(e.subtract(B.current??g.a.ORIGIN)).multiply(l)),!s.current&&c({incrementTransformPx:P,radiusDeltaPx:f-(i??0),points:a})&&t(!0)}),am=(0,i.a)(a=>{K.current=a;let b=g.a.getCenter(a),c=an(a,b);C(b),E(c)}),an=(0,i.a)((a,b)=>{let c=0;for(let d of a)c+=d.distance(b);return c/a.length}),ao=(0,i.a)(a=>{let b=[];for(let c=0;c<a.length;c++)b.push(ar(a[c]));return b}),ap=(0,i.a)(()=>{let a=[];for(let b of Object.keys(v.current))a.push(v.current[b]);return a}),aq=(0,i.a)((a=!0)=>{if(p.current&&(!H.current||a)){let a=p.current.getBoundingClientRect();H.current=new g.a(a.width,a.height),I.current=new h.a(new g.a(-a.left,-a.top))}}),ar=(0,i.a)(a=>(I.current??h.a.IDENTITY).apply(new g.a(a.clientX,a.clientY))),as=(0,i.a)(()=>7&F.current);return{transformV:q.current,setTransformV:r,isActive:s.current,handlers:L}}function n({incrementTransformPx:a,radiusDeltaPx:b}){return a.translate.abs()>=10||Math.abs(b)>=10}function o({scale:a}){return a}(d=e||(e={}))[d.none=0]="none",d[d.touch=1]="touch",d[d.pen=2]="pen",d[d.mouse=4]="mouse",d[d.pointer=7]="pointer",d[d.wheel=8]="wheel",d[d.all=15]="all"}
,,(a,b,c)=>{c.d(b,{a:()=>u,b:()=>t});var d,e,f,g,h={};c.r(h),c.d(h,{docAlreadyExists:()=>m,fileNotFound:()=>j,invalidView:()=>k,listNotFound:()=>l,newExperieceRenderingNotSupported:()=>o,offline:()=>r,onePageNavigationError:()=>q,onePageNavigationViewMismatch:()=>p,parsingError:()=>s,queryThrottled:()=>n,urlTooLongError:()=>i.a});var i=c(241);let j=-0x7ff8fffe,k=-0x7ff8ffa9,l=-1,m=-0x7efdff99,n=-0x7ff8ffdc,o=-2,p=-3,q=-4,r=-5,s=-7;(d=f||(f={}))[d.icon=16]="icon",d[d.iconMin=16]="iconMin",d[d.bigIcon=48]="bigIcon",d[d.bigIconMin=48]="bigIconMin",d[d.regularMin=90]="regularMin",d[d.regular=130]="regular",d[d.nameMin=220]="nameMin",d[d.nameODC=440]="nameODC",d[d.nameODB=280]="nameODB",d[d.originalLocation=300]="originalLocation",d[d.custom=900]="custom",d[d.sharedWith=150]="sharedWith",d[d.note=250]="note",d[d.dateModifiedMl=150]="dateModifiedMl",d[d.dotDotDot=32]="dotDotDot",d[d.ratingsMin=110]="ratingsMin";let t={none:0,notify:1,block:2,notifyAndBlock:3,blockSharing:4};(e=g||(g={}))[e.Auto=0]="Auto",e[e.Pinned=1]="Pinned",e[e.Removed=2]="Removed";let u=h}
,(a,b,c)=>{c.d(b,{a:()=>d});function d(a){let{pathname:b,viewParamsString:c,clearPath:d}=a;return`${d?"/":b}${c.length>0?"?":""}${c}`}}
,,,,,,,,,,,,,,(a,b,c)=>{var d,e;c.d(b,{a:()=>d}),(e=d||(d={}))[e.Default=0]="Default",e[e.OnlyPeopleAdded=1]="OnlyPeopleAdded",e[e.Organization=8]="Organization",e[e.Anyone=16]="Anyone"}
,,,,,(a,b,c)=>{c.d(b,{a:()=>d});let d={sharepoint:0,microservice:1,consumerOnedrive:2}}
,(a,b,c)=>{c.d(b,{a:()=>X});var d,e,f,g,h,i,j=c("odsp.util_126");function k(a,b=!1){let c=new Date(a),d=0>c.getTimezoneOffset(),e=c.getFullYear()+"",f=(0,j.IV)(c.getMonth()+1+"",2),g=(0,j.IV)(c.getDate()+"",2),h=(0,j.IV)(c.getHours()+"",2),i=(0,j.IV)(c.getMinutes()+"",2),l=(0,j.IV)(c.getSeconds()+"",2),m=(0,j.IV)(d?(Math.ceil(c.getTimezoneOffset()/60)+"").replace("-",""):Math.floor(c.getTimezoneOffset()/60)+"",2),n=(d?"+":"-")+m+(0,j.IV)((c.getTimezoneOffset()%60).toString().replace("-",""),2);return b?e+"-"+f+"-"+g+"T"+h+":"+i+":"+l+n:e+f+g+"T"+h+i+l+n}var l=c(50),m=c(115),n=c(104),o=c(95);(d=g||(g={}))[d.unknown=1]="unknown",d[d.odb=2]="odb",d[d.sharePoint=3]="sharePoint",d[d.ngsc=4]="ngsc",d[d.word=5]="word",d[d.powerpoint=6]="powerpoint",d[d.excel=7]="excel",d[d.onenoteWeb=8]="onenoteWeb",d[d.wac=9]="wac",d[d.visio=10]="visio",d[d.officecom=11]="officecom",d[d.listPart=12]="listPart",d[d.outlookWeb=13]="outlookWeb",d[d.odIos=14]="odIos",d[d.odAndroid=15]="odAndroid",d[d.teams=16]="teams",d[d.sample=17]="sample",d[d.odc=18]="odc",d[d.wordAndroid=19]="wordAndroid",d[d.excelAndroid=20]="excelAndroid",d[d.powerpointAndroid=21]="powerpointAndroid",d[d.wordIos=22]="wordIos",d[d.excelIos=23]="excelIos",d[d.powerpointIos=24]="powerpointIos",d[d.onenote=25]="onenote",d[d.teamsIos=26]="teamsIos",d[d.teamsAndroid=27]="teamsAndroid",d[d.onenoteIos=28]="onenoteIos",d[d.visioIos=29]="visioIos",d[d.onenoteAndroid=30]="onenoteAndroid",d[d.visioAndroid=31]="visioAndroid",d[d.outlookWindows=32]="outlookWindows",d[d.outlookMac=33]="outlookMac",d[d.onenoteUWP=34]="onenoteUWP",d[d.officemobileIos=35]="officemobileIos",d[d.officemobileAndroid=36]="officemobileAndroid",d[d.odcWac=37]="odcWac",d[d.outlookGroupsWeb=38]="outlookGroupsWeb",d[d.fluid=39]="fluid",d[d.modernFileExplorer=40]="modernFileExplorer",d[d.listsHome=41]="listsHome",d[d.listsIos=42]="listsIos",d[d.edgeEnterpriseNtp=43]="edgeEnterpriseNtp",d[d.officeFeed=44]="officeFeed",d[d.searchUx=45]="searchUx",d[d.consumerList=46]="consumerList",d[d.shareDemo=47]="shareDemo",d[d.onePlayer=48]="onePlayer",d[d.windowsShare=49]="windowsShare",d[d.streamIos=50]="streamIos",d[d.streamAndroid=51]="streamAndroid",d[d.loopIos=52]="loopIos",d[d.outlookAndroid=53]="outlookAndroid",d[d.outlookiOS=54]="outlookiOS",d[d.whiteboard=55]="whiteboard",d[d.businesscentral=56]="businesscentral",d[d.mslens=57]="mslens",d[d.pbidesktop=58]="pbidesktop",d[d.oneup=59]="oneup",d[d.sharePointPages=60]="sharePointPages",d[d.streamOnline=61]="streamOnline",d[d.npe=62]="npe",d[d.designer=63]="designer",d[d.designerIos=64]="designerIos",d[d.designerAndroid=65]="designerAndroid",d[d.filesintaskbar=66]="filesintaskbar",d[d.bizchat=67]="bizchat",d[d.createModule=68]="createModule";let p=g;(e=h||(h={}))[e.uninitialized=0]="uninitialized",e[e.direct=1]="direct",e[e.organizationView=2]="organizationView",e[e.organizationEdit=3]="organizationEdit",e[e.anonymousView=4]="anonymousView",e[e.anonymousEdit=5]="anonymousEdit",e[e.flexible=6]="flexible",e[e.requestAccess=7]="requestAccess",(f=i||(i={}))[f.specificPeople=0]="specificPeople",f[f.organization=1]="organization",f[f.anyone=2]="anyone",f[f.existing=3]="existing",f[f.specificPeopleFlex=4]="specificPeopleFlex",f[f.customLabeledSpecificPeople=5]="customLabeledSpecificPeople",f[f.direct=6]="direct";let q=i;var r=c(893),s=c(111),t=c(110),u=c(81),v=c(6);class w{getApiRoot(a,b,c,d=!1){let e;if(this._sharingContextInformation){let{isFolder:c,isListSharing:e,itemUrl:f,listId:g,listItemId:h,listUrl:i,resourceId:k,serverRelativeItemUrl:l,uniqueId:m,webAbsoluteUrl:n}=this._sharingContextInformation,o=(d?b?.properties?.listId??g:g)||"",p=(d?b?.properties?.ID??h:h)||"",q=(d?b?.properties?.uniqueId??m:m)||"";if(e)return a.build().webByUrl({webUrl:n}).method("Lists",g);if(m){if(g)return a.build().webByUrl({webUrl:n}).segment("lists").method("getbyid",o).method("GetItemByUniqueId",q);let e=d&&b?.type===t.a.Folder||c?"GetFolderById":"GetFileById",f={guid:d?b?.properties?.uniqueId??m:m};return a.build().webByUrl({webUrl:n}).method(e,f).segment("ListItemAllFields")}return i?a.build().webByUrl({listUrl:i}).method("GetListItem",l):f?j.lU.isFeatureEnabled({ODB:1236})?a.build().webByUrl({webUrl:n}).methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:new v.a(f).path}).segment("ListItemAllFields"):a.build().webByUrl({webUrl:n}).method("GetFileByUrl",u.b(f)).segment("ListItemAllFields"):g&&h?a.build().webByUrl({webUrl:n}).method("Lists",o).method("GetItemById",p):a.build().webByUrl({webUrl:n}).method("GetListItemByResourceId",k)}if(e=b.properties.path?this._itemUrlHelper.getUrlParts({path:b.properties.path}):this._itemUrlHelper.getItemUrlParts(b.key),!j.Ov.isActivated("c75d69bb-a1f0-46fc-a252-78d6cdeac52b","05/08/2024","call GSI using itemType and uniqueId")&&!c&&b?.properties?.uniqueId&&b?.type){let c=b.type===t.a.Folder?"GetFolderById":"GetFileById",d={guid:b.properties.uniqueId};return a.build().webByItemUrl(e).method(c,d).segment("ListItemAllFields")}let f=a.build().webByItemUrl(e).method("Lists",c);return b.isRootFolder||(f=b.properties.ID?f.method("GetItemById",b.properties.ID):f.method("GetItemByUniqueId",b.properties.uniqueId)),f}getFileUrl(a){return this._itemUrlHelper.getItemUrlParts(a.key).fullItemUrl}canUseSecurable(a){let b=a.properties;return!!b&&(a.isRootFolder?!!a.list&&!!a.list.id:!!b.ID||!!b.uniqueId)}static getUniqueSharingPrincipals(a){if(!a)return;let b=new Set;return a.filter(a=>!b.has(a.loginName)&&(b.add(a.loginName),!0))}constructor(a){this._itemUrlHelper=a.itemUrlHelper,this._sharingContextInformation=a.sharingContextInformation}}var x=c(361),y=c(40),z=c(891);class A{_serialize(){let a={};return this._features.forEach((b,c)=>{a[c]={Version:b.version,Enabled:b.enabled}}),a}get(a){if(!a||a&&0===a.length)throw Error("Cannot get feature, featureName input is empty or undefined");return this._features.get(a)}constructor(a){if(this._features=new Map,!a)throw Error("Cannot create SPFeatureInfo object, incoming data is undefined.");for(const b in a)if(void 0!==b){const c=a[b];this._features.set(b,{version:c.Version,enabled:c.Enabled})}}}var B=c(266);c(376);let C=j.Ov.isActivated("7853DF32-37BE-47FC-9ED5-B341B51F0667","07/07/2023","KS for COB simplified ShareDialog")||j.B3.isFeatureEnabled({ECS:1131341}),D=(j.Ov.isActivated("a32b4fa8-d9ef-448b-935e-e20c7e10723f","04/30/2025","KS for checking mian link for is not shared"),j.B3.isFeatureEnabled({ODB:61327,ODC:"COBNewShareDialog"})),E="https://my.microsoftpersonalcontent.com",F=!j.Ov.isActivated("9675890E-EBF0-485C-97F8-E058C05D2690");function G(a,b,c){if(a===h.anonymousEdit||a===h.anonymousView)return q.anyone;if(a===h.organizationEdit||a===h.organizationView)return q.organization;if(a===h.direct)return q.specificPeople;if(a===h.flexible)if(b)return q.anyone;else if(!1===c)return q.organization;else return q.specificPeopleFlex}function H(){let a=window.location.search.substring(1),b=(0,j.pW)(a),c=b.itemMigrated&&"true"===b.itemMigrated.toLowerCase(),d=function(a){if(F)return I(a,E)||I(a,"https://onedrive.live.com");if(a&&"ConsumerTenant"===a.tenantDisplayName&&0===a.webAbsoluteUrl.indexOf(E)){let b=a.webAbsoluteUrl.match(RegExp(`${E}/personal/(\\w+)`));if(b&&2===b.length)return b[1]}}(window._spPageContextInfo);return!c&&d&&(c=!0),!C&&(!!window.FilesConfig&&D||!!c)}function I(a,b){let c=a?new v.a(a.webAbsoluteUrl):void 0;if(c&&c.authority===b&&3===c.segments.length)return c.segments[2]}function J(a){return"{"===a[0]&&(a=a.substring(1,a.length-1)),/^(\{){0,1}[0-9a-fA-F]{8}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{4}\-[0-9a-fA-F]{12}(\}){0,1}$/gi.test(a)&&"00000000-0000-0000-0000-000000000000"!==a}var K=c(892),L=c(0),M=c(61);let N=!j.Ov.isActivated("48d0bf6b-2e41-42a8-a3a3-e8d2ef405dbb","7/14/2022","better error handling"),O=j.Ov.isActivated("3e85cd31-2807-44c1-96bf-35f08619ec11","1/31/2023","Fix for not appending navId to SPL link"),P=j.Ov.isActivated("edb05947-5f5b-47a0-91ef-ddc0cef4e7a1","07/03/2024","sbarrameda: fix to use loginName if userId is undefined"),Q=j.Ov.isActivated("46a06a91-966f-47f1-af68-09d8b3864e12","07/03/2023","Override navId with navIdSendLinkOverride")||j.B3.isFeatureEnabled({ECS:1107386}),R=j.Ov.isActivated("62a4337e-d21e-407b-b2ef-2163777d20b8","12/19/2022","Link unfurl using displayName KS")||j.B3.isFeatureEnabled({ECS:1059927}),S=j.Ov.isActivated("9c1ecbd5-cae0-484e-ba86-18863f653357","09/18/2023","KS for using AgeGroup returned from GSI")||j.B3.isFeatureEnabled({ECS:1132016}),T=j.Ov.isActivated("8b8c00d5-55fe-4115-9289-1f3c0a6e37b4","02/15/2024","Use maxPrincipalsToReturn and maxLinkMembersToReturn in GSI request")||j.B3.isFeatureEnabled({ECS:1231607}),U=j.Ov.isActivated("ecde6cd1-4c53-4160-a2c0-137609d6f987","05/13/2025","joannakuo: add navid to share object"),V=j.Ov.isActivated("bb4978a7-7997-465d-8306-ce0f2683a9ee","06/10/2025","joannakuo: log auth token appId"),W=j.Ov.isActivated("2feadc3c-a1d2-4ee9-a73a-ac8a60ce73f6","07/09/2025","joannakuo: remove padding from navId string");class X extends n.b{static parsePeople(a){return a.map(a=>{let b={role:X.parseSharingRole(a.CurrentRole),statusCode:Number(!a.Status),errorMessage:a.Message||null};return{name:a.DisplayName,email:a.Email,userId:a.UserId,sharingInfo:b}})}static parseSharingRole(a){switch(a){case 0:return 5;case 1:default:return 1;case 2:return 2;case 6:return 6}}getSharingInformation(a,b,c,d,e,f){let g,h=(d=d||this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,a,this._getParentListId(a))).segment("GetSharingInformation"),i="pickerSettings";return b&&(i+=",permissionsInformation"),c&&(i+=",sharingLinkTemplates"),e&&(i+=",addressBarLinkSettings"),g=h.oDataParameter("$Expand",i).toString(),this.getData(()=>g,b=>{let c=JSON.parse(b),d=this._parseGetSharingInformationResponse(c,a);return d.getSharingInformationSources=3,d},"GetSharingInformation",()=>JSON.stringify({request:{maxPrincipalsToReturn:T?30:100,maxLinkMembersToReturn:T?30:100}}),"POST",this._sharingContextInformation&&this._sharingContextInformation.listId&&J(this._sharingContextInformation.listId.slice(1,-1))?{"X-SP-REQUESTRESOURCES":`WEBPROPERTIES, list=${this._sharingContextInformation.listId.slice(1,-1)}`,...(0,K.d)(this._pageContext)?{[K.b]:K.a}:{}}:(0,K.d)(this._pageContext)?{[K.b]:K.a}:void 0,null,null,!0,void 0,void 0,this._getExtraData(),f)}getSharingInformationForRMA(a,b,c){let d=(b=b||this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,a,this._getParentListId(a))).segment("GetSharingInformation");return this.getData(()=>d.toString(),a=>{let b=JSON.parse(a);return this._parseGetSharingInformationResponseForRMA(b)},"GetSharingInformation",()=>"","POST",this._sharingContextInformation&&this._sharingContextInformation.listId&&J(this._sharingContextInformation.listId.slice(1,-1))?{"X-SP-REQUESTRESOURCES":`WEBPROPERTIES, list=${this._sharingContextInformation.listId.slice(1,-1)}`,...(0,K.d)(this._pageContext)?{[K.b]:K.a}:{}}:(0,K.d)(this._pageContext)?{[K.b]:K.a}:void 0,null,null,!0,void 0,void 0,this._getExtraData(),c)}getShareLinkApi(a,b,c){return b.method("Lists",this._getParentListId(a)).method("GetItemById",c).segment("ShareLink")}emailWithoutPermissioning(a,b,c,d){let e=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,b,this._getParentListId(b)).segment("ForwardObjectLink").toString();return this.getData(()=>e,a=>{let c=JSON.parse(a).d,d=[];c.UniquelyPermissionedUsers&&c.UniquelyPermissionedUsers.results&&(d=c.UniquelyPermissionedUsers.results);let e=[];c.InvitedUsers&&c.InvitedUsers.results&&(e=c.InvitedUsers.results);let f={};if(f.statusCode=c.StatusCode,f.errorMessage=c.ErrorMessage,f.people=X.parsePeople(d),f.invitedUsers=X.parsePeople(e),f.itemId=b&&b.id,e.length>0&&(f.invitationLink=e[0].InvitationLink),f.invalidEmails=[],c.UsersWithInvalidEmails&&c.UsersWithInvalidEmails.results)for(let a of c.UsersWithInvalidEmails.results)f.invalidEmails.push(a.User);return f},"ForwardObjectLink",()=>{let b=[];for(let c of a)b.push(c.rawPersonData);let e={peoplePickerInput:JSON.stringify(b),emailBody:c,emailSubject:d,linkParameters:{}};return this._sharingContextInformation&&this._sharingContextInformation.optInSendNavIdInShareLink&&!O&&(this._sharingContextInformation.navIdSendLinkOverride&&!Q?e.linkParameters.nav=W?this._sharingContextInformation.navIdSendLinkOverride:this._sharingContextInformation.navIdSendLinkOverride?.replace(/=/g,""):this._sharingContextInformation.navId&&(e.linkParameters.nav=W?this._sharingContextInformation.navId:this._sharingContextInformation.navId?.replace(/=/g,""))),JSON.stringify(e)},"POST",(0,K.d)(this._pageContext)?{[K.b]:K.a}:void 0)}checkPermissions(a,b){let c=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,b,this._getParentListId(b)).segment("CheckPermissions").toString();return this.getData(()=>c,a=>{let b=JSON.parse(a);return b.d?b.d.CheckPermissions.results:null},"CheckPermissions",()=>JSON.stringify({recipients:a}))}share(a,b){let c=!!this._sharingContextInformation||this._sharingDataSourceHelper.canUseSecurable(b.items[0]);if(9===b.linkType||6===b.linkType||5===b.linkType)return this._shareLink(a,b);{let d,e={};if(c){let a=b.items[0];d=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,a,this._getParentListId(a)).segment("ShareObject").toString()}else d=this._shareUrl;this._sharingContextInformation&&this._sharingContextInformation.listId&&J(this._sharingContextInformation.listId.slice(1,-1))&&(e["X-SP-REQUESTRESOURCES"]=`WEBPROPERTIES, list=${this._sharingContextInformation.listId.slice(1,-1)}`),(0,K.d)(this._pageContext)&&(e[K.b]=K.a);let f=a.length;if(!V&&this._pageContext.authToken){let a=new L.a({name:"SharingDataSource.Share.authTokenAppId"}),b=(0,M.b)(this._pageContext.authToken).appid||"",c="08e18876-6177-487e-b8b5-cf950c1e598c"!==b&&"c58637bb-e2e1-4312-8a00-04b5ffcd3403"===b?L.b.Failure:L.b.Success;a.end({resultType:c,extraData:{appId:b,clientId:this.getClientId(),scenarioId:this._sharingContextInformation.scenarioId,correlationId:this._sharingContextInformation.correlationId,hostSessionId:this._sharingContextInformation.hostSessionId,pageContextCorrelationId:this._pageContext.CorrelationId}})}return this.getData(()=>d,a=>{let c=JSON.parse(a).d,d=[];(0,B.a)()&&window.sessionStorage.setItem("Share_Response",JSON.stringify(c)),c.UniquelyPermissionedUsers&&c.UniquelyPermissionedUsers.results&&(d=c.UniquelyPermissionedUsers.results);let e=[];c.InvitedUsers&&c.InvitedUsers.results&&(e=c.InvitedUsers.results);let f={};if(f.statusCode=c.StatusCode,f.errorMessage=c.ErrorMessage,f.people=X.parsePeople(d),f.invitedUsers=X.parsePeople(e),f.itemId=b.items[0]&&b.items[0].id,e.length>0&&(f.invitationLink=e[0].InvitationLink),f.invalidEmails=[],c.UsersWithInvalidEmails&&c.UsersWithInvalidEmails.results)for(let a of c.UsersWithInvalidEmails.results)f.invalidEmails.push(a.User);return f},"Share",()=>{let d=[];for(let b=0;b<a.length;b++){let c=a[b];d.push(c.rawPersonData)}"2"===b.roleValue?b.roleValue="role:1073741827":"1"===b.roleValue&&(b.roleValue="role:1073741826");let e={peoplePickerInput:JSON.stringify(d),roleValue:b.roleValue,sendEmail:b.sendEmail,emailBody:b.message,emailSubject:b.subject,includeAnonymousLinkInEmail:!b.requireSignIn,propagateAcl:b.propagateSharing,useSimplifiedRoles:!0},f=this._sharingContextInformation?.navIdSendLinkOverride||this._sharingContextInformation?.navId||"";!U&&f&&(e.linkParameters={nav:W?f:f.replace(/=/g,"")}),c||(e.url=this._sharingDataSourceHelper.getFileUrl(b.items[0]));let g=JSON.stringify(e);return(0,B.a)()&&window.sessionStorage.setItem("Share_Payload",g),g},"POST",e,void 0,void 0,!0,void 0,void 0,this._getExtraData(f)).catch(c=>{let d="";try{d=JSON.stringify(c)}catch(a){}return{error:5,debugErrorMessage:d,people:a,statusCode:c.statusCode,errorMessage:c.errorMessage,invitedUsers:[],itemId:b.items[0]&&b.items[0].id||""}})}}updatePermissions2(a,b,c){let d=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,b,this._getParentListId(b),H()).segment("UpdateDocumentSharingInfo").toString();return this.getData(()=>d,a=>{let b=JSON.parse(a).d;return b?{role:b.UpdateDocumentSharingInfo.results[0].CurrentRole}:null},"UpdatePermissions2",()=>{let b;switch(c){case o.a.none:case o.a.view:case o.a.manageList:case o.a.restrictedview:case o.a.review:case o.a.edit:case o.a.owner:b=c;break;default:b=o.a.view}return JSON.stringify({userRoleAssignments:[{UserId:a.loginName,Role:b}],validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:!1,customMessage:null,includeAnonymousLinksInNotification:!1,propagateAcl:!0})})}updatePermissionsMultiple(a,b,c,d,e){let f=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,b,this._getParentListId(b)).segment("UpdateDocumentSharingInfo").toString();return this.getData(()=>f,a=>{let b=JSON.parse(a).d;return b?{role:b.UpdateDocumentSharingInfo.results[0].CurrentRole,success:b.UpdateDocumentSharingInfo.results.map(a=>a.Status).reduce((a,b)=>a&&b,!0)}:null},"UpdatePermissionsMultiple",()=>{let b;switch(c){case o.a.none:b=0;break;case o.a.view:b=1;break;case o.a.review:b=6;break;case o.a.edit:b=2;break;case o.a.restrictedview:b=7;break;default:b=1}return JSON.stringify({userRoleAssignments:a.map(a=>({UserId:P?a.userId:a.userId||a.loginName,Role:b})),validateExistingPermissions:!1,additiveMode:!1,sendServerManagedNotification:d,customMessage:e,includeAnonymousLinksInNotification:!1,propagateAcl:!0})})}parseRawSharingInformation(a,b){return this._parseGetSharingInformationResponse(a,b)}parseRawSharingInformationForRMA(a){return this._parseGetSharingInformationResponseForRMA(a)}unshareLink(a){let b=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,a.item,this._getParentListId(a.item),H()).segment("UnshareLink").toString();return this.getData(()=>b,a=>!!JSON.parse(a).d,"UnshareLink",()=>JSON.stringify({linkKind:a.kind,shareId:a.shareId}))}shareLink(a){let b=a.settings,c=a.items[0],d=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,a.items[0],this._getParentListId(c),H()).segment("ShareLink").toString(),e={};return this._sharingContextInformation&&(this._sharingContextInformation.listId&&J(this._sharingContextInformation.listId.slice(1,-1))&&(e["X-SP-REQUESTRESOURCES"]=`WEBPROPERTIES, list=${this._sharingContextInformation.listId.slice(1,-1)}`),this._sharingContextInformation&&this._sharingContextInformation.enableFallbackShareLink&&(e.Prefer="DirectUrlWithShareToken")),(0,K.d)(this._pageContext)&&(e[K.b]?e[K.b]+=`,${K.a}`:e[K.b]=K.a),this.getData(()=>d,a=>{let b=JSON.parse(a);return b.d?((0,B.a)()&&window.sessionStorage.setItem("ShareLink_Response",JSON.stringify(b.d)),function(a){if(a.d)return Y(a.d.ShareLink.sharingLinkInfo)}(b)):b.error?{error:5,errorMessage:b.error.message}:void 0},"ShareLink",()=>{let c=null;b.expiration&&(c=k(b.expiration.toString()));let d=null;if(a.recipients&&a.recipients.length>0)for(let b of(d=[],a.recipients))b.rawPersonData&&d.push(b.rawPersonData);let e=null;if(b.inviteesToRemove&&b.inviteesToRemove.length>0)for(let a of(e=[],b.inviteesToRemove))e.push({id:a.id,loginName:a.loginName,name:a.primaryText,isExternal:a.isExternal,principalType:a.type,email:a.email});let f={request:{createLink:!!b.createLink,settings:{allowAnonymousAccess:b.allowAnonymousAccess,trackLinkUsers:b.trackLinkUsers,linkKind:b.sharingLinkKind,expiration:c,role:b.role,restrictShareMembership:b.restrictShareMembership,updatePassword:b.updatePassword,password:b.password,shareId:b.shareId,description:b.description,scope:b.scope,nav:""}}};if(this._sharingContextInformation&&this._sharingContextInformation.optInSendNavIdInShareLink&&!O&&(this._sharingContextInformation.navIdSendLinkOverride&&!Q?f.request.settings.nav=this._sharingContextInformation.navIdSendLinkOverride:this._sharingContextInformation.navId&&(f.request.settings.nav=this._sharingContextInformation.navId)),e&&(f.request.settings.inviteesToRemove={results:e}),d&&d.length>0){f.request.peoplePickerInput=JSON.stringify(d);let b=a.emailData,c=a.emailSubject;void 0!==b&&void 0===c&&(f.request.emailData={body:a.emailData,subject:""}),void 0===b&&void 0!==c&&(f.request.emailData={body:"",subject:a.emailSubject}),void 0!==b&&void 0!==c&&(f.request.emailData={body:a.emailData,subject:a.emailSubject})}let g=a.settings.shareId;g&&(f.request.settings.shareId=g,f.request.emailData={body:""});let h=JSON.stringify(f);return(0,B.a)()&&window.sessionStorage.setItem("ShareLink_Payload",h),h},"POST",0!==Object.keys(e).length?e:null,null,null,!0,void 0,void 0,this._getExtraData()).catch(a=>{if(N)return{error:a};let b="";try{b=JSON.stringify(a)}catch(a){}return{error:5,debugErrorMessage:b}})}setAddressBarLinkCapability(a,b){let c=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,a,this._getParentListId(a)).segment("SetAddressBarLinkCapability").toString();return this.getData(()=>c,a=>!!JSON.parse(a).d,"SetAddressBarLinkCapability",()=>JSON.stringify({enable:b}))}shareLinkExpress(a,b,c){let d=this._apiUrlHelper.build().webByUrl({webUrl:this._pageContext.webAbsoluteUrl}).method("Lists",a).method("GetItemById",b).segment("ShareLinkExpress").toString();return this.getData(()=>d,a=>{let b=JSON.parse(a);return b.error||!b.d?.ShareLinkExpress?.sharingLinkInfo?{error:5,errorMessage:b?.error?.message||"No sharing link info returned"}:b.d?Y(b.d.ShareLinkExpress.sharingLinkInfo):void 0},"ShareLinkExpress",()=>JSON.stringify({expressOption:c}),"POST",(0,K.d)(this._pageContext)?{[K.b]:K.a}:void 0,null,null,!0,void 0,void 0,this._getExtraData()).catch(a=>{if(N)return{error:a};let b="";try{b=JSON.stringify(a)}catch(a){}return{error:5,debugErrorMessage:b}})}getClientId(){let a=Number(this._pageContext.webTemplate);if(function(a){if(!a.featureInfo)return Number(a.webTemplate)===y.b.sitePagePublishing;{let b=new A(a.featureInfo);if(!b)return!1;{let a=b.get("SitePagePublishing");return!!a&&a.enabled}}}(this._pageContext))return p.sharePoint;switch(a){case y.b.teamSite:case y.b.group:case y.b.subgroup:case y.b.sitePagePublishing:return p.sharePoint;case y.b.mySite:return p.odb;default:return p.sharePoint}}_shareLink(a,b){let c=b.items[0],d=this._sharingDataSourceHelper.getApiRoot(this._apiUrlHelper,c,this._getParentListId(c)).segment("ShareLink").toString();return this.getData(()=>d,c=>({statusCode:0,errorMessage:"",people:a,itemId:b.items[0].id,invitedUsers:[]}),"ShareLink",()=>{let c=[];for(let b of a)c.push(b.rawPersonData);let d=null;return b.expiration&&(d=k(b.expiration)),JSON.stringify({request:{peoplePickerInput:JSON.stringify(c),emailData:{body:b.message,subject:b.subject},linkKind:this._getSharingLinkKind(b.linkType,b.roleValue),createLink:!0,expiration:d}})},"POST",(0,K.d)(this._pageContext)?{[K.b]:K.a}:void 0)}_getSharingLinkKind(a,b){let c=h.direct;return 6===a?c=h.anonymousEdit:5===a?c=h.anonymousView:9===a&&(c="2"===b?h.organizationEdit:h.organizationView),c}_parseGetSharingInformationResponse(a,b){if(a.error)return{error:5,ageGroup:void 0,anonymousLinkExpirationRestrictionDays:void 0,anyoneLinkTrackUsers:void 0,canAddExistingExternalPrincipal:void 0,canAddExternalPrincipal:void 0,canAddInternalPrincipal:void 0,canRequestAccessForGrantAccess:void 0,canManagePermissions:void 0,defaultSharingLink:void 0,defaultShareLinkScope:void 0,defaultShareLinkToExistingAccess:void 0,hasInheritedLinks:void 0,isShared:void 0,item:void 0,fileExtension:void 0,sharedObjectType:void 0,sharingLinks:void 0,sharingPrincipals:void 0,peoplePickerSettings:void 0,userDisplayName:void 0,blockPeoplePickerAndSharing:void 0,userRole:void 0,defaultShareLinkPermission:void 0,sharingAbilities:void 0,defaultLinkKind:void 0,directLink:void 0,hasPermissionsInformation:void 0,sharingLinkTemplates:void 0,webTemplateId:void 0,itemUniqueId:void 0,itemUrl:void 0,siteId:void 0,listId:void 0,substrateFileId:void 0,tenantId:void 0,isConsumerFiles:void 0,outlookEndpointHostUrl:void 0,webUrl:void 0,userPhotoCdnBaseUrl:void 0,permissionsInformation:void 0,sensitivityLabelInformation:void 0,displayName:void 0};let c=a.d,{userPhotoCdnBaseUrl:d,permissionsInformation:e}=c,f=!!e,g=!!c.sharingLinkTemplates,i=!!c.addressBarLinkSettings,j=f?this._parseSharingLinks(e.links.results,c.directUrl,d,H()):[],k=g?this._parseSharingLinkTemplates(c.sharingLinkTemplates.templates.results,d):[],l=i?c.addressBarLinkSettings:null,m=[];if(f){let a=e.siteAdmins.results,b=e.principals.results,c=this._parseSharingPrincipals(a,void 0,d);c.forEach(a=>a.isSiteAdmin=!0);let f=this._parseSharingPrincipals(b,void 0,d);m=c.concat(f)}let n=this._getDefaultSharingLink(c.defaultLinkKind,c.defaultShareLinkScope,j,c.sharingAbilities),p=this._sharingContextInformation?this._sharingContextInformation.itemName:void 0;R||p||!c||(p=c.displayName);let r={name:p,childCount:this._sharingContextInformation?this._sharingContextInformation.itemCount:void 0,hasDlpPolicy:this._sharingContextInformation?this._sharingContextInformation.hasDlpPolicy:void 0,extension:this._sharingContextInformation&&this._sharingContextInformation.itemExtension?this._sharingContextInformation.itemExtension:c.fileExtension,appmap:this._sharingContextInformation?this._sharingContextInformation.itemAppmap:void 0,itemType:this._sharingContextInformation?this._sharingContextInformation.itemType:void 0};if(b){let a=b.properties,d=a.ItemChildCount?parseInt(a.ItemChildCount,10):0,e=a.FolderChildCount?parseInt(a.FolderChildCount,10):0,f=b.type===t.a.OneNote?0:d+e,g=this._isPolicyTipFlagSet(b.policyTip,x.b.blockSharing),h=b.name;R||h||!c.displayName||(h=c.displayName),r={name:h,childCount:f,hasDlpPolicy:g,extension:b.extension,appmap:b.appMap,itemType:b.type}}let s=c.canRequestAccessForGrantAccess||c.canAddInternalPrincipal||j.length>1,u={anonymousLinkExpirationRestrictionDays:0===c.anonymousLinkExpirationRestrictionDays?-1:c.anonymousLinkExpirationRestrictionDays,anyoneLinkTrackUsers:c.anyoneLinkTrackUsers,allOrganizationSecurityGroupId:c.uniqueAccessGroups?.discoverableByOrganization?.groupId,canAddExistingExternalPrincipal:c.canAddExistingExternalPrincipal,canAddExternalPrincipal:c.canAddExternalPrincipal,canAddInternalPrincipal:c.canAddInternalPrincipal,defaultShareLinkToExistingAccess:c.defaultShareLinkToExistingAccess,canManagePermissions:s,defaultSharingLink:n,fileExtension:c.fileExtension,sharedObjectType:c.sharedObjectType,hasInheritedLinks:!!f&&c.permissionsInformation.hasInheritedLinks,isShared:function(a,b,c){let d=!!a.filter(a=>{let b=new Date(a.expiration);return a.isActive&&a.sharingLinkKind!==h.direct&&(!a.expiration||b.getTime()>Date.now())&&!0!==a.isUnhealthy}).length;if(!d&&b.length){for(let a of b)if(a.role!==o.a.owner){d=!0;break}}return d}(j,m),item:r,sharingLinks:j,sharingPrincipals:m,peoplePickerSettings:c.pickerSettings,userDisplayName:this._pageContext.userDisplayName,blockPeoplePickerAndSharing:c.blockPeoplePickerAndSharing,requiresAccessApproval:!c.canAddInternalPrincipal&&c.canRequestAccessForGrantAccess,canRequestAccessForGrantAccess:c.canRequestAccessForGrantAccess,userRole:c.currentRole,defaultShareLinkPermission:c.defaultShareLinkPermission,sharingAbilities:c.sharingAbilities,defaultLinkKind:c.defaultLinkKind,defaultShareLinkScope:c.defaultShareLinkScope,directLink:{allowsAnonymousAccess:!1,audience:q.existing,expiration:null,description:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"00000000-0000-0000-0000-000000000000",sharingLinkKind:h.direct,sharingScope:3,url:c.directUrl,updatePassword:!1,password:"",passwordLastModifiedBy:null},discoverableByOrganizationEnabled:c.uniqueAccessGroups?.discoverableByOrganization?.enabled,hasPermissionsInformation:!!c.permissionsInformation,sharingLinkTemplates:k,addressBarLinkSettings:l,webTemplateId:c.webTemplateId,itemUniqueId:c.itemUniqueId,itemUrl:c.itemUrl,siteId:c.siteId,listId:c.listId,substrateFileId:c.substrateFileId,tenantId:c.tenantId,isConsumerFiles:!!c.isConsumerFiles&&c.isConsumerFiles,customizedExternalSharingServiceUrl:c.customizedExternalSharingServiceUrl||"",siteIBSegmentIDs:c.siteIBSegmentIDs?c.siteIBSegmentIDs.results:null,siteIBMode:c.siteIBMode,enforceIBSegmentFiltering:!!c.enforceIBSegmentFiltering,enforceSPOSearch:!!c.enforceSPOSearch,outlookEndpointHostUrl:c.outlookEndpointHostUrl?c.outlookEndpointHostUrl:null,webUrl:c.webUrl?c.webUrl:null,isStubFile:!!c.isStubFile&&c.isStubFile,userPhotoCdnBaseUrl:c.userPhotoCdnBaseUrl,permissionsInformation:c.permissionsInformation,sensitivityLabelInformation:c.sensitivityLabelInformation,displayName:c.displayName,isPremium:c.isPremium,isMultiTenantOrganization:c.isMultiTenantOrganization,...!S&&c.ageGroup?{ageGroup:c.ageGroup}:{}};if((0,B.a)()){let a=window.sessionStorage.getItem("Get_Sharing_Information");if(a&&Object.keys(a).length>0){let b=JSON.parse(a);return{...u,...b}}}return u}_parseGetSharingInformationResponseForRMA(a){let b=a.d;return{currentRole:b.currentRole,fileExtension:b.fileExtension,fileName:b.displayName,sharedObjectType:b.sharedObjectType,sensitivityLabelInformation:b.sensitivityLabelInformation}}_parseSharingLinks(a,b,c,d=!1){d||(a=a.filter(a=>!a.isInherited));let e=a.map(a=>{let b,e=a.linkDetails;return b=void 0!==e.Scope&&-1!==e.Scope?Z(e.LinkKind,e.Scope):G(e.LinkKind,e.AllowsAnonymousAccess,e.RestrictedShareMembership),{allowsAnonymousAccess:e.AllowsAnonymousAccess,hasPassword:e.RequiresPassword,blockDownload:e.BlocksDownload,description:e.Description,audience:b,expiration:e.Expiration?new Date(e.Expiration):null,isActive:e.IsActive,isEdit:$(e.LinkKind)||e.IsEditLink,isReview:e.IsReviewLink,isManageList:e.IsManageListLink,principals:this._parseSharingPrincipals(a.linkMembers.results,e.LinkKind,c),invitees:this._parseLinkInvitees(e,c),shareId:e.ShareId,sharingLinkKind:e.LinkKind,sharingScope:e.Scope,url:e.Url,updatePassword:e.UpdatePassword,password:e.Password,passwordLastModifiedBy:this._parseSharingPrincipal(e.PasswordLastModifiedBy,c),isCreateOnlyLink:e.IsCreateOnlyLink,isAddressBarLink:e.IsAddressBarLink,isUnhealthy:e.IsUnhealthy,status:e.SharingLinkStatus,created:e.Created,trackLinkUsers:e.TrackLinkUsers,...d?{inheritedLinkInfo:a.inheritedFrom}:{},...a.linkStatus?{enabled:a.linkStatus.enabled}:{}}});return(e=e.sort((a,b)=>this._getLinkRanking(b)-this._getLinkRanking(a))).push({allowsAnonymousAccess:!1,audience:q.specificPeople,expiration:null,description:null,isActive:!0,isEdit:!0,principals:[],invitees:[],shareId:"",sharingLinkKind:h.direct,sharingScope:2,url:b,updatePassword:!1,password:"",passwordLastModifiedBy:null}),e}_getLinkRanking(a){let b=0;switch(a.audience){case q.anyone:b+=30;break;case q.organization:b+=20;break;case q.specificPeopleFlex:b+=10}return a.isEdit?b+=3:a.isReview?b+=2:a.isEdit||a.isReview||a.blockDownload||(b+=1),b}_getSharingLinkTemplateRanking(a){let b=0;if(a&&a.linkDetails&&a.linkDetails.shareId){switch(a.scope){case 0:b+=30;break;case 1:b+=20;break;case 2:b+=10}switch(a.role){case o.a.edit:b+=3;break;case o.a.review:b+=2;break;case o.a.view:b+=1}}return b}_parseSharingLinkTemplates(a,b){return a.map(a=>{let c,d=a.linkDetails;if(null!==d){let a;a=void 0!==d.Scope&&-1!==d.Scope?Z(d.LinkKind,d.Scope):G(d.LinkKind,d.AllowsAnonymousAccess,d.RestrictedShareMembership),c={allowsAnonymousAccess:d.AllowsAnonymousAccess,hasPassword:d.RequiresPassword,blockDownload:d.BlocksDownload,audience:a,expiration:d.Expiration?new Date(d.Expiration):null,description:d.Description,isActive:d.IsActive,isEdit:$(d.LinkKind)||d.IsEditLink,isReview:d.IsReviewLink,principals:void 0,invitees:this._parseLinkInvitees(d,b),shareId:d.ShareId,sharingLinkKind:d.LinkKind,sharingScope:d.Scope,url:d.Url,updatePassword:d.UpdatePassword,password:d.Password,passwordLastModifiedBy:this._parseSharingPrincipal(d.PasswordLastModifiedBy,b)}}return{linkDetails:c,passwordProtected:a.passwordProtected,role:a.role,scope:a.scope,shareKind:a.shareKind}}).sort((a,b)=>this._getSharingLinkTemplateRanking(b)-this._getSharingLinkTemplateRanking(a))}_parseLinkInvitees(a,b){let c=a.Invitations;if(!c)return[];let d=[];for(let a of c.results)a&&a.invitee&&d.push(a.invitee);return d.map(a=>({id:a.id,email:a.email,primaryText:a.name,isExternal:a.isExternal,loginName:a.loginName,role:null,secondaryText:a.jobTitle,type:a.principalType,imageUrl:(0,z.a)(this._pageContext.webAbsoluteUrl,a.email,b)}))}_parseSharingPrincipals(a,b,c){let d=a.map(a=>{let d=a.principal;d||(d=a);let e={id:d.id,isExternal:d.isExternal,loginName:d.loginName,primaryText:d.name,role:a.role,secondaryText:d.jobTitle,type:d.principalType,imageUrl:(0,z.a)(this._pageContext.webAbsoluteUrl,d.email,c),email:d.email};return b&&(e.sharingLinkKind=b),e});return w.getUniqueSharingPrincipals(d)}_getExtraData(a){let b;return this._sharingContextInformation&&(b={clientId:this._sharingContextInformation.clientId,mode:r.a[this._sharingContextInformation.mode],numRecipients:a}),b}_parseSharingPrincipal(a,b){if(a){let c=a.principal;return c||(c=a),{id:c.id,isExternal:c.isExternal,loginName:c.loginName,primaryText:c.name,role:a.role,secondaryText:c.jobTitle,type:c.principalType,imageUrl:(0,z.a)(this._pageContext.webAbsoluteUrl,c.email,b),email:c.email}}return null}_getDefaultSharingLink(a,b,c,d){let e;d.peopleSharingLinkAbilities&&(d.peopleSharingLinkAbilities.canManageEditLink.enabled||d.peopleSharingLinkAbilities.canManageReadLink.enabled)&&a===h.direct&&(a=h.flexible);let f=a,g=b;return d.anyoneLinkAbilities?(f!==h.anonymousEdit||d.anyoneLinkAbilities.canManageEditLink.enabled||(f=h.anonymousView),f!==h.anonymousView||d.anyoneLinkAbilities.canManageReadLink.enabled||(f=h.organizationEdit),0!==g||d.anyoneLinkAbilities.canManageReadLink.enabled||d.anyoneLinkAbilities.canManageReadLink.enabled||(g=1)):(f!==h.anonymousEdit||d.anonymousLinkAbilities.canManageEditLink.enabled||(f=h.anonymousView),f!==h.anonymousView||d.anonymousLinkAbilities.canManageReadLink.enabled||(f=h.organizationEdit),0!==g||d.anonymousLinkAbilities.canManageReadLink.enabled||d.anonymousLinkAbilities.canManageReadLink.enabled||(g=1)),d.organizationLinkAbilities&&(f!==h.organizationEdit||d.organizationLinkAbilities.canManageEditLink.enabled||(f=h.organizationView),f!==h.organizationView||d.organizationLinkAbilities.canManageReadLink.enabled||(f=h.direct),1!==g||d.organizationLinkAbilities.canManageReadLink.enabled||d.organizationLinkAbilities.canManageEditLink.enabled||(g=2)),!d.peopleSharingLinkAbilities||2!==g||d.peopleSharingLinkAbilities.canManageReadLink.enabled||d.peopleSharingLinkAbilities.canManageEditLink.enabled||(g=3),a===h.anonymousEdit||a===h.anonymousView?e=q.anyone:a===h.organizationEdit||a===h.organizationView?e=q.organization:a===h.direct?e=q.specificPeople:a===h.flexible&&(e=q.specificPeopleFlex),{allowsAnonymousAccess:void 0,audience:e,expiration:void 0,description:void 0,isActive:!0,isEdit:void 0,principals:void 0,shareId:void 0,sharingLinkKind:f,sharingScope:g,url:void 0,invitees:void 0,updatePassword:!1,password:"",passwordLastModifiedBy:void 0}}_isPolicyTipFlagSet(a,b){return a&&(a&b)===b}constructor(a,b={pageContext:a.pageContext}){super({dataSourceName:"SharingDataSource"},b),this._getParentListId=a.getParentListId,this._itemUrlHelper=a.itemUrlHelper||new l.a({},{pageContext:a.pageContext}),this._apiUrlHelper=a.apiUrlHelper||new m.a({},{pageContext:a.pageContext,itemUrlHelper:this._itemUrlHelper}),this._sharingContextInformation=a.sharingContextInformation||void 0,this._sharingDataSourceHelper=new w({itemUrlHelper:this._itemUrlHelper,sharingContextInformation:this._sharingContextInformation,isItemUrlEncoded:a.isItemUrlEncoded});const c=(0,s.a)(this._pageContext);this._shareUrl=c+"/_api/SP.Web.ShareObject"}}function Y(a){let b;b=void 0!==a.Scope&&-1!==a.Scope?Z(a.LinkKind,a.Scope):G(a.LinkKind,a.AllowsAnonymousAccess,a.RestrictedShareMembership);let c=a.Expiration?new Date(a.Expiration):void 0;return{link:{allowsAnonymousAccess:a.AllowsAnonymousAccess,audience:b,expiration:c,description:a.Description,isActive:a.IsActive,isEdit:$(a.LinkKind)||a.IsEditLink,principals:null,invitees:null,hasPassword:a.RequiresPassword,shareId:a.ShareId,sharingLinkKind:a.LinkKind,sharingScope:a.Scope,url:a.Url,updatePassword:a.UpdatePassword,password:a.Password,passwordLastModifiedBy:a.PasswordLastModifiedBy,shareTokenString:a.ShareTokenString,isAddressBarLink:a.IsAddressBarLink,isUnhealthy:a.IsUnhealthy,status:a.SharingLinkStatus,created:a.Created}}}function Z(a,b){if(a===h.anonymousEdit||a===h.anonymousView)return q.anyone;if(a===h.organizationEdit||a===h.organizationView)return q.organization;if(a===h.direct)return q.specificPeople;if(a===h.flexible)if(0==b)return q.anyone;else if(1===b)return q.organization;else return q.specificPeopleFlex}function $(a){return a===h.anonymousEdit||a===h.organizationEdit||a!==h.anonymousView&&a!==h.organizationView&&null}}
,(a,b,c)=>{c.d(b,{a:()=>e});var d=c(382);class e{getSharingInformation(a,b,c,d,e){return this._dataSource.getSharingInformation(a,b,c,d,e,void 0)}getSharingInformationForRMA(a,b){return this._dataSource.getSharingInformationForRMA(a,b,void 0)}shareLink(a){return this._dataSource.shareLink(a).then(b=>(this._invalidateItem(a.items[0]),b))}unshareLink(a){return this._dataSource.unshareLink(a).then(b=>(this._invalidateItem(a.item),b))}updatePermissions2(a,b,c){return this._dataSource.updatePermissions2(a,b,c).then(a=>(this._invalidateItem(b),a))}updatePermissionsMultiple(a,b,c,d,e){return this._dataSource.updatePermissionsMultiple(a,b,c,d,e).then(a=>(this._invalidateItem(b),a))}getClientId(){return this._dataSource.getClientId()}parseRawSharingInformation(a){return this._dataSource.parseRawSharingInformation(a)}parseRawSharingInformationForRMA(a){return this._dataSource.parseRawSharingInformationForRMA(a)}emailWithoutPermissioning(a,b,c,d){return this._dataSource.emailWithoutPermissioning(a,b,c,d).then(a=>a)}checkPermissions(a,b){return this._dataSource.checkPermissions(a,b)}share(a,b,c){return this._dataSource.share(a,b).then(a=>a)}setAddressBarLinkCapability(a,b){return this._dataSource.setAddressBarLinkCapability(a,b)}_invalidateItem(a){this._itemProvider&&a&&a.parent&&a.parent.key&&this._itemProvider.invalidateItem(a.parent.key)}constructor(a){this._dataSource=a.sharingDataSource||new d.a({getParentListId:a.getParentListId,pageContext:a.pageContext}),this._itemProvider=a.itemProvider}}}
,(a,b,c)=>{function d(){return a=>class extends a{constructor(a){const{context:b={}}=a,{userAuthToken:c,userId:d,context:e,...f}=a,g=c&&function(a){try{let b=a.split(".")[1];if(b)return JSON.parse(atob(b.replace(/-/g,"+").replace(/_/g,"/")))}catch(a){return}}(c),h=g&&g.puid?"Business":"Unknown",i=g&&g.app_displayname||"Unknown",j=g&&g.appid||"Unknown",k=function(a,b,c){if(a)if("Unknown"===c)return"";else return a;return"Business"===c&&b&&b.puid||""}(d,g,h);super({context:{AccountType:h,AppName:i,AppId:j,IsAuthenticated:+!!k,SiteSubscriptionId:g&&g.tid||"Unknown",UserId:k,...b},...f})}}}c.d(b,{a:()=>d})}
,(a,b,c)=>{c.d(b,{a:()=>e});var d=c(386);function e(){return a=>class extends a{constructor(a){const{context:b={}}=a;super({language:window.navigator.language,...a,context:{...(0,d.a)(),...b}})}}}}
,(a,b,c)=>{c.d(b,{a:()=>e});var d=c("odsp.util_126");function e(a=new d.Ey){return{BrowserIsMobile:a.isMobile,BrowserIsPWA:a.isPWA,BrowserMajVer:a.browserMajor,BrowserMinVer:a.browserMinor,BrowserName:a.browserName,BrowserUserAgent:a.userAgent,OSName:a.osName,OSVersion:a.osVersion}}}
,(a,b,c)=>{var d,e;c.d(b,{a:()=>d}),(e=d||(d={})).ScriptLoaded="share_scriptsLoaded",e.CopyLinkClicked="share_copyLinkClicked",e.ShareSendClicked="share_sendClicked",e.ShareTeamsClicked="share_teamsClicked",e.ShareTeamsClickedWithContext="share_teamsClickedWithContext",e.ShareAddPeopleCompleted="share_addPeopleCompleted",e.PeoplePickerFocused="share_peoplePickerFocused",e.UIReady="share_uiReady",e.Ready="share_ready",e.Error="share_error",e.Resize="share_resize",e.NewToken="share_newToken",e.GrantAccessCompleted="share_grantAccessCompleted",e.Dismiss="share_dismiss",e.ReadyForRecipients="share_readyForRecipients",e.OutlookClicked="share_outlookClicked",e.SendRecipients="atMention_defaultRecipients",e.ManageAccessClicked="share_manageAccessClicked",e.ShareCompleted="share_completed",e.MakeVisible="share_makeVisible",e.Destruct="share_destruct",e.ResetMakeVisible="share_resetMakeVisible",e.InstantLoadReady="share_instantLoadReady",e.ShareContextInformation="share_postContextInformation",e.Started="share_started",e.LinkSettingCompleted="share_linkSettingsCompleted",e.GetToken="share_getToken",e.DocumentInformation="share_documentInformation",e.ReloadWithAuthToken="share_reloadWithAuthToken",e.SharingInfoBarInformation="share_sharingInfoBarInformation",e.SharingStoreReady="share_sharingStoreReady",e.ShareLoadResult="share_loadResult",e.ShareRefreshCookies="share_refreshCookies",e.CopyToClipboard="share_copyToClipboard",e.ShareCopySharingLinkToClipboard="share_copySharingLinkToClipboard",e.CopyToClipboardResult="share_copyToClipboardResult",e.GetShareAppsConfig="share_getShareAppsConfig",e.ShareAppsConfigResult="share_shareAppsConfigResult",e.ShareAppClicked="share_shareAppClicked",e.ShareAppClickedResult="share_shareAppClickedResult",e.GetPreviewData="share_getPreviewData",e.PreviewDataResult="share_previewDataResult",e.GetShareAsAttachmentData="share_getShareAsAttachmentData",e.ShareAsAttachmentDataResult="share_shareAsAttachmentDataResult",e.SendCopy="share_sendCopy",e.SendPdf="share_sendPdf",e.ShareClicked="share_clicked",e.CopyLinkNotificationShown="share_copyLinkNotificationShown"}
,(a,b,c)=>{var d,e;c.d(b,{a:()=>d}),(e=d||(d={})).Augloop="ms-augloop",e.Substrate="ms-substrate-search",e.Graph="ms-graph",e.SharePoint="SharePoint_MSAL",e.OCPS="ocps"}
,(a,b,c)=>{c.d(b,{a:()=>i});var d=c(390),e=c("odsp.util_126");function f(a){if(e.Ov.isActivated("BABB93B6-A527-424E-BE9D-FDAA87163C4A"))return!1;switch(a){case d.a.SPOPassword:return!e.Ov.isActivated("4D2C42D9-AD8D-4CDD-BBDE-1A59004B0D5F");case d.a.KnownString:return!e.Ov.isActivated("5881AB4E-62A3-466A-9121-4696A4C7FFAB");case d.a.QueryParam:return!e.Ov.isActivated("74E05F7C-7187-4B3C-9B48-13C1742D5BB7");case d.a.JWTOld:return e.Ov.isActivated("EBFAA43D-4287-4B42-B15E-915E6C993511");case d.a.JWT:return!e.Ov.isActivated("865C15CD-213C-4A6A-A51D-67398DCE0975");case d.a.SitePath:return!e.Ov.isActivated("ABCC634A-D509-4E2F-8DBD-72D6DDB70304");case d.a.URL:return!e.Ov.isActivated("538060DB-E344-47C6-B004-746651420C50");case d.a.URLOld:return e.Ov.isActivated("20E10301-7F7C-4806-8943-1C9E19D7EAB2");case d.a.Soap:return!e.Ov.isActivated("0EDD0E35-2E79-453E-9674-E3EAAB9CB032");case d.a.Email:return!e.Ov.isActivated("436FE24B-4602-4C6C-830B-CFF37FF73F30");case d.a.EmailOld:return e.Ov.isActivated("89E1A753-A099-48A0-B909-E830C31F9745");default:return!0}}function g(a){switch(a){case d.a.SitePath:return!e.Ov.isActivated("E51A83DC-7071-44F9-B5B7-96C4604CAE9F");case d.a.URL:return!e.Ov.isActivated("5C465AAE-218B-439A-894C-8F10019A3B0D");case d.a.Email:return!e.Ov.isActivated("0B689E10-1669-4662-A229-A7A6CDDC97A7");default:return!1}}function h(a){return"function"!=typeof a}function i(){let a;if(e.Ov.isActivated("D1A947A7-FF47-4643-936F-AA49C462EA70"))return{disable:!0};let b={warn:[],sanitize:[d.a.SPOPassword,d.a.KnownString,d.a.QueryParam,d.a.SitePath,d.a.URL,d.a.JWT,d.a.Email],parseJsonStrings:!0},c=b.sanitize?.filter(a=>h(a)&&f(a)&&!g(a))||[],i=b.sanitize?.filter(a=>h(a)&&f(a)&&g(a))||[];return{...b,sanitize:c,warn:i,shouldScanExtensionFields:e.Ov.isActivated("9BDABF72-C748-41CA-8A43-1EE2CD6C4D26"),parseJsonStrings:!e.Ov.isActivated("AD54604C-78BF-4068-B45C-67C6B7D59373"),parseArrayStrings:!e.Ov.isActivated("A7DBBB71-8A21-44E1-9888-ECFE5D5BC304"),excludedPaths:Object.keys(a={"UserInfo.Id":"32622FEC-0A09-4437-9304-7F37A3B8C3C7","#":"75E7DF52-7261-44FC-A849-3C4E4E1355EF"}).filter(b=>!e.Ov.isActivated(a[b])),skipObjectKeys:e.Ov.isActivated("F15D4019-401C-4065-9B1D-E7AFF16ABEAD"),isOptimzeSanitizeKSActive:e.Ov.isActivated("E120FBF9-6179-4A1B-B922-0A4E2660A429"),scannerOptions:{[d.a.URL]:{trustedDomains:e.Ov.isActivated("F5BB0FC8-289D-4965-8353-A6EB2135BB4E")?void 0:["res-2.df.onecdn.static.microsoft","res-1.cdn.office.net","r4.res.office365.com","js.monitor.azure.com","ajax.aspnetcdn.com"]}},isExternalScannerSupportKSActive:e.Ov.isActivated("05BD759F-D561-4F40-B83E-AD4C02F9CD12")}}}
,(a,b,c)=>{c.d(b,{a:()=>d});let d={SPOPassword:"SPOPassword",SitePath:"SitePath",URL:"URL",URLOld:"URLOld",Soap:"Soap",KnownString:"KnownString",QueryParam:"QueryParam",JWT:"JWT",JWTOld:"JWTOld",JWTInDepth:"JWTInDepth",Email:"Email",EmailOld:"EmailOld",CustomString:"CustomString"}}
,,,,,(a,b,c)=>{c.d(b,{a:()=>h});var d=c("react-lib"),e=c(67),f=c("fui.util_178"),g=c("fui.core_517");function h(a,b,c=["styles","theme"]){let i=(0,d.useContext)(e.a),j=f.K7.getSettings(c,a,i.customizations),k={};if(j.styles&&"function"==typeof j.styles&&(j.styles=j.styles({...j,...b})),j.styles){if(k.default!==j.styles||k.component!==b?.styles){let a=(0,g.Akq)(j.styles,b?.styles);k.default=j.styles,k.component=b?.styles,k.merged=a}return{...j,...b,styles:k.merged}}return{...j,...b}}}
,(a,b,c)=>{c.d(b,{a:()=>i});var d=c("react-lib"),e=c("fui.core_517"),f=c(725),g=c(731);let h=(0,e.n94)({lineHeightRemove:{lineHeight:""},backgroundRemove:{backgroundColor:""},compatStyles:{display:"contents",color:"inherit",backgroundColor:"inherit",textAlign:"inherit",fontFamily:"inherit",fontSize:"inherit",fontWeight:"inherit",lineHeight:"inherit"}}),i=d.forwardRef(function(a,b){let c=h(),{className:i,configOverride:j,children:k,applyStylesToPortals:l,...m}=a;j?.compat===!0&&(l=l??!1);let n="";return n=d.useMemo(()=>{let a;return(0,e.tlm)(i,...(a=[],j?.lineHeight==="remove"&&a.push(c.lineHeightRemove),j?.background==="remove"&&a.push(c.backgroundRemove),j?.compat===!0&&a.push(c.compatStyles),a))},[j,i]),d.createElement(f.a,{...m,className:n,applyStylesToPortals:l,ref:b,...j?.compat===!0?{"data-is-visible":!0}:{}},d.createElement(g.a,null,k))});i.displayName="FluentProviderWithOverrides"}
,,(a,b,c)=>{c.d(b,{a:()=>f});var d=c("fui.core_517"),e=c(187);let f=a=>({...(0,d.EF5)(a),vivaConnectionsSoftBackground:a.isInverted?a.palette.themeLight:a.palette.themeLighterAlt,semanticPrimaryButtonText:a.semanticColors.primaryButtonText,semanticPrimaryButtonTextHovered:a.semanticColors.primaryButtonTextHovered,semanticPrimaryButtonBackgroundHovered:a.semanticColors.primaryButtonBackgroundHovered,semanticButtonBackgroundDisabled:a.semanticColors.buttonBackgroundDisabled,semanticPrimaryButtonBackgroundDisabled:a.semanticColors.primaryButtonBackgroundDisabled,semanticButtonTextDisabled:a.semanticColors.buttonTextDisabled,semanticDisabledBackground:a.semanticColors.disabledBackground,semanticButtonTextHovered:a.semanticColors.buttonTextHovered,semanticButtonBackgroundHovered:a.semanticColors.buttonBackgroundHovered,semanticPrimaryButtonBackgroundPressed:a.semanticColors.primaryButtonBackgroundPressed,semanticPrimaryButtonTextPressed:a.semanticColors.primaryButtonTextPressed,semanticDisabledText:a.semanticColors.disabledText,semanticActionLink:a.semanticColors.actionLink,semanticBodyText:a.semanticColors.bodyText,semanticDisabledBodyText:a.semanticColors.disabledBodyText,semanticDisabledBodySubtext:a.semanticColors.disabledBodySubtext,semanticInputBackground:a.semanticColors.inputBackground,semanticInputText:a.semanticColors.inputText,semanticPrimaryButtonTextDisabled:a.semanticColors.primaryButtonTextDisabled,semanticPrimaryButtonBackground:a.semanticColors.primaryButtonBackground,semanticButtonBackground:a.semanticColors.buttonBackground,semanticButtonBorder:a.semanticColors.buttonBorder,semanticButtonBackgroundPressed:a.semanticColors.buttonBackgroundPressed,semanticErrorText:a.semanticColors.errorText,colorNeutralForeground4:a.semanticColors.inputPlaceholderText,...(0,e.v)()?{colorStatusDangerBackground1:a.semanticColors.errorBackground,colorStatusWarningBackground1:a.semanticColors.warningBackground,colorStatusSuccessBackground1:a.semanticColors.successBackground}:{}})}
,(a,b,c)=>{c.d(b,{a:()=>d});let d={FluentUIV9ShimOverallControl:60077,FluentUIV9ShimDefaultButton:60337,FluentUIV9ShimPrimaryButton:60344,FluentUIV9ShimIconButton:60355,FluentUIV9ShimActionButton:60356,FluentUIV9ShimImage:60357,FluentUIV9ShimToggle:60461,FluentUIV9ShimCommandBarButton:60466,FluentUIV9ShimCommandBar:60480,FluentUIV9ShimCommandButton:60501,FluentUIV9ShimTooltipHost:60634,FluentUIV9ShimTooltip:60633,FluentUIV9ShimLink:60405,FluentUIV9ShimStack:60413,FluentUIV9ShimCheckbox:60414,FluentUIV9ShimDialog:60426,FluentUIV9ShimChoiceGroup:60415,FluentUIV9ShimPersona:60419,FluentUIV9ShimFacepile:60569,FluentUIV9ShimPivot:60105,FluentUIV9ShimContextualMenu:60556,FluentUIV9ShimOverlay:60547,FluentUIV9ShimOverflowSet:60555,FluentUIV9ShimIcon:60446,FluentUIV9ShimSpinner:60450,FluentUIV9ShimSlider:60454,FluentUIV9ShimLayer:60460,FluentUIV9ShimText:60566,FluentUIV9ShimCustomizer:60650,FluentUIV9ShimThemeProvider:60567,FluentUIV9ShimSpinButton:60557,FluentUIV9ShimLabel:60382,FluentUIV9ShimSeparator:60384,FluentUIV9ShimCompoundButton:60540,FluentUIV9ShimTextField:61154,FluentUIV9ShimShimmer:61344,FluentUIV9ShimFocusTrapZone:60457,FluentUIV9ShimFocusZone:61362,FluentUIV9ShimPanel:61363,FluentUIV9ShimProgressIndicator:61364,FluentUIV9ShimDatePicker:61369,FluentUIV9ShimMessageBar:61378,FluentUIV9ShimDropdown:61379,FluentUIV9ShimCallout:61380,FluentUIV9ShimModal:61381,FluentUIV9ShimLayoutGroup:61383,FluentUIV9ShimComboBox:61384,FluentUIV9ShimCard:61385}}
,(a,b,c)=>{c.d(b,{a:()=>d});let d=c("react-lib").createContext(!1)}
,,,,,,,,,(a,b,c)=>{c.d(b,{a:()=>W,b:()=>P,c:()=>N,d:()=>M,e:()=>X,f:()=>V,g:()=>S,h:()=>U,i:()=>I,j:()=>H,k:()=>R,l:()=>L,m:()=>K,n:()=>O,o:()=>Q,p:()=>G,q:()=>T,r:()=>J});var d=c("odsp.util_126"),e=c(106),f=c(261),g=c(456);let h={ODB:62043};function i(){return d.lU.isFeatureEnabled(h)}let j=!1;function k(a){let b=l("Error"),c=(0,e.a)();c.availability.customCopilotEAPCheckErrorType=a,window.localStorage?.setItem(b,c.availability.customCopilotEAPCheckErrorType)}function l(a){return`UserInEAPGroup_${a}`}var m=c(39);let n={ODB:61346},o={ODB:61866},p={ODB:61991},q={ODB:62020},r={ODB:62337},s={ODB:62386},t={ODB:62431},u={ODB:60872},v={ODB:62460},w={ODB:62563},x={ODB:62591},y={ODB:61993},z={ODB:62713},A={ODB:61698},B={ODB:62716},C={ODB:61574,ODC:!1},D={ODB:62720,ODC:!1},E={ODB:62796,ODC:!1},F={ODB:62727,ODC:!1};function G(a){var b;let f,{pageContextForEAPCheck:h}=a,o=(0,e.a)();if(!d.Ov.isActivated("87a98255-e313-4151-a344-a023c75eaadb","10/18/2024","isgulati - enable rcd check before enabling copilot")&&h?.IsRestrictedContentDiscoverabilityEnabled)return o.availability.isRCDEnabled=!0,!1;if(!d.Ov.isActivated("99f050db-9dd7-4098-8772-9cee7e595faf","10/03/2024","isgulati - enable site check before enabling copilot")&&(f=!0,d.Ov.isActivated("44d3c708-0bb8-444d-8457-4b05f3853ba7")||d.lU.isFeatureEnabled(n)||!h||(f=0===(0,m.c)(90214,h)),(0,e.a)().availability.isSiteAllowed=f,!f))return o.availability.isSiteAllowed=!1,!1;if((0,g.a)())return!0;if(i()){if(o.availability.customCopilotEAPCheckEnabled=!0,!h||!h.aadUserId)return k(h?"MissingAADUserId":"MissingPageContext"),!1;o.availability.aadUserId=h.aadUserId;let d=(b=h.aadUserId,window.localStorage?.getItem(l(b))==="true");return o.availability.isUserInEAP=d,(function(a,b){if(!i()||j||!a||!a.aadUserId)return Promise.resolve();let d=l(a.aadUserId);return j=!0,c.e(12).then(c.bind(c,791)).then(c=>c.isCurrentUserInEAPGroup(a,b).then(a=>{window.localStorage?.setItem(d,a.toString())}))})(h,a.getAuthToken).catch(()=>{k("CacheRefreshError")}),d}return!1}function H(){return d.lU.isFeatureEnabled(o)}function I(){if(d.lU.isFeatureEnabled(p))return!0;let a=1===(0,f.a)(90005);return!d.Ov.isActivated("7db74352-7d19-47c8-938d-fd88e4519e7b")&&a}function J(){return d.lU.isFeatureEnabled(q)}function K(){return d.lU.isFeatureEnabled(r)}function L(){return d.lU.isFeatureEnabled(s)}function M(){return d.lU.isFeatureEnabled(C)}function N(){return d.lU.isFeatureEnabled(t)}function O(){return!d.Ov.isActivated("6dcbfb3f-048a-4997-a888-bf80071d36b5")}function P(){return d.lU.isFeatureEnabled(u)}function Q(){return d.lU.isFeatureEnabled(v)}function R(){return d.lU.isFeatureEnabled(w)}function S(){return d.lU.isFeatureEnabled(x)}function T(){return d.lU.isFeatureEnabled(y)}function U(){return d.lU.isFeatureEnabled(F)}function V(){return d.lU.isFeatureEnabled(D)}function W(a){return d.lU.isEcsFeatureEnabled({ODBECS:"EnableBizchatInAgentBuilder"})&&("ODB"===a?d.lU.isFeatureEnabled(z)&&d.lU.isFeatureEnabled(A):"SPDocLib"===a&&d.lU.isFeatureEnabled(B)&&d.lU.isFeatureEnabled(A))}function X(){return d.lU.isFeatureEnabled(E)}}
,,,(a,b,c)=>{c.d(b,{a:()=>d});let d={none:0,overwrite:1,rename:2,replace:3,merge:4}}
,,,,(a,b,c)=>{c.d(b,{a:()=>f});let d=c(138).a.env;function e(){switch(d&&d.toLowerCase()){case"soak3":return 4;case"soak2":return 3;case"dev":return 2;case"df":return 1;default:return 0}}function f(a="v1.0"){let b=function(){switch(e()){case 3:return"soak2.test.";case 4:return"soak3.test.";case 2:return"newapi.dev.";default:return""}}(),c=2===e()?"storage.live-int.com":"api.onedrive.com";return`https://${b}${c}/${a}`}}
,,(a,b,c)=>{c.d(b,{a:()=>h,b:()=>i});var d,e=c(138),f=c(215);let g=c("odsp.util_126").Ov.isActivated("27B2AAD3-81D5-4366-8DC5-E8CCEAA8F883","12/06/2023"),{isCurrentViewerUnAuth:h,viewerId:i,loggedInUserDriveId:j}="UnAuth"!==(d=e.a?.hcid)&&d?{viewerId:d.toUpperCase(),isCurrentViewerUnAuth:!1,loggedInUserDriveId:(0,f.a)(d)}:{viewerId:g?d||"UnAuth":"",isCurrentViewerUnAuth:!0,loggedInUserDriveId:void 0}}
,,,(a,b,c)=>{c.d(b,{a:()=>p,b:()=>o});var d=c("fui.util_178"),e=c("odsp.util_126"),f=c(39);let g=!e.Ov.isActivated("63D4623B-B40E-4995-B75E-A08D739EB318"),h=e.lU.isFeatureEnabled({ODB:62741}),i=window&&window._spPageContextInfo,j=g&&i&&(0,f.c)(90343,i)>0,k=h||j?"assets/item-types-experiment/":"assets/item-types/",l=d.fG.replace(/(fabric-cdn-prod_)[\d.]+/,"$120251008.001");function m(){return e.Ov.isActivated("f057c969-5203-4bcb-8442-e6a5421ac619")}function n(){return"assets/item-types/"}function o(a){let b="/"===a.charAt(a.length-1)?a:`${a}/`;return`${b}${!m()?n():k}`}function p(a=16,b,c,g=d.fG){let h,i="number"==typeof a?`${a}`:a,j="/"===i.charAt(i.length-1)?i:`${i}/`;return`${!m()?function(a=d.fG){return`${!m()?`${a}/${n()}`:`${d.fG}/${k}`}`}((h=window&&window._spPageContextInfo,!e.Ov.isActivated("63D4623B-B40E-4995-B75E-A08D739EB318")&&h&&(0,f.c)(90251,h)>0||e.lU.isFeatureEnabled({ODB:62741}))?g:l):`${d.fG}/${k}`}${j}${b}.${c}`}}
,(a,b,c)=>{c.d(b,{a:()=>m});var d=c("odsp.util_126");let e=!d.Ov.isActivated("67B85667-0FFB-484F-8DEB-E48ABCE58105");var f=c(215),g=c(47),h=c(41);let i=d.Ov.isActivated("744BB1FD-B6C6-4F04-BECC-4D2F264F2924"),j=d.Ov.isActivated("8ADBDC81-BF91-49BE-866A-82B6636C16B0"),k=i?3:2,l=new g.a("migrationStore",j?h.a.none:h.a.local);function m(a){if(!a||e&&"me"===a)return!1;if(a.indexOf("b!")>=0)return!0;a=(0,f.a)(a);let b=l.getValue(a);if(b){if(b.version===k)return b.isMigrated;l.remove(a)}return!1}d.Ov.isActivated("cf537280-4f8b-431e-bb4a-a82b37ca860d","08/21/2024","No Undo on migrated oneUp odc")}
,,,(a,b,c)=>{var d,e,f,g;c.d(b,{a:()=>d,b:()=>e}),(f=d||(d={})).Adobe="adobe",f.Docusign="docusign",(g=e||(e={})).Adobe="AdobeSign",g.Docusign="DocuSign"}
,,,,(a,b,c)=>{c.d(b,{a:()=>f,b:()=>e});var d=c(138);let e=d.a?.mpcDomain||"https://my.microsoftpersonalcontent.com";function f(a="v2.0"){return`${e}/_api/${a}`}}
,,,(a,b,c)=>{c.d(b,{a:()=>f,b:()=>e});var d=c("odsp.util_126");let e={unknown:"Unknown",spServiceResponse:"SPServiceResponse"};class f extends d.lM{constructor(a){const b=a.errorData,c=a.innerError instanceof f&&a.innerError.errorData,d=a.errorData||c||{status:0},{message:e,correlationId:g,code:h,...i}=d,j="object"==typeof e?e?JSON.stringify(e):`${e}`:e,k=b&&b.codes||{order:[],map:{}};if(c&&c.codes)for(const a of c.codes.order)k.map[a]||(k.order.push(a),k.map[a]=c.codes.map[a]);for(const b of(super({..."string"==typeof g?{correlationId:g}:{},..."string"==typeof h?{code:h}:{},..."string"==typeof j?{message:j}:{},...a,extraData:{...a.extraData||{},hasAuthChallenge:!!d.authenticate,status:d.status,infected:d.infected,groupThrottle:d.groupThrottle,statusText:d.statusText}}),this.name="GetDataError",this.codes=k,this.errorData=d,Object.keys(i)))this[b]=i[b]}}}
,,,(a,b,c)=>{c.d(b,{a:()=>i});var d=c("fui.util_178"),e=c(48),f=c(9);class g{enqueue(a){let b;if(this._running<this.concurrency)this._running++,(b=a()).then(this._promiseComplete,this._promiseComplete);else{let c={callback:a,signal:null,canceled:!1,result:null};c.signal=new e.b(()=>{c.canceled=!0,f.c.is(c.result)&&c.result.cancel()}),this._queue.push(c),b=c.signal.getPromise()}return f.c.resolve(b)}_promiseComplete(){if(this._running--,this._running<this.concurrency&&this._queue.length){let a=this._queue.shift();for(;a&&a.canceled;)a=this._queue.length?this._queue.shift():null;a&&(this._running++,a.result=a.callback(),a.result.then(b=>{a.signal.complete(b),this._promiseComplete()},b=>{a.signal.error(b),this._promiseComplete()}))}}constructor(a){this.concurrency=a||1,this._running=0,this._queue=[],this._promiseComplete=this._promiseComplete.bind(this)}}let h={enqueue:a=>f.a.resolve(a())};class i{throttle(a){return this._uploadQueue.enqueue(()=>(!this._isReady&&this._uploaderCount>=this._throttleBarrier&&(this._uploaderCount=0,this._isReady=!0),this._batchStartTime&&this._uploaderCount>=this._maxUploads)?this._throttleUploader(a):(this._isReady&&!this._batchStartTime&&(this._batchStartTime=Date.now()),this._startUploader(a)))}addThrottleTimer(a){return this._isReady=!0,this._setTimeout(a),this._addUploaderCallback(()=>f.a.resolve())}dispose(){this._timeout&&(this._async.clearTimeout(this._timeout),this._timeout=void 0),this._async.dispose()}_startUploader(a){return this._uploaderCount+=1,a()}_addUploaderCallback(a){let b=new e.b;return this._throttledSignals.push(b),b.getPromise().then(()=>this._startUploader(a))}_throttleUploader(a){if(this._timeout)return this._addUploaderCallback(a);if(this._batchStartTime){let b=1e3-(Date.now()-this._batchStartTime);if(b>0)return this._setTimeout(b),this._addUploaderCallback(a)}return this._uploaderCount=0,this._batchStartTime=Date.now(),this._startUploader(a)}_setTimeout(a){this._timeout&&(this._async.clearTimeout(this._timeout),this._timeout=void 0),this._timeout=this._async.setTimeout(()=>{for(let a of(this._timeout=void 0,this._uploaderCount=0,this._batchStartTime=Date.now(),this._throttledSignals))a.complete();this._throttledSignals=[]},a)}constructor(a={}){this._async=new d.DS,this._uploaderCount=0,this._throttledSignals=[];const{maxParallelUploads:b=3,maxUploadsPerSecond:c=8,throttleBarrier:e=1e3}=a;this._isReady=!1,this._uploadQueue=b===1/0?h:new g(b),this._maxUploads=c,this._throttleBarrier=e}}}
,,,,,(a,b,c)=>{c.d(b,{a:()=>d});let d=(0,c(149).b)({preferPhotos:!1})}
,,,(a,b,c)=>{c.d(b,{a:()=>e});var d=c("odsp.util_126");function e(a){try{if(!a)return;if("string"==typeof a)return(0,d.ve)(a,!1);if((0,d.oI)(a))return a;if(a.message){if(a.loggableMessage)return a.loggableMessage;return(0,d.ve)(a.message,!1)}if(a.name)return(0,d.ve)(a.name,!0);if(a.description)return(0,d.ve)(a.description,!1)}catch{}}}
,(a,b,c)=>{c.d(b,{a:()=>h});var d={};function e(a,b){let c=b?{High:0x7fffffff,Low:0x7fffffff}:{High:0,Low:0},d=a&&a.match(/^(0x)?([0-9a-f]*)$/i);if(d){let b,e;(a=(a=d[2]||"0").slice(-16)).length<=8?(b=0,e=parseInt(a,16)):(b=parseInt(a.slice(0,-8),16),e=parseInt(a.slice(-8),16)),isNaN(b)||isNaN(e)||(c.High=b,c.Low=e)}return c}function f(a){return(a||[]).reduce((a,b)=>({High:a.High|b.High,Low:a.Low|b.Low}),{High:0,Low:0})}function g(a){return a&&a.length?a.reduce((a,b)=>({High:a.High&b.High,Low:a.Low&b.Low})):{High:0,Low:0}}c.r(d),c.d(d,{and:()=>g,fromHexString:()=>e,or:()=>f});let h=d}
,,,,,,,,,,,(a,b,c)=>{let d;c.d(b,{a:()=>aa});var e=c("odsp.util_126"),f=c(48),g=c(96),h=c(21),i=c(0),j=c(6),k=c(256);let l="x-ms-diagnostics",m=/(\d+)(?:;reason="([^"]+?)")?(?:;category="([^"]+?)")?(?:;error_category="([^"]+?)")?/,n=/^User resolution failure: (\S+)(?:\s+(.*))?/;var o=c(257),p=c(432),q=c(520),r=c(16),s=c(154);let t=e.Ov.isActivated("9FC70815-FA7D-41C6-AA63-01B313DB2DEB"),u="WWW-Authenticate",v="X-SubStatusCode",w="X-SPO-ErrorCode",x="X-MSDAVEXT_Error",y="SPSQLQueryCount",z="x-virus-infected",A="Reauthid";class B{getSourceUrl(){return this._url}getAllResponseHeaders(){return this._request.getAllResponseHeaders()}getCorrelationId(){return this.getResponseHeader("SPRequestGuid")}getServiceWorkerDataSourceHeader(){return this.getResponseHeader("X-SERVICEWORKER-DATA-SOURCE")}getStatus(){let a=-1;try{a=this._request.status}catch(a){}return"number"==typeof a?a:-1}getAuthenticationRedirect(){return this.getResponseHeader("X-Forms_Based_Auth_Required")}getResponseType(){return this._request.responseType}getResponseText(){return this._request.responseType&&"text"!==this._request.responseType?this._request.response:this._request.responseText}getErrorResponseText(){return"blob"===this._request.responseType?{status:this._request.status,statusText:this._request.statusText,infected:!!this.getResponseHeader(z),authenticate:this.getResponseHeader(u)}:this.getResponseText()}parseError(){let a=new f.b;return this._request.responseType&&"text"!==this._request.responseType?"blob"===this._request.responseType?(function(a){let b,c=new f.b,d=()=>{if(b.result){let a;try{a=JSON.parse(b.result),c.complete(a)}catch(a){c.complete({message:"Unable to parse blob result."})}}},e=()=>{c.complete({message:"Unable to read blob error response."})};try{(b=new FileReader).addEventListener("load",d),b.addEventListener("error",e),b.readAsText(a)}catch(a){e()}return c.getPromise().then(a=>(b&&(b.removeEventListener("load",d),b.removeEventListener("error",e)),a))})(this._request.response).then(b=>{let c={data:b,status:this.getStatus(),statusText:this._request.statusText,infected:!!this.getResponseHeader(z),authenticate:this.getResponseHeader(u)};a.complete(c)}):a.complete(this._request.response):a.complete(this._request.responseText),a.getPromise()}getValue(a){let b;switch(a){case B.DataValueKeys.SourceURL:b=this.getSourceUrl();break;case B.DataValueKeys.CorrelationId:b=this.getCorrelationId();break;case B.DataValueKeys.Status:b=this.getStatus();break;case B.DataValueKeys.AuthenticationRedirect:b=this.getAuthenticationRedirect();break;case B.DataValueKeys.ResponseText:b=this.getResponseText();break;case B.DataValueKeys.ErrorResponseText:b=this.getErrorResponseText()}return b}getRedirectUrl(){if(this._isCanaryRequest)if(403!==this.getStatus())return this.getAccessDeniedRedirectUrl();else if(this.shouldRedirectToErrorCustomPromptLocation())return this.getRedirectToErrorCustomPromptLocation();else return this.getRedirectLoginPageUrl();if(403===this.getStatus()||401===this.getStatus())if(this.shouldRedirectToErrorCustomPromptLocation())return this.getRedirectToErrorCustomPromptLocation();else return this.getRedirectLoginPageUrl()}getRedirectLoginPageUrl(){let a,b=this.getAuthenticationRedirect();if(b){let c=new r.b(b);c.setQueryParameter("ReturnUrl",s.b(window.location.href)),a=c.toString()}else if(!e.Ov.isActivated("E01ED707-3C9F-4CD5-8ADF-8A5484D4A861","04/18/2023","Construct redirectUrl targetting Default.aspx")){let b=e.Ov.isActivated("46AD8143-4179-406B-83E3-582A1DD3F543","07/21/2023","Use location to determine redirectUrl, in case of cross site calls")?new j.a(this._url).authority:new j.a(window.location.href).authority;if(b){let c=`${window.location.pathname}${window.location.search}`,d=t?location.href:c;a=`${b}/_forms/Default.aspx`+(d?`?ReturnUrl=${encodeURIComponent(d)}`:"")}let c=this.getResponseHeader(A);if(c){let b=new URL(location.href);b.searchParams.append("reauthid",c),a=b.toString()}}return a}getAccessDeniedRedirectUrl(){let a;if(this._webAbsoluteUrl){let b=this._webAbsoluteUrl+"/_layouts/15/AccessDenied.aspx";if(b){let c=new r.b(b);c.setQueryParameter("Source",s.b(window.location.href)),c.setQueryParameter("Type","list"),c.setQueryParameter("correlation",s.b(this.getCorrelationId())),a=c.toString()}}return a}getRedirectToErrorCustomPromptLocation(){let a=this.getResponseHeader("X-SPO-ErrorCustomPromptLocation"),b=new r.b(a);return b.setQueryParameter("ReturnUrl",window.location.href),b.toString()}shouldRedirectToErrorCustomPromptLocation(){let a=this.getResponseHeader(w),b=this.getResponseHeader("sharepointerror");return"9.3"===a||"-2130575129"===b}getResponseHeadersDictionary(){let a={},b=this.getAllResponseHeaders();if(b){let c=b.trim().split(/[\r\n]+/);c&&c.length>0&&c.forEach(function(b){let c=b.split(": "),d=c.shift(),e=c.join(": ");a[d]=e})}return this.getResponseHeadersDictionary=()=>a,a}getResponseHeader(a){let b=this.getResponseHeadersDictionary();return b[a.toLowerCase()]||b[a]||this._request.getResponseHeader(a)}getHeaderNumberValue(a){let b=Number(this.getResponseHeader(a));return isNaN(b)?void 0:b}constructor(a,b,c){this._request=a,this._url=b,this._webAbsoluteUrl=c&&c.webAbsoluteUrl,this._isCanaryRequest=c&&c.isCanaryRequest}}B.DataValueKeys={SourceURL:"SourceUrl",CorrelationId:"CorrelationId",Status:"Status",AuthenticationRedirect:"AuthenticationRedirect",ResponseText:"ResponseText",ErrorResponseText:"ErrorResponseText",GroupThrottle:"GroupThrottle"};var C=c(80);let D=e.Ov.isActivated("94486333-390c-4bb2-9cbf-371c7042f19a"),E=e.lU.isFeatureEnabled({ODB:60886}),F=e.Ov.isActivated("6bd90ef4-625b-47e1-8b58-0b2cc41ec5d0");class G{static _isValidFormDigest(a){return!!(a&&a.serverTime&&Date.now()-new Date(a.serverTime).getTime()<(a.formDigestTimeoutSeconds-60)*1e3)}dispose(){this._scope.dispose()}abort(){if(this._currentRequest){let a=this._currentRequest;a.isCancelled=!0,a.abort(),this._currentRequest=void 0}}isRequestActive(){return!!this._currentRequest}getServerDataFromUrl(a){let{url:b,successCallback:c,failureCallback:d,uploadProgressCallback:e,additionalPostData:f,isRest:g=!0,method:h="POST",withCredentials:i,additionalHeaders:j,contentType:k,noRedirect:l,responseType:m,needsRequestDigest:n=this._needsRequestDigest}=a,o=new Date().toISOString(),p=new XMLHttpRequest;p.open(h,b,!0),"boolean"==typeof i&&(p.withCredentials=i),m&&(p.responseType=m);let q=f instanceof FormData;k?p.setRequestHeader("Content-Type",k):q||(g?p.setRequestHeader("Content-Type","application/json;odata=verbose"):p.setRequestHeader("Content-Type","application/x-www-form-urlencoded"));let r=!1;if(j)for(let a in j)a&&(p.setRequestHeader(a,j[a]),"accept"===a.toLowerCase()&&(r=!0));r||p.setRequestHeader("accept","application/json;odata=verbose"),this._currentRequest=p;let s=a=>{n&&a&&p.setRequestHeader("x-requestdigest",a),this._events.on(p,"readystatechange",()=>{this._onReadyStateChange(p,b,c,d,!!l,o)}),e&&p.upload&&this._events.on(p.upload,"progress",a=>{e(a)}),p.send(f)};n?this._ensureRequestDigest(s,d):s()}ensureRequestDigest(a,b){this._ensureRequestDigest(a,b)}_ensureRequestDigest(a,b){let c=G._formDigests[this._webServerRelativeUrl];!this._alwaysGetDigest&&G._isValidFormDigest(c)?a(c.formDigestValue):this._ensureRequestDigestWorker(a,b)}_ensureRequestDigestWorker(a,b){let c=new Date,d=new G({needsRequestDigest:!1,webServerRelativeUrl:this._webServerRelativeUrl,webUrl:void 0});a||(d._requestCanaryForAuth=!0);let f=this._webAbsoluteUrl||this._webServerRelativeUrl;"string"==typeof f?(G._requestDigestPromise||(G._requestDigestPromise=new Promise((a,e)=>{let g=b=>{let d=JSON.parse(b.getResponseText()).d.GetContextWebInformation;G._formDigests[this._webServerRelativeUrl]={serverTime:c.toISOString(),formDigestValue:d.FormDigestValue,formDigestTimeoutSeconds:d.FormDigestTimeoutSeconds-60,updateFormDigestPageLoaded:new Date},a(G._formDigests[this._webServerRelativeUrl].formDigestValue),G._requestDigestPromise=void 0};d.getServerDataFromUrl({url:r.b.concatenate(f,"/_api/contextinfo"),successCallback:g,failureCallback:(a,b)=>{e({serverData:a,error:b}),G._requestDigestPromise=void 0},method:"POST",noRedirect:!!b})})),G._requestDigestPromise.then(b=>(a&&a(b),b)).catch(({serverData:c,error:d})=>{a?a(void 0):b&&b(c,d)})):b&&b(void 0,new e.lM({code:q.c,isExpected:!1}))}_onReadyStateChange(a,b,c,d,f,g){if(4===a.readyState)if(this._currentRequest=void 0,this._events.off(a),a.upload&&this._events.off(a.upload),a&&a.isCancelled)d(void 0,new e.CE);else if(!function(a){try{if(4===a.readyState&&(void 0===a.status||0===a.status))return!1}catch(a){return!1}return!0}(a))d(void 0,new e.lM({code:q.d,isExpected:!0}));else{let e=new B(a,b,{webAbsoluteUrl:this._webAbsoluteUrl||this._webServerRelativeUrl,isCanaryRequest:this._requestCanaryForAuth}),g=e.getStatus(),h=!f&&e.shouldRedirectToErrorCustomPromptLocation();if(this._requestCanaryForAuth){if(this._requestCanaryForAuth=!1,403===g){let a=e.getRedirectLoginPageUrl();try{h?window.location.href=e.getRedirectToErrorCustomPromptLocation():d(e)}catch(a){}a&&!f&&(window.location.href=a)}else{let a=e.getAccessDeniedRedirectUrl();try{d(e)}catch(a){}a&&!f&&(this._engagement&&this._engagement.logData({name:"AccessDeniedRedirect",isIntentional:!1,extraData:{originalOperation:this._operationName||""}}),window.location.href=a)}return}if(200===g||201===g||204===g||E&&!D&&202===g)return void c(e);if(403===g){G._requestDigestPromise=void 0,f?this._ensureRequestDigestWorker(void 0,(a,b)=>d(e,b)):h?window.location.href=e.getRedirectToErrorCustomPromptLocation():F?this._ensureRequestDigestWorker():this._ensureRequestDigestWorker(void 0,(a,b)=>d(e,b));return}401===g&&h&&(window.location.href=e.getRedirectToErrorCustomPromptLocation()),d(e)}}_tryLoadDigest(a){if(G._isValidFormDigest(a)){G._formDigests[this._webServerRelativeUrl]=a;return}let b=G._formDigests[this._webServerRelativeUrl];G._isValidFormDigest(a)&&(!G._isValidFormDigest(b)||b&&new Date(b.serverTime).getTime()<new Date(a.serverTime).getTime())&&(G._formDigests[this._webServerRelativeUrl]=a)}constructor(a={}){this._scope=new e.XW,this._events=this._scope.attach(new C.a(this));const b=a.webAbsoluteUrl||a.webUrl;this._webServerRelativeUrl=a.webServerRelativeUrl||b&&new r.b(b).getPath(),"/"===this._webServerRelativeUrl&&(this._webServerRelativeUrl=""),this._alwaysGetDigest=a.alwaysGetDigest??!1,this._needsRequestDigest=!1!==a.needsRequestDigest,this._needsRequestDigest&&this._tryLoadDigest(a.formDigest),this._requestCanaryForAuth=!1,this._engagement=a.engagement,this._operationName=a.operationName}}G._formDigests={},G._requestDigestPromise=void 0;var H=c(226),I=c(9);function J(a){let{options:{url:b,authToken:c,telemetryHandler:d,useExactAuthToken:f,method:g,additionalHeaders:h},dataSyncClient:i,aadUserId:j,getData:k}=a,l=()=>k({url:b,telemetryHandler:d,authToken:c,useExactAuthToken:f});return e.Ov.isActivated("26fb0edf-b3af-42db-b8ea-2858c7eacfe0")&&!j?l():I.c.resolve(i).then(a=>{let c;return a?(c=(0,H.a)(a,d),a.getData({url:b,method:g,additionalHeaders:h},({endpoint:a,headers:b,onComplete:d})=>k({url:a.url,authToken:a.authToken,telemetryHandler:b=>c(b,a,d),useExactAuthToken:!0,additionalHeaders:b}),l)):l()})}var K=c(35),L=c(259);let M=e.Ov.isActivated("8871DEAD-6482-4778-A3AB-0A964E21F31E");function N(a){let b,{options:c,webAbsoluteUrl:d,apiEvent:f,tokenProvider:h,getData:i,noRedirect:j,qosName:k}=a,{url:l,disallowSelfIssuedToken:m,disallowCookies:n}=c,p=(0,o.a)(l),q=(a,b)=>{if(!h.getAuthToken)return I.c.resolve({authToken:void 0});let c=new f({name:`${k}.getAuthToken${b?".retry":""}`,url:p});return I.c.resolve(h.getAuthToken(a)).then(a=>(c.end({resultType:g.b.Success,resultCode:a?.authToken?"tokenAuth":"cookieAuth",...a?{extraData:{AuthCorrelationId:a?.correlationId,AuthExpiration:a?.expiresOn}}:{}}),a)).catch(a=>(c.end((0,K.a)(a)),I.c.reject(a)))},r=(a,b)=>{if(!h.getFormDigest)return I.c.resolve(void 0);let c=new f({name:`${k}.getFormDigest${b?".retry":""}`,url:p});return I.c.resolve(h.getFormDigest(a)).then(a=>(c.end({resultType:g.b.Success,resultCode:a?"newDigest":"sameDigest"}),a)).catch(a=>(c.end((0,K.a)(a)),I.c.reject(a)))};if(!q&&!r)return i({url:l});let s={url:l,webAbsoluteUrl:d,claimsChallenge:c.claimsChallenge,disallowCookies:n,disallowSelfIssuedToken:m,apiQosName:k,noRedirect:j},t={url:l,webAbsoluteUrl:d,claimsChallenge:c.claimsChallenge,apiQosName:k,noRedirect:j},u=0,w=()=>u>3?b?I.c.reject(b):I.c.reject(new e.lM({code:"TooManyReauthAttempts"})):(u++,q(s,!1).then(a=>a?.authToken?a.authToken===s.expiration?.authToken||a.authToken===s.claimsChallenge?.authToken?b?I.c.reject(b):I.c.reject(new e.lM({code:"ReauthProducedRepeatToken"})):a:r(t,!1).then(b=>a)).then(a=>{if(a?.authToken&&d&&(e.Ov.isActivated("BCE56589-7ADA-489E-B936-97BC6F63C8CA")||"/"!==l[0])&&!(0,L.a)(l,encodeURI(d)))throw new e.lM({code:"TargetUrlDoesNotBeginWithWebAbsoluteUrl"});return i({url:l,authToken:M?a?.authToken:a,qosExtraData:{...a?{AuthCorrelationId:a.correlationId,AuthExpiration:a.expiresOn}:{}}}).catch(c=>{let d,e,f;if(b=c,(f=c?.authenticate)&&f.slice(0,O.length)===O&&f.indexOf('error="insufficient_claims"')>-1)d={claimsChallenge:{authToken:a?.authToken,claims:P(c),error:c}},e={claimsChallenge:{claims:P(c),reauthid:c.reauthid,error:c}};else{let b,f,g,h;if(b=c?.code,f=c?.status,g=c?.codes,h=g?.map?.[v]?.code,!("3000002,invalid_client"===b||"10013"===b||(401===f||"16"===h)&&"917656"===b||c?.authenticate))return I.c.reject(c);d={expiration:{authToken:a?.authToken,error:c}},e={expiration:{error:c}}}return s={...s,...d},t={...t,...e},w()})}));return w()}let O="Bearer";function P(a){let b=a.authenticate,c='claims="';if(b){let a=b.indexOf(c);if(a>-1){let d=b.indexOf('"',a+c.length);if(d>-1){let f=b.slice(a+c.length,d);return e.Ov.isActivated("93E9F77D-7B3B-4760-B58F-1154E9E530ED","06/02/2022","Decode claims from base64")?f:atob(f)}}}}var Q=c(210),R=c(241);let S=e.lU.isFeatureEnabled({ODB:62073});try{d=window?.UASContext?.workloadExtension?.toLowerCase().startsWith("/sharepoint")??!1}catch(a){d=!1}let T=d;var U=c(143);let V=e.Ov.isActivated("937A3141-0674-4F3C-B6F6-AACCD3BFD1DD","07/12/2024","Disable collect sp perf metrics for Image tagging"),W=e.Ov.isActivated("C8FBDDAA-10A4-401C-AF53-DB24C9FE508B","10/27/2024","always use form digest for COB"),X=e.Ov.isActivated("88166B0F-C6E0-47AB-9069-32290AF11BFF");e.Ov.isActivated("8B20A8CC-6CA5-45DC-B7DC-9F3EB433F422");let Y=e.Ov.isActivated("D6829F03-A1EE-46C4-A474-EA8F5F22A8A2"),Z="undefined"!=typeof window?window:void 0,$=Z&&Z.performance,_=e.Ov.isActivated("B0493589-74F3-4204-AFC6-2B77AA14095B");class aa{static parseJSON(a){return a&&JSON.parse(a)||void 0}getData(a){let{cancelToken:b}=a,c=this._getData(a);if(b){let a=b.subscribe(()=>{c.cancel()});return Promise.resolve(c).then(b=>(a(),b)).catch(b=>{throw a(),b})}return Promise.resolve(c)}_getData(a){let{parseResponse:b=aa.parseJSON,qosExtraData:c,additionalPostData:d="",contentType:g,method:h="POST",maxRetries:r=0,responseType:s,onUploadProgress:t,timeout:z,noTimeoutInLastRetry:B=!1,webAbsoluteUrl:C,allowOAuth:D=!0,customerPromise:E,url:F,maxUrlLength:H=2e3,onBeforeRequest:J,qosObjectType:K,noRedirect:L}=a;if(F.length>H)throw new p.a({errorData:{code:`${R.a},${q.h}`,status:-1}});let M=this._dataRequestorContext,N=this._tokenProvider,O=this._getDataWithTokenProvider,P=this._getDataWithSyncClient,ab=[];this._qosName&&ab.push(this._qosName),a.qosName&&ab.push(a.qosName);let ac=ab.join("."),ad=F=>{let{url:H,telemetryHandler:P,authToken:R,useExactAuthToken:aa=!1,additionalHeaders:ab}=F,ad=!0,ae=(0,o.a)(H),af=o=>{let F,L,{authToken:O,qosExtraData:R}=o,{crossSiteCollectionCall:Y=!1,noRedirect:_=this._noRedirect,needsRequestDigest:af=!0}=a,ag={...a.additionalHeaders,...ab,...!V&&"ODSDataSource.ODSP.ImageTag.Feedback.UploadImage"===ac?{}:{CollectSPPerfMetrics:y}};if(D){let a,b;if(O&&"object"==typeof O?(a=O.authToken,b=O.scheme):a=O,a){let c=!1;!e.B3.isFeatureEnabled({ECS:86137})&&a.split(" ").length>1&&(c=!0);let d=aa||c?a:`${b||"Bearer"} ${a}`,f=!1;for(let a in ag)a&&"authorization"===a.toLowerCase()&&(f=!0);f||(ag.Authorization=d),Y=!0,(W||!(0,U.a)(M))&&(af=!1),_=!0}else!(S&&T)&&N&&N&&(ag.Authorization="Bearer")}let ah=new G({...M?{webServerRelativeUrl:M.webServerRelativeUrl,webAbsoluteUrl:C||M.webAbsoluteUrl,alwaysGetDigest:Y,formDigest:{serverTime:M.serverTime,updateFormDigestPageLoaded:M.updateFormDigestPageLoaded,formDigestValue:M.formDigestValue,formDigestTimeoutSeconds:M.formDigestTimeoutSeconds}}:{},needsRequestDigest:af,engagement:this._engagement,operationName:this._qosName}),ai=Z&&Z.location&&new j.a(Z.location.href).authority,aj=new j.a(H).authority,ak=(a,f)=>{let j,o,r=(d,g)=>h=>{let j,l,m,n,o=h.getResponseText();L=h.getServiceWorkerDataSourceHeader();let q=(0,k.a)(H,g),r={...c||{},needsRequestDigest:af,hasAuthToken:!!O,isCrossOrigin:!!ai&&ai!==aj,CorrelationId:h.getCorrelationId(),...R||{},HttpStatus:h.getStatus(),serviceWorkerDataSource:L||void 0,rawRequestDuration:q.duration,performanceEntry:JSON.stringify(q),serviceWorkerFetchInfo:h.getResponseHeader("X-ServiceWorkerFetchInfo")||void 0,SQLRT:h.getHeaderNumberValue(y),ServerDuration:h.getHeaderNumberValue("SPClientServiceRequestDuration")},t=!1;try{"blob"===s&&o&&"object"==typeof o?m=o:l=b(o,h),t=!0}catch(a){j=a,n={resultType:i.b.Failure,resultCode:"InvalidJSON",error:(0,e.ve)("object"==typeof a?JSON.stringify(a):a,!1),extraData:r,objectType:K}}if(n||(n={resultType:i.b.Success,extraData:r,objectType:K}),P){let{eventData:a}=P({response:l,eventData:n,serverData:h});n=a}if(d?.end(n),t)try{a(m||l)}catch(a){}else f(this._normalizeErrors?new p.a({code:"-1,parse_response",innerError:j,errorData:{correlationId:h.getCorrelationId(),status:h.getStatus()}}):void 0);ah=void 0},z=(a,b)=>(g,h)=>{let j=(0,k.a)(H,b),o={...c||{},needsRequestDigest:af,hasAuthToken:!!O,isCrossOrigin:!!ai&&ai!==aj,rawRequestDuration:j.duration,performanceEntry:JSON.stringify(j)},r="undefined"!=typeof navigator&&!1===navigator.onLine;if(this._offlineDetection&&(r=this._offlineDetection.offline),!g){let b=q.g,c=!0,d=0;h&&h instanceof e.lM&&(b=h.code,c=h.isExpected,d=-1),r&&(b===q.d||b===q.g)&&(b=q.e);let g={status:d,code:b},j={resultType:c?i.b.ExpectedFailure:i.b.Failure,resultCode:b,extraData:o};if(P){let{eventData:a}=P({eventData:j,errorData:g});j=a}a?.end(j),f(this._normalizeErrors?new p.a({errorData:g,innerError:h}):g);return}let s=b=>{let c,h=function(a){let b=!1,c={order:[],map:{}},d=function(a){if(!a.value)return;let b=n.exec(a.value);if(b){let[,a,c]=b,d="UserResolutionFailure",e=a.lastIndexOf("."),f=e>=0?a.substring(e+1):a,g=`${d},${f}${c?","+c:""}`;return{id:d,message:"",category:a,code:g}}if(b=m.exec(a.value)){let[,a="-1",c="",d,e]=b,f=d||e||"unknown";return{id:a,message:c,category:f,code:`${a},${f}`}}}({value:a.getResponseHeader(l)});if(d){switch(d.id){case"3000000":case"3000003":case"3000006":case"3001003":case"3001004":case"3001005":case"3002000":case"3004009":case"3004010":case"3003000":b=!0;break;default:b=!1}let a={source:l,code:d.code,message:d.message,isDisplayable:!0};c.order.push(a.source),c.map[a.source]=a}let e=a.getResponseHeader(x);if(e)try{let[,a="-1",b=""]=/(\d+);\s+(.+)/.exec(e),d={source:x,code:a,message:b,isDisplayable:!1};c.order.push(d.source),c.map[d.source]=d}catch(a){}let f=a.getResponseHeader(w);if(f){let b={source:w,code:f,message:a.getResponseHeader("X-SPO-ErrorMessage"),isDisplayable:!0};c.order.push(b.source),c.map[b.source]=b}let g=a.getResponseHeader(v);if(g){let a={source:v,code:g};c.order.push(a.source),c.map[a.source]=a}return{codes:c,isExpected:b}}(g),j=h?.isExpected,k=h?.codes;if("object"==typeof b&&"number"==typeof b.status)c=b;else if("string"==typeof b){let a;try{a=JSON.parse(b)}catch(a){}if(a)if(a.error_description)c={code:`-1,${a.error||"Unknown"}`,message:a.error_description},"policy_enforced"===a.error&&(j=!0);else if("string"==typeof a.error)c={message:a.error};else if(a.error&&a.error.message&&a.error.message.value){let b={source:p.b.spServiceResponse,code:a.error.code,message:`${a.error.message.value}`,isDisplayable:!0};k&&(k.order.push(b.source),k.map[b.source]=b),c=a.error}else c=a.error||a["odata.error"]||{responseData:a};else if(b&&400===g.getStatus()){let a;c={code:"-1,HTMLResult",message:/<html[^>]*>[\s\S]*?<body[^>]*>[\s\S]*?<\/body>[\s\S]*?<\/html>/i.test(b)?((a=b.match(/<body[^>]*>[\s\S]*<\/body>/i))?a[0]:"").slice(0,1e3):b.slice(0,1e3)},o={...o,rawPayload:d}}}let s=g.getStatus(),t=g.getCorrelationId(),y=g.getResponseHeader("SPGroupThrottle"),z=g.getResponseHeader(x);if(o={...o,CorrelationId:t,HttpStatus:s,GroupThrottle:y,MSCorrelationVector:g.getResponseHeader("MS-CV")},(401===s&&z||403===s||404===s||429===s||503===s||-1===s||0===s&&r)&&(ad=!1,j=!0),400===s){let a,b,c,e=(b={order:[],map:{}},(c=g.getResponseHeader("X-Msedge-Ref"))&&(a={source:v,code:"Non-Empty X-Msedge-Ref details",message:c}),a&&(b.order.push(a.source),b.map[a.source]=a),{codes:b,isExpected:!1});k&&e&&(Array.prototype.push.apply(k.order,e.codes.order),e.codes.order.forEach(a=>{k.map[a]=e.codes.map[a]})),o.rawPayload||(o={...o,rawPayload:d})}if((c=c||{}).codes=k,c.status=s,c.retryAfter=g.getHeaderNumberValue("Retry-After"),c.authenticate=g.getResponseHeader(u),c.authenticate&&(j=!0),!X){let a=g.getResponseHeader(A);a&&(c.reauthid=a)}t&&(c.correlationId=t),y&&(c.groupThrottle=y);let B=JSON.stringify(c);e.Ov.isActivated("C17CE162-3524-444F-85D5-8B5A0AA35544")||(c.targetUrl=g.getSourceUrl());let C=c["@error.redirectUrl"],D=g.getRedirectUrl()||C;D&&(j=!0,c.redirectUrl=D);let E=k?.map[p.b.spServiceResponse];E&&this._normalizeErrors&&(c.message=E.message);let F=k?.order[0];if(F){let a=k.map[F];a&&(F===w&&a.message?(c.code=q.a,c.message=a.message):a.code&&(c.code=a.code))}c.code||(c.code=q.g);let G=`[${s}] ${c.code}`,H={resultType:j?i.b.ExpectedFailure:i.b.Failure,error:(0,e.ve)(B,!1),resultCode:G,extraData:o};if(P){let{eventData:a,canRetry:b}=P({eventData:H,errorData:c,serverData:g});a&&(H=a),(!0===b||!1===b)&&(ad=b),H.resultType===i.b.ExpectedFailure&&(j=!0)}let I=this._normalizeErrors?new p.a({errorData:c,isExpected:j}):c;I.codes&&I.codes&&(H.extraData||(H.extraData={}),H.extraData.errorCodes=JSON.stringify(I.codes.map)),a?.end(H),f(I)},t=g.getResponseType();t&&"text"!==t?g.parseError().then(s):s(g.getResponseText())};j=F=E?new((0,Q.a)(this._apiEvent))({url:ae,name:ac,objectType:K,extraData:c,pillar:E?.pillar?E.pillar:void 0,veto:E?.veto?E.veto:void 0}):new this._apiEvent({url:ae,name:ac,objectType:K,extraData:c}),o=$&&$.now(),ah.getServerDataFromUrl({url:H,successCallback:r(j,o),failureCallback:z(j,o),uploadProgressCallback:t,additionalPostData:d,method:h,additionalHeaders:ag,contentType:g,withCredentials:!O&&void 0,noRedirect:_,responseType:s,needsRequestDigest:af})};return J?.(),(function(a){let{onExecute:b,onCancel:c,timeout:d,canRetry:e,noTimeoutInLastRetry:g}=a,h=0,i=Math.max(a.maxRetries,0),j=()=>{let a=new I.a(b,()=>{c(h>=i||!e())});return d&&(!g||h<i)?I.a.timeout(d,a):a};return h<i?function(a){let b,{adjustRetries:c,async:d,beforeRetry:e,callback:g,canRetry:h=()=>!0,delay:i,resetAttemptsOnRestart:j,shouldRestart:k}=a,{retries:l}=a,m=0,n=new f.b(()=>{b.cancel()});function o(a){k&&k()?(j&&(m=0),q()):n.complete(a)}function p(a){c&&(l=c(a)),m<l&&h(a)?(m++,e&&e(),"number"==typeof i&&d?d.setTimeout(q,i):q()):n.error(a)}function q(){(b=g()).then(o,p)}return q(),n.getPromise()}({canRetry:e,retries:i,callback:j,beforeRetry:()=>{h++}}):j()})({timeout:z,onExecute:ak,maxRetries:r,noTimeoutInLastRetry:B,canRetry:()=>ad,onCancel:a=>{ah&&(ah.abort(),a&&ah.dispose())}}).then(a=>(ah&&ah.dispose(),a),a=>(ah&&ah.dispose(),!F.endTime&&I.a.isCanceled(a)&&F.end({resultCode:q.b,resultType:i.b.ExpectedFailure}),I.a.reject(a)))};return R?I.a.resolve(R).then(a=>af({url:H,authToken:a})):M?.authToken?I.a.resolve(M.authToken).then(a=>af({url:H,authToken:a})):N?O?.({apiEvent:this._apiEvent,getData:af,options:{url:H,authToken:a.authToken,qosExtraData:a.qosExtraData,claimsChallenge:a.claimsChallenge,disallowCookies:a.disallowCookies,disallowSelfIssuedToken:a.disallowSelfIssuedToken},webAbsoluteUrl:(()=>{if(!Y){if(C)return C;if(H&&M&&M.webAbsoluteUrl)if(H.toLowerCase().startsWith(encodeURI(M.webAbsoluteUrl).toLowerCase()))return M.webAbsoluteUrl;else return new j.a(H).authority||window.location.origin;return}return C||M&&M.webAbsoluteUrl})(),qosName:ac,tokenProvider:N,noRedirect:L}):_&&M?.getAuthToken?I.a.resolve(M.getAuthToken({disallowSelfIssuedToken:a.disallowSelfIssuedToken})).then(b=>af({url:H,authToken:b,disallowSelfIssuedToken:a.disallowSelfIssuedToken})):af({url:H})},ae={authToken:a.authToken,telemetryHandler:a.telemetryHandler,url:a.url,useExactAuthToken:a.useExactAuthToken,method:a.method,additionalHeaders:a.additionalHeaders};return this._dataSyncClient&&!a.skipSyncClient?P?.({options:ae,aadUserId:M?.aadUserId,dataSyncClient:this._dataSyncClient,getData:ad}):ad(ae)}constructor(a,b){this._dataRequestorContext=b.dataRequestorContext,this._tokenProvider=b?.tokenProvider??this._dataRequestorContext?.tokenProvider,this._dataSyncClient=b?.dataSyncClient??this._dataRequestorContext?.dataSyncClient,this._qosName=a.qosName,this._apiEvent=b?.apiEvent??g.a,this._engagement=b?.engagement??h.a,this._normalizeErrors=a.normalizeErrors??!0,this._getDataWithTokenProvider=b?.getDataWithTokenProvider??N,this._getDataWithSyncClient=b?.getDataWithSyncClient??J,this._offlineDetection=b?.offlineDetection,this._noRedirect=b?.noRedirect??!0}}}
,(a,b,c)=>{c.d(b,{a:()=>f});var d=c("odsp.util_126");let e={ODB:61554};function f(){return d.lU.isFeatureEnabled(e)}}
,(a,b,c)=>{c.d(b,{a:()=>d});let d=new(c("odsp.util_126")).v7("navigation")}
,(a,b,c)=>{c.d(b,{a:()=>h});var d=c(101),e=c(278);class f extends e.b{apply(a,b){let c,d=this._value,g=this._resortKeys;if(!a||!d||"object"!=typeof d||Object.getPrototypeOf(d)!==Object.prototype||(0,e.e)(d)||(0,e.d)(d))return b.graft(b.unlock({value:a}),{value:d}).value;let h=b.unlock({}),i=Object.keys(a),j=Object.keys(d);for(let a=0;a<i.length;a++){let b=i[a];if(g&&j[a]!==i[a]){c={};break}h[b]=new e.a}for(let b=0;b<j.length;b++){let e=j[b];c&&(c[e]=a[e]),h[e]=new f(d[e],{resortKeys:this._resortKeys})}return b.graft(c||a,h)}constructor(a,b={}){super();const{resortKeys:c}=b;this._resortKeys=c,this._value=a}}var g=c(542);class h{get state(){return this._state}update(a,b,c){c?.override?this._state[a]=b:c?.mirrorPatch?this._state[a]=(0,e.c)({value:this._state[a]},{value:new f(b)}).value:this._state[a]=(0,e.c)(this._state[a],b),c?.silence||this._eventMC.publish(a,this._state[a])}onUpdate(a,b){return this._eventMC.subscribe(a,b)}toJSON(){return this._state}_freezeState(a){a&&"object"==typeof a&&Object.getPrototypeOf(a)===Object.prototype&&(0,g.a)(a)}constructor(a){this._eventMC=new d.a,this._state=a}}}
,,,,,,,,,,,,,,,,,,(a,b,c)=>{c(224)}
,,(a,b,c)=>{c.d(b,{a:()=>f,b:()=>e});var d=c("odsp.util_126");let e=!d.Ov.isActivated("07410C5C-2872-473F-B7CE-7827E0BF1F57"),f=!d.Ov.isActivated("3084B236-EDC2-4FEE-A833-8E1D9084B005");d.Ov.isActivated("F6E111F0-6D77-4CBD-885A-F252116BF795")}
,(a,b,c)=>{c.d(b,{a:()=>g,b:()=>h});var d=c(6),e=c(429),f=c(416);function g(a){return h(a)||function(a){let b=new d.a(a);if(!b.authority)return!1;let c=(0,e.a)();return new d.a(c).authority===b.authority}(a)}function h(a){let b=new d.a(a);if(!b.authority)return!1;let c=(0,f.a)();return new d.a(c).authority===b.authority}}
,,,,,,(a,b,c)=>{c.r(b),c.d(b,{Projector:()=>r,ProjectorMode:()=>e});var d,e,f=c("react-lib"),g=c("react-dom-lib"),h=c(160),i=c(534),j=c(535),k=c(533),l=c(83),m=c(629),n=c("fui.util_178"),o=c(359);(0,n.ZW)([{rawString:".root_7d1cc195{position:absolute;top:0;left:0;width:100%;height:100%;overflow:hidden;-webkit-touch-callout:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.root_7d1cc195.withDiagnostics_7d1cc195{transform:scale(.1);overflow:visible}.surface_7d1cc195{position:absolute;top:0;left:0;width:100%;height:100%;transform-origin:0 0;touch-action:none}.enabled_7d1cc195 .surface_7d1cc195{will-change:transform;backface-visibility:hidden;perspective:1000}.gliding_7d1cc195.preview_7d1cc195 .surface_7d1cc195{/*! autoprefixer: ignore next */transition:transform 267ms cubic-bezier(.1, .9, .2, 1)}.gliding_7d1cc195.live_7d1cc195 .surface_7d1cc195{transition:left 267ms cubic-bezier(.1, .9, .2, 1),top 267ms cubic-bezier(.1, .9, .2, 1),width 267ms cubic-bezier(.1, .9, .2, 1),height 267ms cubic-bezier(.1, .9, .2, 1)}.diagnostics_7d1cc195{position:absolute;top:0;left:0;width:100%;height:100%;transform-origin:0 0;touch-action:none;pointer-events:none;border:1px solid #00f;box-sizing:border-box;background-size:100px 100px;background-image:linear-gradient(to right,red 1px,transparent 1px),linear-gradient(to bottom,red 1px,transparent 1px);opacity:.5}.enabled_7d1cc195 .diagnostics_7d1cc195{will-change:transform;backface-visibility:hidden;perspective:1000}"}]);let p=new i.a(0,0,1,1),q=p.getCenter();function r(a){let{children:b,isEnabled:c=!0,mode:d=0,setIsZoomed:e}=a,i=f.useRef(null),[j,p]=f.useState(k.a.IDENTITY),[r,t]=f.useState(k.a.IDENTITY),[u,v]=f.useState(!1),[w,x]=f.useState(!1),[y,z]=f.useState(),A=!k.a.areEqual(j,k.a.IDENTITY),B=f.useRef(),C=(0,l.a)(({incrementTransformPx:a,radiusDeltaPx:b,points:d})=>c&&(Math.abs(b)>=10&&d.length>=2||A&&a.translate.abs()>=10)),D=(0,l.a)(({scale:a})=>Math.max(1,Math.min(4,a))),{handlers:E,isActive:F,transformV:G,setTransformV:H}=(0,o.b)({ref:i,isEnabled:c,mayStartPan:C,constrainScale:D,allowedModes:A?o.a.all:o.a.wheel});f.useEffect(()=>{F&&v(!1)},[F]),f.useEffect(()=>{function a(){let a=i.current?.getBoundingClientRect();a&&z({width:a.width,height:a.height})}let b=new n.NR(void 0);return b.on(window,"resize",()=>{a()}),a(),()=>{b.dispose()}},[]),f.useEffect(()=>(e&&e(A),()=>{e&&e(!1)}),[A,e]),f.useEffect((0,l.a)(()=>{if(F){let a=s(G,!0);t(j.invert().multiply(a))}}),[F,G]),f.useEffect((0,l.a)(()=>{if(!F&&!u){let a=G;M(a=a.scale<k.a.IDENTITY.scale?k.a.IDENTITY:s(G))}}),[F]);let I=(0,l.a)(()=>{F||k.a.areEqual(r,k.a.IDENTITY)||(v(!0),t(k.a.IDENTITY))});f.useEffect(()=>{let a=requestAnimationFrame(()=>{a=requestAnimationFrame(()=>{g.unstable_batchedUpdates(()=>{I()})})});return()=>{cancelAnimationFrame(a)}},[F,r]);let J=(0,l.a)(()=>{!F&&u&&v(!1)});f.useEffect(()=>{let a=setTimeout(()=>{g.unstable_batchedUpdates(()=>{J()})},500);return()=>{clearTimeout(a)}},[F,u]);let K=(0,l.a)(()=>{F||c||k.a.areEqual(j,k.a.IDENTITY)||M(k.a.IDENTITY),B.current=void 0});f.useEffect(()=>{let a=requestAnimationFrame(()=>{a=requestAnimationFrame(()=>{g.unstable_batchedUpdates(()=>{K()})})});return()=>{cancelAnimationFrame(a)}},[c]);let L=(0,l.a)(a=>{if(a.ctrlKey&&a.altKey&&0===a.button)return void x(a=>!a);if(F||!c)return;let b=i.current?.getBoundingClientRect();B.current=b?new h.a((a.clientX-b.left)/b.width,(a.clientY-b.top)/b.height):q,A?k.a.areEqual(j,k.a.IDENTITY)||M(k.a.IDENTITY):k.a.areEqual(j,k.a.IDENTITY)&&M(k.a.zoom(h.a.ORIGIN,B.current??q,3))}),M=(0,l.a)(a=>{let b=j.multiply(r);p(a),t(a.invert().multiply(b)),H(a)}),N=f.useMemo(()=>{if(0===d){let a=j.multiply(r);return{left:`${100*a.translate.x}%`,top:`${100*a.translate.y}%`,width:`${100*a.scale}%`,height:`${100*a.scale}%`}}{let a=`translate(${100*r.translate.x}%, ${100*r.translate.y}%) scale(${r.scale})`;return{left:100*j.translate.x+"%",top:100*j.translate.y+"%",width:100*j.scale+"%",height:100*j.scale+"%",transform:a}}},[d,r,j]),O=f.useMemo(()=>(0,m.b)(b,{isGliding:u,transformV:0===d?G:j,size:y}),[d,G,j,b,u,y]);return f.createElement("div",{className:(0,n.oG)("root_7d1cc195",{enabled_7d1cc195:c,gliding_7d1cc195:u,live_7d1cc195:0===d,preview_7d1cc195:1===d,withDiagnostics_7d1cc195:w}),ref:i,...E,onDoubleClick:L},f.createElement("div",{className:"surface_7d1cc195",style:N},O),w?f.createElement("div",{className:"diagnostics_7d1cc195",style:{transform:`translate(${100*G.translate.x}%, ${100*G.translate.y}%) scale(${G.scale})`}}):null)}function s(a,b=!1){let c=Math.max(k.a.IDENTITY.scale,a.scale),d=new i.a(a.apply(q).subtract(new h.a(c,c).scale(.5)),new j.a(c,c)),e=p.nudge(d),f=p.getCenter().subtract(e.getCenter());return b&&(f=f.unit().scale(f.abs()-Math.atan(Math.PI*f.abs())/Math.PI*Math.log(a.scale/k.a.IDENTITY.scale))),new k.a(f).multiply(a)}(d=e||(e={}))[d.live=0]="live",d[d.preview=1]="preview"}
,(a,b,c)=>{c.d(b,{a:()=>u});var d=c("react-lib"),e=c(236),f=c(250),g=c(237),h=c(632),i=c(9);function j(a){var b,c;let{path:d,getExport:e}=a;return i.c.resolve(void 0!==a.getModule?k(a.getModule,d):(b=a.require,k(()=>new i.c((a,d)=>{b([c],a,d)}),c=d))).then(e)}function k(a,b){return h.a.mark(`Module_${b}`,20),a().then(a=>a,a=>(i.c.isCanceled(a)||g.a.log(a),i.c.reject(a)))}class l{static addConfig(a){window.require.config(a)}static addPaths(a){window.require.config({paths:a})}static addShims(a){window.require.config({shim:a})}}var m=c(21),n=c(633),o=c("fui.core_517"),p=c(0),q=c(210),r=c("odsp.util_126");let s="MonacoEditor",t=!r.Ov.isActivated("8DDEB6A7-2C96-4945-B2E6-FBE2566D973E"),u=d.memo(a=>{let b=(0,d.useRef)(),c=(0,d.useRef)(null),g=(0,d.useRef)(),h=(0,d.useRef)(),k=(0,d.useRef)(),r=(0,d.useRef)(),u=(0,d.useRef)(),v=g.current,w=h.current,x=k.current,y=r.current,z=u.current,A=b.current,[B,C]=(0,d.useState)(!E());function D(c,d){let{language:e,onChange:f,options:i,textModelOptions:j,value:k,editorDidMount:l,onBlurEditor:m}=a,n=c&&c.editor;(A=b.current)?i&&i!==y&&A.updateOptions&&A.updateOptions(i):(A=b.current=n.create(d,i),l&&l(A,c));let o=A.getModel();o?(k&&k!==o.getValue()&&o.setValue(k),e&&e!==x&&n.setModelLanguage(o,e),j&&j!==z&&o.updateOptions&&o.updateOptions(j)):(o=n&&n.createModel&&n.createModel(k||"",e),A.setModel&&A.setModel(o),j&&o.updateOptions&&o.updateOptions(j)),w||(h.current=m&&A.onDidBlurEditorText&&A.onDidBlurEditorText(m)),v||(g.current=f&&o&&o.onDidChangeContent(()=>{o&&f(o.getValue())}))}function E(){return!!("undefined"!=typeof monaco&&monaco&&monaco.editor)}return(0,d.useEffect)(()=>{let{getWorkerUrl:b,baseUrl:c}=a;return b&&(window.MonacoEnvironment={baseUrl:c||void 0,getWorkerUrl:b}),()=>{A&&A.dispose(),v&&v.dispose(),w&&w.dispose()}},[]),(0,d.useEffect)(()=>{let{moduleType:b}=a,d=c.current;if(k.current=a.language,r.current=a.options,u.current=a.textModelOptions,b===e.a.AMD)E()?d&&D(monaco,d):d&&function(b){var c;let{vsFolderPath:d}=a;l.addConfig({paths:{vs:d}});let e=t?new((0,q.a)(p.a))({name:s,pillar:"View",veto:()=>"MonacoEditor Failure"}):new p.a({name:s});(void 0!==(c={path:"vs/editor/editor.main",getModule:()=>new i.c((a,b)=>{window.require(["vs/editor/editor.main"],a,b)})}).getModule?j({path:c.path,getModule:c.getModule,getExport:f.a}):j({path:c.path,require:c.require,getExport:f.a})).then(()=>{m.a.logData({name:"MonacoEditorAMDInit",isIntentional:!0}),e.end({resultType:p.b.Success}),C(!E()),D(monaco,b)},a=>(e.end({resultType:p.b.Failure,error:"There was an error while loading AMD Monaco Editor: "+JSON.stringify(a)}),i.c.wrapError(a)))}(d);else if(b===e.a.ESM&&a.importESMModule)d&&function(b){let c=t?new((0,q.a)(p.a))({name:`${s}_ESM`,pillar:"View",veto:()=>"MonacoEditor_ESM Failure"}):new p.a({name:s}),{importESMModule:d}=a;d&&d().then(f.a).then(a=>{m.a.logData({name:"MonacoEditorESMInit",isIntentional:!0}),C(!1),D(a,b),c.end({resultType:p.b.Success})},a=>(c.end({resultType:p.b.Failure,error:"There was an error while loading ESM Monaco Editor: "+JSON.stringify(a)}),i.c.wrapError(a)))}(d);else throw Error("Unsupported module type for monaco editor")},[a.options,a.textModelOptions,a.value,a.language]),d.createElement("div",{ref:c,className:a.className},B&&d.createElement(n.a,{size:o.jdf.large}))})}
,(a,b,c)=>{c.d(b,{OneDriveDataSource:()=>l,a:()=>m});var d=c(59),e=c(60),f=c(40),g=c("odsp.util_126"),h=c(686),i=c(13),j=c(112),k=c(687);class l{_getPersonalUrlPayload(a){let b=new e.a({webAbsoluteUrl:a}).build().segments("SP.Directory.DirectorySession","me").rawParameter("$select=mySite");return{webAbsoluteUrl:a,url:b.toString(),qosName:"FavoriteLists.GetMysiteUrl",noRedirect:!0,method:"POST"}}async getPersonalUrl(){if((0,j.a)(this._pageContext)||k.a&&this._pageContext.isUnauthenticated)throw new g.lM({code:"GuestUserDoesNotHaveOneDrive"});try{if(void 0===this._personalUrl)if(this.isCurrentOneDrive())this._personalUrl=this._pageContext.webAbsoluteUrl;else{let a=await this._dataRequestor.getData(this._getPersonalUrlPayload(this._pageContext.webAbsoluteUrl));if(a.d?.mySite){let b=new i.b({context:this._pageContext}).getUrlParts({webUrl:a.d.mySite});this._personalUrl=b.fullWebUrl}else this._personalUrl=null}}catch(a){this._personalUrl=null}if(void 0!==this._personalUrl&&null!==this._personalUrl)return this._personalUrl.endsWith("/")&&(this._personalUrl=this._personalUrl.slice(0,-1)),this._personalUrl;throw new g.lM({code:"UnableToGetPersonalUrl",message:h.a})}getPersonalUrlSync(){return(void 0===this._personalUrl||null===this._personalUrl)&&this.isCurrentOneDrive()?(this._personalUrl=this._pageContext.webAbsoluteUrl,this._personalUrl):this._personalUrl??void 0}isCurrentOneDrive(){return!!(this._pageContext.isMySiteOwner&&this._pageContext.webTemplate&&Number(this._pageContext.webTemplate)===f.b.mySite)}constructor({},{pageContext:a,tokenProvider:b}){this._dataRequestor=new d.b({qosName:"OneDriveDataSource"},{pageContext:a,tokenProvider:b}),this._pageContext=a,this._personalUrl=void 0}}let m=l}
,,,(a,b,c)=>{c.d(b,{a:()=>d});let d={ppe:"3d697adc11914fa4991f1c3870255788-1afd84c4-bb01-494a-bfb0-0216ab2771c6-6977",prod:"a23e4f242c9c4097a968f28c62633e19-62d0d830-5afd-4df3-8e40-351c8711cf5c-7157"}}
,(a,b,c)=>{c.d(b,{a:()=>d.a});var d=c(246)}
,(a,b,c)=>{c.d(b,{a:()=>f});var d=c(149);let e=c("odsp.util_126").Ov.isActivated("91E06BDE-2DA1-4942-B784-40EF3699B7BC"),f=(0,d.b)({preferPhotos:!0,...e?{forceView8ForPhotos:!0}:{}})}
,(a,b,c)=>{let d,e;c.d(b,{a:()=>l});var f=c("fui.util_178"),g=c(9),h=c(248),i=c(247),j=c(0);async function k(a,b="Unknown"){let c=new j.a({name:`Theming.LoadAllFonts.${b}`}),d=[];for(let b of a){let a=!1;if(document.fonts.forEach(c=>{c.family===b.fontFamily&&(a=!0)}),!a){let a=new FontFace(b.fontFamily,function(a){let{remappedPaths:b}=a;return b?b.map(a=>`url(${a})`).join(","):`url(${a.path})`}(b));a.display="swap",document.fonts.add(a),d.push(a.load())}}return Promise.all(d).then(()=>{c.end({resultType:j.b.Success})},a=>{c.end({resultType:j.b.Failure,error:a?.message})})}(0,h.e)("body");class l{static initializeTheme(a,b,c,h,j){let m,n;window.__loadTheme=f.fK,(window.FabricConfig=window.FabricConfig||{}).fontBaseUrl="";let o=window._spModuleLink;if(o&&o.libraries&&o.libraries.length>0&&(0,f.A1)(1),l._useOverrideTheme)return g.c.resolve((0,f.kF)());let p=(d&&e===a||((n=b||window._spPageContextInfo)&&(m=a.webThemeProvider(n)),d=m,e=a),d);return p?(l._themePromise=p.loadFullFormattedThemeData(c).then(a=>{let c=a||{};if((0,i.b)(b)&&c.fontFaces)try{k(c.fontFaces,c.fontPackageSource)}catch{}return(0,i.e)(c,b,h,j),a}),l._themePromise):g.c.resolve((0,i.e)({},b,h))}static overrideTheming(a,b){a&&(0,i.e)(a,b,!0),l._useOverrideTheme=!0,l._themePromise&&l._themePromise.cancel()}static overrideThemingWithFonts(a,b,c){a.loadFullFormattedThemeData().then(a=>{let d={...b};if(a?.fontFaces&&(0,i.b)(c))try{d.fontFaces=a.fontFaces,d.fontSlots=a.fontSlots,d.fontPackageSource=a.fontPackageSource,k(a.fontFaces,a.fontPackageSource)}catch{}l.overrideTheming(d,c)}).catch(a=>{l.overrideTheming(b,c)})}}l._useOverrideTheme=!1,window.FabricConfig&&window.FabricConfig.legacyTheme&&l.overrideTheming()}
,(a,b,c)=>{c.d(b,{a:()=>y});var d=c(9),e=c(495),f=c(47),g=c(41),h=c(21);let i="Data",j="CacheToken",k="CacheVersion",l="CacheExpires",m=/^#[0-9A-Fa-f]{6}$/i,n=/^(#[0-9A-Fa-f]{6});web#\d+$/i,o=/^\/.+_catalogs\/theme\/Themed\/.+$/i;class p{static clearThemeCache(){let a=p.getThemeDataStore();a.remove(i),a.remove(j),a.remove(k),a.remove(l)}static getCachedTheme(a,b){let c,d=p.getThemeDataStore();try{let e=d.getValue(l);a===d.getValue(j)&&"1.7"===d.getValue(k)&&(!e||Date.now()<e)&&(c=d.getValue(i),b&&p._isDirtyCache(a,c)&&(p.clearThemeCache(),c=void 0))}catch{}return c}static updateThemeCache(a,b){let c=p.getThemeDataStore();if(c.setValue(i,a),c.setValue(j,b||a.cacheToken),c.setValue(k,"1.7"),a?.cacheMaxAge){let b=1e3*a.cacheMaxAge;c.setValue(l,Date.now()+b)}else c.remove(l)}static getHeaderThemeCache(a,b){let c=p._getHeaderThemeDataStore().getValue(i);if(c){let d=c.find(b=>b.siteAbsoluteUrl===a);if(d&&d.themedCssFolderUrl===b)return d.themeData}}static updateHeaderThemeCache(a,b,c){let d=p._getHeaderThemeDataStore(),e=d.getValue(i)||[],f={siteAbsoluteUrl:a,themeData:b,themedCssFolderUrl:c};e.length||(e.unshift(f),d.setValue(i,[f]));let g=e.findIndex(b=>b.siteAbsoluteUrl===a);-1!==g&&e.splice(g,1),e.unshift(f),e.length>20&&e.pop(),d.setValue(i,e)}static getThemeDataStore(){return new f.a("odTheme",g.a.local)}static _getHeaderThemeDataStore(){return new f.a("odHeaderTheme",g.a.local)}static _isDirtyCache(a,b){let c=!1;try{if(a&&b&&b.cacheToken){let d=p._getRefinedCacheTokenFromCacheToken(a)||"",e=p._getRefinedCacheTokenFromThemeData(b)||"";d&&e?c=d.toLowerCase()!==e.toLowerCase():(h.a.logData({name:"ThemeCache.UnknownPattern",extraData:{cacheToken:a,cacheTokenInTheme:b.cacheToken}}),c=!1)}}catch{}return c&&h.a.logData({name:"ThemeCache.DirtyCache",extraData:{cacheToken:a,cacheTokenInTheme:b.cacheToken}}),c}static _getRefinedCacheTokenFromThemeData(a){if(a&&a.cacheToken){let b=a.cacheToken.split(":");if(4===b.length)return b[1];let c=a.cacheToken.match(m);if(c)return c[0]}}static _getRefinedCacheTokenFromCacheToken(a){if(a){let b=a.match(o);if(b)return b[0];let c=a.match(n);if(c)return c[1]}}}var q=c(0),r=c(103),s=c("odsp.util_126"),t=c(36);function u(a,b,c){let d={resultType:a};return b&&(d.resultCode=b),c&&(d.error=c),d}class v{static getBackgroundUrl(a){return a?v._makeCssUrl(a.backgroundImageUri):"none"}static _makeCssUrl(a){let b="none";return a&&(b='url("'+v._escapeQuotesAndParentheses(a)+'")'),b}static _escapeQuotesAndParentheses(a){let b={"'":"%27",'"':"%22","(":"%28",")":"%29"},c=null;return null!=a&&(c=a.replace(/(['"\(\)])/gm,function(a,c){return b[c]})),c}loadThemeTokenMap(a,b){return this.loadThemeData(a,b).then(function(a){let b;if(a&&a.palette){b={};let c=a.palette;for(let a in c){let d=c[a];b[a]=d?e.a.toHtmlString(d):null}b.backgroundImageUri=v._makeCssUrl(a.backgroundImageUri)}return b},a=>null)}loadThemeData(a,b){if(!b&&this._dataPromise)return this._dataPromise;let c=!s.Ov.isActivated("c315e78f-4479-425b-bf5c-91c954c3f823"),e=this,f=null,g=q.b.Failure;return this._dataPromise=function(a,b,c,d,e){let f,g=new a(b);try{f=c()}catch(a){throw g.end(u(t.a.Failure,"PromiseCreationFailed",(0,s.ve)(a.toString()))),a}return f.then(a=>{let b;b=u(t.a.Success),g.end(b)},a=>{let b;if(e)try{b=e(a)}catch(a){b=u(t.a.Failure,"GetSchemaException",(0,s.ve)(a.toString()))}else b=a?u(a instanceof Error&&"Canceled"===a.name?t.a.ExpectedFailure:t.a.Failure,void 0,(0,s.ve)((0,r.a)(a),"unsafe")):u(t.a.Failure);g.end(b)}),f}(q.a,{name:"ThemeProvider.LoadData"},()=>new d.c(function(h,i){let j=null;b||(j=p.getCachedTheme(a,c)),j?h(j):e._loadData(b).done(function(b){b?(b.cacheToken&&p.updateThemeCache(b,a),h(b)):(f="NoData",i&&i("No model returned"))},function(a){d.c.isCanceled(a)?(f="Canceled",g=q.b.ExpectedFailure):f="ServerLoadFailure",i&&i(a)})}),0,function(a){d.c.isCanceled(a)&&(g=q.b.ExpectedFailure,f="Canceled");let b=a;return a&&(b=JSON.stringify({name:a.name||void 0,message:a.message&&a.message.value||a.message||void 0,correlationId:a.correlationId||void 0})),{resultType:g,resultCode:f||"Other",error:b}}),this._dataPromise}constructor(a){this._loadData=a}}var w=c(40),x=c(247);class y{loadThemeSlotsMap(a){let b=this._getThemeCacheToken();return b?this._themeProvider.loadThemeTokenMap(b,a):d.c.resolve()}loadFullFormattedThemeData(a){return this.loadFullThemeData(a).then(a=>this._handleIThemeDataToFullFormattedThemeData(a))}loadFullThemeData(a){let b=this._getThemeCacheToken();return b?this._themeProvider.loadThemeData(b,a):d.c.resolve(void 0)}loadThemeDataWithCacheToken(a){return this._forceLoadServerTheme().then(a=>this._handleIThemeDataToFullFormattedThemeData(a))}loadGeneratedTheme(){return this._themeDataSource||(this._themeDataSource=this._getThemeDataSource()),this._themeDataSource.then(a=>a?a.loadGeneratedTheme().then(a=>this._handleIThemeDataToFullFormattedThemeData(a)):d.c.resolve())}getThemeCacheToken(){return this._getThemeCacheToken()}_getThemeCacheToken(){let a,b=this._pageContext;if(b){let c=Number(b.webTemplate),d=c===w.a.teamSite||c===w.a.group?b.groupColor:void 0,e=d?d+";web#"+b.webTemplate:null;a=b.themedCssFolderUrl||e||void 0}return a}_loadTheme(a){return this._getThemeCacheToken()?(this._themeDataSource||(this._themeDataSource=this._getThemeDataSource()),this._themeDataSource.then(b=>b?b.loadTheme(a):d.c.resolve())):d.c.resolve()}_forceLoadServerTheme(){return this._themeDataSource||(this._themeDataSource=this._getThemeDataSource()),this._themeDataSource.then(a=>a?a.loadServerTheme():d.c.resolve())}_handleIThemeDataToFullFormattedThemeData(a){let b,c,d,f,g,h,i;if(!a)return;let j={},k=a.palette;for(let a in k){let b=k[a];b&&(j[a]=e.a.toHtmlString(b))}if(a.backgroundImageUri&&(j.backgroundImageUri=v.getBackgroundUrl(a)),(0,x.c)(this._pageContext)&&(0,x.d)(a.themeSchemaVersion)){let g={};for(let b in a.otherMode?.palette){let c=a.otherMode.palette[b];c&&(g[b]=e.a.toHtmlString(c))}b=Object.keys(g).length>0?{...a.otherMode,palette:g}:void 0;let h=[],i=[];for(let b of a.secondaryColors?.dark??[]){let a=this._handleColorPair(b);h.push(a)}for(let b of a.secondaryColors?.light??[]){let a=this._handleColorPair(b);i.push(a)}c={dark:h,light:i},f=a.displayMode,d=a.themeSchemaVersion}if((0,x.b)(this._pageContext)&&a.fontPackage&&a.fontPackage.fontFaces&&a.fontPackage.fontSlots){g=a.fontPackage.fontFaces,h={},i=a.fontPackage.fontPackageSource;let b=a=>{let b;if(b=this._isEnquoteKillswitchActivated?{fontFamily:a.fontFamily&&'"'+a.fontFamily.replace(/"/g,'\\"')+'"'}:{fontFamily:a.fontFamily&&this._enquoteIfNeeded(a.fontFamily)},a.fontVariationSettings){let c=Object.keys(a.fontVariationSettings),d="";for(let e of c){let c=a.fontVariationSettings[e];switch(e){case"wght":b.fontWeight=c;break;case"wdth":b.fontStretch=c;break;case"slnt":b.fontStyle=`oblique ${c}deg`;break;case"ital":b.fontStyle=c?"italic":"normal";break;case"opsz":b.fontOpticalSizing=c;break;default:d+=d?", ":"",this._isEnquoteKillswitchActivated?d+=`"${e}" ${c}`:d+=`${this._enquoteIfNeeded(e)} ${c}`}}d&&(b.fontVariationSettings=d)}return b.fontFace=a.fontFace,b.fontVariationSettings=a.fontVariationSettings,b};for(let[c,d]of Object.entries(a.fontPackage.fontSlots))s.Ov.isActivated("661c8da2-e6df-4c44-95fb-d32ccf03998f","12/12/2023")?h[c]={fontFamily:d?.fontFamily}:h[c]=b(d)}let l={palette:j,isInverted:a.isInverted,fontPackageSource:i,fontFaces:g,fontSlots:h,...b&&{otherMode:b},...c&&{secondaryColors:c},...f&&{displayMode:f??"light"},...d&&{themeSchemaVersion:d}};return(0,x.a)(l,this._pageContext)}_enquoteIfNeeded(a){return a.startsWith('"')&&a.endsWith('"')?a:`"${a.replace(/"/g,'\\"')}"`}_handleColorPair(a){try{return{themePrimary:e.a.toHtmlString(a.themePrimary),backgroundColor:a.backgroundColor?e.a.toHtmlString(a.backgroundColor):void 0}}catch(a){return{themePrimary:""}}}constructor(a){this._isEnquoteKillswitchActivated=s.Ov.isActivated("b39f1385-ab28-4f24-b610-ec20f5dfac7b"),this._pageContext=a.pageContext?a.pageContext:window._spPageContextInfo,this._getThemeDataSource=a.getThemeDataSource,this._themeProvider=new v(this._loadTheme.bind(this))}}}
,(a,b,c)=>{c.d(b,{a:()=>e});class d{static clone(a){return d.fromRgba(a.R,a.G,a.B,a.A)}static equals(a,b){let c=!a,d=!b;return c||d?c&&d:a.R===b.R&&a.G===b.G&&a.B===b.B&&a.A===b.A}static fromRgba(a,b,c,e){let f=new d;return f.R=Math.round(a),f.G=Math.round(b),f.B=Math.round(c),f.A=null!=e?Math.round(e):d.maxComponent,f}static fromRgbaString(a){let b=new d;if(/^rgb.+/.test(a)){let c=a.match(/[\d.]+/g);b=d.fromRgba(Number(c[0]),Number(c[1]),Number(c[2]),4===c.length?Number(c[3])*d.maxComponent:null)}return b}static fromHtmlColor(a){function b(a,b,c){return parseInt(a.charAt(b)+a.charAt(c),16)}let c=new d;if("string"==typeof a&&"#"===a.charAt(0))switch(a.length){case 9:c.A=b(a,1,2),c.R=b(a,3,4),c.G=b(a,5,6),c.B=b(a,7,8);break;case 7:c.R=b(a,1,2),c.G=b(a,3,4),c.B=b(a,5,6);break;case 4:c.R=b(a,1,1),c.G=b(a,2,2),c.B=b(a,3,3)}else/^rgb.+/.test(a)&&(c=d.fromRgbaString(a));return c}static toHtmlString(a,b){function c(a){let b=Number(a);if(!(b>=0&&b<=d.maxComponent))throw Error("Argument must be a Number in [0, 255]");let c=b.toString(16);return b<16&&(c="0"+c),c}return a.A<d.maxComponent&&!b?"rgba("+a.R.toString(10)+", "+a.G.toString(10)+", "+a.B.toString(10)+", "+(a.A/d.maxComponent).toFixed(2)+")":"#"+(b?c(a.A):"")+c(a.R)+c(a.G)+c(a.B)}constructor(){this.R=0,this.G=0,this.B=0,this.A=d.maxComponent}}d.maxComponent=255;let e=d}
,(a,b,c)=>{c.d(b,{a:()=>d});let d=c(1).a("fluenthybridfont/odsp-next-icons-11c89b6d.woff")}
,(a,b,c)=>{c.d(b,{a:()=>d});let d=c(1).a("fluenthybridfont/patch/odsp-patch-icons-33e61432.woff")}
,(a,b,c)=>{c.d(b,{a:()=>d});let d=c(1).a("fluenthybridfont/app-icons-98056e21.woff")}
,,(a,b,c)=>{c.d(b,{a:()=>d});let d=c(1).a("images/addtoonedrive/shortcutbadge_12.svg")}
,(a,b,c)=>{c.d(b,{a:()=>d});let d=c(1).a("images/addtoonedrive/shortcutbadge_16.svg")}
,(a,b,c)=>{c.d(b,{a:()=>d});let d=c(1).a("images/addtoonedrive/shortcutbadge_20.svg")}
,(a,b,c)=>{c.d(b,{a:()=>d});let d=c(1).a("images/addtoonedrive/shortcutbadge_12_dark.svg")}
,(a,b,c)=>{c.d(b,{a:()=>d});let d=c(1).a("images/addtoonedrive/shortcutbadge_16_dark.svg")}
,(a,b,c)=>{c.d(b,{a:()=>d});let d=c(1).a("images/addtoonedrive/shortcutbadge_20_dark.svg")}
,,,,,,,(a,b,c)=>{c.d(b,{a:()=>f,b:()=>d,c:()=>e});let d=a=>{let b=document.cookie.match("(^|;)\\s*"+a+"\\s*=\\s*([^;]+)");return b&&b.pop()||""},e=(a,b,c,d,e)=>{let f="";if(c){let a=new Date;a.setTime(a.getTime()+24*c*36e5),f=` expires= + ${a.toUTCString()} + ;`}let g="";e&&(g=` samesite=${e};`,"none"===e.toLowerCase()&&(g+=" secure;")),document.cookie=`${a}=${b};${f} path=${d||"/"};${g}`},f=a=>{document.cookie=`${a}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`}}
,(a,b,c)=>{c.d(b,{a:()=>d});let d=c(1).a("images/error/error_exclamation_v3.webp")}
,(a,b,c)=>{c.d(b,{a:()=>d});let d=c(1).a("images/error/error_exclamation_v3_dark.webp")}
,,,,,,(a,b,c)=>{c.d(b,{a:()=>j,b:()=>f,c:()=>i,d:()=>g,e:()=>h,f:()=>e,g:()=>d,h:()=>k});let d="Unknown",e="RequestAborted",f="Canceled",g="NoConnection",h="Offline",i="MissingWebForDigestAuth",j="XSPOErrorMessage",k="UrlTooLong"}
,,(a,b,c)=>{c.d(b,{a:()=>s});var d=c(523),e=c(260),f=c(104),g=c(9),h=c(0),i=c(21),j=c(31),k=c("odsp.util_126"),l=c(6),m=c(524),n=c(263);let o="TryNewExperienceSingle",p=k.Ov.isActivated("23DCF7B8-CE78-43EA-8F10-7B5CD47411D5","05/04/2023","return retriedWithGroupReplaceContext as part of listItemResponse"),q=k.Ov.isActivated("3f7e1f54-43e3-4c37-a5f3-b78fb07ed315","7/12/22","read groupString from postDataContext when listContext group is empty"),r=k.Ov.isActivated("19B3CA17-44A2-4FA5-8255-05669E225738");class s extends f.b{getItem(a,b,c,d,e,f){a.postDataContext.isOnePage=!!a.newTargetListUrl||!!a.isOnePageNavigation;let h=()=>a.remoteItem?this._getRemoteItemPostData():this.getAdditionalPostData(a.postDataContext,b,a.pageSize);return(this.getUrlAsync?this.getUrlAsync(b,a):g.c.resolve(void 0)).then(i=>{let j=j=>super.getData(i?()=>i:()=>this.getUrl(b,a),(a,b)=>this._parseResponse(a,c.qosEvent,b,j),c.qosName,h,"POST",this._getListRequestHeaders(a,b,c),void 0,void 0,a.noRedirect,void 0,a=>{let b=this._telemetryHandler(a);return d&&d(b.eventData),b},void 0,a.authToken,void 0,e,f).then(a=>a,a=>(this._errorHandler(c.qosName,a),g.c.reject(a)));return j().then(a=>a,b=>b.code?.indexOf("Microsoft.SharePoint.SPQueryThrottledException")!==-1?(a.postDataContext?.groupReplace||(a.postDataContext.groupReplace=!0),j(!0)):g.c.reject(b))})}getUrl(a,b){let c,e=b&&b.postDataContext;if(b?.webAbsoluteUrl!==void 0||b?.listFullUrl!==void 0){let c,d,f=this._isSpecifiedItemRequest(a);return c=e&&e.groupReplace?a.requestToken:a.group?void 0:a.requestToken,a.group&&this._isExpandingGroup(a.group.groupString)&&!(e&&e.groupReplace)?d=a.group.groupString:!q&&b.group&&this._isExpandingGroup(b.group.groupString)&&!(e&&e.groupReplace)&&(d=b.group.groupString),function(a){let{webAbsoluteUrl:b,listFullUrl:c,rootFolder:d,spPageFallbackWebAbsoluteUrl:e,useRemoteWeb:f}=a,g=new l.a(c),h=b||g.authority;if(!h)throw new k.lM({code:"MissingWebAuthorityForGetList",message:"No web url available for GetList call"});return(function(a,b){let{listFullUrl:c,rootFolder:d,pageToken:e,filterParams:f,sortField:g,sortDir:h,viewId:i,viewPath:j,groupString:p,searchTerm:q,enableModernListSchemas:r,inplaceSearchMultiLineFieldQuery:s}=b;if(e)return a=a.rawParameter(e.substring(1)),r&&(a=a.parameter(o,{raw:"TRUE"})),void 0!==q&&(a=a.parameter("InplaceSearchQuery",{raw:n.a.encodeURIComponent(q)})),s&&(a=a.parameter("InplaceSearchMultiLineFieldQuery",{raw:n.a.encodeURIComponent(s)})),a;if(d){if(!m.a){let a=new l.a(c).path;if(a&&d.slice(0,a.length).toUpperCase()!==a.toUpperCase())throw k.Ov.isActivated("428a2b3e-a7bb-4dfa-b98b-d310e76d79aa","09/18/2023","Improve logging when we refuse to issue a URL for list data as stream.")||console.log("Root folder is not a sub-path of list for GetList call; listPath: ["+a+"], rootFolder: ["+d+"]"),new k.lM({code:"RootFolderDoesNotBeginWithListPath",message:"Root folder is not a sub-path of list for GetList call"})}c&&c.slice(-d.length)===d||(a=a.parameter("RootFolder",{raw:n.a.encodeURIComponent(d)}))}return i&&(a=a.parameter("View",{raw:i})),j&&(a=a.parameter("ViewPath",{raw:j})),"string"==typeof p&&(a=a.parameter("IsGroupRender",{raw:"TRUE"}).parameter("DrillDown",1).parameter("GroupString",{raw:p})),void 0!==q&&(a=a.parameter("InplaceSearchQuery",{raw:n.a.encodeURIComponent(q)})),g&&(a=a.parameter("SortField",{raw:g}),h&&(a=a.parameter("SortDir",{raw:h}))),f&&(a=a.rawParameter(f)),r&&(a=a.parameter(o,{raw:"TRUE"})),s&&(a=a.parameter("InplaceSearchMultiLineFieldQuery",{raw:n.a.encodeURIComponent(s)})),a})(b&&(!e||e===b)||!c||f?(0,m.b)({webAbsoluteUrl:b,listFullUrl:c||`${new l.a(b).authority}${d||""}`}).segment("RenderListDataAsStream"):(0,m.c)({webAbsoluteUrl:e||h}).segment("SP.List.GetListDataAsStream").parameter("listFullUrl",c||`${new l.a(b).authority}${d||""}`),a).toString()}({webAbsoluteUrl:b.webAbsoluteUrl||"",listFullUrl:b.listFullUrl||"",rootFolder:b.remoteItem?void 0:a.folderPath,pageToken:c,sortField:!f&&a.sortField?a.sortField:void 0,sortDir:!f&&a.sortField?"false"===a.isAscending?"Desc":"Asc":void 0,filterParams:f||b.ignoreFilterParams?void 0:a.filterParams,viewId:f?void 0:a.viewIdForRequest,viewPath:f?void 0:a.viewPathForRequest,groupString:d,searchTerm:a.searchTerm,inplaceSearchMultiLineFieldQuery:a.inplaceSearchMultiLineFieldQuery,enableModernListSchemas:b?.enableModernListSchemas||!0,spPageFallbackWebAbsoluteUrl:this._pageContext.webAbsoluteUrl})}return c={webUrl:this._pageContext.webAbsoluteUrl,listId:b.remoteItem?b.remoteItem.ListId:a.listId,urlParts:b.remoteItem?{}:a.urlParts,searchTerm:a.searchTerm,rootFolder:b.remoteItem?void 0:a.folderPath,isOnePageNavigation:b.isOnePageNavigation,remoteWebUrl:b.remoteItem?b.remoteItem.SiteUrl:b.remoteWebUrl,uniqueId:b.remoteItem&&b.remoteItem.UniqueId,authToken:b?.authToken,inplaceSearchMultiLineFieldQuery:a.inplaceSearchMultiLineFieldQuery,enableModernListSchemas:b?.enableModernListSchemas},k.Ov.isActivated("03784CEA-7833-4740-8D6A-4EA05116664F","5/18/21","Set prefetch param")||(c.isPrefetchPageContext=a.listId&&!this._pageContext.listUrl),this._isSpecifiedItemRequest(a)?c.viewId=a.viewIdForRequest:((!a.viewXmlForRequest||e&&e.isOnePage)&&a.viewIdForRequest!==j.a.Empty&&(c.view=a.viewIdForRequest),!c.view&&a.viewPathForRequest&&(c.viewPath=a.viewPathForRequest),b&&b.ignoreFilterParams||(c.filterParams=a.filterParams),a.sortField&&(c.sortField=a.sortField,c.sortDir="false"===a.isAscending?"Desc":"Asc"),e&&e.groupReplace?c.requestToken=this._isExpandingGroup(c.groupString)?void 0:a.requestToken:c.requestToken=a.group?void 0:a.requestToken,a.group&&this._isExpandingGroup(a.group.groupString)&&!(e&&e.groupReplace)?c.groupString=a.group.groupString:!q&&b.group&&this._isExpandingGroup(b.group.groupString)&&!(e&&e.groupReplace)&&(c.groupString=b.group.groupString),e&&e.webId&&(c.webId=e.webId)),d.a(c)}getAdditionalPostData(a,b,c){return e.a(a,b,c)}needsRequestDigest(a){return!!k.Ov.isActivated("4CE25DD5-0B47-4B9E-B6F9-5037A00C6CF8","04/21/2021","need Request Digest")||-1===a.toLowerCase().indexOf("/renderlistdataasstream?")}_getListRequestHeaders(a,b,c){let e=this._pageContext.webAbsoluteUrl&&this._pageContext.webAbsoluteUrl!==a.webAbsoluteUrl?a.listFullUrl:new l.a(a.listFullUrl).path,f=d.c(r?b:{listUrl:e},a.postDataContext);return c&&c.application&&(f.Application=c.application,f.Scenario="ViewList",f.ScenarioType="AUO"),a.setServiceWorkerCoalesceHeader&&(f["X-Service-Worker-Prefetch-And-Coalesce"]="true"),f["X-ServiceWorker-Strategy"]=a.skipServiceWorkerCache?"SkipCache":"CacheFirst",f}_getRemoteItemPostData(){return JSON.stringify({parameters:{RenderOptions:7}})}_isSpecifiedItemRequest(a){return a.itemIds&&a.itemIds.length>0}_isExpandingGroup(a){return!!a&&"__next__"!==a}_parseResponse(a,b,c,d){let e=c.getServiceWorkerDataSourceHeader();try{if(void 0!==a)return this._getListItemResponse(a,e,d,c.getSourceUrl().includes("http://localhost"))}catch(f){if("{}"!==a.substring(0,2))throw b.end({resultType:h.b.Failure,resultCode:"BadJSON"}),f;return this._getListItemResponse(a.substring(2),e,d,c.getSourceUrl().includes("http://localhost"))}}_getListItemResponse(a,b,c,d){let e;return e=JSON.parse(a),"ServiceWorker-FromCache"===b&&(e.isFromServiceWorkerCache=!0),!p&&c&&(e.retriedWithGroupReplaceContext=!0),e.isFromNucleus=d,e}_telemetryHandler(a){let{errorData:b}=a,c={...a.eventData};if(b){let a,d=b.code?b.code:"";return d.indexOf("2147024860")>-1?d="ListViewTreshold":d.indexOf("2147024749")>-1?d="LookupColumnTreshold":d.indexOf("2147024809")>-1&&d.indexOf("requestUrl")>-1?d="RequestURLFailure":d.indexOf("2147024809")>-1&&d.indexOf("range")>-1?d="RangeError":d.indexOf("2147024809")>-1&&d.indexOf("view")>-1?d="InvalidView":d.indexOf("2130575340")>-1&&d.indexOf("field")>-1?d="FieldTypesNotInstalledProperly":d.indexOf("2146232832")>-1?(d="DefaultDoclibNotFound",500===b.status&&(a=!1,c.resultType=h.b.ExpectedFailure)):d.indexOf("2147024895")>-1?(d="PrefetchWebMismatch",500===b.status&&(a=!1,c.resultType=h.b.ExpectedFailure)):d=c.resultCode,c.resultCode=d,{canRetry:a,eventData:c}}return{eventData:c}}_errorHandler(a,b){let c=b&&b.code?b.code:"";c.indexOf("2147024860")>-1?i.a.logData({name:a+".ListViewTreshold"}):c.indexOf("2147024749")>-1&&i.a.logData({name:a+".LookupColumnTreshold"})}constructor(a,b={}){const{pageContext:c,normalizeErrors:d,noRedirect:e}=a,{tokenProvider:f}=b;super({dataSourceName:"ListItemDataSource"},{pageContext:c,normalizeErrors:d,noRedirect:e,tokenProvider:f})}}}
,(a,b,c)=>{c.d(b,{a:()=>i,b:()=>l,c:()=>k});var d=c(13),e=c(263),f=c(146),g=c("odsp.util_126");let h="TryNewExperienceSingle";function i(a){let b,{webUrl:c,webId:i,listId:k,view:l,searchTerm:m,rootFolder:n,sortField:o,sortDir:p,filterParams:q,groupString:r,requestToken:s,viewId:t,viewPath:u,urlParts:v,isOnePageNavigation:w,isPrefetchPageContext:x,uniqueId:y,remoteWebUrl:z,authToken:A,inplaceSearchMultiLineFieldQuery:B,enableModernListSchemas:C}=a,D=z?[e.a.escapeUrlForCallback(z)]:[e.a.escapeUrlForCallback(c)];z&&"/"!==z.slice(-1)?D.push("/"):"/"!==c.slice(-1)&&D.push("/"),v&&({siteRelation:b=v.isCrossSite}=v);let E=b!==d.d.sameSite;if(!A&&v&&(E||i)&&v.fullListUrl&&!w){D.push("_api/SP.List.GetListDataAsStream?listFullUrl='");let a=v.fullListUrl;if(z&&(a=new URL(z).origin+v.serverRelativeItemUrl),D.push(e.a.encodeRestUriStringToken(a)),s)return"?"!==s[0]&&f.a.logData({name:"ListItemDataHelper.InvalidRequestToken",message:s}),D.push("'&"+s.substring(1)),D.join("");D.push("'&View=")}else{let a=v&&v.serverRelativeListUrl;if(a||(a=v&&v.serverRelativeItemUrl),a&&!x?D.push("_api/web/GetList(@listUrl)"):k?(D.push("_api/web/lists/GetById('"),D.push(k),D.push("')")):D.push("_api/web/DefaultDocumentLibrary"),s)return D.push("/RenderListDataAsStream"),D.push(s),D.push(j(a)),"string"==typeof m&&(D.push("&InplaceSearchQuery="),D.push(e.a.encodeURIComponent(m))),C&&D.push(`&${h}=TRUE`),D.join("");D.push("/RenderListDataAsStream?"),a&&D.push(j(a,!0)),D.push("View="),l&&D.push(l),u&&(D.push("&ViewPath="),D.push(e.a.encodeURIComponent(u)))}return t&&D.push(`&ViewId=${t}`),"string"==typeof m&&(D.push("&InplaceSearchQuery="),D.push(e.a.encodeURIComponent(m))),n&&(D.push("&RootFolder="),D.push(e.a.encodeURIComponent(n))),y&&(D.push("&RootFolderUniqueId="),D.push(e.a.encodeURIComponent(y))),"string"==typeof r&&(D.push("&IsGroupRender=TRUE"),D.push("&DrillDown=1"),D.push(`&GroupString=${r}`)),o&&D.push(`&SortField=${o}`),p&&D.push(`&SortDir=${p}`),q&&(q.startsWith("&")||g.Ov.isActivated("8bcd8267-4968-45bc-b7f3-4cd9135477f7","3/07/2023","add & before filter params")?D.push(q):D.push(`&${q}`)),B&&(D.push("&InplaceSearchMultiLineFieldQuery="),D.push(e.a.encodeURIComponent(B))),C&&D.push(`&${h}=TRUE`),D.join("")}function j(a,b){let c=[];return a&&(b||c.push("&"),c.push("@listUrl='"),c.push(e.a.encodeRestUriStringToken(a)),c.push("'"),b&&c.push("&")),c.join("")}function k(a,b){let c,d,f,g;return b&&(c=b.needsQuickLaunch,d=b.webId,f=b.siteId),a.listUrl?g=`listUrl=${e.a.encodeURIComponent(a.listUrl)}`:a.listId&&(g=`list=${a.listId}`),d&&(g+=`,webId=${d}`),f&&(g+=`,siteId=${f}`),{"X-SP-REQUESTRESOURCES":c?`NAVIGATIONSTRUCTURE,${g}`:g}}function l(a,b){let c=a;b&&0===a.indexOf(b)&&(c=a.replace(b,"")),"/"===c.substring(0,1)&&(c=c.substring(1)),0===c.toLowerCase().indexOf("lists/")&&(c=`${c.substr(6)}List`);let d=[];for(let a=0;a<c.length;a++){let b=c.charAt(a),e=c.charCodeAt(a);if(!(e>47&&e<58||e>64&&e<91||e>96&&e<123||!g.Ov.isActivated("A6D032E8-39A0-42FE-8971-B666836685FB","6/10/2021","fix listEntityTypeName for list name contains japanese character")&&(b.match(/[\u3040-\u30ff\u3400-\u4dbf\u4e00-\u9fff\uf900-\ufaff\uff66-\uff9f]/)||b.toLowerCase()!==b.toUpperCase()))){let a=`0000${e.toString(16)}`.slice(-4);b=`_x${a}_`}d.push(b)}return d.length>0&&1===d[0].length&&(d[0]=d[0].toUpperCase()),`SP.Data.${d.join("")}Item`}}
,(a,b,c)=>{c.d(b,{a:()=>g,b:()=>j,c:()=>h,d:()=>i});var d=c(60),e=c(6),f=c("odsp.util_126");let g=f.Ov.isActivated("78432EE1-1DA7-4E3A-B230-9C77BFEC795B","05/26/2022","Validate RootFolder against List URL");function h(a){return new d.a({webAbsoluteUrl:a.webAbsoluteUrl}).build()}function i(a){let{webAbsoluteUrl:b,listOrItemFullUrl:c}=a,d=b||new e.a(c).authority;if(!d)throw new f.lM({code:"MissingWebUrlForApiUrl",message:"Could not determine the target webUrl to create an API call."});let g=h({webAbsoluteUrl:d});return!b&&c?g.method("SP.RemoteWeb",c).segment("Web"):g.segment("web")}function j(a){let{webAbsoluteUrl:b,listFullUrl:c}=a,d=new e.a(c),h=new e.a(b);if(!g&&d.authority&&h.authority&&h.authority.toUpperCase()!==d.authority.toUpperCase())throw new f.lM({code:"FullListUrlIsNotOnSameDomainAsWeb",message:"List url is not on same domain as Web url for GetList call"});let j=d.path,k=i({webAbsoluteUrl:b,listOrItemFullUrl:c});if(j){if(!g&&h.path&&j.slice(0,h.path.length).toUpperCase()!==h.path.toUpperCase())throw new f.lM({code:"RelativeListUrlDoesMatchWebUrl",message:"List url does not have same path as Web url for GetList call"});k=k.methodWithAliases("GetListUsingPath",{DecodedUrl:j})}else k=k.segment("DefaultDocumentLibrary");return k}}
,(a,b,c)=>{c.d(b,{a:()=>d});function d(a,b=!0){return a=encodeURI(a),b&&a&&(a=a.replace(/#/g,"%23")),a}}
,,(a,b,c)=>{var d,e;c.d(b,{a:()=>d}),(e=d||(d={})).personal="personal",e.business="business",e.documentLibrary="documentLibrary"}
,(a,b,c)=>{c.d(b,{a:()=>e,b:()=>h});var d,e,f=c("odsp.util_126");(d=e||(e={}))[d.none=0]="none",d[d.encodeUrl=1]="encodeUrl",d[d.encodeCommand=2]="encodeCommand";let g=f.Ov.isActivated("E2D71F66-C24B-4BB1-A8A0-D31E816358AE");class h{static createProtocolHandlerUrl(a,b,c,d,e,f,h){var i;let j=[],k=a.split("|");if(2===k.length||!g&&"onenote"===k[0].toLowerCase())return j.push(k[0]),j.push(":"),j.push(b),j.join("");3===k.length&&(a=k[0]),j.push(a),j.push(":"),j.push(c),f&&"ms-excel"===a&&c!==this.protocolCommand.New&&j.push(2===e?"%7Cofc":"|ofc"),h&&("ms-word"===(i=a)||"ms-powerpoint"===i||"ms-excel"===i)&&function(a,b,c){let{clickOriginAppGuid:d,clickCorrelationID:e,clickTime:f}=b;d&&(a.push(2===c?"%7Cor%7C":"|or|"),a.push(d)),e&&(a.push(2===c?"%7Ccid%7C":"|cid|"),a.push(e)),f&&(a.push(2===c?"%7Cct%7C":"|ct|"),a.push(f.toString()))}(j,h,e),j.push(2===e?"%7Cu%7C":"|u|"),j.push(b),c===this.protocolCommand.New&&(j.push(2===e?"%7Cs%7C":"|s|"),d&&j.push(d));let l=j.join("");return 1===e?encodeURI(l):l}}h.protocolCommand={View:"ofv",Edit:"ofe",New:"nft"}}
,,,(a,b,c)=>{c.d(b,{a:()=>g});var d=c(32),e=c(16),f=c("odsp.util_126");class g{static AddWopiPerfMarkToTargetUrl(a,b,c,d){try{let h=new e.b(c);return h.setQueryParameter(g.param_CT,a,!0),h.setQueryParameter(g.param_OR,b,!0),void 0!==d&&f.B3.isFeatureEnabled({ODB:61451})&&h.setQueryParameter(g.param_ACT,d,!0),h.toString()}catch(a){}}static AddWopiPerfMark(a,b,c){try{if("sessionStorage"in window&&window.sessionStorage){if(c){let a=decodeURIComponent(c),d=a&&a.indexOf("sourcedoc=");if(-1!==d){let c=a.substring(d).indexOf("&"),e=-1===c?a.substring(d):a.substring(d,d+c);e=escape(e),window.sessionStorage["WOPIPerf_UserClick_"+e]=b}}window.sessionStorage.WOPIPerf_UserClickOrigin=a}}catch(a){}}static GetWopiFrameEditUrl(a){if(!a.properties["serverurl.progid"])return"";{let b="action=interactivepreview",c=a.properties.ServerRedirectedEmbedUrl;return c&&(c="ms-visio"!==a.appMap&&"ms-excel"!==a.appMap&&d.b.hasItemPermission(a,d.b.editListItems)?c.replace(b,"action=edit"):c.replace(b,"action=default")),c}}static GetWopiDocEditUrl(a,b,c){if(a.properties["serverurl.progid"]){let e="action=interactivepreview",f=a.properties.ServerRedirectedEmbedUrl;return f&&(f=this.ReplaceToDocAspx(f,a,b,c),f="ms-visio"!==a.appMap&&"ms-excel"!==a.appMap&&d.b.hasItemPermission(a,d.b.editListItems)?f.replace(e,"action=edit"):f.replace(e,"action=default")),f}}static ReplaceToDocAspx(a,b,c,d){a=a.replace("/WopiFrame.aspx?","/doc.aspx?");let f=new e.b(a);return f.setQueryParameter("uid",b.properties.UniqueId),f.setQueryParameter("ListItemId",b.properties.ID),f.setQueryParameter("ListId",c),f.setQueryParameter("odsp","1"),d&&d.length>0&&f.setQueryParameter("env",d),f.toString()}}g.param_CT="CT",g.param_OR="OR",g.param_ACT="ACT"}
,(a,b,c)=>{c.d(b,{a:()=>g,b:()=>h});let d=["htm","html","svg"],e=["eml","msg","md","mdown","markdown"];function f(a,b){return!!b&&a.indexOf(("."===b[0]?b.slice(1):b).toLowerCase())>=0}function g(a){return f(e,a)}function h(a){return f(d,a)}}
,(a,b,c)=>{c.d(b,{a:()=>f,b:()=>g});var d=c(160),e=c(534);class f{static areEqual(a,b,c=1e-6){return d.b.areEqual(a.translate,b.translate,c)&&Math.abs(Math.log(a.scale/b.scale))<c}static zoom(a,b,c){return new f(a.subtract(b).scale(c-1),c)}static centerWithinBounds(a,b,c){return new f(new e.b(d.b.ORIGIN,a).getCenter().subtract(d.b.getCenter([b,c])))}apply(a){return a.scale(this.scale).add(this.translate)}multiply(a){return new f(this.translate.add(a.translate.scale(this.scale)),this.scale*a.scale)}invert(){return new f(this.translate.scale(-1/this.scale),1/this.scale)}toString(){return`[Transform (${this.translate.x}, ${this.translate.y}) ${this.scale}]`}constructor(a=new d.b,b=1){this.translate=a,this.scale=b}}f.IDENTITY=new f;let g=f}
,(a,b,c)=>{c.d(b,{a:()=>f,b:()=>g});var d=c(160),e=c(535);class f{clip(a){let b=new f(this);return b.x<a.x&&(b.width-=a.x-b.x,b.x=a.x),b.getRight()>a.getRight()&&(b.width-=b.getRight()-a.getRight()),b.y<a.y&&(b.height-=a.y-b.y,b.y=a.y),b.getBottom()>a.getBottom()&&(b.height-=b.getBottom()-a.getBottom()),b}contains(a){if(a instanceof d.b)return a.x>=this.x&&a.y>=this.y&&a.x<=this.getRight()&&a.y<=this.getBottom();{let b=a.getPoint(),c=new d.b(a.getRight(),a.getBottom());return this.contains(b)&&this.contains(c)}}getCenter(){return new d.b(this.x+this.width/2,this.y+this.height/2)}getLeft(){return this.x}getTop(){return this.y}getRight(){return this.x+this.width}getBottom(){return this.y+this.height}getPoint(){return new d.b(this.x,this.y)}getSize(){return new e.b(this.width,this.height)}inflate(a,b){let c,d;return"object"==typeof a?(c=a.width,d=a.height):(c=a,d=b),new f(this.x-c/2,this.y-d/2,this.width+c,this.height+d)}nudge(a){let b=new f(this);return b.x<a.x?b.x=a.x:b.getRight()>a.getRight()&&(b.x=a.getRight()-b.width),b.y<a.y?b.y=a.y:b.getBottom()>a.getBottom()&&(b.y=a.getBottom()-b.height),b}translate(a,b){return a instanceof d.b?this.translate(a.x,a.y):new f(this.x+a,this.y+b,this.width,this.height)}union(a){let b=Math.min(this.x,a.x),c=Math.min(this.y,a.y);return new f(b,c,Math.max(this.x+this.width,a.x+a.width)-b,Math.max(this.y+this.height,a.y+a.height)-c)}fit(a,b){let c=a;c=this.width&&this.height&&(b?this.width>c.width||this.height>c.height:this.width>c.width&&this.height>c.height)?this._scaleTo(a,b):this;let d=(a.width-c.width)/2,e=(a.height-c.height)/2;return new f(d+this.x,e+this.y,c.width,c.height)}_scaleTo(a,b){let c=a.width/a.height,d=this.width/this.height,e=0,g=0;return(b?d:c)<(b?c:d)?(g=a.height,e=d*a.height):(e=a.width,g=a.width/d),new f(this.x,this.y,e,g)}constructor(a,b,c,e){this.x=0,this.y=0,this.width=0,this.height=0,0==arguments.length?(this.x=0,this.y=0,this.width=0,this.height=0):a instanceof f?(this.x=a.x,this.y=a.y,this.width=a.width,this.height=a.height):a instanceof d.b?(this.x=a.x,this.y=a.y,this.width=b.width,this.height=b.height):"object"==typeof a&&"number"==typeof a.left&&"number"==typeof a.top&&"number"==typeof a.width&&"number"==typeof a.height?(this.x=a.left,this.y=a.top,this.width=a.width,this.height=a.height):(this.x=a,this.y=b,this.width=c,this.height=e)}}let g=f}
,(a,b,c)=>{c.d(b,{a:()=>d,b:()=>e});class d{constructor(a,b){this.width=0,this.height=0,this.width=a,this.height=b}}let e=d}
,(a,b,c)=>{c.d(b,{a:()=>i,b:()=>h,c:()=>g});var d=c("odsp.util_126"),e=c(537),f=c(538);function g(a,b,c=!1){let d=Date.now()-a.getTime();if(d<-5*e.c);else if(d<e.c)return h("LessThanAMinute",c);else if(d<e.g)return h("AboutAMinute",c);else if(d<e.b)return i(Math.floor(d/e.c),"XMinutes");else if(d<e.f)return h("AboutAnHour",c);else if(d<e.a)return i(Math.floor(d/e.b),"XHours");else if(d<e.e){let d=a.toLocaleTimeString(b);return h("YesterdayAndTime",c).replace("{0}",d)}else if(d<e.d)return i(Math.floor(d/e.a),"XDays");return"undefined"!=typeof Intl&&Intl.DateTimeFormat?(j[b]||(j[b]=new Intl.DateTimeFormat(b)),j[b].format(a)):a.toLocaleDateString(b)}function h(a,b,c,d){return f["RelativeDateTime_"+a+(c?"Future":"")+(d?"Intervals":"")+(b?"_StartWithLowerCase":"")]}function i(a,b,c,e){let f=h(b,!!e&&c,e),g=h(b,!1,e,!0);return((0,d.sQ)(f,g,a)||"").replace("{0}",a+"")}let j={}}
,(a,b,c)=>{c.d(b,{a:()=>h,b:()=>f,c:()=>d,d:()=>j,e:()=>i,f:()=>g,g:()=>e,h:()=>k,i:()=>l});let d=6e4,e=12e4,f=36e5,g=72e5,h=864e5,i=1728e5,j=27648e5;function k(a,b){return a.getDate()===b.getDate()&&Math.abs(b.getTime()-a.getTime())<h}function l(a,b){return a.getFullYear()===b.getFullYear()}}
,,(a,b,c)=>{c.d(b,{a:()=>e});let d={"3fr":1,"3g2":1,"3gp":1,"3gp2":1,"3gpp":1,"3mf":1,ai:1,ari:1,arw:1,asf:1,avci:1,avcs:1,avi:1,bas:1,bay:1,bmp:1,cap:1,cbl:1,cfg:1,cool:1,cr2:1,cr3:1,crw:1,csv:2,cur:1,dcm:1,dcm30:1,dcr:1,dcs:1,dds:1,dib:1,dic:1,dicm:1,dicom:1,dng:1,doc:2,docm:2,docx:2,dot:2,dotm:2,dotx:2,drf:1,dwg:1,eip:1,eml:1,epdf:1,epub:1,erf:1,exif:1,fbx:1,fff:1,flac:1,fppx:1,gif:1,hdp:1,heic:1,heics:1,heif:1,heifs:1,ico:1,icon:1,iiq:1,jfif:1,jpe:1,jpeg:1,jpg:1,jxr:1,k25:1,kdc:1,key:1,m2ts:1,m4a:1,m4v:1,mat:1,mef:1,mkv:1,mos:1,mov:1,movie:1,mp3:1,mp4:1,mp4v:1,mpeg:1,mpg:1,mrw:1,msg:1,mts:1,nef:1,notebook:2,nrw:1,numbers:1,obj:1,odf:2,odp:2,ods:2,odt:2,ogg:1,one:2,onepkg:2,onetoc2:2,opus:1,orf:1,ori:1,pages:1,pano:1,pdf:1,pdfa:1,pef:1,pict:1,ply:1,png:1,pot:2,potm:2,potx:2,ppa:2,ppam:2,pps:2,ppsm:2,ppsx:2,ppsxm:1,ppt:2,pptm:2,pptx:2,psb:1,psd:1,ptx:1,pxn:1,raf:1,raw:1,rle:1,rtf:2,rw2:1,rwl:1,sketch:1,sr2:1,srf:1,srw:1,stl:1,tif:1,tiff:1,vdw:2,vsd:2,vsdm:2,vsdx:2,vsl:2,vss:2,vssm:2,vssx:2,vst:2,vstm:2,vstx:2,wdp:1,webm:1,webp:1,wma:1,wmv:1,x3f:1,xbm:1,xcf:1,xd:1,xla:2,xlam:2,xll:2,xls:2,xlsb:2,xlsm:2,xlsx:2,xlt:2,xltm:2,xltx:2,xpm:1};function e(a){return!!a&&d[a=("."===a[0]?a.slice(1):a).toLowerCase()]>=1}}
,(a,b,c)=>{c.d(b,{a:()=>g});var d,e=c("odsp.util_126");let f={ODB:563,Fallback:!1};!function(a){"use strict";var b;function c(a){return"url"===a||"website"===a}a.isShortcutItem=function(a){return!!a&&!!a.extension&&c("."!==a.extension[0]?a.extension:a.extension.slice(1))},a.isShortcutFileType=c,a.isShortcutEnabled=function(){return e.B3.isFeatureEnabled(f)},(b=a.ShortcutErrors||(a.ShortcutErrors={}))[b.UnknownError=0]="UnknownError",b[b.NewFileCreationFileAlreadyExistsError=1]="NewFileCreationFileAlreadyExistsError",b[b.InvalidCharacterError=2]="InvalidCharacterError"}(d||(d={}));let g=d}
,(a,b,c)=>{function d(a){return!a.RemoteItem&&1===Number(a["Created_x0020_Date.ifnew"])}function e(a){let b=Number(a._VirusStatus)||0;return 0!==b&&3!==b}c.d(b,{a:()=>e,b:()=>d})}
,(a,b,c)=>{let d,e;c.d(b,{a:()=>g});let f=(d={},e=new WeakMap,Object.freeze(d),e.set(d,!0),!!e.get(d));function g(a){f&&!Object.isFrozen(a)&&Object.freeze(a)}}
,,(a,b,c)=>{c.d(b,{a:()=>g});var d=c(164),e=c("odsp.util_126");class f{get scope(){return this._Component_scope}get isDisposed(){return this.scope.isDisposed}dispose(){this._Component_scope.dispose()}managed(a){return this.resources&&(a=this.resources.injected(a)),this.scope.attached(a)}child(a){let b;return b=a instanceof e.v7?this.resources.consume(a):this.resources?this.resources.injected(a,{injectChildResourceScope:!0}):a,this.scope.attached(b)}constructor(a={},b={}){const{id:c="Component"}=a,{resources:f=b.resources?new e.ny(b.resources,{owner:c,internalSource:"Component"}):a.resources}=this;this.id=c,this.resources=f,this._Component_scope=new d.a}}f.dependencies={resources:e.m3};let g=f}
,(a,b,c)=>{c.d(b,{a:()=>d});let d="https://outlook.office365.com"}
,(a,b,c)=>{c.d(b,{a:()=>j,b:()=>i});var d=c("odsp.util_126");let e="EUPL",f="undefined"!=typeof window?window.performance:void 0;function g(a,b=!0){return b&&0!==a.lastIndexOf(`${e}.`)?`${e}.${a}`:a}function h(a,b){try{f&&f.mark&&f.mark(g(a,b))}catch{}}function i(a,b,c){h(`${a}${b?`(${b})`:""} (start)`,c)}function j(a,b,c,d){h(`${a}${c?`(${c})`:""} (end${b?`, ${b}`:""})`,d),function(a,b,c,d){try{f&&f.measure&&f.measure(g(a,d),g(b,d),g(c,d))}catch{}}(`${a}${c?`(${c})`:""}${b?` (${b})`:""}`,`${a}${c?`(${c})`:""} (start)`,`${a}${c?`(${c})`:""} (end${b?`, ${b}`:""})`,d)}function k(){let a=performance.getEntriesByType("mark");for(let b of(a.sort((a,b)=>a.startTime-b.startTime),a))console.log(`${b.startTime.toFixed(0)} : ${b.name}`)}(0,d.PZ)("performance",{get:()=>({logMarks:k})}),window.__debugLogPerformanceMarks=k}
,,(a,b,c)=>{c.d(b,{a:()=>e});class d{notify(a,b){let c=(a,b,c)=>{try{a(b,c)}catch(a){console.warn(a)}};if(this._observers[b]){let d=this._observers[b].slice();for(let e=0;e<d.length;e++)c(d[e],a,b)}if(this._observers[""]){let d=this._observers[""].slice();for(let e=0;e<d.length;e++)c(d[e],a,b)}}subscribe(a,b){return b=b||"",this._observers[b]||(this._observers[b]=[]),this._observers[b].push(a),this.subscriberCount++,a}unsubscribe(a,b){if(b=b||"",this._observers[b]){let c=this._observers[b].indexOf(a);c>=0&&(this._observers[b].splice(c,1),this.subscriberCount--)}}constructor(){this.subscriberCount=0,this._observers={}}}class e extends d{get value(){return this._value}set value(a){this._value=a,this.notify(this._value,"set")}constructor(a){super(),this._value=a}}}
,(a,b,c)=>{c.d(b,{a:()=>d});function d(a){return"/shares/u!"+btoa(a).replace("=","").replace("/","_").replace("+","-")}}
,(a,b,c)=>{c.d(b,{a:()=>d});function d(a){return document.body||"interactive"===document.readyState||"complete"===document.readyState?(a(!1),Promise.resolve(!1)):new Promise((b,c)=>{let d=setInterval(()=>{if(document.body){clearInterval(d);try{a(!0),b(!0)}catch(a){c(a)}}},5)})}}
,(a,b,c)=>{c.d(b,{a:()=>s});var d=c(48),e=c(62),f=c(161),g=c("odsp.util_126"),h=c(274),i=c(166),j=c(273),k=c(290),l=c(167),m=c(291);let n=new Set;n.add(".docx"),n.add(".txt"),n.add(".html");let o={ODC:"EnableAudioPlayer",ODB:841,OneDrive:!0},p={"ar-SA":!0,"he-IL":!0,"ja-JP":!0,"ko-KR":!0,"zh-CN":!0},q=/&(?:access_|proof)token=[^&]*/g;class r{getVideoUrl(a){if("False"===a.item[i.a.hasVideoManifest]&&!a.item[i.a.videoManifestUrl]&&"audio"!==f.b(a.fileExtension)&&!g.lU.isFeatureEnabled(o))return;let b=this._processor.generateUrl(i.a.videoManifestUrl,a.item);if(b){if(k.b){let c=a.item[i.a.cTag];c&&(b+=`&cTag=${encodeURIComponent(c)}`)}b+="&action=Access"}return b}getThumbnail(a,b){if(("False"!==a.item[i.a.hasThumbnail]||a.item[i.a.thumbnailUrl])&&this._thumbnailHelper.canProvideThumbnail(a.fileExtension)){let c=this._processor.generateUrl(i.a.thumbnailUrl,a.item,void 0,b);c&&(c+="&encodeFailures=1");let{allowCookieAuth:d=!0,itemKey:e,fileExtension:f,mediaServiceMetadata:h}=a;if(c&&d&&this._cookieHelper.canUseCookies())c=c.replace(q,""),k.b&&a.item[i.a.cTag]&&(c+="&ctag="+encodeURIComponent(a.item[i.a.cTag])),this._cookieHelper.trackItem({itemKey:e,thumbnailUrl:c,fileExtension:f,mediaServiceMetadata:h});else if(c&&!b?.isMeTATempAuthDeprecationEnabled){let a=this._processor.getCommonAuthData();if(a){let b=g.lU.isFeatureEnabled(l.a),d={authToken:b?a.authTokenV21:a.authToken,proofToken:b?a.proofTokenV21:a.proofToken},e=this._authTokenStore.getToken(this._processor.getUniqueKey(),d);e&&e!==d&&(c=c.replace(q,`&access_token=${e.authToken}${e.proofToken?`&prooftoken=${e.proofToken}`:""}`))}}return c?this._thumbnailHelper.getThumbnail({itemKey:e,fileExtension:f,baseUrl:c,mediaServiceMetadata:h}):void 0}}getDownloadAsZipUrl(a){let b=i.a.zipUrl,c=this._processor.getNormalUrl(b,a);return c||(a[i.a.zipUrl]=i.d,c=this._processor.getFallbackUrl(b,a)),c}getPassthroughUrl(a,b){return this._processor.generateUrl(i.a.transformUrl,a.item,"passthrough",b)}getPdfConversionUrl(a,b,c){let d=a.fileExtension;return(this._pageContext.blockDownloadsExperienceEnabled||this._pageContext.viewOnlyExperienceEnabled)&&j.b(d)?this.getPassthroughUrl(a,c):!p[e.a.language]&&(j.a(d,!0)||b)?this._processor.generateUrl(i.a.pdfConversionUrl,a.item,void 0,c):void 0}getFbxConversionUrl(a,b){return"True"===a.item[i.a.hasBxf]&&h.a(a.fileExtension)?this._processor.generateUrl(i.a.transformUrl,a.item,"bxf",b):""}getHtmlConversionUrl(a,b){return this._processor.generateUrl(i.a.transformUrl,a.item,"html",b)}getZipMetaDataUrl(a,b){return this._processor.generateUrl(i.a.transformUrl,a.item,"zipmetadata",b)}getDownloadZipContentsUrl(a){return this._processor.generateUrl(i.a.transformUrl,a,"zipcontent")}getImmersiveReaderUrl(a){var b;if(b=a.fileExtension,n.has(b))return this._processor.generateUrl(i.a.transformUrl,a.item,"imreader")}getOfficeBundleGenerateUrl(a){if("False"===a.item[i.a.hasOfficePreview]&&!a.item[i.a.officeBundleGenerate])return;let b=this._processor.generateUrl(i.a.officeBundleGenerate,a.item);if(!k.b)return b&&b.replace("Generate","")+"&minVersion={{minVersion}}";{let c=encodeURIComponent(a.item[i.a.cTag]);return b&&b.replace("Generate","")+`&minVersion={{minVersion}}&cTag=${c}`}}getOfficeBundleGetFragmentUrl(a){if("False"===a.item[i.a.hasOfficePreview]&&!a.item[i.a.officeBundleGetFragment])return;let b=this._processor.generateUrl(i.a.officeBundleGetFragment,a.item);return b&&b.replace("Get","")+"&fragment={0}"}getitemUrlWithToken(a){let b=this._processor.getCommonProperty(i.a.driveAccessToken);return b&&(0,m.b)(a,b)}getPushChannelUrl(){return this._processor.getCommonProperty(i.a.pushChannelBaseUrl)}getGenerateTranscriptUrl(a){return this._processor.getAnalyzeUrl("transcriptinit",a.item)}getThumbnailSpriteBaseUrl(a){if(!g.Ov.isActivated("957EE380-12BB-11EF-9E35-0800200C9A66","2024-05-15","Killswitch for adding thumbnailSpriteBaseUrl for video files.")&&"video"===f.b(a.fileExtension))return this._processor.generateUrl(i.a.transformUrl,a.item,"thumbnailSprite")}getMediaBaseUrl(a){return this._processor.generateUrl(i.a.mediaBaseUrl,a.item)}constructor(a,b){this._processor=b.metaDataProcessor,this._cookieHelper=b.authCookieHelper,this._thumbnailHelper=b.thumbnailHelper,this._pageContext=b.pageContext,this._authTokenStore=b.authTokenStore}}class s extends r{getAuthData(){return this._authTokenDataSource&&this.hasAuthDataExpired()?this._authTokenDataSource.getAuthToken({}).then(a=>(this.setBaseInfo(a),this._authDataSignal.getPromise())):this._authDataSignal.getPromise()}hasAuthData(){return!!this._processor.getCommonAuthData()}hasAuthDataExpired(){let a=new Date;a.setMinutes(a.getMinutes()+5);let b=this._processor.getCommonAuthData();return!!b&&b.expirationTime<=a}setBaseInfo(a){this._baseInfoSet=!0;let b=this._processor.parseCommonData(a);for(let a of(b.authData&&(this._authDataSignalCompleted?this._authDataSignal=new d.b:this._authDataSignalCompleted=!0,this._authDataSignal.complete(b.authData)),this._cookieHelper.checkCookies(b.mediaUrl,b.authData),this._baseInfoSetCallbacks))a()}hasSetBaseInfo(){return this._baseInfoSet}registerSetBaseInfoCallback(a){this._baseInfoSetCallbacks.push(a)}constructor(a,b){super(a,b),this._baseInfoSetCallbacks=[],this._authDataSignalCompleted=!1,this._authDataSignal=new d.b,this._authTokenDataSource=b.authTokenDataSource,this._baseInfoSet=!1}}}
,(a,b,c)=>{c.d(b,{a:()=>k,b:()=>l});var d=c(242),e=c(23),f=c("odsp.util_126");let g={ODB:816,OneDrive:!0},h={ODB:820},i={".xls":!0,".xlsx":!0},j={".jpg":!0,".jpeg":!0,".png":!0,".gif":!0,".doc":!0,".docx":!0,".ppt":!0,".pptx":!0};class k{getImageUrl(a){if(a.isCrossDomain){let b=this._apiUrlHelper.build().webByItemUrl(a);return(b=(b=b.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:a.serverRelativeItemUrl})).segment("OpenBinaryStream")).toString()}return a.fullItemUrl}constructor(a,b){this._apiUrlHelper=b.apiUrlHelper}}class l{getThumbnail({fileExtension:a="",itemKey:b,baseUrl:c,mediaServiceMetadata:d}){let e,f,g=d&&d.photo,h=d&&d.video;g?(e=g.width,f=g.height):h&&(e=h.frameWidth,f=h.frameHeight);let i={width:e||0,height:f||0};if(".gif"===a.toLowerCase()){let a=this._itemUrlHelper.getItemUrlParts(b),c={url:this._crossDomainImageHelper.getImageUrl(a),...i};return{...c,getAligned:()=>c}}if(c){let a=d&&d.lenses;return a&&a.officeLens&&(c+="&lenses=OfficeLens"),{url:this._getUrl({baseUrl:c}),...i,getAligned:(a,b)=>({url:this._getUrl({baseUrl:c,desiredSize:a,alignment:b,width:e,height:f}),...i})}}}canProvideThumbnail(a){return!!a&&("."===(a=a.toLowerCase())[0]&&(a=a.substring(1)),!i[a]&&(!!f.B3.isFeatureEnabled(g)||!!f.B3.isFeatureEnabled(h)&&!!a&&!j[a]))}_getUrl(a){let b,{desiredSize:c={width:1024,height:1024},alignment:f,width:g,height:h}=a;f&&(f.name===d.a.name?b="fill":f.name===`${d.c.name}-${d.d.name}`&&(b="dochead"));let i={width:Math.ceil(c.width),height:Math.ceil(c.height),srcWidth:g||"",srcHeight:h||""};return b&&(i.cropMode=b),`${a.baseUrl}&${(0,e.a)(i)}`}constructor(a){this._itemUrlHelper=a.itemUrlHelper,this._crossDomainImageHelper=a.crossDomainImageHelper}}}
,(a,b,c)=>{c.d(b,{a:()=>l});var d=c(48),e=c(9),f=c(114),g=c("odsp.util_126");function h(a){let b=new d.b,c=document.createElement("img");return c.onload=()=>{b.complete()},c.onerror=()=>{b.error()},c.src=a,b.getPromise()}let i=[];class j{static initializeAuthenticators(a,b){if(b)if(window.$Config.aadClientId&&"live.com"===window.$Config.domain);else{let c=b.s,d=b.r;for(let b=0;c&&b<c.length;b++)i.push(new j(a[b],c[b],!d[b]));b.c=a=>{i[a].onAuthComplete()},j.authenticate("https://livefilestore.com/"),j.authenticate("https://1drv.com/")}}static authenticate(a){let b;for(let c=0;c<i.length;c++){let d=i[c];if(d.requiresAuth(a)){b=d.authenticate(a);break}}let c=[b||e.c.wrap(!0)];for(let b of this._cookieCheckers)b.isApplicable(a)&&c.push(b.check(a));return e.c.all(c).then(a=>a.reduce((a,b)=>a&&b))}static registerCookieChecker(a){this._cookieCheckers.push(a)}requiresAuth(a){return this.domainRegex.test(a)}authenticate(a){let b=new Date().getTime();if(b-this._lastAttempt>6e5&&(this._authPromise=null,this._lastAttempt=b),!this._authPromise){this._authPromise=new d.b;let a=document.createElement("IFRAME");a.src=this.iframeSrc,a.style.display="none",document.body.appendChild(a)}return this._authPromise.getPromise()}onAuthComplete(){this._authPromise.complete(!0)}constructor(a,b,c){this.complete=!1,this.pending=!1,this.eventName="cookieToss",this._lastAttempt=0,this.domainRegex=a,this.iframeSrc=b,this.complete=c}}j._cookieCheckers=[];var k=c(167);class l{canUseCookies(){return!!(this._cookieAuthData.active||1===this._cookieState)}trackItem(a){this._cookieAuthData.active||this.itemsWaitingForCookies.push({...a})}checkCookies(a,b){if(-1!==this._cookieState&&b&&b.supportsCookies&&(this._cookieAuthData.mostRecent=b,1!==this._cookieState))if(this._cookieAuthData.active){if(this._cookieAuthData.active!==b){let c=Date.now()-this._cookieAuthData.active.timeReceived.getTime();c>432e5&&(this._haveCookies=new d.b,this._cookieAuthData.active=void 0),c>72e5&&this._updateCookies(a,b)}}else this._updateCookies(a,b)}_updateCookies(a,b){let c=0===this._cookieState;this._cookieState=1,this._makeImageRequest(a,b,c).then(()=>{this._cookieAuthData.active=b,this._cookieState=2,this.itemsWaitingForCookies.length=0,this._haveCookies.complete(!0)},()=>{this._cookieState=-1,this._updateThumbnailUrls(b),this._haveCookies.error(!1)})}_makeCorsRequest(a,b){let c;a+="/Auth/SetCookies?provider=spo";let d=g.B3.isFeatureEnabled(k.a),f=d?b.authTokenV21:b.authToken,h=d?b.proofTokenV21:b.proofToken;return this._platform.isIE&&this._platform.browserMajor<=10?(a+="&access_token="+f,a+="&prooftoken="+h):c={spo_access_token:f,spo_prooftoken:h},this.sendCorsRequest(a,c).then(b=>{if(!b.isOldCookiePresent)return this.sendCorsRequest(a,c).then(a=>{if(!a.isOldCookiePresent)return e.c.wrapError("Cookie request succeeded, but the cookies are not actually being set")})})}sendCorsRequest(a,b){return f.a.start({withCredentials:!0,url:a,headers:b,method:"POST"}).then(a=>{let b;try{b=JSON.parse(a.responseText)}catch(a){}return b||e.c.reject("Expected response object but received nothing")})}_makeImageRequest(a,b,c){let d=g.B3.isFeatureEnabled(k.a),e=d?b.authTokenV21:b.authToken,f=d?b.proofTokenV21:b.proofToken;return a+="/Auth/SetCookiesImg?provider=spo",a+="&access_token="+e,h(a+="&prooftoken="+f).then(()=>{if(c)return h(a+"&throwOnMissingCookies=true")})}_updateThumbnailUrls(a){this.itemsWaitingForCookies.length&&this._updateThumbnailUrlCallback(this,a)}constructor(a,b){this._platform=b.platformDetection,this.thumbnailHelper=b.thumbnailHelper,this._updateThumbnailUrlCallback=b.updateThumbnailUrlCallback,this._cookieState=0,this._haveCookies=new d.b,this.itemsWaitingForCookies=[],this._cookieAuthData={},j.registerCookieChecker({isApplicable:a=>!(a.indexOf("access_token")>0||0>a.indexOf(".svc.ms/transform/thumbnail")),check:a=>{let b=new d.b;return this._haveCookies.getPromise().done(a=>b.complete(a),a=>b.error(a)),b.getPromise()}})}}}
,(a,b,c)=>{c.d(b,{a:()=>g});var d=c(47),e=c(41),f=c(159);class g{getToken(a,b){if(a){let c=this._dataStore.getValue(a);if(c&&!(0,f.a)(c,36e5))return c;this._dataStore.setValue(a,b)}return b}constructor(a={},b={}){const{dataStoreType:c=d.a}=b;this._dataStore=new c("MediaAuthStore",e.a.session)}}}
,(a,b,c)=>{c.d(b,{a:()=>e});var d=c("react-lib");class e extends d.PureComponent{static getDerivedStateFromError(a){return{hasError:!0}}render(){return this.state.hasError?this.props.fallback?this.props.fallback:null:d.createElement(d.Fragment,null,this.props.children)}componentDidCatch(a,b){this.props.onError&&this.props.onError(a,b)}constructor(a){super(a),this.state={hasError:!1}}}}
,(a,b,c)=>{c.d(b,{a:()=>d});class d{getPreAuthUrls(a){let{items:b,accessToken:c,driveUrl:d="",appId:e}=a;return this._dataRequestor.send({path:`${d||"/drive"}/getPreAuthorizedUrls${e?"?appId="+e:""}`,apiName:"GetPreAuthorizedUrls",postData:JSON.stringify({items:b}),requestType:"POST",accessToken:c,useAuthorizationHeaders:!!c}).then(a=>a.value)}constructor(a,b){this._dataRequestor=b.dataRequestor}}}
,(a,b,c)=>{c.d(b,{a:()=>n});var d=c(104),e=c(9),f=c(886),g=c(13),h=c(50),i=c(60),j=c(115),k=c(23),l=c(81),m=c("odsp.util_126");class n extends d.b{downloadItems(a){let{items:[b]}=a;return this.getDownloadUrl(b,null,{downloadType:f.a.download}).then(a=>{window.location.href=a})}getDownloadUrl(a,b,c={}){let{downloadType:d=f.a.download}=c,h=this._itemUrlHelper.getItemUrlParts(a.key);if(d===f.a.view)return e.c.resolve((0,l.a)(h.fullItemUrl));if(d===f.a.share){let b;b=a.video?24:1;let c=this._apiUrlHelper.build().webByItemUrl(h);return function(a){let{serverRelativeItemUrl:b,dataRequestor:c,webApiUrl:d,duration:e=1,authToken:f}=a,g=d;return g=(g=g.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:b})).method("GetPreAuthorizedAccessUrl",e),c.getData({url:g.toString(),method:"GET",authToken:f,qosName:"ItemDataSource.getDownloadUrl"}).then(a=>{let{d:{GetPreAuthorizedAccessUrl:b}}=a;return b})}({dataRequestor:this.dataRequestor,webApiUrl:c,duration:b,serverRelativeItemUrl:h.serverRelativeItemUrl})}if(d===f.a.load)if(h.isCrossDomain&&c.authToken)return this.dataRequestor.getData({url:this._apiUrlHelper.contextInfoUrl(h.fullItemUrl),method:"POST",qosName:"GetContextInfo",authToken:c.authToken}).then(a=>{let{d:{GetContextWebInformation:{WebFullUrl:b}}}=a,c=new i.a({webAbsoluteUrl:b}).build().segment("web").methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:h.serverRelativeItemUrl}).segment("OpenBinaryStream");return e.c.resolve(c.toString())});else return e.c.resolve(this.getBinaryStreamApiUrl(h).toString());{let a;if(b||h.siteRelation===g.d.sameSite){let c;c=b?this._itemUrlHelper.getItemUrlParts(b.key).fullItemUrl:this._pageContext.webAbsoluteUrl,a=e.c.resolve(c)}else c.webAbsoluteUrl||(a=!m.Ov.isActivated("3dd660dc-b6bd-411f-ae14-1f8134830f62","03/08/2023","Add feature to allow adding auth to getDownloadUrl for download type: Download.download scenario")&&c&&c.authToken&&h.isCrossDomain?this.dataRequestor.getData({url:this._apiUrlHelper.contextInfoUrl(h.fullItemUrl),method:"POST",qosName:"GetContextInfo",authToken:c.authToken}).then(a=>{let{d:{GetContextWebInformation:{WebFullUrl:b}}}=a;return b}):this.dataRequestor.getData({url:this._apiUrlHelper.contextInfoUrl(h.fullItemUrl),method:"POST",qosName:"GetContextInfo"}).then(a=>{let{d:{GetContextWebInformation:{WebFullUrl:b}}}=a;return b})),a=new e.c(a=>a(""));return a.then(a=>`${c.webAbsoluteUrl||a}/${this._pageContext.layoutsUrl}/download.aspx?${(0,k.a)({SourceUrl:h.serverRelativeItemUrl})}`)}}getBinaryStreamApiUrl(a){let b=this._apiUrlHelper.build().webByItemUrl(a);b=(b=b.methodWithAliases("GetFileByServerRelativePath",{DecodedUrl:a.serverRelativeItemUrl})).segment("OpenBinaryStream");let c=this._pageContext.authToken;return c&&(b=b.oDataParameter("access_token",c)),b}constructor(a){super({},{pageContext:a}),this._itemUrlHelper=new h.a({},{pageContext:a}),this._apiUrlHelper=new j.a({},{pageContext:a,itemUrlHelper:this._itemUrlHelper})}}}
,,(a,b,c)=>{c.d(b,{a:()=>e});var d=c("react-lib");let e=(a,b)=>d.useCallback(()=>{let b=0,c=0;return a?.register(),{start:(d=200)=>{a&&(a.start(),a.setMaximum(100),a.setCurrent(b),c=window.setInterval(()=>{if(100-b>10){b+=10,a.setCurrent(b);return}b=Math.floor((100-b)/4)+b,a.setCurrent(b)},d))},error:()=>{a&&(window.clearInterval(c),b=0,a.setCurrent(b),a.fail())},success:()=>{a&&(window.clearInterval(c),b=100,a.setCurrent(b),a.succeed())}}},b)}
,(a,b,c)=>{c.d(b,{a:()=>e});var d=c(279);function e(a,b,c={}){let{comparer:f=d.a,debug:g=!1}=c;if((0,d.a)(a,b))return!1;if("object"!=typeof a||null===a||"object"!=typeof b||null===b)return!g||{previous:a,next:b};let h=Object.keys(a),i=Object.keys(b);if(h.length!==i.length)return!g||{__keys:{previous:h,next:i}};for(let c of h)if(!(c in b)||!f(a[c],b[c],c))return!g||{[c]:{previous:a[c],next:b[c]}};return!1}}
,(a,b,c)=>{c.d(b,{a:()=>e});var d=c(116);function e(a){let b,{blockDownloadsExperienceEnabled:c,viewOnlyExperienceEnabled:e,itemIsFolder:f,itemHasOpenUrl:g,itemHasAppMap:h}=a;if(c||e)return c&&g&&h?b=d.b.ConditionalAccessViewOnly:c&&!f?b=d.b.ConditionalAccessBlocked:e&&(b=d.b.ConditionalAccessViewOnly),b}}
,(a,b,c)=>{c.d(b,{a:()=>e,b:()=>d});let d=(a,b,c)=>"--"+a+"\r\nContent-Type: "+b+"\r\nContent-Transfer-Encoding: "+c+"\r\n\r\n",e=(a,b,c,d,e)=>{let f=c+" "+d+" HTTP/1.1\r\n";return f+="Content-Type: "+a+"\r\nAccept: "+b+"\r\n",e&&(f+="Content-Length: "+e+"\r\n\r\n"),f}}
,,(a,b,c)=>{c.d(b,{a:()=>d,b:()=>f,c:()=>e,d:()=>j,e:()=>g,f:()=>n,g:()=>l,h:()=>k,i:()=>h,j:()=>m,k:()=>i});let d={r:255,g:255,b:255,a:1},e=3,f="#1F1F1F",g=.3,h=1,i=90,j={scale:1,rotation:0,currentScrollPosition:{x:0,y:0},originalLayoutSize:{width:0,height:0},originalPageRects:[]},k="Page-",l=5,m=[1,2,4,6,8,12],n=[8,12,16,24,28,32]}
,(a,b,c)=>{c.d(b,{a:()=>e});var d=c("react-lib");let e=a=>{d.useEffect(()=>{let b=()=>{matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`).addEventListener("change",b,{once:!0}),a()};b()},[a])}}
,,,,,(a,b,c)=>{c.d(b,{a:()=>m,b:()=>l});var d=c("react-lib"),e=c(37),f=c(148),g=c(481),h=c(84),i=c(597),j=c(598),k=c(599);(0,c("fui.util_178").ZW)([{rawString:".odPdfViewer_f71dc38d{width:100%;height:100%}.odPdfViewer_f71dc38d>div>div:focus{outline:auto 1px}"}]);let l=(a,b,c,d)=>{performance.mark("item-viewer-PDFViewerInit");let{workerUrl:g,wasmUrl:h,wasmJsUrl:i,dataUrl:j,parserWasmJsUrl:k,parserWasmUrl:l,mipWasmJsUrl:m,mipWasmUrl:n}=a,o=[{wasmUrl:h,wasmJsUrlOrBlob:i,dataUrl:j}];l&&k&&o.push({wasmUrl:l,wasmJsUrlOrBlob:k,type:"Manipulator"}),n&&m&&o.push({wasmUrl:n,wasmJsUrlOrBlob:m,type:"Mip"});let p=g.indexOf("odspserviceworkerproxy.aspx")>-1?"_swBuildNumber":void 0;e.a.setAll({workerSrc:g,wasmModuleInit:o,disableExternalWasmCache:!0,fontConfigs:b,globalVarNameForWorkerVer:p,features:c,mipPrefetchConfig:d}),(0,f.b)()},m=d.forwardRef((a,b)=>{performance.mark("item-viewer-PDFViewerRenders");let{openUrl:c,shouldAutoFocus:e}=a,f=d.useRef(null);d.useImperativeHandle(b,()=>({getPdfMetadata:()=>{let a=f.current?.getViewer();return a?{scale:a.scale,rotation:a.rotation,currentScrollPosition:a.currentScrollPosition,originalLayoutSize:a.originalLayoutSize,originalPageRects:a.originalPageRects}:{scale:-1,rotation:0,currentScrollPosition:new h.a(0,0),originalLayoutSize:{height:0,width:0},originalPageRects:[]}},rotate:async a=>{await f.current?.getViewer()?.rotate(a)},scrollBy:(a,b)=>{f.current?.getViewer()?.scrollBy(a,b)},scrollTo:(a,b,c)=>{f.current?.getViewer()?.scrollTo(a,b,c)},onMouseMove:a=>{f.current?.onMouseMove(a)},getEventHandlers:()=>f.current?.getViewer()?.getEventHandlers(),getToastOperation:()=>f.current?.getToastOperation(),merge:a=>f.current?.getViewer()?.merge(a),hasSignature:()=>f.current?.getViewer()?.hasSignature?.()}),[]),d.useEffect(()=>{e&&f.current?.getViewer()?.focus()},[e]);let l=d.useCallback(()=>{if(c&&0!==c.length)try{window.open(c,"_blank","noopener")}catch(a){console.log(`Fail to open PDF in new window, error: ${JSON.stringify(a)}`)}},[c]);return d.createElement("div",{className:"odPdfViewer_f71dc38d"},d.createElement(g.a,{ref:f,...a,localeStrings:{app:i,content:j,annotBar:k},onOpenInNewWindow:l}))})}
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,(a,b,c)=>{var d,e;c.d(b,{a:()=>d}),(e=d||(d={}))[e.Click=1]="Click",e[e.Tap=2]="Tap",e[e.Keyboard=3]="Keyboard",e[e.Drop=4]="Drop"}
,,,(a,b,c)=>{c.d(b,{a:()=>e});var d=c(277);function e(a){let b=a.replace(".",""),c=Object.keys(d.a);for(let a in c)if(d.a.hasOwnProperty(c[a])){let e=c[a];if(d.a[e].indexOf(b)>-1)return e}}}
,(a,b,c)=>{c.d(b,{a:()=>i,b:()=>j,c:()=>k});var d,e,f=c("odsp.util_126"),g=c(261);let h=!f.Ov.isActivated("EEAA73AF-8769-4895-9A57-3A03F7E1AC29");(d=e||(e={})).enableAnalyzeImage="enableAnalyzeImage",d.enableODSPCortexImage="enableODSPCortexImage";let i={name:"enableAnalyzeImage",experiment:90269,feature:h?{ODB:61293,ODC:!1}:{ODB:61293}},j={name:"enableODSPCortexImage",feature:h?{ODB:62081,ODC:!1}:{ODB:62081}};function k(a,b){if(b){if(a.appSpecific&&-1===a.appSpecific.indexOf(b)||a.appsExcluded&&-1!==a.appsExcluded.indexOf(b))return!1}else if(a.appSpecific||a.appsExcluded)return!1;return!!(a.feature&&f.lU.isFeatureEnabled(a.feature)||a.killSwitch&&!f.Ov.isActivated(a.killSwitch)||a.experiment&&1===(0,g.a)(a.experiment)||a.isEnabled&&a.isEnabled())}}
,(a,b,c)=>{c.d(b,{a:()=>e,b:()=>h});let d=["pdf","docx","xlsx","doc","odt","ppt","pptx","odp","rtf","txt","htm","html","aspx","loop","fluid",...c(606).j?[]:["page"]],e=["bmp","dib","gif","ico","jfif","jpe","jpeg","jpg","png","svg","tif","tiff","xbm","xpm"];[...e];let f=["xls","xlsx","xlb","xlc","xlsb","xlsm","xlt","xltx","xltm","xlm","xla","xll","xlam","xlw","excel","csv","odc","ods","doc","docx","docm","dot","dotx","dotm","odt","docb","wbk","rtf","word","pptx","ppt","pot","potx","potm","ppam","ppsx","ppsm","sldx","sldm","ppa","pps","pptm","odp","powerpoint"];function g(a,b){a.forEach(a=>{b.has(a)||b.set(a,a)})}function h(a,b){let c=new Map;return g(d,c),g(f,c),g(["md","one"],c),a&&g(e,c),b&&g(["mp4"],c),{map:c,array:Array.from(c.values())}}}
,(a,b,c)=>{c.d(b,{a:()=>f,b:()=>n,c:()=>e,d:()=>p,e:()=>k,f:()=>g,g:()=>h,h:()=>i,i:()=>l,j:()=>m,k:()=>o,l:()=>j,m:()=>q,n:()=>t});var d=c("odsp.util_126");d.Ov.isActivated("73C30953-F1D9-4AA7-8CBF-3FBCA6EF8967");let e=!d.Ov.isActivated("0AD73D0F-A8BF-458A-A170-85E1AE657C54");d.Ov.isActivated("1730F2A0-FAF4-4982-B7C5-0C6ED7892310"),d.Ov.isActivated("af77d302-97ca-4db3-ad92-370bb0c32fd2"),d.Ov.isActivated("EA2E7878-BDA1-4976-AF51-2114EBEB14B1");let f=!d.Ov.isActivated("86DEFC3E-B100-402D-A498-A1BB294C4A8D");d.Ov.isActivated("C3064A1E-7D37-4075-BD67-B231550000F9"),d.Ov.isActivated("A28243FA-A021-4DFA-904F-D8FEA9C116F3"),d.Ov.isActivated("9f46d127-a10f-44e9-bdf8-16d8225b17f5");let g=!d.Ov.isActivated("F39CAE90-1462-4670-A02C-B39822AADA11");d.Ov.isActivated("54d50a4a-4131-4585-ad52-0e49e8c5afad"),d.Ov.isActivated("5143c1d2-68dd-42a2-b6d5-ae9f20ac29e8"),d.Ov.isActivated("26F3418F-C046-4391-9AC2-AAF4AD7CC240"),d.Ov.isActivated("AACD847F-9FE2-4CD2-848B-752AE11CDA75"),d.Ov.isActivated("95CB0BC2-9E6F-4A19-B021-CB6C0EECBEF6"),d.Ov.isActivated("D1041FF8-666B-4F40-94E4-A6CD50DB6012"),d.Ov.isActivated("8c4805cf-6e29-41a7-b6e3-947317298f2e"),d.Ov.isActivated("5c915908-1f02-4284-93af-e61756abd16d"),d.Ov.isActivated("ad3f574d-b704-4411-8e31-500fafbcdf42");let h=!d.Ov.isActivated("d30c55ac-8771-4c23-984f-0f0d2e8b56e4");d.Ov.isActivated("20496d14-997c-480b-955f-ec3ce65844cc"),d.Ov.isActivated("069CB1D3-21D0-400E-8766-09614CE9FE69"),d.Ov.isActivated("fc913696-f050-49e5-ac88-fb2e86f91917");let i=!d.Ov.isActivated("d381f44a-069a-4e8d-b89b-09e852f90d98"),j=!d.Ov.isActivated("c33c69db-7554-46fa-8cf0-945349ce1687");d.Ov.isActivated("56ba9a30-707c-48c5-96ec-a1b9e7b7302f");let k=!d.Ov.isActivated("2cf47be1-64ea-4edf-ae12-c886f6a1e942");d.Ov.isActivated("80670016-CE96-49A4-AA11-866A510B3ECB"),d.Ov.isActivated("C1E0C854-768E-49D6-BDBD-2AF8EFEFFBFD");let l=d.Ov.isActivated("DB84A8AB-B82B-41F8-8E13-E0108E2E88BB"),m=d.Ov.isActivated("FAC4C621-2A97-4E4A-8E3C-14B3DAEAE670");d.Ov.isActivated("74DB16F6-854E-4FE5-BC64-2C1279E3B521"),d.Ov.isActivated("b6e1f3e2-2d0e-4f3b-9c8e-5f3d6e4c8f7a");let n=!d.Ov.isActivated("764c911f-aabd-46f3-ac42-94b16ed3002c");d.Ov.isActivated("c5fb012c-9998-4864-abc6-cbbb5a30f949"),d.Ov.isActivated("8a3b2c1d-4e5f-6a7b-8c9d-0e1f2a3b4c5d"),d.Ov.isActivated("b4c5d6e7-f8a9-0b1c-2d3e-4f5a6b7c8d9e"),d.Ov.isActivated("79fc903d-e357-4d9c-9ca6-ba9d882ffecb");let o=!d.Ov.isActivated("831c2fd4-0714-49b9-813f-6658ecb6489f");d.Ov.isActivated("334b365c-0196-4b43-8838-9c7aeba0f47d"),d.Ov.isActivated("F1ED74E9-721D-4A42-820A-0DFC1BA39F77"),d.Ov.isActivated("D1D238FF-1235-4807-B9DC-08B455470DBA"),d.Ov.isActivated("630ace56-af69-404f-b71f-c0b52c65dd69"),d.Ov.isActivated("4a694cdd-9590-46c7-a015-41d19fe7ba73"),d.Ov.isActivated("dbb9471f-134f-432b-8848-076349ef9811"),d.Ov.isActivated("48B2D47F-301A-4617-B2B0-0B89C1135DCB");let p=!d.Ov.isActivated("8A0D74D4-8D7B-42C7-AB99-0D66B92A58E1");function q(){return!d.Ov.isActivated("7e444452-0cf9-4a03-a4c7-1963b6754d8d")}d.Ov.isActivated("48B2D47F-301A-4617-B2B0-0B89C1135DCB"),d.Ov.isActivated("a1b2c3d4-e5f6-7890-abcd-ef1234567890");let r=!d.Ov.isActivated("48ce2531-1d34-480e-9ac7-bf4eece8c0ec"),s={ODB:-9999,ODC:!1};function t(a,b){return r&&a&&(!!b||d.lU.isFeatureEnabled(s))}}
,,(a,b,c)=>{c.d(b,{a:()=>d});function d(a){if(!a||!a.length)return;let b=[];for(let c of a){if(!c.sharepointIds)continue;let{siteId:a,webId:d,listId:e,listItemUniqueId:f}=c.sharepointIds;a&&d&&e&&f&&b.push({siteId:a,webId:d,listId:e,uniqueId:f,fileName:c.name})}return b}}
,,,,,,,,,,,,,(a,b,c)=>{c.d(b,{a:()=>n});var d=c("react-lib"),e=c(358),f=c(3),g=c("fui.core_517"),h=c(356),i=c(357),j=c(70);let k=(0,g.n94)({root:{display:"block",lineHeight:"normal",...h.a.padding("5px","0px")},required:{paddingRight:"12px"},disabledV2:{color:i.a.semanticDisabledBodyText}}),l=(0,f.a)({useStaticStyles:!0}),m=new Set(["as","className","componentRef","required","disabled","theme","styles"]),n=a=>{let b,c,f=(b=k(),c=l(a.styles),{...{ref:a.componentRef,required:!!a.required&&{className:b.required,children:"*"},disabled:a.disabled??!1,className:(0,g.tlm)(a.disabled&&b.disabledV2,"ms-Label",b.root,c.root,a.className)},...(0,j.d)(a,m)});return d.createElement(e.a,{weight:"semibold",...f},a.children)};n.displayName="LabelShim"}
,,(a,b,c)=>{c.d(b,{a:()=>d});let d=c(1).a("images/copilot/svg/ic_fluent_copilot_20_color.svg")}
,(a,b,c)=>{c.d(b,{a:()=>d});let d=c(1).a("images/copilot/svg/ic_research_planet_file_20_color.svg")}
,,(a,b,c)=>{c.d(b,{a:()=>d});let d=c(1).a("images/atp/malware_icon_208x208.svg")}
,(a,b,c)=>{c.d(b,{a:()=>d});let d=c(1).a("images/error/web_warning_v3.webp")}
,(a,b,c)=>{c.d(b,{a:()=>d});let d=c(1).a("images/error/web_warning_v3_dark.webp")}
,(a,b,c)=>{c.d(b,{a:()=>f,b:()=>e});var d=c("react-lib");function e(a,b){return f(a)?a(b):d.createElement(d.Fragment,null,a)}function f(a){return"function"==typeof a}}
,,,(a,b,c)=>{c.d(b,{a:()=>m});var d=c(96),e=c(38),f=c(63),g=c(30),h=c(153);let i=window.performance,j="EUPL.AppStart",k="EUPL.DataManager.FirstDataFetch.GetItem.Start",l="EUPL.DataManager.FirstDataFetch.GetItem.End";class m{static getResponseEnd(){return i&&i.timing?window.g_responseEnd&&(i.timing.responseEnd&&Number(window.g_responseEnd)<i.timing.responseEnd||!i.timing.responseEnd)?Number(window.g_responseEnd):i.timing.responseEnd:NaN}static getNavigationStart(){try{return i.timing.navigationStart}catch{return}}static appStart(){try{i&&i.timing&&(m.mark(j),g.a.addEventHandler({sourceName:"PerformanceCollection",handler:this.eventLogHandler}),this.summary.w3cResponseEnd=m.getResponseEnd()-i.timing.fetchStart,this.summary.w3cResponseStart=i.timing.responseStart-i.timing.fetchStart,this._times.appStart=Date.now(),this.summary.appStart=this._times.appStart-m.getResponseEnd(),this.summary.prefetchStart=-1,this.summary.deferredListDataRender=-1,this.summary.dns=i.timing.domainLookupEnd-i.timing.domainLookupStart,this.summary.tcpConnect=i.timing.connectEnd-i.timing.connectStart,this.summary.sslConnect=i.timing.secureConnectionStart?i.timing.connectEnd-i.timing.secureConnectionStart:-1)}catch(a){f.a.log(a)}}static plt(a){try{if(i&&i.timing&&void 0===m._times.plt){let b=Date.now(),c=Math.round(i.now());g.a.removeEventHandler(this.eventLogHandler);let d=(0,h.e)("EUPL.OnePageNavigation.Start");this._times.plt=isNaN(d)?b-i.timing.fetchStart:c-d,this.summary.preRender=(0,h.e)(k)-(0,h.e)(j),this.summary.dataFetch=(0,h.e)(l)-(0,h.e)(k),this.summary.postRender=m.now()-(0,h.e)(l),this.summary.render=this.summary.preRender+this.summary.postRender,this.summary.plt=this._times.plt,this.summary.pltWithUnload=b-i.timing.navigationStart,this.summary.name=a,this.summary.appCacheHit=this.summary.w3cResponseEnd<=40&&!!window.applicationCache&&window.applicationCache.status!==window.applicationCache.UNCACHED,this.getHttpRequests(),m.mark("EUPL.glass")}}catch(a){f.a.log(a)}}static mark(a,b){(0,h.f)(a,b)}static pageLoaded(){return void 0!==this._times.plt}static getMarkerTime(a){return(0,h.e)(a)}static now(){return h.a?Math.round(i.now()):Date.now()}static eventLogHandler(a){d.a.isTypeOf(a)&&(void 0===m._times.appDataFetchStart?m._times.appDataFetchStart=a.startTime:(a.eventType===e.b.End||a.eventType===e.b.Single)&&(m._times.appDataFetchEnd=m._times.appDataFetchEnd?Math.max(m._times.appDataFetchEnd,a.endTime):a.endTime))}static getHttpRequests(){if(i&&i.getEntriesByType){let a=[],b=i.getEntriesByType("resource"),c=b.length;for(let d=0;d<c;d++){let c={startTime:Math.round(b[d].startTime),url:b[d].name,duration:Math.round(b[d].duration)};a.push(c)}let d=document.getElementsByTagName("iframe");c+=d.length;for(let e=0;e<d.length;e++){try{b=d[e].contentWindow.performance.getEntriesByType("resource")}catch(a){b=null}if(b){let d=b.length;c+=d;for(let c=0;c<d;c++){let d={startTime:Math.round(b[c].startTime),url:b[c].name,duration:Math.round(b[c].duration)};a.push(d)}}}this.summary.httpRequests=c,this.httpRequestCollection=a}}}m.summary={},m._times={}}
,(a,b,c)=>{c.d(b,{a:()=>q});var d=c("react-lib"),e=c("fui.core_517"),f=c(356),g=c(634),h=c(3),i=c(70);let j=new Set(["ariaLabel","ariaLive","className","componentRef","label","labelPosition","styles","size","theme","type"]),k={top:"above",right:"after",bottom:"below",left:"before"},l={[e.jdf.xSmall]:"extra-tiny",[e.jdf.small]:"extra-tiny",[e.jdf.medium]:"tiny",[e.jdf.large]:"small"},m={[e.TRP.normal]:"tiny",[e.TRP.large]:"small"};var n=c(187);let o=(0,h.a)({useStaticStyles:!0}),p=(0,e.n94)({spinner:{...f.a.overflow("hidden")}}),q=a=>{let b,c,f=(c=a.labelPosition?k[a.labelPosition]:"below",a.type&&(b=m[a.type]),b=void 0!==a.size?l[a.size]:b??"tiny",{...{ref:a.componentRef,labelPosition:c,size:b,label:a.label,className:a.className},...(0,i.d)(a,j)}),h=o(a.styles,{theme:a.theme}),q=p();return f.label&&(f.label={className:(0,e.tlm)("ms-Label",h.label),children:f.label}),f.className=(0,e.tlm)("ms-Spinner",h.root,a.className),(0,n.w)()&&(f.spinner={className:q.spinner}),d.createElement(g.a,f)};q.displayName="SpinnerShim"}
,,,,(a,b,c)=>{c.d(b,{a:()=>h});var d,e=c(638);let f=/\.?0+$/;function g(a,b,c){return a.replace("{0}",function(a,b){let{language:c="en-us",trimDecimal:d,numberOfDecimals:e=0}=b;if(a>=100||a===Math.floor(a)){let b=a.toFixed(e?e+1:0),c=b.length;return b.slice(0,e?-1:c)}let g=a.toFixed(e?e+1:a>=10?1:2),h=g.length,i=g.slice(0,e?-1:h),j=1.2.toLocaleString(c).replace(/\d+/g,"");return(d?i.replace(f,""):i).replace(".",j)}(b,c))}(d||(d={})).getDisplayString=function(a,b){let{onlyReturnGB:c,ignoreZero:d}=b;return"number"!=typeof a||isNaN(a)||d&&0===a||!c&&a<0?"":c&&a<107374182.4?e.g:1===a?e.b:a<1024?g(e.a,a,b):a<1024e3?g(e.d,a/1024,b):!c&&a<1048576e3?g(e.e,a/1048576,b):a<1073741824e3?g(e.c,a/0x40000000,b):g(e.f,a/0x10000000000,b)};let h=d}
,,,,,,,,,(a,b,c)=>{c.d(b,{a:()=>p});var d=c("react-lib"),e=c(647),f=c("fui.core_517"),g=c(3),h=c("fui.util_178"),i=c(357),j=c(70);let k=(0,f.n94)({root:{fontSize:"inherit",fontWeight:"inherit",[f.u5r]:{color:"LinkText"}}}),l=(0,f.n94)({root:{fontSize:"inherit",fontWeight:"inherit",[f.u5r]:{MsHighContrastAdjust:"auto",forcedColorAdjust:"auto"},outlineColor:"transparent"}}),m=(0,f.n94)({disabled:{color:i.a.semanticDisabledText,":hover":{color:i.a.semanticDisabledText},":active":{color:i.a.semanticDisabledText}}}),n=new Set(["as","componentRef","disabled","styles","theme","type","underline"]),o=(0,g.a)({useStaticStyles:!0}),p=a=>{let b=(a=>{let{as:b,componentRef:c,disabled:d,ref:e,type:g,underline:i,href:p}=a,q=k(),r=l(),s=m(),t=o(a.styles,{theme:a.theme||(0,h.kF)()});return{...(0,j.d)(a,n),appearance:"default",as:b||(p?"a":"button"),type:g,disabled:d,ref:c||e,inline:i,className:(0,f.tlm)("ms-Link","ms-LinkShim",(p?r:q).root,a.disabled&&s.disabled,t.root,a.className)}})(a);return d.createElement(e.a,b)};p.displayName="LinkShim"}
,,,(a,b,c)=>{c.d(b,{a:()=>d});let d=c(1).a("images/oneupzip/zipicon.svg")}
,(a,b,c)=>{c.d(b,{a:()=>h});var d=c("fui.util_178"),e=c(16);let f=!!(window.Flight?.version==="dev"||window.Flight?.devMode),g=window?.document?.cookie.indexOf("srr")!==-1||f;function h(a){let b=(0,d.i6)(),c=g?b:"";if(!c){let a=window.require?.toUrl("");if(a){let b=new e.b(a);c=e.b.concatenate(b.getLeftPart(e.a.authority),(0,d.FR)())}else c=b}return e.b.concatenate(c,a)}}
,,(a,b,c)=>{c.d(b,{a:()=>d});let d=c(1).a("images/error/error1.svg")}
,(a,b,c)=>{c.d(b,{a:()=>d});let d=c(1).a("images/error/error2.svg")}
,(a,b,c)=>{c.d(b,{a:()=>d});let d=c(1).a("images/error/error3.svg")}
,,(a,b,c)=>{c.d(b,{a:()=>d});let d=c(1).a("images/copilot/svg/ic_fluent_copilot_16_color.svg")}
,(a,b,c)=>{c.d(b,{a:()=>h});var d=c(21),e=c(0),f=c(658);let g=!1;function h({pageContext:a,getCopilotAgentBillingDataSource:b,getVroomDataRequestorParams:h}){let i=(0,f.a)(a.aadUserId);if(!g){g=!0;let f=i?"UserCopilotAgentBillingAvailable":"UserCopilotAgentBillingNotAvailable";new e.a({name:f}).end({resultType:e.b.Success}),d.a.logData({name:f}),c.e(70).then(c.bind(c,843)).then(c=>c.refreshCopilotAgentBillingStatus({pageContext:a,getCopilotAgentBillingDataSource:b,getVroomDataRequestorParams:h}))}return i}}
,(a,b,c)=>{let d;c.d(b,{a:()=>i,b:()=>h});var e=c(106),f=c(659),g=c(660);function h(a){return`copilot_agent_billing_${a}`}function i(a){return!!a&&(!function(a){if(void 0===d){var b;let c=window.localStorage?.getItem(h(a||""));if("true"===c)d={overallAvailabillity:!0,...(0,g.b)()?{promotionalAccess:!1}:{},payAsYouGo:!1,...(0,f.a)()?{mcsAgent:!1}:{}};else if("false"===c)d={overallAvailabillity:!1,...(0,g.b)()?{promotionalAccess:!1}:{},payAsYouGo:!1,...(0,f.a)()?{mcsAgent:!1}:{}};else if(null!==c)try{d=JSON.parse(c),!(0,g.b)()&&d&&"promotionalAccess"in d&&(d.promotionalAccess=void 0)}catch(a){d=void 0}if("object"==typeof(b=d)&&b&&"overallAvailabillity"in b&&(!(0,g.b)()||"promotionalAccess"in b)&&"payAsYouGo"in b&&(!(0,f.a)()||"mcsAgent"in b)||(d=void 0),void 0!==d){let a=(0,e.a)();a.availability.isCopilotAgentBillingAvailable=d.overallAvailabillity,a.availability.isCopilotAgentBillingPromotionalAccessAvailable=d.promotionalAccess,a.availability.isCopilotAgentBillingPayAsYouGoAvailable=d.payAsYouGo,(0,f.a)()&&(a.availability.isCopilotStudioAgentAvailable=d.mcsAgent)}}d??((0,g.b)(),(0,f.a)())}(a),!!d?.overallAvailabillity)}}
,(a,b,c)=>{c.d(b,{a:()=>e});var d=c("odsp.util_126");function e(){return d.lU.isFeatureEnabled({ODB:1868})}}
,(a,b,c)=>{c.d(b,{a:()=>e,b:()=>f,c:()=>g});var d=c("odsp.util_126");function e(){return d.Ov.isActivated("9AC5F76C-68B8-4278-8C9C-4A6AAAF94158")}function f(){return d.Ov.isActivated("1c9ffd5d-91cb-4b23-bc22-b5b33fda0201")}function g(){return d.Ov.isActivated("8deb5383-8ef1-4d7f-94ca-7924a2ddb648")}}
,,(a,b,c)=>{c.d(b,{a:()=>m});var d=c("react-lib"),e=c("react-dom-lib"),f=c("fui.util_178");(0,f.ZW)([{rawString:'.root_f8e2bfcb{position:absolute;top:0;left:0;bottom:0;right:0;overflow:clip;-webkit-touch-callout:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.root_f8e2bfcb:focus{outline:0}.platform_f8e2bfcb{z-index:0;position:absolute;top:0;left:0;width:100%;height:100%;transform-origin:0 0;touch-action:none}.platform_f8e2bfcb.enabled_f8e2bfcb{will-change:transform;backface-visibility:hidden;perspective:1000}.slide_f8e2bfcb{position:absolute;left:0;top:0;width:100%;height:100%;z-index:1;opacity:0;visibility:hidden;/*! autoprefixer: ignore next */transition:opacity 0s linear .3s,visibility 0s linear .3s,transform 0s linear}.slide_f8e2bfcb.current_f8e2bfcb.loaded_f8e2bfcb{opacity:1;visibility:inherit;transition-delay:0s,0s,0s}.slide_f8e2bfcb.current_f8e2bfcb.deleted_f8e2bfcb,.slide_f8e2bfcb.deleted_f8e2bfcb{z-index:0;opacity:0;visibility:hidden;transition-duration:0s,0s,0s;transition-delay:0s,0s,0s}.platform_f8e2bfcb.enabled_f8e2bfcb .slide_f8e2bfcb{will-change:transform;backface-visibility:hidden;perspective:1000}.platform_f8e2bfcb.flipping_f8e2bfcb .slide_f8e2bfcb{transition-duration:0s,0s,0s;transition-delay:0s,0s,0s}.platform_f8e2bfcb.flipping_f8e2bfcb .slide_f8e2bfcb[data-item-order="1"]{z-index:10}.platform_f8e2bfcb.flipping_f8e2bfcb .slide_f8e2bfcb[data-item-order="1"].current_f8e2bfcb.loaded_f8e2bfcb{transition-duration:.3s,0s,.3s}.platform_f8e2bfcb.flipping_f8e2bfcb .slide_f8e2bfcb[data-item-order="2"]{z-index:9}.platform_f8e2bfcb.flipping_f8e2bfcb .slide_f8e2bfcb[data-item-order="2"].loaded_f8e2bfcb{transition-duration:.3s,0s,.3s;transition-delay:0.3s,0.6s,0s}.platform_f8e2bfcb.flipping_f8e2bfcb .slide_f8e2bfcb[data-item-order="3"]{z-index:8}.platform_f8e2bfcb.flipping_f8e2bfcb .slide_f8e2bfcb[data-item-order="4"]{z-index:7}.platform_f8e2bfcb.flipping_f8e2bfcb .slide_f8e2bfcb[data-item-order="5"]{z-index:6}.platform_f8e2bfcb.flipping_f8e2bfcb .slide_f8e2bfcb[data-item-order="6"]{z-index:5}.platform_f8e2bfcb.flipping_f8e2bfcb .slide_f8e2bfcb[data-item-order="7"]{z-index:4}.platform_f8e2bfcb.flipping_f8e2bfcb .slide_f8e2bfcb[data-item-order="8"]{z-index:3}html[dir=ltr] .platform_f8e2bfcb.flipping_f8e2bfcb .slide_f8e2bfcb[data-item-direction="1"]{transform:translate(2%,0)}html[dir=rtl] .platform_f8e2bfcb.flipping_f8e2bfcb .slide_f8e2bfcb[data-item-direction="1"]{transform:translate(-2%,0)}html[dir=ltr] .platform_f8e2bfcb.flipping_f8e2bfcb .slide_f8e2bfcb[data-item-direction="-1"]{transform:translate(-2%,0)}html[dir=rtl] .platform_f8e2bfcb.flipping_f8e2bfcb .slide_f8e2bfcb[data-item-direction="-1"]{transform:translate(2%,0)}.platform_f8e2bfcb.rotating_f8e2bfcb .slide_f8e2bfcb{transition-delay:0s,0s,0s;transition-duration:0s,0s,0s}html[dir=ltr] .platform_f8e2bfcb.rotating_f8e2bfcb .slide_f8e2bfcb[data-item-offset="2"]{transform:translate(204%,0)}html[dir=rtl] .platform_f8e2bfcb.rotating_f8e2bfcb .slide_f8e2bfcb[data-item-offset="2"]{transform:translate(-204%,0)}html[dir=ltr] .platform_f8e2bfcb.rotating_f8e2bfcb .slide_f8e2bfcb[data-item-offset="1"]{transform:translate(102%,0)}html[dir=rtl] .platform_f8e2bfcb.rotating_f8e2bfcb .slide_f8e2bfcb[data-item-offset="1"]{transform:translate(-102%,0)}html[dir=ltr] .platform_f8e2bfcb.rotating_f8e2bfcb .slide_f8e2bfcb[data-item-offset="-1"]{transform:translate(-102%,0)}html[dir=rtl] .platform_f8e2bfcb.rotating_f8e2bfcb .slide_f8e2bfcb[data-item-offset="-1"]{transform:translate(102%,0)}html[dir=ltr] .platform_f8e2bfcb.rotating_f8e2bfcb .slide_f8e2bfcb[data-item-offset="-2"]{transform:translate(-204%,0)}html[dir=rtl] .platform_f8e2bfcb.rotating_f8e2bfcb .slide_f8e2bfcb[data-item-offset="-2"]{transform:translate(204%,0)}.platform_f8e2bfcb.rotating_f8e2bfcb .slide_f8e2bfcb[data-item-offset="-1"],.platform_f8e2bfcb.rotating_f8e2bfcb .slide_f8e2bfcb[data-item-offset="-2"],.platform_f8e2bfcb.rotating_f8e2bfcb .slide_f8e2bfcb[data-item-offset="1"],.platform_f8e2bfcb.rotating_f8e2bfcb .slide_f8e2bfcb[data-item-offset="2"]{visibility:inherit;opacity:1}.platform_f8e2bfcb.gliding_f8e2bfcb{/*! autoprefixer: ignore next */transition:transform .3s ease-out}.platform_f8e2bfcb.gliding_f8e2bfcb .slide_f8e2bfcb[data-item-offset="-1"],.platform_f8e2bfcb.gliding_f8e2bfcb .slide_f8e2bfcb[data-item-offset="-2"],.platform_f8e2bfcb.gliding_f8e2bfcb .slide_f8e2bfcb[data-item-offset="1"],.platform_f8e2bfcb.gliding_f8e2bfcb .slide_f8e2bfcb[data-item-offset="2"]{transition-delay:0.3s,0.3s,0s}'}]);var g=c("fui.core_517"),h=c(359),i=c(533),j=c(160),k=c(83);let l=d.createContext({index:-1,getOrder:()=>-1});function m(a){let{isEnabled:b=!0,canNavigate:c=!0,items:m,item:p,onItemInvoked:q,getKey:r=o,onRenderSlide:s,rootProps:t,className:u}=a,v=(0,g.N3o)(),[w,x]=d.useState(!0),[y,z]=d.useState(!1),[A,B]=d.useState(!1),C=d.useRef(null),D=d.useRef(null),E=d.useMemo(()=>{if(p)for(let a=0;a<m.length;a++){let b=m[a];if(b&&r(b)===r(p))return a}return -1},[m,p]),F=d.useRef(E),G=d.useRef(-1);d.useMemo(()=>{G.current=F.current},[E]),F.current=E;let H=G.current,I=d.useRef(-1);d.useMemo(()=>{E>-1&&(I.current=E)},[E]);let J=I.current,K=d.useMemo(()=>c?a.slideAllocationCount??15:1,[]),L=m.length,[M,N]=d.useState([]);d.useEffect(()=>{p&&N(a=>[p,...a])},[p]);let O=(0,k.a)(()=>{N(a=>a.slice(0,1))});d.useEffect(()=>{let a=setTimeout(()=>{e.unstable_batchedUpdates(()=>{O()})},600);return()=>{clearTimeout(a)}},[p]);let P=w&&E>-1&&H>-1?Math.max(-1,Math.min(1,E-H)):0,Q=d.useRef({start:0,end:0}),R=d.useRef([]),S=R.current,T=d.useMemo(()=>{if(p)for(let a=0;a<S.length;a++){let b=S[a]?.item;if(b&&r(b)===r(p))return a}return -1},[p,S]),U=-1===T||E>=2&&T<2||E<=L-1-2&&T>S.length-1-2||L<=K&&L!==S.length;d.useMemo(()=>{if(U&&E>-1)if(K>1){let a=E+.8*(Math.floor(K/2)-2)*P,b=Math.max(0,Math.min(L-K,a-Math.floor(K/2))),c=Math.min(L,b+K);Q.current={start:b,end:c}}else Q.current={start:E,end:E+1}},[L,E,U,P]);let V=Q.current,W=E>-1&&V.end-V.start>0,X=d.useMemo(()=>{if(W){let a=[];for(let b=V.start;b<V.end;b++){let c=m[b];a.push({item:c,itemIndex:b})}return a}},[m,W,V]),Y=d.useMemo(()=>{if(!W)return[{item:p,itemIndex:-1}]},[W,p]),Z=d.useMemo(()=>X||Y||[],[W,X,Y]);R.current=Z,d.useEffect((0,k.a)(()=>{if(-1===E&&p&&J>-1){let a=Math.max(0,Math.min(m.length-1,J)),b=m[a];b&&q&&q(b,a)}}),[p,m,J]);let $=(0,k.a)(({incrementTransformPx:a,radiusDeltaPx:c,points:d})=>b&&Math.abs(a.translate.x)>=10&&c<5&&d.length<2),{handlers:_,isActive:aa,transformV:ab,setTransformV:ac}=(0,h.b)({isEnabled:b,mayStartPan:$,allowedModes:h.a.pointer,ref:C}),ad=Date.now(),ae=d.useRef(ad),af=d.useRef(ab),ag=ae.current,ah=af.current;ae.current=ad,af.current=ab;let ai=ab.translate.subtract(ah.translate).scale(1e3/(ad-ag));d.useEffect((0,k.a)(()=>{if(aa)B(!0),z(!1),x(!1);else if(!aa&&!w){var a;let b,c=ab.translate.negate(),d=(a=ai.negate(),b=0,c.x>.3&&c.x<.5?b+=.5:c.x<-.3&&c.x>-.5&&(b-=.5),a.x>1&&c.x<.5?b+=.5:a.x<-1&&c.x>-.5&&(b-=.5),(b=Math.max(-1,Math.min(1,b)))+c.x),e=Math.max(0,Math.min(L-1,E+Math.round(v?-d:d))),f=m[e];f&&q?q(f,e):e=E,ac(new i.a(new j.a(v?-e:e,0).subtract(new j.a(v?-E:E,0).add(c))))}}),[aa]);let aj=(0,k.a)(()=>{aa||w||(ac(i.a.IDENTITY),z(!0),B(!0))});d.useEffect(()=>{let a=requestAnimationFrame(()=>{a=requestAnimationFrame(()=>{e.unstable_batchedUpdates(()=>{aj()})})});return()=>{cancelAnimationFrame(a)}},[aa]);let ak=(0,k.a)(()=>{!aa&&y&&(z(!1),B(!1),x(!0))});d.useEffect(()=>{let a=setTimeout(()=>{e.unstable_batchedUpdates(()=>{ak()})},600);return()=>{clearTimeout(a)}},[aa]);let al=d.useMemo(()=>{let a=ab.translate,b=E>-1?L:1,c=E>-1?E:0,d=-a.x,e=d,f=c+d;if(f<0||f>b-1){let a=Math.max(0-c,Math.min(b-1-c,(d>0?Math.floor:Math.ceil)(d))),f=Math.PI;e=Math.atan(f*(d-a))/f+a}return new i.a(new j.a(-e,a.y))},[ab,L,E]),am=d.useMemo(()=>({transform:`translate(${100*al.translate.x}%, 0)`}),[al]),an=d.useCallback(a=>{for(let b=0;b<M.length;b++){let c=M[b];if(r(a)===r(c))return b}return -1},[M]),ao=d.useMemo(()=>({getOrder:an,index:E}),[an,E]),ap=(0,k.a)(a=>{if(a.target===D.current&&E>-1){if(a.key===(v?"ArrowLeft":"ArrowRight")&&E<m.length-1){let b=m[E+1];b&&(q&&q(b,E+1,a),a.stopPropagation())}else if(a.key===(v?"ArrowRight":"ArrowLeft")&&E>0){let b=m[E-1];b&&(q&&q(b,E-1,a),a.stopPropagation())}}}),aq=d.useMemo(()=>d.createElement(l.Provider,{value:ao},Z.map(a=>d.createElement(n,{key:a.item?`item-${r(a.item)}`:`index-${a.itemIndex}`,itemIndex:a.itemIndex,item:a.item,onRenderSlide:s,className:u}))),[ao,Z,s,u]);return d.createElement("div",{...t,ref:D,className:(0,f.oG)("root_f8e2bfcb"),tabIndex:0,onKeyDownCapture:ap},d.createElement("div",{className:(0,f.oG)("platform_f8e2bfcb",{flipping_f8e2bfcb:w,rotating_f8e2bfcb:A,enabled_f8e2bfcb:b,gliding_f8e2bfcb:y}),"data-is-powered":aa,"data-direction":P>0?"forward":P<0?"backward":void 0,style:am,ref:C,..._},aq))}function n(a){let{item:b,itemIndex:c,onRenderSlide:e,className:g}=a,{index:h,getOrder:i}=d.useContext(l),j=c-h,k=d.useMemo(()=>b?i(b):-1,[i,b]),m=j>0?1:j<0?-1:0,[n,o]=d.useState(!1),p=d.useMemo(()=>e?e({itemIndex:c,offset:j,item:b,setIsLoaded:o}):null,[e,c,b,j,o]);return d.createElement("div",{className:(0,f.oG)("slide_f8e2bfcb",g,{current_f8e2bfcb:0===j,loaded_f8e2bfcb:!!b&&n}),"data-item-offset":j,"data-item-order":k+1,"data-item-direction":m},p)}function o(a){return`${a.key??""}`}}
,,(a,b,c)=>{c.d(b,{a:()=>h});var d=c(111),e=c(376),f=c(95),g=c(32);function h({mainLinkInfo:a,permissions:b,pageContext:c}){let{Audience:h,Role:k}=a,l=j(e.a,h),m=j(f.a,k),n=function(a,b=!1){f.a.none;let c=g.b.hasPermission(a,g.b.managePermissions),d=g.b.hasPermission(a,g.b.insertListItems),e=g.b.hasPermission(a,g.b.deleteListItems),h=g.b.hasPermission(a,g.b.editListItems),i=g.b.hasPermission(a,g.b.openItems),j=g.b.hasPermission(a,g.b.viewListItems),k=g.b.hasPermission(a,g.b.manageLists),l=g.b.hasPermission(a,g.b.reviewListItems),m=g.b.hasPermission(a,g.b.submitItems);return c&&d&&e&&h&&i&&j?f.a.owner:d&&h&&i&&j?b&&k?f.a.manageList:f.a.edit:i&&j&&l?f.a.review:i&&j?f.a.view:j?f.a.restrictedview:m?f.a.submit:f.a.none}(b,!0);switch(l){case e.a.OnlyPeopleAdded:return!1;case e.a.Organization:return!(0,d.c)(c)&&i({targetRole:m,currentRole:n});case e.a.Anyone:return i({targetRole:m,currentRole:n});default:return!1}}function i({targetRole:a,currentRole:b}){switch(a){case f.a.none:return!1;case f.a.restrictedview:switch(b){case f.a.none:case f.a.limitedView:return!0;default:return!1}case f.a.view:switch(b){case f.a.none:case f.a.limitedView:case f.a.restrictedview:return!0;default:return!1}case f.a.review:switch(b){case f.a.none:case f.a.limitedView:case f.a.restrictedview:case f.a.view:return!0;default:return!1}case f.a.edit:switch(b){case f.a.none:case f.a.limitedView:case f.a.restrictedview:case f.a.view:case f.a.limitedEdit:case f.a.review:return!0;default:return!1}case f.a.manageList:switch(b){case f.a.manageList:case f.a.owner:return!1;default:return!0}case f.a.owner:return b!==f.a.owner;case f.a.submit:case f.a.limitedView:case f.a.limitedEdit:default:return!1}}function j(a,b){let c=Number(b);if(!isNaN(c))return Object.values(a).includes(c)?c:void 0;let d=Object.keys(a).filter(a=>isNaN(Number(a))).find(a=>a.toLowerCase()===b.toLowerCase());if(d)return a[d]}}
,,,(a,b,c)=>{c.d(b,{a:()=>e});var d=c("odsp.util_126");function e(a){let{suspensibles:b,onRetry:c,onLoad:e,onError:f}=a,g=[],h=Array.isArray(b)?[]:{},i=Object.keys(b),j=i.length;for(let a of i){let c=b[a];try{let b=c.read();j--,h[a]=b}catch(a){if((0,d.Qu)(a))g.push(a);else throw a}}if(!j)return e&&e(h),h;Promise.all(g).then(()=>c()).catch(a=>{f&&f(a)})}}
,,,(a,b,c)=>{c.d(b,{a:()=>e});let d=0;function e(a){return`${a}_${++d}`}}
,(a,b,c)=>{c.d(b,{a:()=>e});let d=()=>{let a=(()=>{try{return Function("return true")()}catch{return!1}})();return d=()=>a,a};function e(){return d()}}
,(a,b,c)=>{c.d(b,{a:()=>L});var d=c(381),e=c(9),f=c(243),g=c("odsp.util_126");let h={ownerCannotShareWithSelf:!0,maximumRecipientsExceeded:!0,invalidAclEmailSpecified:!0,duplicateMembersInRequest:!0,secureSharingInvalidRequest:!0};class i{static getSharesPathFromItemUrl(a){let b=btoa(unescape(encodeURIComponent(a)));return`/shares/u!${b.replace(/=/g,"").replace(/\//g,"_").replace(/\+/g,"-")}/driveItem`}createBundle(a,b){let c=JSON.stringify({children:a.map(a=>({id:a})),bundle:{},name:b});return c=c.slice(0,-1)+',"@microsoft.graph.conflictBehavior": "rename"}',this._dataRequestor.send({path:"/drive/bundles",apiName:"bundles",requestType:"POST",useAuthorizationHeaders:!0,postData:c,getErrorAsMessage:!0,expectedErrorCodes:h,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(a=>a)}getFamily(){let a={};return g.B3.isFeatureEnabled({ODC:"FamilySharingPreferKillswitch"})||(a.prefer="family.group-enabled-only"),("1.0"===this._graphApiVersion&&this._betaDataRequestor?this._betaDataRequestor:this._dataRequestor).send({path:"/household/me/family",apiName:"family",requestType:"GET",useAuthorizationHeaders:!0,getErrorAsMessage:!0,headers:a,expectedErrorCodes:{...h,404:!0},qosExtraData:{graphApiVersion:"beta"}}).then(a=>a).catch(a=>{})}getFamilyMembers(){let a={};return g.B3.isFeatureEnabled({ODC:"FamilySharingPreferKillswitch"})||(a.prefer="family.group-enabled-only"),("1.0"===this._graphApiVersion&&this._betaDataRequestor?this._betaDataRequestor:this._dataRequestor).send({path:"/household/me/family/members",apiName:"familyMembers",requestType:"GET",useAuthorizationHeaders:!0,getErrorAsMessage:!0,headers:a,expectedErrorCodes:{...h,404:!0},qosExtraData:{graphApiVersion:"beta"}}).then(a=>a).catch(a=>{})}isUserPremium(){return this._dataRequestor.send({path:"/me/drive",apiName:"drive",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:h,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(a=>!!a.quota.storagePlanInformation&&!a.quota.storagePlanInformation.upgradeAvailable)}getDriveInfo(){return this._dataRequestor.send({path:"/me/drive",apiName:"drive",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:h,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(a=>a)}createLink(a){let{itemIds:b,type:c,scope:d,preventDownload:e,password:f,expiration:g,bundleName:h}=a;return 1===b.length?this.createLinkSingleItem({itemUrl:this.getDrivesPathFromItemId(b[0]),type:c,scope:d,preventDownload:e,password:f,expiration:g}):this.createBundle(b,h||"").then(a=>this.createLinkSingleItem({itemUrl:this.getDrivesPathFromItemId(a.id),type:c,scope:d,preventDownload:e,password:f,expiration:g}))}createLinkFromItemUrl(a){let{itemUrl:b,type:c,scope:d,preventDownload:e,password:f,expiration:g}=a;return this.createLinkSingleItem({itemUrl:i.getSharesPathFromItemUrl(b),type:c,scope:d,preventDownload:e,password:f,expiration:g})}getCurrentUserId(){return this._dataRequestor.send({path:"/me",apiName:"me",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:h,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(a=>a.id)}getDriveOwner(a){return this._dataRequestor.send({path:"/drives/"+a,apiName:"/drives/",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:h,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(a=>a)}getCurrentUser(){return this._dataRequestor.send({path:"/me",apiName:"me",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:h,qosExtraData:{graphApiVersion:this._graphApiVersion}})}getItemInfo(a){let b=`${this.getDrivesPathFromItemId(a)}`;return this._dataRequestor.send({path:b,apiName:"item",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:h,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(a=>a)}getItemInfoFromItemUrl(a){let b=`${i.getSharesPathFromItemUrl(a)}`;return this._dataRequestor.send({path:b,apiName:"item",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:h,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(a=>a)}getPermissions(a){let b=`${this.getDrivesPathFromItemId(a)}/permissions`;return("1.0"===this._graphApiVersion&&this._betaDataRequestor?this._betaDataRequestor:this._dataRequestor).send({path:b,apiName:"permissions",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:h,qosExtraData:{graphApiVersion:"beta"}}).then(a=>a.value)}getPermissionsFromItemUrl(a){let b;b="1.0"===this._graphApiVersion&&this._betaDataRequestor?this._betaDataRequestor:this._dataRequestor;let c=`${i.getSharesPathFromItemUrl(a)}/permissions`;return b.send({path:c,apiName:"permissions",requestType:"GET",useAuthorizationHeaders:!0,breakCache:!0,getErrorAsMessage:!0,expectedErrorCodes:h,qosExtraData:{graphApiVersion:"beta"}}).then(a=>a.value)}invite(a){let{itemIds:b,recipients:c,message:d,requireSignIn:e,sendInvitation:f,roles:g,password:h,expiration:i,bundleName:j}=a;return 1===b.length?this.inviteSingleItem(this.getDrivesPathFromItemId(b[0]),c,d,e,f,g,h,i):this.createBundle(b,j||"").then(a=>this.inviteSingleItem(this.getDrivesPathFromItemId(a.id),c,d,e,f,g,h,i))}inviteFromItemUrl(a){let{itemUrl:b,recipients:c,message:d,requireSignIn:e,sendInvitation:f,roles:g,password:h,expiration:j}=a;return this.inviteSingleItem(i.getSharesPathFromItemUrl(b),c,d,e,f,g,h,j)}getDefaultLink(a,b,c){return b.length>0?this.inviteSingleItem(i.getSharesPathFromItemUrl(a),b,"",!0,!1,[],"",void 0,{prefer:"getDefaultLink,ReturnSpecificErrorCode"},c):this.createLinkSingleItem({itemUrl:i.getSharesPathFromItemUrl(a),useMultiPart:c}).then(a=>e.c.wrap([a]))}getDefaultLinkByUniqueId(a,b,c){return b.length>0?this.inviteSingleItem(this.getPathFromUniqueId(a),b,"",!0,!1,[],"",void 0,{prefer:"getDefaultLink,ReturnSpecificErrorCode"},c):this.createLinkSingleItem({itemUrl:this.getPathFromUniqueId(a),useMultiPart:c}).then(a=>e.c.wrap([a]))}updatePermissions(a,b,c){let d=`${this.getDrivesPathFromItemId(a)}/permissions/${b}`;return this._dataRequestor.send({path:d,apiName:"updatePermission",requestType:"PATCH",useAuthorizationHeaders:!0,postData:JSON.stringify({roles:[c]}),getErrorAsMessage:!0,expectedErrorCodes:h,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(a=>a.value).catch(a=>{let b=a.message||"Error updating permission",c=a.code||(0,f.e)(a)||"genericPermissionUpdateFailure",d={error:a.error,name:a.name,errorCode:c,debugErrorMessage:JSON.stringify(a),errorMessage:b,rawError:JSON.stringify(a)};return e.c.reject(d)})}updatePermissionsFromItemUrl(a,b,c){let d=`${i.getSharesPathFromItemUrl(a)}/permissions/${b}`;return this._dataRequestor.send({path:d,apiName:"updatePermission",requestType:"PATCH",useAuthorizationHeaders:!0,postData:JSON.stringify({roles:[c]}),getErrorAsMessage:!0,expectedErrorCodes:h,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(a=>a.value)}unshareLink(a,b){let c=`${this.getDrivesPathFromItemId(a)}/permissions/${b}`;return this._dataRequestor.send({path:c,apiName:"removePermission",requestType:"DELETE",useAuthorizationHeaders:!0,getErrorAsMessage:!0,expectedErrorCodes:h,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(()=>!0)}unshareLinkFromItemUrl(a,b){let c=`${i.getSharesPathFromItemUrl(a)}/permissions/${b}`;return this._dataRequestor.send({path:c,apiName:"removePermission",requestType:"DELETE",useAuthorizationHeaders:!0,getErrorAsMessage:!0,expectedErrorCodes:h,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(()=>!0)}createLinkSingleItem(a){let{type:b,itemUrl:c,scope:d,preventDownload:e,password:f,useMultiPart:g,expiration:i}=a,j=`${c}/createLink`,k=b&&d?{type:b,scope:d,preventDownload:e}:{};return(f||""===f)&&(k.password=f),i&&(k.expirationDateTime=i),this._dataRequestor.send({path:j,apiName:"createLink",requestType:"POST",useMultiPart:g,useAuthorizationHeaders:!0,postData:JSON.stringify(k||{}),getErrorAsMessage:!0,expectedErrorCodes:h,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(a=>a)}getPathFromUniqueId(a){return`/sites/root/items/${a}/driveItem`}getDrivesPathFromItemId(a){let b=a.split("!");return b.length>1?`/drives/${b[0]}/items/${a}`:`/drive/items/${a}`}inviteSingleItem(a,b,c,d,e,f,g,i,j,k){let l=`${a}/invite`,m={recipients:b,message:c,requireSignIn:d,sendInvitation:e,roles:f};return g&&(m.password=g),i&&(m.expirationDateTime=i),this._dataRequestor.send({path:l,apiName:"invite",requestType:"POST",useAuthorizationHeaders:!0,postData:JSON.stringify(m),useMultiPart:k,headers:j,getErrorAsMessage:!0,expectedErrorCodes:h,qosExtraData:{graphApiVersion:this._graphApiVersion}}).then(a=>a.value)}constructor(a,b){this._dataRequestor=b.dataRequestor,this._betaDataRequestor=b.betaDataRequestor,this._graphApiVersion=a.graphApiVersion||""}}var j=c(673),k=c(48),l=c(893),m=c(382),n=c(383),o=c(6),p=c(194),q=c(384);let r=g.Ov.isActivated("0f076102-5fa0-402d-8cbe-240c5abb8fb8")?"eeddb977348d43ebaaae45e759ea6e96-42528e91-0556-4879-9b8d-af7b3b8417e4-6984":"eeddb977348d43ebaaae45e759ea6e96-e15eaf40-ba64-4d72-bc1b-c3951c77cdfb-6929";function s(){return a=>class extends a{constructor(a){const{context:b={}}=a,{accountType:c="Unknown",clientName:d="Unknown",cloudType:e="Unknown",correlationId:f,environment:h=a.ariaEnvironment||"prod",isAuthenticated:i="NA",language:j=b.Market,scenario:k="Unknown",siteSubscriptionId:l="Unknown",userId:m="Unknown",version:n="Unknown",tenantToken:o=r,context:p,...q}=a;super({tenantToken:o,context:{AccountType:c,ClientName:d,CloudType:e,CorrelationId:f,Environment:h,IsAuthenticated:i,IsSharedControl:!0,Market:j,Scenario:k,Session:g.uq(),SiteSubscriptionId:l,UserId:m,Version:n,Workload:"SharedControls",...b},...q})}}}function t(){return a=>class extends a{constructor(a){const{context:b={}}=a,{ariaLoader:d=async()=>c.e(2).then(c.t.bind(c,213,23)),context:e,...f}=a;super({ariaLoader:d,context:{...b},...f})}}}class u extends(0,q.a)()(s()(t()(p.a))){constructor(a){super(a)}}let v=(0,c(385).a)()(u);class w extends v{constructor(a){super(a)}}var x=c(30),y=c(96),z=c(59),A=c(0),B=c(31),C=c(75),D=c(676),E=c(388),F=c(892);let G=g.lU.isFeatureEnabled({ODC:"ODCSharePrefetchInline"}),H=g.lU.isFeatureEnabled({ODB:61327,ODC:"COBNewShareDialog"});var I=c(222),J=c(195),K=c(387);class L{async initializeUI(){let a=this._context&&this._context.correlationId;this._isShareReady=!1;let b=this._props.isConsumer,c=Promise.resolve(void 0),d=Promise.resolve(void 0);if(!this._addSharingContextInfoToFormEnabled){c=this._context.mode!==l.a.copy||"teams"!==this._context.clientId||this._context.shareId?Promise.resolve(void 0):this._getDefaultLink(),d=b&&!this._launchNewSharedialogInCOB||this._props.disablePrefetchSharingInformation?Promise.resolve(void 0):this._getSharingInformation();let g=!b||this._launchNewSharedialogInCOB||this._useODCSharePrefetchInline&&this._isInlineConsumer?this._signal.getPromise():Promise.resolve(void 0);Promise.all([this._toTuple(c),this._toTuple(d),this._toTuple(g)]).then(([c,d,g])=>{try{let g=!1;if(!b||this._launchNewSharedialogInCOB){let a=this._props.options.onError;if(this._isError(c)&&(g=!0,a&&a({name:"SharePrefetchError",message:"",error:c.error,resultCode:e.c.isCanceled(c.error)?"Canceled":(0,f.e)(c.error)})),this._isError(d)){g=!0;let b=d.error,c={code:b.code,status:b.status};a&&a({name:"SharePrefetchError",message:"",error:b,resultCode:e.c.isCanceled(d.error)?"Canceled":`[${c.status.toString()}] ${c.code||"Unknown"}`})}}let h=this._iframe.contentWindow;if(h&&(!b||this._launchNewSharedialogInCOB)){let a={...this._getSharingContextInfo(),rawInvite:c.value,sharingInformation:d.value};this._sharingHostMessenger?this._sharingHostMessenger.sendSharingContextInformation(a):h.postMessage(a,this._iframeUrl)}else if(b)if(this._useODCSharePrefetchInline&&this._isInlineConsumer&&h){let a={...this._context,rawInvite:c.value,sharingInformation:d.value,hasTokenProvider:!1};h.postMessage(a,this._iframeUrl)}else this._formInput.value=JSON.stringify(this._context),this._form.submit();else g||this._sessionQos.end({resultType:A.b.ExpectedFailure,resultCode:"abandoned",extraData:{error:"contentWindow not defined to postMessage context",iframeInBody:this._elementWindow.document.body.contains(this._iframe),messagesReceived:Object.keys(this._messagesReceived).join(","),mode:this._context.mode,correlationId:a}})}catch(b){this._sessionQos.end({resultType:A.b.Failure,extraData:{unhandledError:b.toString(),correlationId:a}})}})}this._props.disableIframeDomainCheck||setTimeout(()=>{if(!this._scriptsLoadedTime){let b=new Image;b.onerror=()=>{let b="ShareDomainNotReachable"+(window.navigator&&window.navigator.onLine?"Online":"Offline"),c=this._props.options&&this._props.options.onError;c&&c({name:"SharePrefetchError",message:b,error:Error(b),debugErrorMessage:`Unable to reach ${this._iframeBaseUrl} domain. Refer to https://docs.microsoft.com/en-us/office365/enterprise/urls-and-ip-address-ranges`,resultCode:b}),this._sessionQos.end({resultType:A.b.ExpectedFailure,resultCode:b,extraData:{mode:this._context.mode,iframeBaseUrl:this._iframeBaseUrl,correlationId:a}}),clearTimeout(this._timeoutId)},b.src=`${this._iframeBaseUrl}/favicon.ico?${Math.random()}`}},!this._props.iframeCheckTimeout||this._props.iframeCheckTimeout<=0?8e3:this._props.iframeCheckTimeout);let g=this._props.timeout||45e3;this._timeoutId=setTimeout(async()=>{let e,f,h=!1;try{h=!!await d}catch(a){e=a}let i=!1;try{let a=await c;i=!!(a&&a)}catch(a){f=a}let j=this._elementWindow.document.body.contains(this._props.element),k={isTimeout:!0,iframeInBody:this._elementWindow.document.body.contains(this._iframe),rootElementInBody:j,messagesReceived:Object.keys(this._messagesReceived).join(","),getSharingHasData:h,getSharingError:e,inviteHasData:i,inviteError:f,isConsumer:b,timeout:g,mode:this._context.mode,isOnline:window.navigator&&window.navigator.onLine,scriptsLoadedTime:this._scriptsLoadedTime?this._scriptsLoadedTime.getTime()-this._iframeStartTime.getTime():-1,iframeLoadedTime:this._iframeLoadedTime,correlationId:a};this._showShareUX();let l=this._props.options&&this._props.options.onTimeout;l&&l(k),this._sessionQos.end({resultType:j?A.b.Failure:A.b.ExpectedFailure,resultCode:"timeout",extraData:k})},g)}dispose(){let a=this._context&&this._context.correlationId;clearTimeout(this._timeoutId),this._messagesReceived.sharePrefetch_dispose=!0,this._elementWindow.removeEventListener("message",this._onReceiveWindowMessage),this._props.element.removeChild(this._iframe),this._sessionQos.end({resultType:A.b.ExpectedFailure,resultCode:"disposed",extraData:{isDisposed:!0,iframeInBody:this._elementWindow.document.body.contains(this._iframe),messagesReceived:Object.keys(this._messagesReceived).join(","),mode:this._context.mode,correlationId:a,isOnline:window.navigator&&window.navigator.onLine,iframeLoadedTime:this._iframeLoadedTime}})}async _getDefaultLink(){let a=new i({},{dataRequestor:new j.a({},{urlDataSource:{getApiBaseUrl:()=>`${this._context.webAbsoluteUrl}/_api/v2.0`},sessionManagementProvider:this._props.options.graphTokenProvider||{getToken:()=>e.c.resolve({accessToken:this._context.authToken})},apiEvent:y.a.withManager(this._manager)})}),b=[];this._context.defaultRecipients&&this._context.defaultRecipients.length>0&&(b=this._context.defaultRecipients.map(a=>({email:a})));let c=this._context.uniqueId?a.getDefaultLinkByUniqueId(this._context.uniqueId||"",b,!this._props.disableUseMultiPart):a.getDefaultLink(this._context.itemUrl||"",b,!this._props.disableUseMultiPart);return{value:await c}}_getSharingInformation(){let a={authToken:this._context.authToken,webAbsoluteUrl:this._context.webAbsoluteUrl,webTemplate:this._context.isODB?"21":"1",env:"prod"},b=this._props.options.spRestTokenProvider,c=this._manager,d=new m.a({pageContext:a,getParentListId:this._getParentListId,sharingContextInformation:this._context},{pageContext:a,dataRequestorType:class extends z.a{constructor(d){super(d,{pageContext:a,apiEvent:y.a.withManager(c),tokenProvider:b})}},tokenProvider:b}),e=new n.a({pageContext:a,getParentListId:this._getParentListId,itemProvider:{invalidateItem:()=>{}},sharingDataSource:d}),f=this._launchNewSharedialog||this._context.mode===l.a.copy||this._context.mode===l.a.linkSettings;return e.getSharingInformation({key:"",name:this._context.itemName,properties:{}},f,!0,void 0,this._context.mode===l.a.manageAccess)}_initializeIframe(){this._elementWindow.addEventListener("message",this._onReceiveWindowMessage),this._iframe.name="shareFrame",this._iframe.id="shareFrame",this._iframe.onload=()=>{this._iframeLoadedTime=new Date().getTime()-this._iframeStartTime.getTime()},this._iframeUrl&&!this._launchNewSharedialogInCOB&&(this._hostOrigin=new o.a(window.location.href).authority,this._iframeUrl+=`&channelId=${this._channelId}&origin=${this._hostOrigin}`),this._launchNewSharedialog||(this._iframe.src=this._iframeUrl),this._iframe.style.width="0px",this._iframe.style.height="0px",this._iframe.style.visibility="hidden",g.Ov.isActivated("b7e8f429-3a1c-4f29-8b45-1d6e2a7c9f48","11/26/2025","Use quoted self keyword in iframe allow attribute for clipboard permissions")?this._iframe.allow=`clipboard-read self ${new o.a(this._iframeUrl).authority}; clipboard-write self ${new o.a(this._iframeUrl).authority}`:this._iframe.allow=`clipboard-read 'self' ${new o.a(this._iframeUrl).authority}; clipboard-write 'self' ${new o.a(this._iframeUrl).authority}`}_initializeForm(){this._form.target="shareFrame",this._form.method="POST",this._form.action=this._iframeUrl,this._form.style.display="none",this._formInput.type="text";let a=this._context?.authToken;if(this._launchNewSharedialog){if(this._formInput.value=a,this._formInput.name="access_token",this._addSharingContextInfoToFormEnabled){let a=document.createElement("input"),b=this._getSharingContextInfo();a.name="context",a.value=JSON.stringify(b),this._form.appendChild(a)}if((0,F.c)()&&window._spPageContextInfo?.isCommonDomainRequestContext===!0){let a=document.createElement("input");a.name="isCommonDomainRequestContext",a.value="true",this._form.appendChild(a)}}else this._formInput.name="context";this._form.appendChild(this._formInput);let b=document.createElement("input");b.type="submit",this._form.appendChild(b)}_getSharingContextInfo(){let a=this._props.options.spRestTokenProvider,b=this._props.options.sharingHostTokenProvider,c=[],d=!!a&&!!a.getAuthToken;return b&&(d=!0,c=[]),{...this._context,hasTokenProvider:d,...c.length>0?{hasAdditionalTokenProvider:c}:{}}}_showShareUX(){this._isShareReady=!0;let a=this._props.styles;a&&a.border?this._iframe.style.border=a.border:this._iframe.style.border="0",a&&(a.margin&&(this._iframe.style.margin=a.margin),a.minWidth&&(this._iframe.style.minWidth=a.minWidth),a.minHeight&&(this._iframe.style.minHeight=a.minHeight)),this._iframe.style.visibility="visible",this._iframe.style.height=this._context.fullScreenIframe?"100vh":`${this._iframeHeight||400}px`;let b=this._props.context?.hostOptions?.enableWiderDialog===!1?320:480;this._iframe.style.width=this._context.fullScreenIframe?"100%":`${b||this._iframeWidth||this._iframe.style.minWidth}px`,clearTimeout(this._timeoutId)}_getParentListId(a){return""}async _toTuple(a){try{return{value:await a}}catch(a){return{error:a}}}_isError(a){return!!a.error}_createSharingHostMessenger(){if(this._clientOrigin=new o.a(this._iframeUrl).authority,!this._clientOrigin||!this._iframe.contentWindow)return null;{let a=new D.a({origin:this._clientOrigin,channelId:this._channelId,source:this._iframe.contentWindow,customerPromiseLogger:this._shareCustomerPromiseLogger});return a.addCommandHandler(a=>{let b=Promise.resolve({result:"success"});switch(a.name){case K.a.GetToken:"tokenName"in a&&Object.values(E.a).includes(a.tokenName)&&(b=this._processGetTokenEvent(a));break;case K.a.ShareRefreshCookies:b=this._processRefreshCookies(a);break;default:this._processEvent(a),b=Promise.resolve({result:"success"})}return b}),a}}_processGetTokenEvent(a){let{onGetAuthToken:b}=this._props.options?.sharingHostTokenProvider||{};if(b)return(async()=>{try{let c=await b(a);return{result:"success",token:c}}catch(a){return{result:"error",error:{code:a.code||"authTokenErrorException",message:a instanceof Error?a.message:"Encountered error when fetching auth token"},isExpected:!!a.isExpected}}})();{let b=this._props.options?.spRestTokenProvider?.getAugloopToken;if("tokenName"in a&&a.tokenName===E.a.Augloop&&b)return(async()=>{try{let c=a.getTokenParams?.resource,d=await b(c);return{result:"success",token:d}}catch(a){return{result:"error",error:{code:a.code||"AugloopTokenErrorException",message:a instanceof Error?a.message:"Encountered error when fetching augloop token"},isExpected:!!a.isExpected}}})()}return Promise.resolve({result:"error",error:{code:"AugloopTokenErrorException",message:"Encountered issue with incorrect command or undefined getAugloopToken"},isExpected:!1})}_processRefreshCookies(a){let{onRefreshCookies:b}=this._props.options?.sharingHostTokenProvider||{};if(b){let{getFormDigestOptions:c}=a;return(async()=>{try{return this._sharingHostMessenger&&await b({...c,sharingHostMessenger:this._sharingHostMessenger}),{result:"success"}}catch(a){return Promise.resolve({result:"error",error:{code:a.code||"refreshCookiesErrorException",message:a instanceof Error?a.message:"Encountered error when refreshing cookies"},isExpected:!!a.isExpected})}})()}return Promise.resolve({result:"error",error:{code:"AugloopTokenErrorException",message:"Encountered issue with incorrect command or undefined getAugloopToken"},isExpected:!1})}_processEvent(a){switch(a.name){case K.a.ScriptLoaded:this._scriptsLoadedTime=new Date,this._signal.complete();let b=this._props.options&&this._props.options.onScriptsLoaded;b&&b();break;case K.a.Resize:if(!this._context.fullScreenIframe&&"width"in a&&"height"in a){let b=this._props.options&&this._props.options.onResize;b&&a.width&&a.height&&b(a.width,a.height),this._iframeWidth=a.width||320,this._iframeHeight=a.height||400,this._isShareReady&&(this._iframe.style.height=`${this._iframeHeight}px`,this._iframe.style.width=`${this._iframeWidth}px`)}break;case K.a.Started:let c=this._props.options&&this._props.options.onStarted;c&&c();break;case K.a.Ready:this._showShareUX();let d={scriptsLoadedTime:this._scriptsLoadedTime?this._scriptsLoadedTime.getTime()-this._iframeStartTime.getTime():-1,iframeLoadedTime:this._iframeLoadedTime,mode:this._context.mode,recipientsCount:this._context.defaultRecipients&&this._context.defaultRecipients.length||0,shareId:this._context.shareId,correlationId:this._context?.correlationId};this._sessionQos.end({resultType:A.b.Success,extraData:d}),this._shareCustomerPromiseLogger.end({resultType:A.b.Success});let e=this._props.options&&this._props.options.onReady;e&&e();break;case K.a.Error:this._showShareUX();let g=this._props.options&&this._props.options.onError;if("error"in a){let b=a.resultCode||(0,f.e)(Error(a.error))||"unavilable";this._sessionQos.end({resultType:A.b.Failure,resultCode:b,extraData:{correlationId:this._context?.correlationId}}),this._shareCustomerPromiseLogger.end({resultType:A.b.Failure,errorCode:b,extraData:{clientId:this._context.clientId,mode:this._context?.mode,correlationId:this._context?.correlationId}}),g&&g({name:"SharePrefetchError",message:a.errorMessage||"",error:Error(a.error),debugErrorMessage:a.debugErrorMessage||"",errorMessage:a.errorMessage||"",resultCode:b})}break;case K.a.ShareCompleted:let h=this._props.options&&this._props.options.onCompleted;h&&h({scope:"scope"in a&&a.scope||"",shareType:"shareType"in a?a.shareType:0});break;case K.a.Dismiss:let i=this._props.options&&this._props.options.onDismiss;i&&i();break;case K.a.ManageAccessClicked:let j=this._props.options&&this._props.options.openManageAccess;j&&j();break;case K.a.LinkSettingCompleted:let k=this._props.options&&this._props.options.onLinkSettingsComplete;a&&k&&k(a);break;case K.a.GrantAccessCompleted:let l=this._props.options&&this._props.options.onGrantAccessComplete;"successful"in a&&a.successful&&l&&l();break;case K.a.ReadyForRecipients:if(this._props.options?.onReadyForRecipients){let a=this._props.options?.onReadyForRecipients();a&&a.length>0&&this._iframe?.contentWindow&&this._iframe?.contentWindow.postMessage(JSON.stringify({name:"atMention_defaultRecipients",recipientIds:a}),this._iframeUrl)}break;case K.a.GetToken:let m=new A.a({name:"SharingSession.GetToken"}),n=this._iframe.contentWindow;if(!n){m.end({resultType:A.b.Failure,error:"no_window"});break}this._props.options.spRestTokenProvider&&this._props.options.spRestTokenProvider.getAuthToken&&a&&"url"in a?this._props.options.spRestTokenProvider.getAuthToken({...a,apiQosName:"SharePrefetch.getToken",disallowCookies:!0}).then(a=>{a?(this._sharingHostMessenger?this._sharingHostMessenger.sendNewToken(a,void 0):n.postMessage(JSON.stringify({name:"share_newToken",token:a}),this._iframeUrl),m.end({resultType:A.b.Success})):(this._sharingHostMessenger?this._sharingHostMessenger.sendNewToken(void 0,"no_token"):n.postMessage(JSON.stringify({name:"share_newToken",error:"no_token"}),this._iframeUrl),m.end({resultType:A.b.Failure,error:"no_token"}))}).catch(a=>{this._sharingHostMessenger?this._sharingHostMessenger.sendNewToken(void 0,"token_exception",a.toString()):n.postMessage(JSON.stringify({name:"share_newToken",error:"token_exception",errorDetails:a}),this._iframeUrl),m.end({resultType:A.b.Failure,error:String(a)})}):(this._sharingHostMessenger?this._sharingHostMessenger.sendNewToken(void 0,"no_handler"):n.postMessage(JSON.stringify({name:"share_newToken",error:"no_handler"}),this._iframeUrl),m.end({resultType:A.b.Failure,error:"no_handler"}))}}constructor(a){let b;this._iframe=document.createElement("iframe"),this._form=document.createElement("form"),this._formInput=document.createElement("input"),this._sharingHostMessenger=null,this._channelId=B.a.generate(),this._onReceiveWindowMessage=a=>{try{let b=a?.data&&JSON.parse(a.data);if(!this._elementWindow.document.body.contains(this._props.element)){this._messagesReceived.sharePrefetch_selfDispose=!0,this.dispose();return}b.name&&(this._messagesReceived[b.name||""]=!0,this._processEvent(b))}catch(a){}},this._signal=new k.b,this._context=a.context,this._iframeWidth=0,this._iframeHeight=0,this._timeoutId=-1,this._isShareReady=!1,this._iframeUrl="",this._iframeBaseUrl="",this._messagesReceived={},this._props=a,this._elementWindow=this._props.elementWindow||window,this._sessionId=this._props.sessionId||B.a.generate(),this._manager=(0,x.b)({sourceName:"SharePrefetch"}),this._hostOrigin="",this._clientOrigin="",this._clickTime=this._props.clickTime||Date.now(),this._sessionQos=new(A.a.withManager(this._manager).withContext(a=>({...a,"AppInfo.Session":this._sessionId})))({name:`SharingSession.${l.a[a.context.mode||l.a.share]}`}),this._shareCustomerPromiseLogger=new C.b({scenario:"sharePrefetch.load",perfGoalInMs:3e4});const c=void 0===this._props.context.hostMethod?d.a.microservice:this._props.context.hostMethod,e=this._props.isConsumer;if(this._launchNewSharedialog=c===d.a.sharepoint&&(!e||H),this._launchNewSharedialogInCOB=this._launchNewSharedialog&&H&&!!e,this._isInlineConsumer=(e||!1)&&c===d.a.consumerOnedrive,this._useODCSharePrefetchInline=G&&this._isInlineConsumer,this._addSharingContextInfoToFormEnabled=!g.Ov.isActivated("9CEFC1D7-1807-4AFE-B66C-614C3F4E9029","07/08/2025","AddSharingContextInfoToForm")&&this._launchNewSharedialog,!this._context?.authToken)throw Error("An access token is required for SharePrefetch optimization");let f="";if(this._context.invitationId&&(f=`&invitationId=${this._context.invitationId}`),this._launchNewSharedialog){const a=this._props.sharepointHostUrl?`${this._props.sharepointHostUrl}&sessionId=${this._sessionId}&clickTime=${this._clickTime}${this._launchNewSharedialogInCOB?"&itemMigrated=true":""}`:void 0;this._iframeUrl=a||`${this._context.webAbsoluteUrl}/_layouts/15/sharedialog.aspx?sessionId=${this._sessionId}&sharingCorrelationId=${B.a.generate()}&clickTime=${this._clickTime}${f}&crossdomain=true${this._launchNewSharedialogInCOB?"&itemMigrated=true":""}`}else if(c===d.a.sharepoint&&this._props.sharepointHostUrl)this._iframeBaseUrl=this._iframeUrl=this._props.sharepointHostUrl;else if(this._useODCSharePrefetchInline&&this._isInlineConsumer)this._iframeBaseUrl=window.location.protocol+"//"+window.location.hostname,b=document.cookie.replace(/ /g,"").split(";").filter(a=>0===a.indexOf("srr=")).map(a=>a.split("=")[1])[0];else switch((b=document.cookie.replace(/ /g,"").split(";").filter(a=>0===a.indexOf("srr=")).map(a=>a.split("=")[1])[0])?"test":a.environment){case"pathfinder":this._iframeBaseUrl="https://od.apps.mil";break;case"trailblazer":this._iframeBaseUrl="https://admin.onedrive.us";break;case"ag08":this._iframeBaseUrl="https://odweba.svc.ms.eaglex.ic.gov";break;case"ag09":this._iframeBaseUrl="https://odweba.svc.ms.microsoft.scloud";break;case"test":this._iframeBaseUrl="https://www.onedrive-tst.com",this._iframeUrl=a.testEnvironmentUrl||"";break;default:this._iframeBaseUrl="https://www.odwebp.svc.ms"}const h={clientName:this._context.clientId,userAuthToken:this._context.authToken,Session:this._sessionId};e&&(this._context.userId?h.userId=this._context.userId:h.accountType="ConsumerAnonymous"),g.Ov.isActivated("27C7DEF3-409A-44D0-BFDC-124F29455DDA","01/29/2025","more sharing telemetry")?new w(h).attach(this._manager):(0,I.b)({workload:"ODB",sourceName:"odb-share-prefetch",tokens:J.a,customManager:this._manager,context:h,initOneDS:!0}),this._iframeUrl||c!==d.a.microservice?!this._iframeUrl&&this._useODCSharePrefetchInline&&this._isInlineConsumer&&(this._iframeUrl=`${this._iframeBaseUrl}/share?smkt=${a.locale}${e?"&consumer=true":""}&sessionId=${this._sessionId}${f}${b?`&nextdevhost=${encodeURIComponent(b)}&nextserverhost=${encodeURIComponent(b)}`:""}`):this._iframeUrl=`${this._iframeBaseUrl}/share?smkt=${a.locale}${e?"&consumer=true":""}&sessionId=${this._sessionId}${f}${b?`&devhost=${encodeURIComponent(b)}`:""}`,this._iframeStartTime=new Date,this._initializeIframe(),a.element.appendChild(this._iframe);const i=this._isInlineConsumer&&this._useODCSharePrefetchInline;if(!e||this._launchNewSharedialogInCOB||i){if(this._launchNewSharedialog){this._initializeForm();const a=this._iframe.contentWindow;a&&(a.document.body.appendChild(this._form),this._form.submit())}}else this._initializeForm(),a.element.appendChild(this._form);this._sharingHostMessenger||this._launchNewSharedialogInCOB||(this._sharingHostMessenger=this._createSharingHostMessenger())}}}
,(a,b,c)=>{c.d(b,{a:()=>d});let d=c(232).a}
,(a,b,c)=>{c.d(b,{a:()=>g,b:()=>p});var d=c(16),e=c(0);let f=c("odsp.util_126").Ov.isActivated("C55E83F0-3687-4B0B-96B3-4EA3194C5B49"),g={Small:1,Medium:2,Large:3},h="_oat_",i="UserPhotoAspx",j={},k={},l="TryGetAlternativeUrlFailure",m="_spPageContextInfo",n="_spHomePageContext";function o(a){if(-1===a.indexOf(h))return!0;let b=k[a];if(b)return Date.now()/1e3<b;let c=new d.b(a),f=c.getQueryParameter(h);if(f){let c=f.split("_");if(2===c.length&&(b=Number(c[0])),!b)return new e.a({name:l}).end({resultType:e.b.Failure,resultCode:"OatParamUnexpectedFormat",extraData:{eatParam:f}}),k[a]=Date.now()/1e3+86400,!0;if(b-=30,k[a]=b,Date.now()/1e3>b)return!1}let g=c.getQueryParameter("P1");if(!g)return!0;let i=Number(g);return i-=30,k[a]=Math.min(i,k[a]),!(Date.now()/1e3>i)}function p(a,b,c){let h;switch(c=c||function(a){function b(a){return o(window[a].userPhotoCdnBaseUrl)?window[a].userPhotoCdnBaseUrl:(f&&delete window[a].userPhotoCdnBaseUrl,"")}try{let c=j&&j[a];if(!c&&i===a&&(window[m]?.userPhotoCdnBaseUrl?c=b(m):window[n]?.userPhotoCdnBaseUrl&&(c=b(n))),!c)return;if(!o(c))return void(f?delete j[a]:j[a]&&delete j[a]);return c}catch(a){f&&new e.a({name:l}).end({resultType:e.b.Failure,resultCode:"Unexpected",extraData:{error:a}})}}(i)||"/_layouts/15/userphoto.aspx",b){case g.Medium:h="M";break;case g.Large:h="L";break;default:h="S"}let k=new d.b(c);return k.setQueryParameter("size",h),k.setQueryParameter("accountname",a||""),k.toString()}}
,(a,b,c)=>{c.d(b,{a:()=>d});function d(a){if(!a||0===a.length)return 0;let b=5381;for(let c=0;c<a.length;c++)b=(b<<5)+b+a.charCodeAt(c),b&=b;return b}}
,(a,b,c)=>{c.d(b,{a:()=>h});var d=c(677),e=c(0);class f{get ready(){return this._messenger.ready}sendCommand(a,b){return this._messenger.sendCommand(a,b)}sendNotification(a){return this._messenger.sendNotification(a)}addCommandHandler(a){return this._commandHandlers.push(a),{dispose:()=>{let b=this._commandHandlers.indexOf(a);b>-1&&this._commandHandlers.splice(b,1)}}}addNotificationHandler(a){return this._notificationHandlers.push(a),{dispose:()=>{let b=this._notificationHandlers.indexOf(a);b>-1&&this._notificationHandlers.splice(b,1)}}}dispose(){this._messenger.dispose()}_onCommand(a){for(let b of this._commandHandlers){let c=b(a);if(c)return c}}_onNotificiation(a){for(let b of this._notificationHandlers)b(a)}constructor(){this._commandHandlers=[],this._notificationHandlers=[]}}var g=c(387);class h extends f{sendShareDestruct(){let a={command:"shareCommand",name:g.a.Destruct};return this._send(a)}sendShareRevisible(a){return a.command="shareCommand",this._send(a)}sendSharingContextInformation(a){return this._send({command:"shareCommand",name:"share_postContextInformation",data:a})}sendNewToken(a,b,c){let d={command:"shareCommand",name:g.a.NewToken};return a?d.token=a:b&&(d.error=b,d.errorDetails=c),this._send(d)}sendDocumentInformation(a){let b={command:"shareCommand",name:g.a.DocumentInformation,data:{documentInformation:a}};return this._send(b)}sendReloadWithAuthToken(a){let b={command:"shareCommand",name:g.a.ReloadWithAuthToken,data:{authToken:a}};return this._send(b)}sendSharingInfoBarInformation(a){return this._send({command:"shareCommand",name:"share_sharingInfoBarInformation",data:{sharingInfoBarInformation:a}})}_send(a){return this._messenger.sendCommand(a).then(a=>!!a).catch(b=>(this._customerPromiseLogger?.end({resultType:e.b.Failure,errorCode:`SharingHostMessenger - send ${a.name} failed`,extraData:{errorMessage:b.toString()}}),!1))}constructor({initTimeoutMs:a=4e4,...b}){super(),this._customerPromiseLogger=b.customerPromiseLogger,this._messenger=(0,d.a)({...b,initTimeoutMs:a,identifyParent:!0,onCommand:this._onCommand.bind(this),onNotification:this._onNotificiation.bind(this)})}}}
,(a,b,c)=>{c.d(b,{a:()=>m});var d=c("odsp.util_126");class e{on(a,b,c){let d;if(f(a))d=a;else{let b=this._targetMap.get(a);b?d=b:(d=new EventTarget,this._targetMap.set(a,d))}d.addEventListener(b,c);let e=this._disposableMap.get(a);e||(e=new Map,this._disposableMap.set(a,e));let g=this._scope.attach({dispose:()=>{d.removeEventListener(b,c)}});e.set(b,g)}off(a,b,c){let d;if(f(a))d=a;else{let b=this._targetMap.get(a);b&&(d=b)}let e=this._disposableMap.get(a);if(e){let c=e.get(b);c&&(c.dispose(),e.delete(b)),0===e.size&&this._disposableMap.delete(a)}d&&d.removeEventListener(b,c)}dispose(){this._scope.dispose()}constructor(a){this._scope=new d.XW,this._targetMap=new WeakMap,this._disposableMap=new WeakMap}}function f(a){return!!a.addEventListener}class g{setTimeout(a,b){let c=setTimeout(()=>{this._timeoutMap.delete(c),a()},b),d=this._scope.attach({dispose:()=>{clearTimeout(c)}});return this._timeoutMap.set(c,d),c}clearTimeout(a){let b=this._timeoutMap.get(a);b&&(this._timeoutMap.delete(a),b.dispose())}dispose(){this._scope.dispose()}constructor(a){this._scope=new d.XW,this._timeoutMap=new Map}}let h="handlerRejection",i="canceled",j=0;class k{dispose(){this._scope.dispose(),this._signals.forEach(a=>{a.resolve({result:"error",isExpected:!0,error:{code:i,message:"Messenger disposed"}})}),this._signals.clear()}sendCommand(a,b={}){if(this._scope.isDisposed)return Promise.resolve({result:"error",isExpected:!1,error:{code:"disposed",message:"disposed"}});let c=++j,{timeoutDelayMs:d=this._resultTimeoutMs,acknowledgeTimeoutMs:e=this._ackTimeoutMs,transfer:f}=b;return this._port.then(b=>{let g=this._async,h=new Promise(a=>{this._signals.set(c,{acknowledgeTimeout:g.setTimeout(()=>{this._onResult(l(c,"acknowledgeTimeout"))},e),resultTimeout:g.setTimeout(()=>{this._onResult(l(c,"resultTimeout"))},d),resolve:a})});return b.postMessage({type:"command",id:c,data:a},f||[]),h})}sendNotification(a){this._scope.isDisposed||this._port.then(b=>{b.postMessage({type:"notification",data:a})})}_onAcknowledge(a){let b=this._signals.get(a.id);b&&this._async.clearTimeout(b.acknowledgeTimeout)}_onCommand(a,b){let c=b.id;a.postMessage({type:"acknowledge",id:c}),this._invokeCommandHandler(b.data).then(b=>{a.postMessage({type:"result",data:b,id:c})}).catch(a=>{})}_onNotification(a){this._invokeNotificationHandler(a.data)}_onResult(a){let b=a.id,c=this._async,d=this._signals,e=d.get(b);e&&(c.clearTimeout(e.acknowledgeTimeout),c.clearTimeout(e.resultTimeout),e.resolve(a.data)),d.delete(b)}constructor(a,b={}){let c;const f=new Map,j={onCommand:a.onCommand,onNotification:a.onNotification},{initResources:k,initTimeoutMs:l=1e4,ackTimeoutMs:m=1e3,resultTimeoutMs:n=1e4}=a,{asyncType:o=g,eventGroupType:p=e}=b,q=this._scope=new d.XW;q.attach(k);const r=this._async=q.attach(new o(this)),s=q.attach(new p(this));this._ackTimeoutMs=m,this._resultTimeoutMs=n,this._invokeCommandHandler=a=>{try{let b=j.onCommand&&j.onCommand(a);if(!b)return Promise.resolve({result:"error",error:{code:"unsupportedCommand",message:a.command},isExpected:!0});return Promise.resolve(b).catch(a=>(a=a||{name:h,isExpected:!1,message:"Unknown error"},{result:"error",error:{code:a.code||a.name||h,message:a.message||`${a}`},isExpected:!!a.isExpected}))}catch(a){return Promise.resolve({result:"error",isExpected:!1,error:{code:"handlerError",message:a&&`Name: ${a.name}; Message: ${a.message||a}`}})}},this._invokeNotificationHandler=a=>{try{j.onNotification&&j.onNotification(a)}catch{}};const t=this._port=new Promise((b,d)=>{q.attach({dispose:()=>{let a=Error("Initialization canceled.");a.code=i,d(a)}}),c=r.setTimeout(()=>{let a=Error(`Initialization timed out after ${l}ms`);a.code="setupTimeout",d(a)},l),a.init(a=>{r.clearTimeout(c),q.attach({dispose:()=>{a.close()}});let d=b=>{let c=b.data;if(c&&"object"==typeof c){if("acknowledge"===c.type)return this._onAcknowledge(c);if("command"===c.type)return this._onCommand(a,c);if("notification"===c.type)return this._onNotification(c);if("result"===c.type)return this._onResult(c)}};s.on(a,"message",d),a.start(),b(a)},d)});this.ready=t.then(()=>{},a=>(this.dispose(),Promise.reject(a))),this._signals=f}}function l(a,b){return{id:a,data:{result:"error",error:{code:b,message:"Timed out"},isExpected:!1}}}function m(a,b={}){let{channelId:c,onReinitialize:f,origin:g,receiver:h=window,source:i,identifyParent:j}=a,{eventGroupType:l=e,messengerType:n=k}=b,o=new d.XW,p=o.attach(new l(null));return new n({onCommand:a.onCommand,onNotification:a.onNotification,init:(a,b)=>{let e;if(j&&i){let a=setInterval(()=>{i.postMessage({type:"identify-parent",channelId:c},g)},100);e=o.attach({dispose:()=>{clearInterval(a)}})}let k=!1;p.on(h,"message",b=>{let h=b.data;if((0,d.UA)(b.origin,g)&&(!i||b.source===i)&&h&&"object"==typeof h&&"initialize"===h.type&&h.channelId===c){if(e&&e.dispose(),f){if(k){f(),p.dispose();return}k=!0}else p.dispose();let b=h.replyTo;b.postMessage({type:"activate"}),a(b)}})},initResources:o,initTimeoutMs:a.initTimeoutMs,ackTimeoutMs:a.ackTimeoutMs,resultTimeoutMs:a.resultTimeoutMs})}}
,(a,b,c)=>{c.d(b,{a:()=>d});function d(a){let b=document.getElementById(a);return b||((b=document.createElement("div")).id=a,document.body.appendChild(b)),[b,function(){b&&document.body.contains(b)&&document.body.removeChild(b)}]}}
,,(a,b,c)=>{c.d(b,{a:()=>e});var d=c("odsp.util_126");function e(){return!d.Ov.isActivated("19CFF699-BC25-4595-AF4E-60224802FA48")&&d.lU.isFeatureEnabled({ODB:62582})}}
,(a,b,c)=>{var d,e;c.d(b,{a:()=>d}),(e=d||(d={}))[e.share=1]="share",e[e.copyLink=2]="copyLink",e[e.atMention=3]="atMention",e[e.manageAccess=5]="manageAccess",e[e.notify=6]="notify",e[e.addPeople=7]="addPeople"}
,,(a,b,c)=>{function d({extension:a,isMountPoint:b}){var c;return!(b||"url"===(c=a)||".url"===c)}c.d(b,{a:()=>d})}
,,,,(a,b,c)=>{c.d(b,{a:()=>d});let d=!c("odsp.util_126").Ov.isActivated("66EDC6AE-80AC-4431-B9D9-456A88EB4A33")}
,(a,b,c)=>{c.d(b,{a:()=>d});let d=c(1).a("images/brand-icons/product/svg/word_16x1.svg")}
,(a,b,c)=>{c.d(b,{a:()=>d});let d=c(1).a("images/brand-icons/product/svg/excel_16x1.svg")}
,(a,b,c)=>{c.d(b,{a:()=>d});let d=c(1).a("images/brand-icons/product/svg/powerpoint_16x1.svg")}
,(a,b,c)=>{c.d(b,{a:()=>d});let d=c(1).a("images/brand-icons/product/svg/onenote_16x1.svg")}
,(a,b,c)=>{c.d(b,{a:()=>f});var d=c(114),e=c(0);function f(a){return{getImmersiveReaderContext:async()=>({content:await function(a){let{url:b,qosName:c}=a,f="MeTA.IMReader";f+=c?"."+c:"";let g=new e.a({name:f});return d.a.start({url:b}).then(a=>(g.end({resultType:e.b.Success}),Promise.resolve(a))).catch(a=>{let b=a.response&&JSON.parse(a.response),c=b?.error?.innererror?.code||b?.error?.code||JSON.stringify(b);return g.end({resultType:e.b.Failure,resultCode:a.status.toString(),error:c,extraData:{message:b?.error.message,details:JSON.stringify(a.response)}}),Promise.reject(a)})}(a)})}}}
,(a,b,c)=>{async function d(a){let{getImmersiveReaderContext:b,options:d}=a,f={uiZIndex:1000001,timeout:2e4,cognitiveAppId:"OneDrive",...d},{launchWithoutContentAsync:g}=await c.e(0).then(c.t.bind(c,778,23));try{let[a,c]=await Promise.all([g(f),e(b)]),{provideContentModelResponse:d,cancelAndCloseReader:h}=a,i=200===c.status?JSON.parse(c.response):c;try{let a=await d(i);return Promise.resolve(a)}catch(a){if(h(),a.message&&"string"==typeof a.message)return Promise.reject(Error(a.message));return Promise.reject(Error("Unknown. Immersive Reader failed at providing API response."))}}catch(a){if("Immersive Reader is already launching"===a)return Promise.reject(Error(a));return Promise.reject(Error("Unknown. Immersive Reader failed at launch."))}}async function e(a){try{let b=await a();return Promise.resolve(b.content)}catch(a){return Promise.resolve(a)}}c.d(b,{a:()=>d})}
,(a,b,c)=>{c.d(b,{a:()=>d});function d(a){return a>0&&a<=0x3200000}}
,,,(a,b,c)=>{c.d(b,{a:()=>d});let d=c(1).a("images/clipchamp/clipchamp_256x.svg")}
,(a,b,c)=>{c.d(b,{a:()=>d});let d=c(1).a("images/clipchamp/clipchampfy26_256x.svg")}
,(a,b,c)=>{var d,e;c.d(b,{a:()=>f}),(e=d||(d={}))[e.Recycle=2]="Recycle",e[e.PermanantDelete=3]="PermanantDelete",e[e.MoveToSecondStage=4]="MoveToSecondStage";let f=d}
,,,(a,b,c)=>{c.d(b,{a:()=>d});let d=c(1).a("images/contentcenter/syntexicons/esignatureicons/microsoftlogo_16x1.svg")}
,(a,b,c)=>{c.d(b,{a:()=>d});let d=c(1).a("images/brand-icons/product/svg/sharepoint_16x1.svg")}
,(a,b,c)=>{c.d(b,{a:()=>d});let d=c(1).a("images/contentcenter/syntexicons/esignatureicons/adobeacrobatsign.svg")}
,(a,b,c)=>{c.d(b,{a:()=>d});let d=c(1).a("images/contentcenter/syntexicons/esignatureicons/docusign.svg")}
,(a,b,c)=>{c.d(b,{a:()=>d});let d=c(1).a("images/contentcenter/syntexicons/esignatureicons/signature.svg")}
,(a,b,c)=>{c.d(b,{a:()=>d});let d=c(1).a("images/contentcenter/syntexicons/esignatureicons/signaturehighcontrast.svg")}
,,,,,,,,(a,b,c)=>{c.d(b,{a:()=>h});var d=c("odsp.util_126");let e=new Set(["csv","doc","docx","htm","html","markdown","md","msg","odp","ods","pdf","ppt","pptx","rtf","txt","xls","xlsx"]),f=new Set(["csv","doc","docx","htm","html","markdown","md","mdown","mdtext","mdtxt","mdwn","mht","mhtml","mkd","mkdn","msg","odp","ods","odt","pdf","ppt","pptx","rmd","rtf","tab","tsv","txt","xlf","xls","xlsx"]),g={ODB:62507};function h(a){if(!a)return!1;let b=a.toLowerCase().replace(/^\.?/,"");return d.lU.isFeatureEnabled(g)?f.has(b):e.has(b)}}
,(a,b,c)=>{c.d(b,{a:()=>d});function d(a){return".copilot"===a||".agent"===a}}
,,,(a,b,c)=>{c.d(b,{a:()=>p});var d=c(3),e=c("react-lib"),f=c("fui.core_517"),g=c(720),h=c(70);let i={tiny:100,xSmall:100,small:200,smallPlus:200,medium:300,mediumPlus:400,large:500,xLarge:500,xxLarge:700,mega:1e3,xLargePlus:700,xxLargePlus:800,superLarge:900},j=["xLarge","xLargePlus","xxLarge","xxLargePlus","superLarge","mega"],k=new Set(["as","block","nowrap","variant","styles"]);var l=c(395);let m=(0,f.n94)({size300:{lineHeight:"normal"}}),n=(0,d.a)({useStaticStyles:!0}),o=(0,d.a)(),p=a=>{let b,c=(0,l.a)("Text",a),{as:d,styles:p={},className:q,theme:r,block:s,nowrap:t,variant:u}=c,v=(b={},void 0!==c.nowrap&&(b.wrap=!c.nowrap),void 0!==c.block&&(b.block=c.block),void 0!==c.variant&&(b.size=i[c.variant],j.includes(c.variant)&&(b.weight="semibold")),void 0!==c.as&&(b.as=c.as),{...b,...(0,h.d)(c,k)}),w=m(),x={};if(r){let{fonts:a,semanticColors:b}=r,c=a[u||"medium"];x={root:[c,{color:c.color||b.bodyText,display:s?"td"===d?"table-cell":"block":"inline",mozOsxFontSmoothing:c.MozOsxFontSmoothing,webkitFontSmoothing:c.WebkitFontSmoothing},t&&{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},q]}}let y=n(p,{theme:r}),z=o(x,{theme:r});return e.createElement(g.a,{...v,className:(0,f.tlm)(y?.root,z?.root,v?.size&&v?.size!==300?"":w.size300,q)},a.children)};p.displayName="TextShim"}
,,,,,(a,b,c)=>{c.d(b,{a:()=>k});var d=c("react-lib"),e=c(183),f=c(396),g=c("fui.util_178"),h=c(398),i=c("odsp.util_126");let j={compat:!0};function k(a){let b,c,{theme:k}=a;if(!k?.palette)return d.createElement(e.a,a);let{children:l,...m}=(b=i.Ov.isActivated("6031CC4D-E22A-4F82-B975-7224AACE86A6")?a.theme:(0,g.MP)((0,g.kF)(),a.theme),c={},b&&(c.theme=(0,h.a)(b)),a.style&&(c.style=a.style),c.children=a.children,c);return d.createElement(f.a,{...m,configOverride:j},d.createElement(e.a,a,l))}k.displayName="ThemeProviderShim"}
,,,,,,,,,,(a,b,c)=>{c.d(b,{a:()=>d});let d=a=>{let{theme:b}=a,{effects:c}=b;return{root:{borderRadius:c.roundedCorner4,boxShadow:c.elevation8},container:{borderRadius:c.roundedCorner4},list:{padding:"4px"},subComponentStyles:{callout:{},menuItem:{root:{borderRadius:c.roundedCorner2,"&:after":{borderRadius:c.roundedCorner2}},divider:{margin:"4px"},icon:{color:"inherit"}}}}}}
,(a,b,c)=>{c.d(b,{a:()=>w});var d=c(336),e=c("react-lib"),f=c(3),g=c(5),h=c("fui.util_178"),i=c("fui.core_517"),j=c(737),k=c(738),l=c(739),m=c(748),n=c(70);let o=new Set(["allowTouchBodyScroll","className","componentRef","containerClassName","dragOptions","enableAriaHiddenSiblings","focusTrapZoneProps","isAlert","isBlocking","isDarkOverlay","isModeless","isOpen","layerProps","onDismiss","onDismissed","onLayerDidMount","overlay","popupProps","responsiveMode","scrollableContentClassName","styles","subtitleAriaId","theme","titleAriaId","topOffsetFixed"]);var p=c(395);let q=(0,i.n94)({dialogSurface:{width:"fit-content",maxWidth:"100vw",overflowX:"auto",overflowY:"auto",padding:"0 0 1px 0",border:0},dialogBody:{display:"block"},dialogContent:{overflowY:"visible",margin:"0",padding:"0"}}),r=(0,f.a)({}),s=1e3*parseFloat(g.c.durationValue2),t=e.forwardRef(function(a,b){let c=(a=>{var b;let{isAlert:c,isModeless:d,isBlocking:e,isOpen:f,onDismiss:g}=a;return{modalType:(b={isAlert:c,isModeless:d,isBlocking:e}).isAlert?"alert":b.isModeless?"non-modal":b.isBlocking?"alert":"modal",open:f,onOpenChange:(a,b)=>{!1===b.open&&g?.(a)},...(0,n.d)(a,o)}})(a),d=(a=>{let b,{layerProps:c,popupProps:d,titleAriaId:e,subtitleAriaId:f}=a,g=c?.hostId?document.getElementById(c.hostId):void 0;return{"aria-labelledby":e,"aria-describedby":f,...(b=(0,n.c)(d),d?.role&&(b.role=d.role),b),mountNode:g}})(a),{className:f,containerClassName:g,scrollableContentClassName:t,onDismissed:u,isOpen:v,children:w,overlay:x,layerProps:y}=a,z=g;"object"==typeof g&&(z=(0,h.t3)(g));let A=(0,i.tlm)(f,z),B=r((0,p.a)("Modal",a).styles),C=q(),D=y?.onLayerDidMount,E=(0,n.f)(),F="object"==typeof a.styles&&"object"==typeof a.styles.root&&a.styles.root&&"display"in a.styles.root&&"none"===a.styles.root.display,[G,H]=e.useState(!0);e.useEffect(()=>{v||setTimeout(()=>{u?.()},s)},[v,u]),e.useEffect(()=>{v&&G&&(D?.(),H(!1))},[v,G,D]);let I=e.createElement(j.a,{className:(0,i.tlm)("ms-Dialog-main",C.dialogBody,B.scrollableContent),tabIndex:-1},e.createElement(k.a,{className:(0,i.tlm)("ms-Dialog-inner",C.dialogContent,t,B.scrollableContent)},w));return e.createElement(l.a,c,e.createElement(m.a,{style:{position:"fixed",display:F?"none":"block"},className:(0,i.tlm)("ms-Modal",i.Xg_,C.dialogSurface,A,B.main),backdrop:{style:{display:F?"none":"block"},className:(0,i.tlm)(x?.className,B.layer)},ref:E,...d},I))});t.displayName="ModalShim";var u=c(736),v=c(399);let w=a=>(0,u.a)(d.a,t,a,v.a.FluentUIV9ShimModal)}
,(a,b,c)=>{c.d(b,{a:()=>j});var d=c("react-lib"),e=c("odsp.util_126"),f=c(399);let g={forceEnabledFlights:[],forceDisabledFlights:[],flights:void 0,isInitialized:!1,queryParams:void 0};function h(a,b){if(-1!==g.forceEnabledFlights.indexOf(a))return!0;if(-1!==g.forceDisabledFlights.indexOf(a)||!b||0===b.length)return!1;let c=Object.values(f.a).indexOf(a);return -1===c?(console.error("The flight which needs to be checked is not in the fluent UI V9 component flights list"),!1):b.length<(c>>5)+1?(console.error("The fluent UI V9 component flights list is not initialized correctly"),!1):(b[c>>5]&1<<(31&c))!=0}var i=c(400);function j(a,b,c,j,k){let l,m=d.useContext(i.a),n=(window.__FUIV9Flights?(g.isInitialized||(g.flights||(g.flights=window.__FUIV9Flights),function(a){if(a&&a.length>0){let b=a.split(",");for(let a of(g.forceEnabledFlights=[],g.forceDisabledFlights=[],b))if("!"===a[0]){let b=parseInt(a.slice(1),10);isNaN(b)||g.forceDisabledFlights.push(b)}else{let b=parseInt(a,10);isNaN(b)||g.forceEnabledFlights.push(b)}}}(function(a){if(g.queryParams||(g.queryParams=new URLSearchParams(window.location.search)),g.queryParams.has(a))return g.queryParams.get(a)}("debugFlights")),function(){if(new Set(g.forceEnabledFlights.concat(g.forceDisabledFlights)).size<g.forceEnabledFlights.length+g.forceDisabledFlights.length)throw Error("There are flights that are forced to be both enabled and disabled")}(),g.isInitialized=!0),!!j&&!(j<0)&&h(f.a.FluentUIV9ShimOverallControl,g.flights)&&h(j,g.flights)):(l={ODB:f.a.FluentUIV9ShimOverallControl},e.lU.isFeatureEnabled(l)&&e.lU.isFeatureEnabled({ODB:j})))&&m;k&&(n=n&&!e.Ov.isActivated(k));let o=n?b:a;return d.createElement(o,c)}}
,,,,,,,,,,,,,,(a,b,c)=>{c.d(b,{a:()=>i});var d=c("odsp.util_126"),e=c(284),f=c(195);let g=d.Ov.isActivated("4146963c-106a-457e-9773-0cfa2d273108"),h=d.Ov.isActivated("2bb86a32-e66e-4b16-bb9a-4f666ca841ca");function i(a){return{workload:"ODB",sourceName:a.sourceName,tokens:a.tokens??f.a,context:a.context,pageContext:a.pageContext,customManager:a.customManager,initOneDS:a.initOneDS,offlineDetection:g?void 0:(0,e.a)(),...!h&&a.sessionId?{sessionId:a.sessionId}:{}}}}
,,(a,b,c)=>{let d;c.d(b,{a:()=>o,b:()=>p});var e=c(31),f=c("odsp.util_126"),g=c(38),h=c(16),i=c(194),j=c(385),k=c(39);let l=(d=(0,j.a)()(i.a),class extends d{constructor(a){const{contextProvided:b,...c}=a,{osName:d,osVersion:e}=new f.Ey;super({context:{OSName:d,OSVersion:e,UserAgent:navigator.userAgent,...b},logStartEvents:!0,...c})}}),m=!f.Ov.isActivated("F68B6171-BBD4-440F-9527-F56CE8D3EA2C","01/06/2024","collect flight and experiment"),n=!f.Ov.isActivated("D3B20610-CED8-4AAF-958B-8EC166C0A3D4","02/20/2024","build as experiment context");function o(a,b){let c,d,i,j,l,{CorrelationId:o,systemUserKey:p,userLoginName:q,farmName:r,farmLabel:s,siteSubscriptionId:t,homeTenantId:u,aadTenantId:v,SideBySideToken:w}=a;if(f.Ov.isActivated("0d905643-decb-4b91-8c6d-87348745d166"))c=o;else{let a=new h.b(window.location.href).getQueryParameter("sessionId");c=e.a.isValidGuid(a)?a:o}if(m){let b=function(a){let b,c=window.ODSP_EXPERIMENTS||{};for(let a in c)if(c.hasOwnProperty(a)){b=b||{};let d=c[a];d&&d._serverTime&&Date.now()-new Date(d._serverTime).getTime()<1296e6&&(b[a]=c[a])}return window.ODSP_EXPERIMENT_TAGS||(0,k.d)(a),{experiments:b,experimentTags:window.ODSP_EXPERIMENT_TAGS}}(a)||{};d=JSON.stringify(b.experiments),i=JSON.stringify(b.experimentTags),j=function(a){let b,{ExpFeatures:c}=a;if(c)for(let a of(b="",c))b+=(function(a){let b=(a>>>0).toString(2);return`${Array(32-b.length+1).join("0")}${b}`})(a).split("").reverse().join("");if(!f.Ov.isActivated("f00a10d6-c80d-49a2-9636-1b349f88c198")){let c=function(a){let{ECSClientFeatures:b}=a;return Object.keys(f.u9.EcsClientFlightInfo).map(a=>`ECS_${String(a)}_${(0,f.Us)(a,b)}`).join(",")}(a);c&&(b+=`|${c}`)}return b}(a)}return n&&(l="undefined"!=typeof window?window._spModuleLink:void 0),{UserId:p,FarmName:r,FarmLabel:s,AccountType:q?g.a[g.a.Business]:g.a[g.a.BusinessAnonymous],TenantID:t,ServerGU:w,Session:c,SessionId:c,HomeTenantId:u||v,ResourceTenantId:v,...m?{Flights:j,Experiments:d,ExperimentTags:i}:{},...n&&l?{isBuildAsExperimentRunning:l.isBuildAsExperimentRunning,buildAsExperimentTargetVersion:l.targetBuildNumber}:{},...b}}function p(a){let{pageContext:b,customerContext:c,...d}=a;return new l({contextProvided:o(b,c||{}),disableCookies:b.isAnonymousGuestUser,ariaLogConfiguration:{collectorUrl:b.ariaCollectorUrl},...d})}}
,,,,,(a,b,c)=>{c.d(b,{a:()=>l});var d=c(9),e=c(62);let f=c("odsp.util_126").Ov.isActivated("1C80122B-A9F9-4BAE-8C6F-5CA4331FBEBD");function g(a){return!!a.fileHandler}let h=/^(?:data|blob|javascript):/i,i=/^(?:data|http|https):/i,j={svg:!0,png1x:!0,png1_5x:!0,png2x:!0};function k(a){let b;if(a){for(let d in a)if(j.hasOwnProperty(d)){var c;let e=(c=a[d])&&i.test(c)?c:void 0;e&&(b||(b={}),b[d]=e)}}return b}class l{getFileHandlerData(a){return d.c.resolve((async()=>{let{language:b=e.a.language,accessToken:c,endpoint:d="",includePromotedApp:i=!1,driveId:j,allowCookies:l}=a||{},m=d+"/drive";j&&(m="me"===j?`${d}/me/drive`:`${d}/drives/${j}`);let n=async a=>{let b={custom:[],create:[],open:[],preview:[]},c={};for(let d of this._localFileHandlerProvider?[...await this._localFileHandlerProvider.getLocalFileHandlers(),...a.value]:a.value){if(!g(d)||g(d)&&d.hidden)continue;let a=i?g(d)&&!!d.promoted:void 0,e=g(d)&&!!d.builtIn,{application:f,id:j,actions:l,fileHandler:m}=d;if(!l)continue;let{fileTypeDisplayName:n,fileTypeIconUrl:o,version:p}=m;if(!p)continue;let q={id:j,appId:f.id,actionMenuDisplayName:m.actionMenuDisplayName,displayName:f.displayName,appIcon:k(m.appIcon),version:p,fileTypeDisplayName:n,fileTypeIcon:k(m.fileTypeIcon||{png1x:o}),isPromoted:a,isBuiltIn:e},r=0;for(let d of l){let{url:e}=d;if(!e||h.test(e))continue;let{displayName:f,shortDisplayName:g,icon:i,availableOn:j}=d;if(!j)continue;let l="newFile"===d.type?"create":d.type,m={type:l,url:e,displayName:f,icon:k(i),availableOn:{file:j.file,folder:j.folder,allowMultiSelect:j.allowMultiSelect},handler:q,id:r},n=j.file,o=n&&n.extensions;switch(l){case"custom":if(!f||(m.shortDisplayName=g,!n&&!j.folder))continue;break;case"create":if(!o||!o[0])continue;break;case"open":case"preview":if(!n)continue;if(o&&!a)for(let a of o)(c[a]||(c[a]={open:[],preview:[]}))[l].push(m);break;default:continue}b[l].push(m),r++}}return{actions:b,preferences:c,version:4}},o=m+"/apps?"+(i?"select=*,promoted,builtIn&":"")+"$expand=actions",p="GetDriveApps",q=async()=>{let a=await this._dataRequestor.send({path:o,apiName:p,headers:{"Accept-Language":b},accessToken:c,useAuthorizationHeaders:!!c,allowCookies:l,disallowSelfIssuedToken:!f||void 0});return await n(a)};if(this._prefetchCache)try{let a=await this._prefetchCache.getData({url:o,body:"",qosName:p});return await n(a)}catch(a){}return await q()})())}constructor(a,b){this._dataRequestor=b.dataRequestor,this._prefetchCache=b.prefetchCache,this._localFileHandlerProvider=b.localFileHandlerProvider}}}
,(a,b,c)=>{c.d(b,{a:()=>d});class d{async getLocalFileHandlers(){return[]}constructor(a,b){}}}
,,,(a,b,c)=>{c.d(b,{a:()=>f,b:()=>d,c:()=>e,d:()=>g});let d=3e5,e=864e5,f="odsp-ds-",g={cache:"cache",request:"request"}}
,(a,b,c)=>{c.d(b,{a:()=>d});let d={useCacheAndUpdateInTheBackground:0,useCacheIfNotExpired:1,onlyCache:2,bypassCache:3,useCacheAndNoUpdate:4,useCacheIfNotExpiredOrOnFailure:5,useCacheAndImmediatelyUpdate:6}}
,,,(a,b,c)=>{let d;c.d(b,{a:()=>d});var e=c("react-dom-lib"),f=c("react-lib"),g=c("fui.util_178"),h=c("odsp.util_126"),i=c(305),j=c("fui.core_517"),k=c(396),l=c(398),m=c(254);let n=f.forwardRef(function(a,b){let{dir:c,theme:d}=a,e=c||(document?.documentElement?.dir==="rtl"?"rtl":"ltr"),h=f.useMemo(()=>(0,l.a)(d),[d]),n=f.useRef(h),o=f.useRef(d),p=(0,i.a)(),q=n.current,r=a=>{a&&(0,m.a)(a,o.current)||(o.current=a,n.current=(0,l.a)(a),p())};return f.useMemo(()=>{(0,g.U0)(r)},[]),f.useEffect(()=>()=>{(0,g.kX)(r)},[]),f.createElement(j.m5X,{dir:e},f.createElement(k.a,{...a,theme:q,dir:e,ref:b},a.children))});n.displayName="FluentMigrationThemeWrapper";let o={lineHeight:"remove",background:"remove"},p={compat:!0};var q=c(400),r=c(407);let s=({children:a})=>{let b=f.useMemo(r.a,[]);return f.createElement(q.a.Provider,{value:b},a)};d=h.Ov.isActivated("26DDB843-862A-4916-A636-1BCE47633238")?e.render:(...a)=>{let[b,...c]=a;return((...a)=>{let[b,c,...d]=a,i=f.isValidElement(b)&&b||void 0;e.render(f.createElement(n,{theme:(0,g.kF)(),configOverride:h.Ov.isActivated("6cda8c08-94f5-469f-8312-b4c4442d386a")?o:p},b),c,...d);try{if(i){let a=c?.children[0];if(!a||!a.classList.contains("fui-FluentProvider"))return null;let b=Object.keys(a).find(a=>a.startsWith("__reactFiber$"));if(!b)return null;let d=a[b]?.child?.child?.child;return!d||d.type!==i.type||d.stateNode instanceof Node?null:d.stateNode}}catch{}return null})(f.createElement(s,null,b),...c)}}
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,(a,b,c)=>{c.d(b,{a:()=>h,b:()=>j});var d=c(102),e=c("odsp.util_126"),f=c(40);let g={ODB:e.Ov.isActivated("904afe8e-3cce-4ab4-ac2f-97b60197cf59","11/9/2021","Disable check for webTemplate mySite as qualification for isOdb"),ECS:108854},h=window._spPageContextInfo&&(window._spPageContextInfo.listBaseTemplate===d.a.mySiteDocumentLibrary||!e.B3.isFeatureEnabled(g)&&Number(window._spPageContextInfo.webTemplate)===f.b.mySite),i=!!window.FilesConfig,j=h||i}
,(a,b,c)=>{c.d(b,{a:()=>d});class d{push(a){this._length<this._size&&this._length++,this._head++,this._head===this._size&&(this._head=0),this._buffer[this._head]=a}popOldest(){if(0===this._length)return null;let a=(this._head-this._length+1+this._size)%this._size;return this._length--,this._buffer[a]}get isFull(){return this._length>=this._size}getAll(){let a=this._head+1;return this._length<this._size?this._buffer.slice(0,a):[...this._buffer.slice(a),...this._buffer.slice(0,a)]}constructor(a){if(a<=0)throw Error("Size must be positive");this._size=a,this._buffer=Array(a),this._length=0,this._head=-1}}}
,(a,b,c)=>{var d,e;c.d(b,{a:()=>d}),(e=d||(d={}))[e.Single=0]="Single",e[e.Start=1]="Start",e[e.End=2]="End"}
,,,,(a,b,c)=>{c.d(b,{a:()=>d.b});var d=c(242)}
,,,,,(a,b,c)=>{c.d(b,{a:()=>d});let d={download:0,view:1,load:2,share:3}}
,,,,,(a,b,c)=>{c.d(b,{a:()=>h});var d,e,f=c(6),g=c(674);function h(a,b,c){let d=(0,g.b)(b,void 0,c);if(!a||!d||0===d.indexOf("http"))return d;try{return new f.a(a).authority+d}catch(a){return d}}(d=e||(e={})).Small="S",d.Medium="M",d.Large="L"}
,(a,b,c)=>{c.d(b,{a:()=>f,b:()=>e,c:()=>g,d:()=>h});var d=c("odsp.util_126");let e="Prefer",f="ocdiAsDefault";function g(){return!d.Ov.isActivated("9e83ffc0-b39a-4fbf-8c0b-6e0c5bb9c0e6","07/29/2025","Add prefer header to support OCDI for WSET Item")}function h(a){return!!g()&&!d.Ov.isActivated("61ff1676-78f4-428f-9283-ba6cc93f3303","10/06/2025","Enable OCDI as default preferred functionality via spPageContextInfo")&&a?.isOCDIAsDefaultPreferred===!0}}
,(a,b,c)=>{var d,e;c.d(b,{a:()=>f}),(e=d||(d={}))[e.share=1]="share",e[e.copy=2]="copy",e[e.atMention=3]="atMention",e[e.linkSettings=4]="linkSettings",e[e.manageAccess=5]="manageAccess",e[e.notify=6]="notify",e[e.addPeople=7]="addPeople";let f=d}
,(a,b,c)=>{c.d(b,{a:()=>d});let d=!c("odsp.util_126").Ov.isActivated("6d2a844a-9c33-46b3-80c2-9e47560a97b7","4/26/2022")}
]]),define("plt.odsp-common",[],{});