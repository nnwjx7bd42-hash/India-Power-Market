/*! For license information please see oneuplightspeedwebpack.js.LICENSE.txt */
var __webpack_result__;(()=>{var a,b,c,d,e=[,,(a,b,c)=>{"use strict";c.d(b,{a:()=>e});var d=c("odsp.util_126");d.Ov.isActivated("0F025BDE-6561-48CD-8F76-0CB01AFB2B83");let e=new d.v7("appPageContext")}
,,(a,b,c)=>{"use strict";c.d(b,{$:()=>C,$b:()=>f,A:()=>_,Ab:()=>a_,Ac:()=>aI,B:()=>aa,Bb:()=>bh,Bc:()=>a9,C:()=>A,Cb:()=>a7,Cc:()=>aH,D:()=>t,Db:()=>aj,Dc:()=>aL,E:()=>Y,Eb:()=>aW,Ec:()=>aO,F:()=>N,Fb:()=>bQ,Fc:()=>aV,G:()=>K,Gb:()=>bM,Gc:()=>bJ,H:()=>J,Hb:()=>bB,Hc:()=>a$,I:()=>M,Ib:()=>a4,Ic:()=>aN,J:()=>L,Jb:()=>bv,K:()=>S,Kb:()=>aD,Kc:()=>at,L:()=>R,Lb:()=>a2,Lc:()=>bq,M:()=>U,Mb:()=>aY,Mc:()=>aB,N:()=>Q,Nb:()=>bN,Nc:()=>aM,O:()=>T,Ob:()=>aZ,Oc:()=>a0,P:()=>X,Pb:()=>bm,Pc:()=>av,Q:()=>v,Qb:()=>bd,R:()=>p,Rb:()=>an,Rc:()=>ak,S:()=>r,Sb:()=>bA,Sc:()=>be,T:()=>q,Tb:()=>bp,Tc:()=>bx,U:()=>W,Ub:()=>au,Uc:()=>bI,V:()=>u,Vb:()=>bH,Vc:()=>bj,W:()=>V,Wb:()=>aU,Wc:()=>as,X:()=>F,Xb:()=>bt,Y:()=>ay,Yb:()=>aF,Z:()=>az,Zb:()=>aR,_:()=>ab,_b:()=>bz,_c:()=>bu,a:()=>j,ab:()=>ad,ac:()=>ag,b:()=>af,bb:()=>bF,bc:()=>a3,c:()=>E,cb:()=>a6,cc:()=>bo,d:()=>G,db:()=>bK,dc:()=>bi,e:()=>k,eb:()=>h,ec:()=>aG,f:()=>z,fb:()=>br,fc:()=>aQ,g:()=>n,gb:()=>bE,gc:()=>aA,h:()=>aw,hb:()=>bw,hc:()=>bf,i:()=>s,ib:()=>Z,ic:()=>bL,j:()=>ax,jb:()=>bs,jc:()=>by,k:()=>y,kb:()=>a8,kc:()=>a1,l:()=>m,lb:()=>ao,lc:()=>bc,m:()=>O,mb:()=>al,mc:()=>bg,n:()=>P,nb:()=>ar,nc:()=>a5,o:()=>w,ob:()=>bP,oc:()=>bk,p:()=>H,pb:()=>am,pc:()=>aC,q:()=>I,qb:()=>aP,qc:()=>bO,r:()=>x,rb:()=>g,rc:()=>aJ,s:()=>l,sb:()=>ap,sc:()=>aE,t:()=>D,tb:()=>ah,tc:()=>ba,u:()=>o,ub:()=>aq,uc:()=>aS,v:()=>B,vb:()=>bD,vc:()=>aK,w:()=>ae,wb:()=>bR,wc:()=>bn,x:()=>i,xb:()=>aX,xc:()=>bl,y:()=>ac,yb:()=>bC,yc:()=>aT,z:()=>$,zb:()=>bb,zc:()=>bG});var d=c("odsp.util_126"),e=c(409);let f=d.lU.isFeatureEnabled,g={ODB:817,ODC:!0,OneDrive:!0},h={ODB:60124,Fallback:!1},i={ODB:60358},j={ODB:62197},k={ODB:1655,ODC:!1,Fallback:!1},l={ODB:61828,Fallback:!1},m={ODB:61978,ODC:!1,Fallback:!1},n={ODB:60839,Fallback:!1},o={ODB:62087,Fallback:!1},p={ODB:62435,Fallback:!1},q={ODB:60389,Fallback:!1},r={ODB:62868,Fallback:!1},s={ODB:62399,Fallback:!1},t={ODB:62450,Fallback:!1},u={ODB:62238,Fallback:!1},v={ODB:62667,Fallback:!1},w={ODB:62117,Fallback:!1},x={ODB:62325,Fallback:!1},y={ODB:62570,Fallback:!1},z={ODB:61749,Fallback:!1},A={ODB:61860,Fallback:!1},B={ODB:62264,Fallback:!1},C={ECS:1071224},D={ECS:1538945},E={ECS:1534310},F={ODB:!0,Fallback:!0},G={ODB:1614,Fallback:!1},H={ODB:1063,Fallback:!1},I={ODB:61719,Fallback:!1},J={ODB:1513,Fallback:!1},K={ODB:62343,Fallback:!1},L={ODB:62448,Fallback:!1},M={ODB:62558,Fallback:!1},N={ODB:62477,Fallback:!1},O={ODB:62071,Fallback:!1},P={ODB:61561,Fallback:!1},Q={ECS:1551255},R={ODB:61881,Fallback:!1},S={ODB:61973,Fallback:!1},T={ODB:61982,Fallback:!1},U={ODB:62242,Fallback:!1},V={ODB:61168,Fallback:!1},W={ODB:61504,Fallback:!1},X={ODB:62828,Fallback:!1},Y={ODB:61403},Z={ODB:1355,ODC:!1,OneDrive:!1,Fallback:!1},$={ODB:61890,ODC:!1,OneDrive:!1,Fallback:!1},_={ODB:62164,ODC:!1,OneDrive:!1,Fallback:!1},aa={ODB:62154,ODC:!1,OneDrive:!1,Fallback:!1},ab={ODB:61709,ODC:!0,OneDrive:!0,Fallback:!0},ac={ODB:62143,ODC:!1,OneDrive:!1,Fallback:!1},ad={ODB:61094,ODC:!1,OneDrive:!1,Fallback:!1},ae={ODB:62312},af={ODB:62290,ODC:!1,OneDrive:!1,Fallback:!1};function ag(a){return(0,e.p)({pageContextForEAPCheck:a})}let ah={ODB:!d.Ov.isActivated("8a90e09f-a635-4113-897e-402973bce841","10/21/2021","Use pdf viewer to preview tiff files"),ODC:!0},ai={ODB:1698};function aj(){return d.Ov.isActivated("654448bc-6e4d-4549-8df3-4aedd7e604cd")}function ak(){return d.Ov.isActivated("efa666e1-be72-4739-8a97-ace125257194")}function al(){return!d.Ov.isActivated("ca174314-6a76-407f-94e4-196cefd1c38f","02/13/2025","Define and pass method to get augloop token from host")}function am(){return!d.Ov.isActivated("f354777e-75e7-4c72-b712-13edc24ce313","04/01/2025","Define and pass method to get augloop token from same domain host")}function an(){return!d.Ov.isActivated("acdb253c-32ab-4596-97a5-c9a5bad0c3e2","02/26/2025","Get listId for oneup share dialog from oneupstore")}function ao(){return!d.Ov.isActivated("75589528-9502-4766-af7e-ea81c45d9c58","02/10/2025","Add more file metadata (createTime, modifyTime, size) for oneup copilot telemetry")}function ap(){return!d.Ov.isActivated("644f5b58-825e-47c6-a523-1ddab71ccbae","02/21/2025","Add copilot host app telemetry")}function aq(){return!d.Ov.isActivated("93E97E3A-4A8D-42FE-A949-3F67593C24DB","03/21/2025","Add siteId and webId from item pageContext")}let ar={ODB:!0,OneDrive:!0},as={ODB:61113},at={ODB:61686},au={ODB:62536};function av(){return!d.Ov.isActivated("8829b122-25f1-497b-889d-18046e90cdb4","05/23/2024","Update oneupitem processing to exclude unsupported files from officebundle generation, to prevent unsupported wac viewer usage")}let aw={ODB:61210},ax={ODB:61338},ay={ODB:61220},az={ODB:61238};function aA(){return f(ai)}function aB(){return!d.Ov.isActivated("6b3d3f79-542e-416d-a2d5-df4c81a10a67","04/19/2024","Update 3d viewer to support gltf csl")}function aC(){return!d.Ov.isActivated("5904d91a-f2d9-492f-809a-0628008a7395","01/18/2024","Refactor UA and Esign for PDF perf improvement")}function aD(){return!d.Ov.isActivated("a57daca8-0ab6-44bc-85da-ad7ef0256836","02/01/2024","Default OneNote file to other viewer no matter if it contains thumbnail url")}function aE(){return!d.Ov.isActivated("ca112383-8d78-4a73-8406-2825ad372646","02/06/2024","useMemo in oneupSlide to avoid unnecessary re-rendering")}function aF(){return!d.Ov.isActivated("5DB864CD-C8C0-412B-BDCF-7B1D19DC6408","02/07/2024","Refactor eSignature for perf improvement")}function aG(){return!d.Ov.isActivated("2786c500-79af-45d2-a8bc-9e24bba711dc","02/14/2024","set accessToken to undefined for file handler")}function aH(){return!d.Ov.isActivated("878753ca-7dc4-4e78-9149-0385365eb96e","02/28/2024","update the file type check for thumbnail")}function aI(){return!d.Ov.isActivated("a647a6fc-3e82-4662-9c1c-7fe30dc1c1ed","03/05/2024","update the file picker to use webDavUrl")}function aJ(){return!d.Ov.isActivated("13e9d428-5e1f-4cbe-a1e4-188f29b2a0ca","04/05/2024","log experiment data for oneup")}function aK(){return!d.Ov.isActivated("ba334243-6ae7-47f8-b998-b7d40e2b1a5f","04/22/2024","display right pane with error message")}function aL(){return!d.Ov.isActivated("59dd68f8-625d-4d16-b841-b507c7cae5ba","04/24/2024","enable show presence for current single client")}function aM(){return d.Ov.isActivated("59599a46-3c86-46b4-b44e-8e9836b0c8cc","05/13/2024","refactor command bar styles")}function aN(){return!d.Ov.isActivated("13e9d428-5e1f-4cbe-a1e4-188f29b2a0ca","05/15/2024","use onedrive/sharepoint for filehandler client name")}function aO(){return!d.Ov.isActivated("dfafd001-d599-49cf-b756-f64d5614b6c7","05/23/2024","use first focusable target")}function aP(){return!d.Ov.isActivated("6884f3e1-f7e7-429c-829d-de15202d7086","05/29/2024","disable FRE for WAC and Video")}function aQ(){return!d.Ov.isActivated("83b9c996-3090-4417-ad53-fc565729550b","06/14/2024","Enable override to other viewer for specific extensions")}function aR(){return!d.Ov.isActivated("2fc93384-9c5a-45c4-a1d7-5938985af39e","07/18/2024","fast one up error handling for no access scenarios")}function aS(){return!d.Ov.isActivated("21df4421-5b42-4f02-b214-c13002058ff0","07/11/2024","suppress web keyboard shortcuts while oneup is open")}function aT(){return!d.Ov.isActivated("9b38ea60-d047-400c-b415-50e7d0a5ab6d","07/03/2024","send oauth token over in crosslist scenario for info pane")}function aU(){return!d.Ov.isActivated("4439e66f-5028-47c6-a785-33ccd584aee6","07/25/2024","Check ODB info pane status and auto launch in oneup on boot if open")}function aV(){return!d.Ov.isActivated("9b38ea60-d047-400c-b415-50e7d0a5ab6d","07/10/2024","load wac viewer when offset is 0")}let aW={ODB:62047};function aX(){return!d.Ov.isActivated("02071577-5f64-4528-af85-232e917aecb5","08/27/2024","aterentiev - enable builder for copilot viewer")}function aY(){return!d.Ov.isActivated("bf73f6e4-c9d8-4ee6-bbbe-8b594bc274c1","10/30/2024","haonwan - enable show default badge for oneup")}function aZ(){return!d.Ov.isActivated("9b559192-7d10-466a-a1be-da381f30568a","09/04/2024","aterentiev - enable OCV feedback for copilot viewer")}function a$(){return!d.Ov.isActivated("438f44e6-9109-48e0-ad63-1422c7a65475","09/04/2024","aterentiev - pass token provider to copilot data source")}function a_(){return!d.Ov.isActivated("cfbff67e-09b8-486e-a4b8-ed7c9434ae22","09/13/2024","allow commandbar set updates when file handler api returns")}function a0(){return!d.Ov.isActivated("2f6e0461-222d-4d79-a39f-831d09809081","10/18/2024","use updated path to check other viewer override extensions")}function a1(){return!d.Ov.isActivated("9284827c-56e3-4243-8ef5-5afecfb65666","10/16/2024","Enable Vroom API fallback for image loading")}function a2(){return!d.Ov.isActivated("b642e08a-06ad-49e9-bf39-0db7e490a0a3","10/21/2024","sanitize all sent telemetry data")}function a3(){return!d.Ov.isActivated("534bb451-0390-4c4a-927c-ec97a617fd7d","10/24/2024","expose resource key for host theme")}function a4(){return!d.Ov.isActivated("0d37f72d-8169-41fe-b594-8452db7e28c0","10/28/2024","Enable Add to Teams for Copilot Agents")&&f({ODB:62053})}function a5(){return!d.Ov.isActivated("ca96046d-3322-4be7-84f5-9ca5281a9a99","11/12/2024","HTML viewer access expiration retry")}function a6(){return!d.Ov.isActivated("c3e8b8a9-6ea6-4e5d-88f9-ff5c5eaffc95","11/07/2024","Add vroom fallback for empty thumbnail url")}function a7(){return!d.Ov.isActivated("d2b2f4a4-0c6b-4e0d-8b7e-7e8b6c3e6c6f","11/14/2024","enable log flight data for fast oneup")}function a8(){return!d.Ov.isActivated("d2b2f4a4-0c6b-4e0d-8b7e-7e8b6c3e6c6f","11/14/2024","enable shorten cxp timeout")}function a9(){return d.Ov.isActivated("6F22857B-5848-4E9E-8624-15642948563C")}function ba(){return!d.Ov.isActivated("de59bdac-1542-4bb7-9c1c-7a880892c286")}function bb(){return d.Ov.isActivated("5fc1ded9-c576-4bf6-b8ab-457eddd55bd2")}function bc(){return d.Ov.isActivated("0aeb81cf-c6e7-4d6b-b198-cd0e194f6dde")}function bd(){return d.Ov.isActivated("264c573a-03eb-4282-be9c-c88d19d1eb09")}function be(){return d.Ov.isActivated("e6b8f0a6-7e0a-4f5c-9e1a-1d0f7c1c7a0d")}function bf(){return d.Ov.isActivated("a708bde5-cb00-40e4-a756-3e986734603b")}function bg(){return d.Ov.isActivated("2e8efc47-e426-4c39-ae38-1a2bec5772f1")}function bh(){return d.Ov.isActivated("d0109f10-ad73-47b5-a998-9acfc42b16ba")}function bi(){return d.Ov.isActivated("5f0e16a3-0d23-4e17-9abd-b43d22831c61")}function bj(){return d.Ov.isActivated("522c147a-a792-48d2-9a26-aa1720532889")}function bk(){return d.Ov.isActivated("eadaa6c7-1c75-4926-be30-0510bc5697e0")}function bl(){return d.Ov.isActivated("8dd563db-9593-4bba-91a0-a91168179353")}function bm(){return!d.Ov.isActivated("51c9bf6c-73e8-40ad-b80b-b38739fa14a5")&&(0,e.i)()}function bn(){return d.Ov.isActivated("bb0e5c2b-b32e-44ba-9aff-26e05ec9017f")}function bo(){return!d.Ov.isActivated("58C70DD8-6098-4631-B087-8AB0DAA4D91A")}function bp(){return!d.Ov.isActivated("1e4b1d7e-3be7-4ec1-ac86-1650f9b16b68")}function bq(){return!d.Ov.isActivated("f1a2b0d4-3c8e-4b5f-9c7d-6a0e1f2a3b8d")}function br(){return!d.Ov.isActivated("f3a2b0d1-4c5e-4b8f-9a7c-6d0e1f3a2b0d","04/30/2025","allow direct image content url instead of requesting the thumbnail")}function bs(){return!d.Ov.isActivated("56479aa3-3d34-4c29-8c6c-9a2f1e48cd62")}function bt(){return!d.Ov.isActivated("f1a2b0d4-3c8e-4b5f-9c7d-6a0e1f2a3b8d")}function bu(){return!d.Ov.isActivated("9bf3f748-8f0e-46d7-84c5-72d8b0ad29dc","05/20/2025","KS of temp auth deprecation for PDF conversion")&&f({ODB:62389})}function bv(){return!d.Ov.isActivated("18eed333-212d-4a6e-b8fe-9065600b6cf2")}function bw(){return!d.Ov.isActivated("80B0E160-C226-405A-9A8A-67FF98C5D942")}function bx(){return!d.Ov.isActivated("f73b0655-d633-4840-bff8-6aa522e57e04")}function by(){return!d.Ov.isActivated("3c204aba-1510-4f6a-a383-4b50604ff43f")}function bz(){return!d.Ov.isActivated("11aaa868-80fc-41cf-b2df-8f66ddcfe134")}function bA(){return!d.Ov.isActivated("7c6d6850-2bcb-4471-a37e-f41e621a5d5a")}function bB(){return!d.Ov.isActivated("5db3ccd8-17b0-42ef-9d97-67700e0fa004")}function bC(){return!d.Ov.isActivated("68e4747f-72d4-4108-8169-d7878ea7d17d")}function bD(){return!d.Ov.isActivated("42c1814c-3aac-4384-ba9b-e1b76136e02e")}function bE(){return!d.Ov.isActivated("0ba2b5b5-4709-4098-8d6e-08b7bb9ceafd")}function bF(){return!d.Ov.isActivated("cfa1de1d-53e6-4fed-bb93-a606ed9d11d5")}function bG(){return d.Ov.isActivated("078a41d0-1795-4dcd-902e-dd9f1568df01")}function bH(){return d.Ov.isActivated("1ee48c4b-5580-47e9-bb51-87b56f89ef01")}function bI(){return!d.Ov.isActivated("e20f9834-89bc-4ae6-834d-57bce7e59e30")}function bJ(){return!d.Ov.isActivated("fe88e8e8-efa5-4350-8b87-2a9f9c9fe4c8")}function bK(){return!d.Ov.isActivated("e75d3951-01b0-4bbc-a0bc-b37ba3e80dd5")}function bL(){return!d.Ov.isActivated("cc994155-1fc4-48ab-8cbe-15ec90c79b94")}function bM(){return!d.Ov.isActivated("834b32f8-0ea3-42d9-8ffe-5d97680d325e")}function bN(){return!d.Ov.isActivated("3f5b23b6-eae5-4d1a-9d97-5f1a5cf86331")}function bO(){return!d.Ov.isActivated("1d5a7e6d-0c95-4b40-bb82-291c80052b7f")}function bP(){return!d.Ov.isActivated("18938864-2860-4527-9e26-e1ecdb96d9f3")}function bQ(){return!d.Ov.isActivated("62dee815-38df-4e4e-b9c6-2ec63f4475b7")}function bR(){return f({ODB:62843})}}
,,,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>i,b:()=>l,c:()=>k,d:()=>m,e:()=>j,f:()=>v,g:()=>w});var d,e,f,g,h,i,j,k,l,m,n=c(79),o=c("odsp.util_126"),p=c(458),q=c(72),r=c("react-lib"),s=c(4),t=c(530);(d=i||(i={}))[d.Off=0]="Off",d[d.On=1]="On",(e=j||(j={}))[e.none=0]="none",e[e.detailPane=1]="detailPane",e[e.versionHistory=2]="versionHistory",e[e.copilotPane=3]="copilotPane",e[e.commentsPane=4]="commentsPane",e[e.copilotDetailPane=5]="copilotDetailPane",(f=k||(k={}))[f.view=0]="view",f[f.edit=1]="edit",(g=l||(l={}))[g.view=0]="view",g[g.edit=1]="edit",(h=m||(m={}))[h.carousel=0]="carousel",h[h.single=1]="single";class u extends p.a{getViewerState(a){let b=this.state.currentState.viewerStates;return b?.get(a)}getOneUpNavMode(){return this.state.currentState.navMode||0}getAnnotationViewerState(){return this.state.currentState.annotationViewerState}getESignData(){return this.state.currentState.eSignData}getFileHandlerOptions(){return this.state.currentState.fileHandlerOptions}updateViewerState(a,b){let c=this.state.currentState.viewerStates||new Map,d=c?.get(b.key);b.options={...d,...b.options,pdfViewerStates:{...d?.pdfViewerStates,...b.options.pdfViewerStates}},c.set(b.key,b.options),this.update("currentState",{publisher:a,viewerStates:new Map(c)})}updateRightPaneError(a,b){(0,s.vc)()&&this.update("currentState",{publisher:a,rightPane:{...b,hasError:!0}})}updateRightPaneState(a,b){0!==b.type&&this.updateESignDataState(a,{isCreateSidePanelActive:!1}),this.update("currentState",{publisher:a,rightPane:{...b,hasError:void 0,error:void 0}})}get rightPaneType(){return this.currentAppState.rightPane.type}updateNavMode(a,b){this.update("currentState",{publisher:a,navMode:+(1===b)})}updateModalState(a,b){this.update("currentState",{publisher:a,modal:b})}updatePdfCopilotAction(a,b,c){this.update("currentState",{publisher:a,pdfCopilotAction:{prompt:b,isSent:c}})}updateFabCopilotAction(a,b){this.update("currentState",{publisher:a,fabCopilotAction:{prompt:b}})}updateParentPermissionValidity(a,b){this.update("currentState",{publisher:a,hasValidPermissionToParent:b})}updateFileHandlerOptions(a,b){this.update("currentState",{publisher:a,fileHandlerOptions:b})}updatePerfButtonState(a,b){this.update("currentState",{publisher:a,perfDataReported:b})}updatePerfButtonIsVisible(a,b){this.update("currentState",{publisher:a,isPerfButtonOpen:b})}updateIsPresenceFacepileVisible(a,b){this.state.currentState.isPrecenseFacepileVisible!==b&&this.update("currentState",{publisher:a,isPrecenseFacepileVisible:b})}updateOneUpShellFreIsOpen(a,b){this.update("currentState",{publisher:a,isOneUpFreOpen:b})}updateImageState(a,b){this.update("currentState",{publisher:a,imageMode:b})}updatePdfState(a,b){this.update("currentState",{publisher:a,pdfAppMode:b})}updateIsPdfPaidFeaturesEnabled(a,b){this.update("currentState",{publisher:a,isPdfPaidFeaturesEnabled:b})}updateToastState(a,b){let c=this.state.currentState.toast;b.timeStamp=Date.now();let d=b.toastKey?b.toastKey:"defaultKeyToDisplayOnlyOneToast";if(c?c.set(d,b):(c=new Map).set(d,b),!1===b.visible&&c.delete(d),c.size>2){let a="",b=1/0;c.forEach((c,d)=>{c.timeStamp&&c.timeStamp<b&&(a=d,b=c.timeStamp)}),c.delete(a)}let e=new Map(c);this.update("currentState",{publisher:a,toast:e})}updateErrorState(a,b){this.update("currentState",{publisher:a,errorState:b})}setIsFocusItemFavorited(a,b){this.update("currentState",{publisher:a,isFocusItemFavorited:b})}setIsFeedbackEnabled(a,b){this.update("currentState",{publisher:a,isFeedbackEnabled:b})}toggleAnnotationViewerVisiblity(a){let b=this.state.currentState.annotationViewerState,c=b.viewerVisiblity,d=+(0===c||void 0===c),e={...b,viewerVisiblity:d,isActive:!b.isActive};this.update("currentState",{publisher:a,annotationViewerState:e}),(0,s.$b)(s.z)&&this.hideUACommentsPane(d,a)}hideUACommentsPane(a,b){0===a&&4===this.state.currentState.rightPane.type&&this.updateRightPaneState(b,{type:0})}setSiteHidePeoplePreviewingFiles(a,b){this.update("currentState",{publisher:a,siteHidePeoplePreviewingFiles:b})}setAnnotationViewerPreloadSucceeded(a,b){let c=this.state.currentState.annotationViewerState;this.update("currentState",{publisher:a,annotationViewerState:{...c,hasPreloadSucceeded:b}})}updateDeletedKeysState(a,b){this.update("currentState",{publisher:a,deletedKeys:b})}updateRenamedKeyInFastOneUpState(a,b){this.update("currentState",{publisher:a,renamedKeyInFastOneUp:b})}updateIsUniversalPrintLicenseValidState(a,b){this.update("currentState",{publisher:a,isUniversalPrintLicenseValid:b})}updateIsNoAccessScenarioState(a,b){this.update("currentState",{publisher:a,isNoAccessScenario:b})}updateESignDataState(a,b){b.isCreateSidePanelActive&&this.updateRightPaneState(a,{type:0}),this.update("currentState",{publisher:a,eSignData:b})}updateIsTeamsFileScenaro(a,b){this.update("currentState",{publisher:a,isTeamsFileScenario:b})}updateIsPublishToWebNavIdSet(a,b){this.update("currentState",{publisher:a,isPublishToWebNavIdSet:b})}get currentAppState(){return this.state.currentState}clean(){this.update("currentState",{publisher:"close",rightPane:{type:0},errorState:void 0,viewerStates:void 0,imageMode:0,annotationViewerState:{viewerVisiblity:u._defaultAnnotationVisibility,hasPreloadSucceeded:!1,isActive:!1},pdfAppMode:n.a.View,toast:void 0,modal:{showModal:!1,content:void 0},eSignData:{isCreateSidePanelActive:!1},perfDataReported:void 0,isFocusItemFavorited:void 0,isFeedbackEnabled:void 0,renamedKeyInFastOneUp:void 0,fabCopilotAction:void 0,pdfCopilotAction:void 0})}navClean(){this.update("currentState",{publisher:"nav",eSignData:{isCreateSidePanelActive:!1}})}updateAutoOpenCopilotExperimentEnabled(a){this.update("currentState",{publisher:"OneUpAutoActionExecutor",isAutoOpenCopilotExperimentEnabled:a})}constructor(){super({currentState:{publisher:"init",rightPane:{type:0},modal:{showModal:!1},navMode:0,eSignData:{isCreateSidePanelActive:!1},annotationViewerState:{viewerVisiblity:u._defaultAnnotationVisibility,isActive:!1},isFocusItemFavorited:void 0,isFeedbackEnabled:void 0,isPerfButtonOpen:(0,s.$b)(s.Wc),isOneUpFreOpen:!1,isPrecenseFacepileVisible:!1,isTeamsFileScenario:!1,isPublishToWebNavIdSet:!1,isAutoOpenCopilotExperimentEnabled:void 0}}),(0,t.a)().attachStores({oneUpStateStore:this})}}u._defaultAnnotationVisibility=0;let v=new o.v7({name:"OneUpStateStore",factory:new o.Jz(u)});function w(a,b){return function(a,b,c){let[d,e]=(0,r.useState)(),[f,g]=(0,r.useState)(()=>{let d=a.state[b],f=c?c(d):d;if(!(0,o.Qu)(f))return f;f.then(a=>g(a)).catch(a=>e(a))});return(0,r.useLayoutEffect)(function(){return a.onUpdate(b,a=>{let b=c?c(a.detail):a.detail;(0,o.Qu)(b)?b.then(a=>g(a)).catch(a=>e(a)):g(b)})},[]),[f,d]}((0,q.c)().consume(v),a,b)}}
,,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>e.a,b:()=>e.d,c:()=>g});var d=c(2),e=c(13),f=c(50);let g=(0,c("odsp.util_126").hl)("ItemUrlHelper",f.a,{pageContext:d.a})}
,,(a,b,c)=>{"use strict";c.d(b,{a:()=>f,b:()=>k});var d,e,f,g=c(101),h=c("odsp.util_126"),i=c(530);(e||(e={})).updateOneUpStatus="updateOneUpStatus",(d=f||(f={})).oneUpItemCacheUpdate="oneUpItemCacheUpdate",d.oneUpSpartanUpdate="oneUpSpartanUpdate",d.initialStoreDataWhenSubscribing="initialStoreDataWhenSubscribing";class j{subscribe(a,b,c){let d=this._eventMC.subscribe(a,b);return b(new CustomEvent("updateOneUpStatus",{detail:{publisher:"initialStoreDataWhenSubscribing",update:this.getOneUpProperties()}})),d}update(a,b){this._focusItem=a.focusItem||this._focusItem,this._focusItemSet=a.focusItemSet||this._focusItemSet,this._parentItem=a.parentItem||this._parentItem,this._currentIndex=void 0!==a.currentIndex?a.currentIndex:this._currentIndex,this._focusItemKey=a.focusItemKey||this._focusItemKey,this._childItemKeys=a.childItemKeys||this._childItemKeys,this._currentItemSetKey=a.currentItemSetKey||this._currentItemSetKey,this._list=a.list||this._list,this._appLevelPageContext=a.appLevelPageContext||this._appLevelPageContext,this._pageContexts=a.pageContexts||this._pageContexts,this._parentStoreKey=a.parentStoreKey||this._parentStoreKey,this._invalidateitemsAfterRename=a.invalidateItemsAfterRename||this._invalidateitemsAfterRename,this._eventMC.publish("updateOneUpStatus",{publisher:b,update:a})}getOneUpProperties(){return this._focusItem?{focusItem:this._focusItem,focusItemSet:this._focusItemSet,parentItem:this._parentItem,currentIndex:this._currentIndex,focusItemKey:this._focusItemKey,childItemKeys:this._childItemKeys,currentItemSetKey:this._currentItemSetKey,list:this._list,appLevelPageContext:this._appLevelPageContext,pageContexts:this._pageContexts,parentStoreKey:this._parentStoreKey,invalidateItemsAfterRename:this._invalidateitemsAfterRename}:void 0}clean(){this._focusItem=void 0,this._focusItemSet=void 0,this._parentItem=void 0,this._currentIndex=void 0,this._focusItemKey=void 0,this._childItemKeys=void 0,this._currentItemSetKey=void 0,this._list=void 0,this._appLevelPageContext=void 0,this._pageContexts=void 0,this._parentStoreKey=void 0}get focusItem(){return this._focusItem}get focusItemSet(){return this._focusItemSet}get parentItem(){return this._parentItem}get currentIndex(){return this._currentIndex}get focusItemKey(){return this._focusItemKey}get childItemKeys(){return this._childItemKeys}get currentItemSetKey(){return this._currentItemSetKey}get list(){return this._list}get pageContexts(){return this._pageContexts}get appLevelPageContext(){return this._appLevelPageContext}get parentStoreKey(){return this._parentStoreKey}constructor(){this._eventMC=new g.a,(0,i.a)().attachStores({oneUpStore:this})}}let k=new h.v7({name:"OneUpStore",factory:{dependencies:{},create:()=>({instance:new j})}})}
,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>d.a});var d=c(457)}
,,(a,b,c)=>{"use strict";c.d(b,{a:()=>n,b:()=>o,c:()=>m});var d=c(157),e=c(267),f=c(268),g=c(878),h=c(158),i=c(109),j=c(269),k=c(879),l=c(880);let m=/^Filter(Field|Value|Type|Op|LookupId|Display)(s?)([1-9]|10)$/,n={idParamKey:d.b,parentIdParamKey:f.a,driveIdParamKey:"driveId",parentDriveIdParamKey:"parentDriveId",driveEndpointParamKey:"endpoint",queryTypeParamKey:j.b,pageParamKey:"p",parentQueryTypeParamKey:j.a,windowNameJsonKey:"ODBParams",queryParamKey:d.g,conversationIdParamKey:"cvid",metadataSearchIdKey:d.f,uniqueParamKey:"u",navParamKey:"nav",localeKey:"locale",dateFilterKey:"dateFilter",typeFiltersKey:d.i,userFiltersKey:"userFilters",viewIdKey:d.j,viewPathKey:d.k,isPowerAppView:"isPowerAppView",listIdKey:d.d,listUrlKey:d.e,webUrlKey:d.l,routingKey:k.b,sortFieldKey:d.h,isAscendingKey:d.c,policyTipKey:"policyTipForListItemId",sharingKey:"sharingDialogForListItemId",openShare:"openShare",managePermissionsKey:"managePermissionsForListItemId",pseudoPolicyTipKey:"showpolicytips",groupByKey:d.a,errorTypeKey:"type",correlationIdKey:"correlation",approvalItemVersion:"approvalItemVersion",commentIdKey:"commentId",emailCTRParamKey:l.a,useFiltersInViewXmlKey:"useFiltersInViewXml",itemId:"itemId",playlistLayout:"playlistLayout",needsAttentionViewKey:"needsAttentionView",requiredColumnsKey:"required",pickerLinkTypeKey:"link_type",pickerAADClientIdKey:"aad_client_id",pickerMSAClientIdKey:"msa_client_id",pickerSelectionModeKey:"selection_mode",pickerViewTypeKey:"view_type",pickerAccessLevelKey:"access",pickerReturnUrlKey:"ru",remoteItem:e.a,stateParamKey:"state",agentBuilderModeKey:"agentBuilderMode",callerId:"CallerId",callerScenarioId:"CallerScenarioId",listItemIdKey:"ID",rootFolderParamKey:"RootFolder",sourceKey:"Source",isDialogKey:"IsDlg",contentTypeId:"ContentTypeId",newTargetListUrlKey:"newTargetListUrl",shareLinkId:"slrid",settingKey:"setting",userExpirationPanelKey:"userExpiration",sharedLibraryCreated:"sharedLibraryCreated",expandPageRowLimitKey:"rowLimit",fileBrowserOptionsKey:"fileBrowser",groupIdKey:"groupId",odSkipAutoFocus:"odSkipAutoFocus",teamIdKey:"teamId",channelIdKey:"channelId",entityIdKey:"entityId",subEntityIdKey:"subEntityId",ringIdKey:"ringId",asidKey:"asid",sidKey:"sid",hostName:"hostName",returnUrl:"returnUrl",disableQueryAlterationKey:"dqa",searchScopeKey:"searchScope",searchQueryKey:"q",action:h.a,openedFrom:"openedfrom",videoDriveId:"videoDriveId",videoItemId:"videoItemId",videoParentId:"videoParentId",referrer:"referrer",referrerScenario:"referrerScenario",referrerPlatform:"referrerPlatform",referrerVersion:"referrerVersion",referrerSessionId:"referrerSessionId",referrerConversationId:"conversationId",viewerKey:"viewer",personIdKey:"personId",emailIdKey:"emailId",meetingIdKey:"meetingId",templateId:"templateId",sourceDoc:"sourcedoc",entryPoint:"entry",noAuthRedirect:"noAuthRedirect",appParamKey:"app",scenarioParamKey:"scenario",loadFormWithNucleus:"loadFormWithNucleus",referringClientKey:"referringClient",localKey:"local",shareTokenKey:i.b,cid:g.d,sortBy:g.r,sortDirection:g.s,mid:g.k,mcid:g.j,contextualFilter:g.e,extensionFilter:g.h,searchConversationId:g.q,dateFilterType:g.f,beginDate:g.b,endDate:g.g,scope:g.p,authKey:g.a,navModeKey:"navMode",siteAnalyticsOverallTrafficRangeParamKey:"overallTrafficRange"},o=n}
,,,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>g,b:()=>f});var d=c("odsp.util_126");let e=window._spPageContextInfo,f=a=>{let b=(a=>{if(e&&e.farmSettings)return e.farmSettings[a]})(a);return!!b&&(1===Number(b)||"true"===b.toLowerCase())},g=a=>a.serviceSetting?f(a.serviceSetting):d.lU.isFeatureEnabled(a)}
,,,,,,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>f});var d=c("tslib_533"),e=c(65),f=function(){function a(){}return a.setAll=function(a){var b=a.workerSrc,c=a.wasmModuleInit,d=a.fontConfigs,e=a.enableLogging,f=a.disableExternalWasmCache,g=a.globalVarNameForWorkerVer,h=a.features,i=a.mipPrefetchConfig;this.workerSrc=b,this.wasmModuleInit=c,this.fontConfigs=d,this.enableLogging=e,this.disableExternalWasmCache=f,this.globalVarNameForWorkerVer=g,this.features=h,this.mipPrefetchConfig=i},Object.defineProperty(a,"workerSrc",{get:function(){return this.value.workerSrc},set:function(a){this.value.workerSrc=a},enumerable:!1,configurable:!0}),Object.defineProperty(a,"wasmModuleInit",{get:function(){return this.value.wasmModuleInit},set:function(a){this.value.wasmModuleInit=a},enumerable:!1,configurable:!0}),Object.defineProperty(a,"fontConfigs",{get:function(){return this.value.fontConfigs},set:function(a){this.value.fontConfigs=a},enumerable:!1,configurable:!0}),Object.defineProperty(a,"enableLogging",{get:function(){return this.value.enableLogging},set:function(a){e.a.enabled=this.value.enableLogging=!!a},enumerable:!1,configurable:!0}),Object.defineProperty(a,"disableExternalWasmCache",{get:function(){return this.value.disableExternalWasmCache},set:function(a){this.value.disableExternalWasmCache=!!a},enumerable:!1,configurable:!0}),Object.defineProperty(a,"globalVarNameForWorkerVer",{get:function(){return this.value.globalVarNameForWorkerVer},set:function(a){this.value.globalVarNameForWorkerVer=a},enumerable:!1,configurable:!0}),Object.defineProperty(a,"mipPrefetchConfig",{get:function(){return this.value.mipPrefetchConfig},set:function(a){this.value.mipPrefetchConfig=a},enumerable:!1,configurable:!0}),Object.defineProperty(a,"features",{get:function(){return this.value.features},set:function(a){this.value.features=a},enumerable:!1,configurable:!0}),a.setMessengerOptions=function(a){return(0,d.yv)(this,void 0,void 0,function(){return(0,d.SO)(this,function(b){switch(b.label){case 0:if(!a)return[2];return[4,c.e(33).then(c.bind(c,474))];case 1:return b.sent().setMessengerOptions(a),this.value.messengerOptions=a,[2]}})})},Object.defineProperty(a,"messengerOptions",{get:function(){return this.value.messengerOptions},enumerable:!1,configurable:!0}),a.value={workerSrc:"index.worker.js",wasmModuleInit:[]},a}()}
,,,,,,,,,(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>T,resourceKey:()=>U});var d=c(544),e=c(2),f=c(9),g=c("odsp.util_126"),h=c(6),i=c(141),j=c(884),k=c(60),l=c(145),m=c(0);function n({tokenName:a,resource:b,tokenType:c,scopes:d}){let e;return d&&(e=[...d].sort().join("-")),`${a}|${b}|${c||""}|${e||""}`.toUpperCase()}let o=new Map,p=new g.v7({name:"27627B91-5ACE-49DE-BCC5-B43A90CFDDD1",factory:new g.Uo(o)});var q=c(434),r=c(285);function s(a){let{pageContext:b}=a,c=function(a){let{pageContext:b}=a,c=b?.systemUserKey;return c&&c.substring(c.lastIndexOf("|")+1).replace("@live.com","")||""}(a),d=!0===b.isAnonymousGuestUser||!0===b.isEmailAuthenticationGuestUser?r.a.anonymous:r.a.aad,e=b.userLoginName,f=b.webPermMasks;return{email:b.userEmail,id:c,loginName:e,type:d,sessionState:"",webPermMasks:f}}let t=new g.v7({name:"getUserIdentity",factory:{dependencies:{pageContext:e.a},create:a=>({instance:()=>s(a)})}});var u=c(165),v=c(547);let w=c(41).a.local,x=new g.v7({name:"DD7BE76F-18BB-4D13-AA87-33CF4D3EF788",factory:new g.Uo(w)}),y=new g.v7({name:"A0543C51-A890-4590-B5D4-A031E38D2D66",factory:{dependencies:{pageContext:e.a,identityDataStoreCachingType:x},create:({pageContext:a,identityDataStoreCachingType:b})=>({instance:new v.a({userId:a.systemUserKey,cachingType:b})})}});var z=c(99),A=c(74),B=c(61);function C(a){let b,{access_token:c,expires_on:d}=a;return d&&isNaN(b=1e3*Number(d))&&(b=new Date(d).getTime()),(!b||isNaN(b))&&(b=1e3*Number((0,B.b)(c).exp)),isNaN(b)?void 0:b-3e5}let D=new g.v7({name:"cachingTokenFetcher",factory:new g.FF(class{async getToken(a){let{resource:b,url:c,tokenType:d,claimsChallenge:e,scopes:f,expiration:g,apiQosName:h,name:i}=a,j=n({tokenName:i,resource:b,tokenType:d,scopes:f}),k=this._promiseCache.get(j),l=this._prefetchPromiseCache?.get(j),o=a=>{let b=C(a),{access_token:c,correlationId:d}=a,e=b;if(b&&"ms-substrate"===i){let a=Date.now();b-a>36e5&&(e=a+36e5)}return this._cache.setValue(j,{value:c,expiration:e,correlationId:d}),{accessToken:c,tokenExpiry:b,correlationId:d}};if(e||g)await Promise.all([...k?[k.catch(a=>{})]:[],...l?[l.catch(a=>{})]:[]]),this._cache.setValue(j,void 0);else{let a=this._cache.getValue(j,Date.now());if(a)return{access_token:a.value,expires_on:`${a.expiration}`,correlationId:a.correlationId};if(k){let a=await k;if(a)return{access_token:a.accessToken,expires_on:`${a.tokenExpiry}`,correlationId:a.correlationId}}if(l){this._prefetchPromiseCache?.delete(j);let a=(async()=>{try{let a,b=await l;if(new m.a(b.qos.start).end({...b.qos.end,resultType:b.qos.success?m.b.Success:m.b.Failure}),b.response){if(!b.response.ok)return;let c=await b.response.json();a=o({...c,correlationId:b.response.headers.get("SPRequestGuid")||""})}return a}catch(a){return}})();this._promiseCache.set(j,a);let b=await a;if(this._promiseCache.delete(j),b)return{access_token:b.accessToken,correlationId:b.correlationId,expires_on:`${b.tokenExpiry}`}}}let p=(async()=>await this._tokenFetcher.getToken({name:i,resource:b,url:c,tokenType:d,claimsChallenge:e,scopes:f,apiQosName:h}))().then(a=>{let b=o(a);return this._promiseCache.delete(j),b},a=>(this._promiseCache.delete(j),Promise.reject(a)));this._promiseCache.set(j,p);let q=await p;return{access_token:q.accessToken,correlationId:q.correlationId,expires_on:`${q.tokenExpiry}`}}constructor(a,b){this._tokenFetcher=b.tokenFetcher,this._cache=b.cache,this._prefetchPromiseCache=b.prefetchPromiseCache,this._promiseCache=new Map}},{tokenFetcher:q.a,cache:y,prefetchPromiseCache:p})});var E=c(230);let F=g.Ov.isActivated("6BC7F79B-F64E-45FD-8C10-8A0B11E1A1AE"),G=g.Ov.isActivated("A3C20F37-C7C2-4AC6-ADB4-8C6958661CE0"),H=!g.Ov.isActivated("646D58EC-51E4-4C3E-9B03-EC9E3174625D"),I=!g.Ov.isActivated("a7484c4e-8121-4906-9a28-6611d11e8e64"),J=!g.Ov.isActivated("DDD0B6F7-6461-4DFD-A821-98C1FB34AA32"),K=g.Ov.isActivated("34908FC4-B8D9-43F0-9ACF-7C6834B7E992"),L=g.Ov.isActivated("908187BF-9713-42A6-87F8-1DF09061838F"),M=g.Ov.isActivated("CE33C02E-50E4-42DC-A90F-21222CB273FF"),N=g.Ov.isActivated("E28AAE17-1BB8-40DA-821F-22E93744EB98"),O=!g.Ov.isActivated("421F2F5A-FEE0-43C7-8348-381AF429EF4D"),P="https://graph.microsoft.com",Q="https://substrate.office.com",R="api://63c9fecc-99c2-4c4c-878f-84685641aa94",S=["https://esign.svc.cloud.dev.microsoft","https://esign.svc.cloud.microsoft","9471276c-aa67-4dd2-bde2-291a033f3c3c","396ef0b6-ae1c-4404-86ce-0a869d4d2987",i.c];class T extends d.a{getIdentity(){return O?this._getUserIdentity():s({pageContext:this._pageContext})}getSignInUrl(){throw Error("Not Implemented")}getGraphToken(a){return f.c.resolve((async()=>{let{resource:b,scopes:c,claimsChallenge:d,apiQosName:e,forceSpHttpClient:g}=a;return b&&!this._isGraphEndpoint(b)?this.getSharePointToken({webAbsoluteUrl:b,forceRefresh:!!d||void 0,claimsChallenge:d?{claims:d.claims,access_token:d.access_token,error:d.error}:void 0,apiQosName:e}):c&&(c.indexOf("InformationProtection.Read.All")>-1||c.indexOf("InformationProtectionPolicy.Read")>-1||c.indexOf("Calendars.Read")>-1)?F?f.c.resolve(this.resources.consumeAsync(l.a.bypass)).then(a=>a.fetchToken({resource:b||P,tokenName:J?"ms-graph":void 0,claims:d?.claims,apiQosName:e})).then(a=>({accessToken:a})):this._getTokenForResource("ms-graph",{resource:b&&new h.a(b).authority||P,claimsChallenge:d,scopes:c,...g?{useSpHttpDataSource:(0,A.k)(A.c)||I&&g}:{},apiQosName:e}):this._getTokenForResource("ms-graph",{resource:b&&new h.a(b).authority||P,claimsChallenge:d,...g?{useSpHttpDataSource:(0,A.k)(A.c)||I&&g}:{},...!G?{scopes:c}:{},apiQosName:e})})())}getStrongAuthToken(a){return this._getTokenForResource("oAuth-SA",{resource:new h.a(this._pageContext.webAbsoluteUrl).authority,apiQosName:a.apiQosName||"MSAStrong",scopes:["onedrive_implicit_forceSA.access"]})}getLokiToken(a){let{apiQosName:b}=a;return this._getTokenForResource("ms-loki",{resource:"https://loki.delve.office.com",apiQosName:b})}getPushChannelToken(a){let{apiQosName:b}=a;return this._getTokenForResource("pushchannel",{resource:"https://pushchannel.1drv.ms",apiQosName:b})}getTeamsCMDToken(a){let{apiQosName:b}=a;return this._getTokenForResource("teams-cmd",{resource:"6bc3b958-689b-49f5-9006-36d165f30e00",apiQosName:b})}getMeetingCatchupToken(a){let{apiQosName:b}=a;return this._getTokenForResource("ms-mcu",{resource:"https://MeetingCatchup.substrate.office.com",apiQosName:b})}getFormsToken(a){let{apiQosName:b}=a;return this._getTokenForResource("ms-forms",{resource:"https://forms.office.com",apiQosName:b})}getOCPSToken(a){let{apiQosName:b}=a;return this._getTokenForResource("ocps",{resource:"https://clients.config.office.net",apiQosName:b})}getSPHomeToken(a){let{apiQosName:b}=a;return this._getTokenForResource("SPHome",{resource:a.resource,apiQosName:b})}getOfficeToken(a){let{apiQosName:b}=a;return this._getTokenForResource("ms-officeapps",{resource:"https://officeapps.live.com",apiQosName:b})}getSubstrateToken(a){let{tokenType:b=i.e.Default,skipCache:c,resourceType:d=i.d.Default,apiQosName:e,claimsChallenge:f,forceRefresh:g}=a;if(b===i.e.STI)return this._getTokenForResource("ms-substrate-sti",{resource:Q,tokenType:"STI",skipCache:c,apiQosName:e});let h=(0,u.h)(this._pageContext?.env2),j=this._pageContext?.substrateEndpointUrl||Q,k="ms-substrate";return d===i.d.Search&&(h?(j=`${this._pageContext?.substrateEndpointUrl||"https://partner.outlook.cn"}/search`,k="ms-substrate-search"):!N&&(0,A.k)(A.f)&&(j=`${Q}/search`,k="ms-substrate-search")),this._getTokenForResource(k,{resource:j,skipCache:c,apiQosName:e,claimsChallenge:f,forceRefresh:g})}getSubstrateTenantFeedbackToken(a){let{apiQosName:b}=a;return this._getTokenForResource("ms-substrate-tenant-feedback",{resource:"https://substrate.office.com/tenantfeedback",apiQosName:b})}getSubstrateTaigerServiceToken(a){let{apiQosName:b}=a;return this._getTokenForResource("ms-substrate-taiger-service",{resource:`${this._pageContext?.substrateEndpointUrl||Q}/TaigerService`,apiQosName:b})}getMediaTAToken(a){let{endPoint:b,apiQosName:c}=a;return this._getTokenForResource("SharePoint-media",{resource:b,apiQosName:c})}getMediaTAGptToken(a){let{endpoint:b,claimsChallenge:c,apiQosName:d}=a;return F?f.c.resolve(this.resources.consumeAsync(l.a)).then(a=>a.fetchToken({resource:b,claims:c?.claims,apiQosName:d})).then(a=>({accessToken:a})):this._getTokenForResource("SharePoint-mediaGPT",{resource:b,claimsChallenge:c,apiQosName:d})}getAugloopToken(a){let{resource:b="https://augloop.office.com/v2",apiQosName:c}=a;return this._getTokenForResource("ms-augloop",{resource:b,apiQosName:c})}getSharePointToken(a){let{webAbsoluteUrl:b,disallowSelfIssuedToken:c,forceRefresh:d,claimsChallenge:e,apiQosName:g}=a,i=new h.a(b).authority,j=/https:\/\/(.*).svc.ms/.test(b);if(this._isGraphEndpoint(b))return this._getTokenForResource("ms-graph",{resource:i,forceRefresh:d,claimsChallenge:e,apiQosName:g});if(this._pageContext.isAnonymousGuestUser||this._pageContext.isEmailAuthenticationGuestUser||j)if(!this._isGraphEndpoint(b)&&!j)return F?f.c.resolve(this.resources.consumeAsync(l.a.bypass)).then(a=>a.fetchToken({tokenName:J?"SharePoint-bypass":void 0,resource:i,claims:e?.claims,apiQosName:g})).then(a=>({accessToken:a})):this._getTokenForResource("SharePoint_MSAL",{resource:i,apiQosName:g,claimsChallenge:e});else{let a=this._isGraphEndpoint(b)?"SharePoint-graph":j?"SharePoint-media":"SharePoint";return this._getTokenForResource(a,{resource:i,forceRefresh:d,claimsChallenge:e,apiQosName:g})}return c?this._getTokenForResource("SharePoint_MSAL",{resource:i,forceRefresh:d,claimsChallenge:e,apiQosName:g,...!L?{}:{tokenType:"SPO"}}):M||(0,E.a)(i,{appPageContext:this._pageContext})?this._getTokenForResource("SharePoint_SelfIssued",{resource:i,forceRefresh:d,tokenType:"SPO",claimsChallenge:e,apiQosName:g}):this._getTokenForResource("oAuth",{resource:i,apiQosName:g,claimsChallenge:e})}getPowerBIToken(a){let{resource:b,apiQosName:c}=a;return this._getTokenForResource("power-bi",{resource:b,apiQosName:c})}getPowerPlatformToken(a){let{resource:b,apiQosName:c}=a;return this._getTokenForResource("power-platform",{resource:b,apiQosName:c})}getPhoneLinkToken(a){let{resource:b,apiQosName:c}=a;return this._getTokenForResource("your-phone",{resource:b,apiQosName:c})}getYammerToken(a){let{resource:b,apiQosName:c}=a;return this._getTokenForResource("yammer",{resource:b,apiQosName:c})}getAzNBToken(a){let{apiQosName:b}=a;return F?f.c.resolve(this.resources.consumeAsync(l.a.bypass)).then(a=>a.fetchToken({resource:R,apiQosName:b})).then(a=>({accessToken:a})):this._getTokenForResource("az-nb",{resource:R,apiQosName:b})}getOfficeHomeToken(a){let{resource:b,apiQosName:c}=a;return F?f.c.resolve(this.resources.consumeAsync(l.a.bypass)).then(a=>a.fetchToken({resource:b,tokenName:"OfficeHome",apiQosName:c})).then(a=>({accessToken:a})):this._getTokenForResource("office-home",{resource:b,apiQosName:c})}getAzRMSToken(a){let{resource:b,apiQosName:c}=a;return this._getTokenForResource("az-rms",{resource:b,apiQosName:c})}getOAuthSessionToken(a){let{endPoint:b,claimsChallenge:c,apiQosName:d}=a;return this._getTokenForResource("oAuth",{resource:b,claimsChallenge:c,...!F?{useSpHttpDataSource:S.indexOf(b)>=0}:{},apiQosName:d})}getFormDigest(a){let b,{url:c}=a;return b=c?c.split("/_api")[0]+"/_api/contextInfo":this._getContextInfoUrl(),this._dataRequestor.getData({url:b,qosName:"IdentityDataSource.getFormDigest",method:"POST"}).then(a=>a.d.GetContextWebInformation.FormDigestValue)}_getTokenForResource(a,b){return f.c.resolve((async()=>{if(!K&&this._cachingTokenFetcher&&!b.useSpHttpDataSource)return this._getTokenForResourceWithDelegatedCaching(a,b);let{resource:c,tokenType:d,claimsChallenge:e,scopes:g,forceRefresh:h,apiQosName:i}=b,j=n({tokenName:a,resource:c,tokenType:d,scopes:g}),k=this._promiseCache.get(j),o=this._prefetchPromiseCache?.get(j),p=a=>{let c=C(a),{access_token:d,correlationId:e}=a;return b.skipCache||this._cache.setValue(j,{value:d,expiration:c,correlationId:e}),{accessToken:d,tokenExpiry:c,correlationId:e}};if(e||h)await Promise.all([...k?[k.catch(a=>{})]:[],...o?[o.catch(a=>{})]:[]]),this._cache.setValue(j,void 0);else{let a=this._cache.getValue(j,Date.now());if(a)return{accessToken:a.value,tokenExpiry:a.expiration,correlationId:a.correlationId};if(k){let a=await k;if(a)return a}if(o){this._prefetchPromiseCache?.delete(j);let a=(async()=>{try{let a,b=await o;if(new m.a(b.qos.start).end({...b.qos.end,resultType:b.qos.success?m.b.Success:m.b.Failure}),b.response){if(!b.response.ok)return;let c=await b.response.json();a=p({...c,correlationId:b.response.headers.get("SPRequestGuid")||""})}return a}catch(a){return}})();this._promiseCache.set(j,a);let b=await a;if(this._promiseCache.delete(j),b)return b}}if(H&&this._offlineDetection.offline)return f.c.resolve({accessToken:"nucleusOfflineToken",tokenExpiry:Date.now()+36e5});let q=async()=>{let b,d=await this.resources.consumeAsync(l.a.bypass),f=await d.fetchTokenData({resource:c,tokenName:J?a:void 0,claims:e?.claims,scopes:g,apiQosName:i}),h=f.expiresOn?.getTime();return h&&(b=(h/1e3).toString()),{access_token:f.accessToken,expires_on:b}},r=(b.useSpHttpDataSource?q():this._tokenFetcher.getToken({name:a,resource:c,url:c,tokenType:d,claimsChallenge:e,scopes:g,apiQosName:i})).then(a=>{let b=p(a);return this._promiseCache.delete(j),b},a=>(this._promiseCache.delete(j),f.c.reject(a)));return this._promiseCache.set(j,r),await r})())}_getContextInfoUrl(){return this._apiUrlHelper.build().segment("contextInfo").toString()}_isGraphEndpoint(a){let b=`${this._pageContext.msGraphEndpointUrl}/`;return`${a}/`.slice(0,b.length)===b}async _getTokenForResourceWithDelegatedCaching(a,b){if(H&&this._offlineDetection.offline)return Promise.resolve({accessToken:"nucleusOfflineToken",tokenExpiry:Date.now()+36e5});let{resource:c,apiQosName:d,claimsChallenge:e,forceRefresh:f,scopes:h,skipCache:i,tokenType:j}=b,k=!i&&this._cachingTokenFetcher||this._tokenFetcher,l=await k.getToken({name:a,resource:c,url:c,apiQosName:d,claimsChallenge:e,expiration:f?{error:new g.lM({code:"ForceRefresh "})}:void 0,scopes:h,tokenType:j});return{accessToken:l.access_token,correlationId:l.correlationId,tokenExpiry:C({access_token:l.access_token,expires_on:l.expires_on})}}constructor(a={},b){super(a,b),this._pageContext=b.pageContext,this._dataRequestor=new j.a({qosName:"IdentityDataSource",normalizeErrors:!0},{pageContext:this._pageContext}),this._cache=b.identityCache,this._promiseCache=new Map,this._prefetchPromiseCache=b.prefetchPromiseCache,this._apiUrlHelper=new k.a({webAbsoluteUrl:this._pageContext.webAbsoluteUrl}),this._tokenFetcher=b.tokenFetcher,this._cachingTokenFetcher=b.cachingTokenFetcher,this._offlineDetection=b.offlineDetection,this._getUserIdentity=b.getUserIdentity}}T.dependencies={...d.a.dependencies,pageContext:e.a,tokenFetcher:q.a,cachingTokenFetcher:K?void 0:D,prefetchPromiseCache:p.optional,identityCache:y,offlineDetection:z.a,getUserIdentity:t};let U=(0,g.hl)("03C5D12A-0C54-49E0-9E95-6368770CE03F",T)}
,,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>g,b:()=>J});var d,e,f,g,h,i,j=c(116),k=c("odsp.util_126"),l=c(57),m=c(61);let n=new k.v7("pdfViewerEmbedOptions");var o=c(100),p=c(4),q=c(293),r=c(20),s=c(2),t=c(97),u=c(32);class v{canSave(a){return this.canSaveAsOriginal(a)}}let w=(0,k.hl)("PdfDataSource",class extends v{canSaveAsOriginal(a){let{item:b}=a;return!!b&&u.a.hasItemPermission(b,u.a.insertListItems)&&u.a.hasItemPermission(b,u.a.editListItems)&&!this._pageContext?.isAnonymousGuestUser&&!this._pageContext?.isEmailAuthenticationGuestUser}constructor(a,b){super(),this._pageContext=b.pageContext}},{pageContext:s.a.optional});var x=c(117),y=c(294),z=c(58),A=c(108),B=c(118),C=c(295);(d=g||(g={})).GetDownloadUrl="GetDownloadUrl",d.GetDownloadToken="GetDownloadToken",(e=h||(h={})).DownloadAspx="DownloadAspx",e.MeTATransform="Transform",e.VroomContent="VroomContent",e.Unknown="Unknown",(f=i||(i={})).MipFetchTokenUserCancelled="MipFetchTokenUserCancelled",f.MipFetchTokenMonitorTimeout="MipFetchTokenMonitorTimeout",f.MipFetchTokenPostFailed="MipFetchTokenPostFailed",f.MipFetchTokenAccessDenied="MipFetchTokenAccessDenied",f.MipFetchTokenPopUpBlocked="MipFetchTokenPopUpBlocked",f.MipFetchTokenRequestPreviouslyFailed="MipFetchTokenRequestPreviouslyFailed",f.MipFetchTokenAnonymousUser="MipFetchTokenAnonymousUser",f.MipFetchTokenResourceNotAllowed="MipFetchTokenResourceNotAllowed",f.MipFetchTokenFailed="MipFetchTokenFailed";let D=["user_canceled","user_cancelled"],E=".pdf",F=(0,p.$b)(p.S)?2097152:0xa00000,G=(0,p.$b)(p.T)?0x1400000:0x3200000,H=["ODBLightSpeedWebPack","TeamsODBFileBrowserWebPack","ODBUWP"];class I{static isWasmSupported(){if(void 0===I._isWasmSupported){let a=!1;try{if("object"==typeof WebAssembly&&"function"==typeof WebAssembly.instantiate){let b=new WebAssembly.Module(Uint8Array.of(0,97,115,109,1,0,0,0));b instanceof WebAssembly.Module&&(a=new WebAssembly.Instance(b)instanceof WebAssembly.Instance)}}catch(a){}I._isWasmSupported=a}return I._isWasmSupported}isNotEmbed(){return this._urlDataSource.getPageType(this._viewParams)!==o.a.Embed}isSameDomainEmbed(a){if(this.isNotEmbed())return;let b=this._getHostOriginFromQSP(),c=window.location.origin;if(b)return b===c&&c===new URL(a).origin}isSupportedFileType(a){let b=this._extension(a);return this._enablePdf&&(b===E||".ai"===b||!!a.pdfConversion)&&(this._enablePreviewTif||".tif"!==b&&".tiff"!==b)}isProgressiveLoadingEnabled(a){return!!((0,p.$b)(p.u)||(0,y.a)(p.t.ECS))&&!!a.size&&!a.pdfConversion&&(!!(0,p.$b)(p.R)||(this._platformDetection.isMobile?a.size>F:a.size>G))}isODSPCopilotEnabled(a){return!!(0,p.$b)(p.i)}isMsPdfViewerSupported(){let a=this._enableMsPdfviewer&&(this.isNotEmbed()||this._enableEmbedMsPdfviewer),b=this._isHostAppTeams()&&(0,y.a)(p.$.ECS),c=!this.isNotEmbed()&&(this._embedOptions?.useMsPdf||!1);return(a||b||c)&&this._isMsPdfViewerSupported()}isMsPdfViewerAvailable(a){return this.isSupportedFileType(a)&&this._isEnabledInOneUp(a)&&this.isMsPdfViewerSupported()}isPdfEditAvailable(a){let b=!!a.size&&a.size<=z.w;return this.isMsPdfViewerAvailable(a)&&(this._enableEditPdf||!this.isNotEmbed())&&this._extension(a)===E&&b}isPdfExtractAvailable(a){let b=!!a.size&&a.size<=z.x;return this._hasBypassOrSyntexAccess()&&this.isMsPdfViewerAvailable(a)&&this.isNotEmbed()&&this._enableExtractPdf&&this._extension(a)===E&&b}isPdfEncryptAvailable(a){return!!a.size&&a.size<=z.x&&this._enableEncryptPdf&&this.isMsPdfViewerAvailable(a)&&this.isNotEmbed()}isWatermarkAvailable(a){return this._hasBypassOrSyntexAccess()&&this._enableWatermark&&this.isMsPdfViewerAvailable(a)&&this.isNotEmbed()}isPdfCompressAvailable(a){let b=!!a.size&&a.size<=z.x;return this._enableCompressPdf&&this.isMsPdfViewerAvailable(a)&&this.isNotEmbed()&&this._extension(a)===E&&b}isPdfExtractable(){return this._hasBypassOrSyntexAccess()&&this._enableExtractPdf}isPdfOutlineAvailable(a){return(0,p.$b)(p.J)&&this.isMsPdfViewerAvailable(a)}isPdfOutlineNextAvailable(a){return(0,p.$b)(p.I)&&this.isPdfOutlineAvailable(a)}isPdfEditable(a){return a.itemStatus!==j.b.ConditionalAccessViewOnly&&a.itemStatus!==j.b.ConditionalAccessBlocked&&this._pdfDataSource?.canSave({item:a})}isPdfPrintable(a){return!!(a&&a.extension&&a.openUrl&&a.itemStatus!==j.b.ConditionalAccessViewOnly&&a.itemStatus!==j.b.ConditionalAccessBlocked&&u.a.hasItemPermission(a,u.a.openItems))}isPdfPrintEnabled(){return!(this.isNotEmbed()||(0,x.t)())&&(this._embedOptions?.enablePdfPrint??!1)}isPdfShowStickyNoteEnabled(){return!(0,x.v)()&&(this.isNotEmbed()?(0,p.$b)(p.W):this._embedOptions?.enablePdfStickyNote??!1)}getWorkerManifestName(){if(!(0,x.z)())return this.isNotEmbed()?void 0:"embedmspdfwebworker";{let a=window._spModuleLink?.manifestName||"";return(0,p.$b)(p.x)&&-1!==H.indexOf(a)?"odbmspdfwebworker":"mspdfwebworker"}}getEmbedOptions(){return this._embedOptions}hasSyntexLicense(){return this._pageContext?.canUserUseSyntex||this._pageContext?.isUserSyntexV2Licensed||!1}isNoTempAuthEnabled(){return this._isMicroserviceEmbed()?!(0,y.b)(p.N.ECS)&&!!this._embedOptions?.hostHasTokenProvider:!(0,x.w)()}isTempAuthDeprecated(a){return this.isNotEmbed()?a?.downloadUrl?!(0,x.p)()&&this._enableDeprecateTempAuthForPrefetch:!(0,x.q)()&&this._enableDeprecateTempAuth:!(0,x.s)()&&!!a.urls&&!!a.urls[A.a.downloadUrlNoAuth]&&(this.isSameDomainEmbed(a.urls[A.a.downloadUrlNoAuth])?this._enableNoTempAuthForEmbedSameDomain:this._enableNoTempAuthForEmbedCrossDomain&&!!this._embedOptions?.hostHasTokenProvider)}getPdfSource(a){if(!a)return"DownloadAspx";let b=a.url;if(!b)return"VroomContent";if((0,B.b)(b)){let{urlPath:a="",inputFormat:c=""}=(0,B.a)(b)||{};return`Transform_${a}_${c}`}return"Unknown"}getTempAuthLogData(a){if(!(0,x.r)()&&a.url){let b=(0,C.a)(a.url);return void 0!==b?{isPdfNoTempAuth:!b,isPdfUseToken:!!a.token}:{isPdfUseToken:!!a.token}}}handleMipTokenError(a){let b=!1,c="MipFetchTokenFailed",d=a?.message?.toLocaleLowerCase();return D.some(a=>d.includes(a))?(c="MipFetchTokenUserCancelled",b=!0):d.includes("monitor_window_timeout")?c="MipFetchTokenMonitorTimeout":d.includes("post_request_failed")?c="MipFetchTokenPostFailed":d.includes("access_denied")?c="MipFetchTokenAccessDenied":d.includes("popup_window_error")?c="MipFetchTokenPopUpBlocked":d.includes("token request previously failed")?c="MipFetchTokenRequestPreviouslyFailed":d.includes("anonymous or email authenticated guest user")?(c="MipFetchTokenAnonymousUser",b=!0):d.includes("resource is not allowed")&&(c="MipFetchTokenResourceNotAllowed"),new k.lM({code:c,message:a?.message,isExpected:b})}_hasBypassOrSyntexAccess(){return!!(0,p.$b)(p.V)||this.hasSyntexLicense()}_isMicroserviceEmbed(){return!this.isNotEmbed()&&window.Flight?.manifest==="embedwebpack"}_isHostAppTeams(){if(this.isNotEmbed())return!1;let a=this._getClientId();return!!a&&-1!==["MicrosoftTeams","Microsoft Teams","Microsoft Teams Web Client","Teams Service","Teams Client App","Teams Additional Client App","Teams App"].indexOf(a)}_isEnabledInOneUp(a){return!a.officeBundle&&!a.wopiFrameUrl&&!(this._enableHTML&&a.htmlConversion)}_isMsPdfViewerSupported(){return I.isWasmSupported()}_extension(a){return a&&a.extension&&a.extension.toLowerCase()||""}_getClientId(){let a=this._pageContext?.authToken||"",b=(0,m.b)(a);return b&&b.app_displayname||this._getClientIdFromQSP()}_getClientIdFromQSP(){let a=window,b=(0,k.pW)((a.location.search||"").slice(1)),c=(0,k.pW)((a.location.hash||"").slice(1)),d=a.PageContext?.scenarioContext.embed||{};return({...b,...c,...d}).client_id}_getHostOriginFromQSP(){let a=window,b=(0,k.pW)((a.location.hash||"").slice(1));if(b.origin)return b.origin;let c=(0,k.pW)((a.location.search||"").slice(1));if(c.embed)try{return JSON.parse(c.embed).o}catch(a){return}}constructor(a,b){this.isWorkerVersionMismatch=a=>{let b=window._spModuleLink?.buildNumber;return"dev"!==b&&!!a&&!!b&&a!==b},this._enablePdf=(0,p.$b)(p.rb),this._enableMsPdfviewer=(0,p.$b)(p.eb),this._enableEmbedMsPdfviewer=(0,p.$b)(p.e),this._enableEditPdf=(0,p.$b)(p.d),this._enableExtractPdf=(0,p.$b)(p.H),this._enableWatermark=(0,p.$b)(p.D),this._enableEncryptPdf=(0,p.$b)(p.G),this._enableCompressPdf=(0,p.$b)(p.F),this._enablePreviewTif=(0,p.$b)(p.tb),this._enableDeprecateTempAuth=(0,p.$b)(p.L),this._enableDeprecateTempAuthForPrefetch=(0,p.$b)(p.K),this._enableNoTempAuthForEmbedSameDomain=(0,p.$b)(p.O),this._enableNoTempAuthForEmbedCrossDomain=(0,p.$b)(p.M),this._enableHTML=(0,p.$b)(p.nb)&&((0,q.a)()||b.platformDetection.isEdge),this._urlDataSource=b.urlDataSource,this._pdfDataSource=b.pdfDataSource,this._navigation=b.navigation,this._viewParams=this._navigation.viewParams,this._platformDetection=b.platformDetection,this._pageContext=b.pageContext,this._embedOptions=b.embedOptions}}I.dependencies={};let J=(0,k.hl)("PdfViewerHelper",I,{platformDetection:l.a,urlDataSource:t.a,navigation:r.a,pdfDataSource:w,pageContext:s.a.optional,embedOptions:n.optional})}
,,,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>e});var d=c("odsp.util_126");let e=new d.v7({name:"platformDetection",factory:new d.Jz(d.Ey)})}
,(a,b,c)=>{"use strict";c.d(b,{A:()=>f,a:()=>E,b:()=>o,c:()=>q,d:()=>p,e:()=>x,f:()=>t,g:()=>i,h:()=>h,i:()=>g,j:()=>k,k:()=>l,l:()=>j,m:()=>m,n:()=>D,o:()=>B,p:()=>A,q:()=>y,r:()=>C,s:()=>z,t:()=>w,u:()=>v,v:()=>n,w:()=>s,x:()=>r,y:()=>e,z:()=>d});var d=.5,e=5,f=90,g=14,h=3,i=7,j=5,k=5,l=5,m=150,n=96,o=100,p=1,q=255,r=3e8,s=1e8,t=255,u="MsPdfViewer.",v=u+"GLOBAL_ZOOM_OPTION_STORE_KEY",w=u+"GLOBAL_OUTLINE_DEFAULT_OFF_STORE_KEY ",x=u+"CACHED_DISPLAY_INFO_ARRAY_STORE_KEY",y={r:0,g:81,b:186,a:1},z=1.12,A=-1,B=0,C="freeTextInitialAttributes",D=5242880,E="AbortError"}
,,,,,,(a,b,c)=>{"use strict";var d,e,f,g;c.d(b,{a:()=>e,b:()=>d}),(f=d||(d={})).Start="start",f.Succeed="succeed",f.Fail="fail",(g=e||(e={})).DocumentPreviewDone="DocumentPreviewDone",g.DocumentLoad="DocumentLoad",g.DocumentSave="DocumentSave",g.DocumentExtract="DocumentExtract",g.DocumentMerge="DocumentMerge",g.DocumentEncrypt="DocumentEncrypt",g.DocumentCompress="DocumentCompress",g.DocumentProgressiveLoad="DocumentProgressiveLoad",g.DocumentProgressiveLoadDownloadFullDocument="DocumentProgressiveLoadDownloadFullDocument",g.DocumentGetWatermark="DocumentGetWatermark",g.DocumentAddWatermark="DocumentAddWatermark",g.DocumentDeleteWatermark="DocumentDeleteWatermark",g.DocumentUpdateWatermark="DocumentUpdateWatermark",g.Copilot="Copilot",g.MipDocumentLoad="MipDocumentLoad"}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>j});var d,e,f,g,h=c("tslib_533");(d=f||(f={})).MSPDF_LOG_VERBOSE="VERBOSE",d.MSPDF_LOG_INFO="INFO",d.MSPDF_LOG_WARNING="WARNING",d.MSPDF_LOG_ERROR="ERROR",(e=g||(g={})).GREEN="green",e.CYAN="cyan";var i=function(){function a(){}return a._format=function(a,b,c){return"[".concat("MSPDFKit-Web","] ").concat(a," | ").concat(b,": ").concat(c)},a._tint=function(a,b){return["%c".concat(a),"color:".concat(b)]},a.prototype.verbose=function(b,c){console.log(a._format(f.MSPDF_LOG_VERBOSE,b,c))},a.prototype.info=function(b,c){console.info.apply(console,(0,h.lt)([],(0,h.pM)(a._tint(a._format(f.MSPDF_LOG_INFO,b,c),g.GREEN)),!1))},a.prototype.warn=function(b,c){console.warn(a._format(f.MSPDF_LOG_WARNING,b,c))},a.prototype.error=function(b,c){console.error(a._format(f.MSPDF_LOG_ERROR,b,c.toString()))},a.prototype.time=function(a){console.time(a)},a.prototype.timeEnd=function(a){console.timeEnd(a)},a}(),j=function(){function a(){}return Object.defineProperty(a,"enabled",{get:function(){return this._enabled},set:function(a){this._enabled=a},enumerable:!1,configurable:!0}),a.initialize=function(b){a._logHandler=b},a.verbose=function(b,c){a.enabled&&a._logHandler.verbose(b,c)},a.info=function(b,c){a.enabled&&a._logHandler.info(b,c)},a.warn=function(b,c){a.enabled&&a._logHandler.warn(b,c)},a.error=function(b,c){a.enabled&&a._logHandler.error(b,c)},a.time=function(b){a.enabled&&a._logHandler.time&&a._logHandler.time(b)},a.timeEnd=function(b){a.enabled&&a._logHandler.timeEnd&&a._logHandler.timeEnd(b)},a._enabled=!1,a._logHandler=new i,a}()}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>o,b:()=>f,c:()=>n,d:()=>g,e:()=>m,f:()=>q});var d,e,f,g,h=c("tslib_533");(d=f||(f={})).EventHandleFailed="EventHandleFailed",d.FileDownloadFailed="FileDownloadFailed",d.RangeDownloadSizeMismatch="RangeDownloadSizeMismatch",d.FontLoadFailed="FontLoadFailed",d.PrintFailed="PrintFailed",d.PrintNoPermission="PrintNoPermission",d.ShowThumbnailFailed="ShowThumbnailFailed",d.Unknown="Unknown",d.WasmModuleInitFailed="WasmModuleInitFailed",d.WasmModuleNotFound="WasmModuleNotFound",d.WasmRuntimeError="WasmRuntimeError",d.WasmCacheFailed="WasmCacheFailed",d.AnnotationAddFailed="AnnotationAddFailed",d.PdfJsPreviewFailed="PdfJsPreviewFailed",d.InvalidPDF="InvalidPDF",d.PDFWorkerMismatch="PDFWorkerMismatch",d.PreviewerFailToLoadTask="PreviewerFailToLoadTask",d.PreviewerFailToLoadPage="PreviewerFailToLoadPage",d.PreviewerFailToFetchFile="PreviewerFailToFetchFile",d.PreviewerUnmounted="PreviewerUnmounted",d.PdfLoadCanceled="PdfLoadCanceled",d.ViewContextNotInitialized="ViewContextNotInitialized",d.PreRenderError="PreRenderError",d.GetPdfStreamFailed="GetPdfStreamFailed",d.UploadFileDataFailed="UploadFileDataFailed",d.RangeDownLoadFailed="RangeDownLoadFailed",d.RangeDownloadFileSizeMismatch="RangeDownloadFileSizeMismatch",d.ProgressiveLoadFailed="ProgressiveLoadFailed",d.ProgressiveLoadFetchRangeFailed="ProgressiveLoadFetchRangeFailed",d.ProgressiveLoadParsingFailed="ProgressiveLoadParsingFailed",d.ProgressiveLoadFetchByStreamFailed="ProgressiveLoadFetchByStreamFailed",d.WatermarkOperationFailed="WatermarkOperationFailed",d.UndoFailed="UndoFailed",d.RedoFailed="RedoFailed",d.GetUndoRedoStatusFailed="GetUndoRedoStatusFailed",d.ClearRedoStackFailed="ClearRedoStackFailed",d.MipProhibitScreenshotFailed="MipProhibitScreenshotFailed",(e=g||(g={})).PDFError="PDFError",e.PdfOpenError="PdfOpenError",e.PdfWorkerMismatchError="PdfWorkerMismatchError",e.NetworkError="NetworkError";var i="MsPdfViewer",j="MSPDF",k=function(a,b,c,d){return{error:{name:a,message:b,stack:c},extraData:{location:i,code:d}}},l=function(a,b,c,d,e){return void 0===e&&(e=!1),{isExpected:e,code:a,error:{name:b,message:c,stack:d},extraData:{location:i}}},m=function(a){function b(c,d,e){var f=this;return void 0!==e&&(d=JSON.stringify({message:d,isExpected:e})),(f=a.call(this,d)||this).toCaughtError=function(){return k("".concat(j,"_").concat(f.name),f.message,f.stack)},Object.setPrototypeOf(f,b.prototype),f.name=c,f.isExpected=e,f}return(0,h.e2)(b,a),b.prototype.toQosError=function(){return l(this.name,this.name,this.message,this.stack,this.isExpected)},b.getParsedErrorData=function(a){var b=function(){try{return JSON.parse(a.message)}catch(a){return{}}}();return{isExpected:b.isExpected||!1,error:b.message||a.message||"Unknown error",code:a.name}},b}(Error),n=function(a){function b(c,d,e){void 0===e&&(e=!1);var f=a.call(this,d)||this;return f.toString=function(){return"[".concat(f.name,"] code: ").concat(f.code,", message: ").concat(f.message,", stack: ").concat(f.stack)},f.toCaughtError=function(){var a=f.code||f.name;return k("".concat(j,"_").concat(a),f.message,f.stack,f.code)},Object.setPrototypeOf(f,b.prototype),f.name=g.PDFError,f.code=c,f.isExpected=e,f}return(0,h.e2)(b,a),b.prototype.toQosError=function(){return l(this.code||this.name,this.name,this.message,this.stack,this.isExpected)},Object.defineProperty(b.prototype,"errorCode",{get:function(){return this.code||f.Unknown},enumerable:!1,configurable:!0}),b}(Error),o=function(a){function b(c,d,e,f,j,k){var l=a.call(this,"".concat(c||d,".").concat(e||"GetFile"),f,k)||this;return l.toQosError=function(){return(0,h.q5)((0,h.q5)({},a.prototype.toQosError.call(l)),{extraData:{location:i,status:l.status,responseHeaders:l.responseHeaders}})},Object.setPrototypeOf(l,b.prototype),l.name=g.NetworkError,l.status=c,l.statusText=d,l.where=e,l.responseHeaders=j,l}return(0,h.e2)(b,a),b}(n);function p(a){var b=n.call(this,f.InvalidPDF,a,!0)||this;return Object.setPrototypeOf(b,p.prototype),b.name=g.PdfOpenError,b}(0,h.e2)(p,n);var q=function(a){function b(c){var d=a.call(this,f.PDFWorkerMismatch,c,!1)||this;return Object.setPrototypeOf(d,b.prototype),d.name=g.PdfWorkerMismatchError,d}return(0,h.e2)(b,a),b}(n)}
,,,,,,,(a,b,c)=>{"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t;c.d(b,{a:()=>i,b:()=>j,c:()=>f,d:()=>h,e:()=>d,f:()=>g,g:()=>l,h:()=>k,i:()=>e}),(m=d||(d={})).HighlightLink="HighlightLink",m.ClearHighlightLink="ClearHighlightLink",m.InkStrokesAdded="InkStrokesAdded",m.InkAdded="InkAdded",m.InkUpdated="InkUpdated",m.DocumentDirty="DocumentDirty",m.DocumentSaved="DocumentSaved",m.InvalidateRect="InvalidateRect",m.InvalidateRectForAnnot="InvalidateRectForAnnot",m.ShowFreeText="ShowFreeText",m.ShowTextField="ShowTextField",m.ScaleChanged="ScaleChanged",m.ResponsiveResize="ResponsiveResize",m.RotationChanged="RotationChanged",m.AnnotationChanged="AnnotationChanged",m.Scrolling="Scrolling",m.ZoomStart="ZoomStart",m.ZoomEnd="ZoomEnd",m.Pinching="Pinching",m.InitialDisplayInfoApplied="InitialDisplayInfoApplied",m.DocumentReloaded="DocumentReloaded",m.VisiblePagesLoaded="VisiblePagesLoaded",m.ShowEditableInk="ShowEditableInk",m.ShowErasableInk="ShowErasableInk",m.TriggerInkDrying="TriggerInkDrying",m.WatermarkVisible="WatermarkVisible",m.WatermarkSaved="WatermarkSaved",m.TouchDrawingStateChange="TouchDrawingStateChange",m.CanUndoRedoChanged="CanUndoRedoChanged",m.UndoStroke="UndoStroke",m.RedoStroke="RedoStroke",m.UndoRedoTriggered="UndoRedoTriggered",m.UndoRedoUpdated="UndoRedoUpdated",m.ShowEditableNote="ShowEditableNote",(n=e||(e={})).FitSize="FitPageWithWindowSize",n.FitWidth="FitPageWithWindowWidth",(o=f||(f={})).Default="default",o.Text="text",o.Link="pointer",(p=g||(g={}))[p.Degree0=0]="Degree0",p[p.Degree90=1]="Degree90",p[p.Degree180=2]="Degree180",p[p.Degree270=3]="Degree270",(q=h||(h={}))[q.Success=0]="Success",q[q.InvalidContentType=1]="InvalidContentType",q[q.InvalidContentDisposition=2]="InvalidContentDisposition",q[q.DocumentCancelled=4]="DocumentCancelled",q[q.PdfiumUnknown=5]="PdfiumUnknown",q[q.PdfiumFile=6]="PdfiumFile",q[q.PdfiumFormat=7]="PdfiumFormat",q[q.PdfiumUnsupportedSecurity=8]="PdfiumUnsupportedSecurity",q[q.PdfiumPage=9]="PdfiumPage",q[q.PdfiumXfaLoad=10]="PdfiumXfaLoad",q[q.PdfiumXfaLayout=11]="PdfiumXfaLayout",q[q.IncorrectPassword=12]="IncorrectPassword",q[q.IncorrectResponseStatus=13]="IncorrectResponseStatus",q[q.UnexpectedError=14]="UnexpectedError",q[q.IncorrectMIPAuth=15]="IncorrectMIPAuth",q[q.EmptyMIPAuth=16]="EmptyMIPAuth",(r=i||(i={}))[r.None=0]="None",r[r.Ink=1]="Ink",r[r.Erase=2]="Erase",r[r.Highlight=3]="Highlight",r[r.FreeText=4]="FreeText",r[r.PointErase=5]="PointErase",r[r.Watermark=6]="Watermark",(j||(j={})).Form="Form",(s=k||(k={}))[s.None=0]="None",s[s.Saving=1]="Saving",s[s.Done=2]="Done",s[s.Failed=3]="Failed",(t=l||(l={}))[t.None=0]="None",t[t.Added=1]="Added",t[t.EditsSaved=2]="EditsSaved",t[t.Deleted=3]="Deleted"}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>j,b:()=>n,c:()=>k,d:()=>o,e:()=>m,f:()=>l,g:()=>i,h:()=>q,i:()=>r,j:()=>p,k:()=>e.a,l:()=>h,m:()=>g,n:()=>f});var d=c("odsp.util_126"),e=c(28);d.Ov.isActivated("ADD22FCF-682C-4C09-975D-664352383E72"),d.Ov.isActivated("B91F0E95-6979-43B3-AB45-EF0D38DCBA16");let f=window._spPageContextInfo,g=window._spModuleLink&&"SPListWebPack"===window._spModuleLink.manifestName,h=!f||"21"===f.webTemplate&&700===f.listBaseTemplate;window._spModuleLink&&window._spModuleLink.manifestName,window._spModuleLink&&window._spModuleLink.manifestName,window._spModuleLink&&window._spModuleLink.manifestName,d.Ov.isActivated("00aa15f3-56ad-456e-84e4-13a81c33c9b8");let i={ODB:60798,ODC:"DownloadDebugLogs"},j={Fallback:!d.Ov.isActivated("B35E04AA-346B-44E3-B7A4-88FC1D79C889","01/06/2023","Enable Popup flow for MSAL authentication")};d.Ov.isActivated("D5785406-7DE5-44D8-AC99-33F3E6A967F2"),d.Ov.isActivated("DE2FA0D9-D704-4B85-916B-9DB19121E9A1","3/21/2023","Fix COB OneUp cannot open thumbnail correctly."),(0,e.a)({ODB:61957});let k={ODB:!d.Ov.isActivated("4EE5E12D-167E-4A66-BE5E-71E34C8291AA")&&62152},l={ODB:!d.Ov.isActivated("4E60AAE1-23CA-4515-B68B-106C3B47DC34")&&62153},m={ODB:!d.Ov.isActivated("4CDEDDDC-D32E-48ED-8965-E3F03E7002E7")&&62187},n={ODB:!!d.Ov.isActivated("89BF4904-6D98-4D31-9E4C-B8894827B62B")||!d.Ov.isActivated("4C4C0B55-FF26-4263-8379-A7B39CC514EF")&&62659},o={ODB:h?60875:1408},p={ODB:62432},q={ODB:62774},r={ODB:1934};d.Ov.isActivated("6C1EAAAD-B308-4B7C-80EE-05531A74980A"),d.Ov.isActivated("935897F1-9D61-4770-896A-D5A1C0341C4E"),d.Ov.isActivated("78140CE2-6676-4C6F-9697-D067DA79B9E6"),d.Ov.isActivated("3A2520E4-7D30-4C56-85D9-3D59406A0954")}
,,(a,b,c)=>{"use strict";c.d(b,{a:()=>u});var d=c("odsp.util_126"),e=c(97),f=c(285),g=c(98),h=c(9),i=c(137),j=c(42),k=c(231);let l=new d.v7("forceAadTokenInSessionManagementProvider"),m=!d.Ov.isActivated("5190349E-1CFC-4163-AA2E-1494CEAFD7DF");class n{getToken(a){let{path:b,apiVersion:c,apiQosName:e,disallowSelfIssuedToken:g,useStrongAuthToken:i}=a,k=this._identityDataSource.getIdentity().type,l=new j.a(b).authority;if(k!==f.a.aad&&!this._forceAadTokenInSessionManagementProvider)return m&&l?this._identityDataSource.getSessionToken({resource:l,apiQosName:e}):this._identityDataSource.getSessionToken({apiQosName:e});if(i&&this._identityDataSource.getStrongAuthToken)return this._identityDataSource.getStrongAuthToken({apiQosName:e});if(b&&this._alwaysUseTokenFetcherForVroom){let a=new j.a(b).authority;return this._identityDataSource.getSharePointToken?.({webAbsoluteUrl:a,apiQosName:e,disallowSelfIssuedToken:g})}return this._microServiceDataSource?this._microServiceDataSource.getAuthData().then(a=>{if(a)return c&&"v2.1"===c?{accessToken:a.authTokenV21,proofToken:a.proofTokenV21,tokenUrl:a.tokenUrlV21}:{accessToken:a.authToken,proofToken:a.proofToken,tokenUrl:a.tokenUrl}},a=>h.c.resolve()):h.c.reject(new d.lM({code:"unauthUser",isExpected:!0,message:"Cannot request a token for an unauthenticated user."}))}getFormDigest(a){let{url:b}=a;return this._identityDataSource.getFormDigest?.({url:b})}constructor(a,b){this._identityDataSource=b.identityDataSource,this._microServiceDataSource=b.microServiceDataSource,this._alwaysUseTokenFetcherForVroom=b.alwaysUseTokenFetcherForVroom,this._forceAadTokenInSessionManagementProvider=b.forceAadTokenInSessionManagementProvider}}n.dependencies={identityDataSource:i.a,microServiceDataSource:g.a.optional,alwaysUseTokenFetcherForVroom:k.a,forceAadTokenInSessionManagementProvider:l.optional};let o=(0,d.hl)("SessionManagementProvider",n);var p=c(232),q=c(459),r=c(462),s="VroomDataRequestor";let t=new d.v7({name:`${s}.isOfflineStatePromise`,factory:{dependencies:{isOfflineStateObservable:q.a},create:a=>({instance:()=>h.c.resolve(a.isOfflineStateObservable.get())})}}),u=(0,d.hl)(s,p.a,{sessionManagementProvider:o.optional,urlDataSource:e.a.optional,cookieOrigin:r.a,isOffline:t})}
,,,(a,b,c)=>{"use strict";var d,e,f,g,h,i;c.d(b,{a:()=>d,b:()=>e,c:()=>f}),(g=d||(d={}))[g.View=0]="View",g[g.Edit=1]="Edit",g[g.Extract=2]="Extract",g[g.Esign=3]="Esign",(h=e||(e={})).Focus="focus",h.Visible="visible",h.Hidden="hidden",(i=f||(f={})).ExitEditMode="ExitEditMode",i.MetadataUpdated="MetadataUpdated"}
,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>q,b:()=>p,c:()=>s,d:()=>n,e:()=>i,f:()=>l,g:()=>o,h:()=>k,i:()=>h,j:()=>e,k:()=>j,l:()=>r,m:()=>m,n:()=>g,o:()=>f});var d=c("odsp.util_126");c(2);let e=new d.v7("ResourceKeys"),f=new d.v7("ResourceKeys"),g=new d.v7("ResourceKeys"),h=new d.v7("ResourceKeys"),i=new d.v7("ResourceKeys"),j=new d.v7("ResourceKeys"),k=new d.v7("ResourceKeys"),l=new d.v7("ResourceKeys"),m=new d.v7("ResourceKeys"),n=new d.v7("getTextContentFallbackAsync"),o=new d.v7("initTelemetryHandler"),p=new d.v7("fastOneUpClientName"),q=new d.v7("accountType"),r=new d.v7("isPdfPremiumFeaturesEnabled"),s=new d.v7("getOneUpFabCommands")}
,,(a,b,c)=>{"use strict";c.d(b,{a:()=>d,b:()=>e});var d=function(){function a(a,b){this.x=a,this.y=b}return a.prototype.distanceTo=function(a){return Math.sqrt(Math.pow(this.x-a.x,2)+Math.pow(this.y-a.y,2))},a.prototype.midPointTo=function(b){return new a((this.x+b.x)/2,(this.y+b.y)/2)},a.prototype.symmetricMap=function(){return new a(-this.x,-this.y)},a.prototype.plus=function(b){return new a(this.x+b.x,this.y+b.y)},a.prototype.scale=function(a){return this.x*=a,this.y*=a,this},a.prototype.round=function(){return this.x,this.y,this},a}(),e=function(){function a(a,b,c,e){this.origin=new d(a,b),this.size={width:c,height:e}}return a.create=function(b){return new a(b.origin.x,b.origin.y,b.size.width,b.size.height)},a.prototype.scale=function(a){return this.origin.scale(a),this.width*=a,this.height*=a,this},a.prototype.intersect=function(b){if(b){var c=Math.max(this.x,b.x),d=Math.min(this.x+this.width,b.x+b.width),e=Math.max(this.y,b.y),f=Math.min(this.y+this.height,b.y+b.height);if(c<d&&e<f)return new a(c,e,d-c,f-e)}},a.prototype.area=function(){return this.width*this.height},a.prototype.ceil=function(){var a=this.right,b=this.bottom;return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.width=Math.ceil(a)-this.x,this.height=Math.ceil(b)-this.y,this},a.prototype.equals=function(a){return this.x===a.x&&this.y===a.y&&this.width===a.width&&this.height===a.height},a.prototype.toString=function(){return"(".concat(this.x,", ").concat(this.y,"), ").concat(this.width," * ").concat(this.height)},Object.defineProperty(a.prototype,"x",{get:function(){return this.origin.x},set:function(a){this.origin.x=a},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"y",{get:function(){return this.origin.y},set:function(a){this.origin.y=a},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"width",{get:function(){return this.size.width},set:function(a){this.size.width=a},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"height",{get:function(){return this.size.height},set:function(a){this.size.height=a},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"right",{get:function(){return this.x+this.width},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!1,configurable:!0}),a}()}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>j,b:()=>k});var d=c("tslib_533"),e=c(64),f=c(308),g=function(){function a(a,b,c){var d=new f.d(a);b(d),this._id=d.payload.id,this._name=a.name,this._active=!0,this._startExtraData=a.extraData||{},this._logQosEnd=c}return a.prototype.stop=function(a){this._active&&this._logEnd(e.b.Succeed,a||{})},a.prototype.fail=function(a){this._active&&this._logEnd(e.b.Fail,(0,d.q5)({isExpected:!1},a))},a.prototype._logEnd=function(a,b){b.extraData=(0,d.q5)((0,d.q5)({},this._startExtraData),b.extraData);var c=new f.c(this._id,this._name,a,b);this._logQosEnd(c),this._active=!1},a}(),h="PDF:Telemetry".concat("undefined"==typeof window?" | Worker":""),i=function(){function a(){}return a.prototype.logQosStart=function(a){var b=a.payload;console.log("[".concat(h,"] [").concat(a.type,"]: ").concat(b.id," | ").concat(b.name,": ").concat(b.status,",\n        ").concat(b.startTime,", extraData: ").concat(JSON.stringify(b.extraData)))},a.prototype.logQosEnd=function(a){var b=a.payload,c="[".concat(h,"] [").concat(a.type,"]: ").concat(b.id," | ").concat(b.name,": ").concat(b.status,", ").concat(b.endTime,", ");switch(b.status){case e.b.Succeed:c+="extraData: ".concat(JSON.stringify(b.extraData));break;case e.b.Fail:var d=b.error;c+="isExpected: ".concat(b.isExpected,", code: ").concat(b.code," error: { name: ").concat(d.name,", message: ").concat(d.message," }, extraData: ").concat(JSON.stringify(b.extraData))}console.log(c)},a.prototype.logEngagement=function(a){this._log(a)},a.prototype.logError=function(a){this._log(a)},a.prototype.logVerbose=function(a){this._log(a)},a.prototype._log=function(a){console.log("[".concat(h,"] [").concat(a.type,"]: ").concat(JSON.stringify(a.payload)))},a}(),j=function(){function a(){}return a.initialize=function(b){a._handler=b},a.createScenario=function(b){var c=a.handler;return new g(b,c.logQosStart,c.logQosEnd)},a.logEngagement=function(b){var c=new f.b(b);a.handler.logEngagement(c)},a.logError=function(b){var c=new f.a(b);a.handler.logError(c)},a.logVerbose=function(b){var c,d,e=new f.e(b);null==(d=(c=a.handler).logVerbose)||d.call(c,e)},Object.defineProperty(a,"handler",{get:function(){return a._handler},enumerable:!1,configurable:!0}),a._handler=new i,a}(),k=j.initialize}
,,,,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>f,b:()=>g});var d=c("tslib_533"),e={UseBlobForStringLength:"510d7ace-c669-4a2c-b87c-17de82da37b3",CheckWorkerVersion:"4d99680d-88bd-4dff-99a1-7e3eebd51734",UseSizeObserver:"66c17183-e7b2-4755-a82e-a9a2c20f5d16",UseExternalCidFont:"dc778e1c-946e-42b2-a4f8-5fd70cde9539",EnableCJKInFormTextField:"f3fc69e6-5bdc-4f0f-a5c0-c070ead620ec",StoreFreeTextAttributeInLocalStorage:"24019b2e-df14-4d7f-9fb4-04dbe0ce8933",EnableICUConverter:"ce1c33bb-89ca-4343-9fb4-f2d1d1f101a2",EnableProgressiveDocumentHandler:"d3788b76-abcd-472d-8927-581f42e7a04c",AddOutlineCheck:"8b994226-443a-4593-bf91-ff9fe85c3195",EnableDynamicChunkRequestSize:"bcbadf30-a483-4a3f-9a69-b28997496071",SendMipTelemetryFromWorker:"a27f106d-c10b-4387-afaf-2078ab9775f6",CacheFontFile:"db703eee-5499-45e0-9a72-b1b4ebafb127",CacheMipWasm:"bd4a128d-2b4f-4fa0-8372-903fb1f03381",EnableFetchDataByRangeStream:"72c0dc1c-9a51-4194-806a-8bac708b0359",FRTWithPrerender:"f10f1d8e-ba31-45c1-abae-3d2808cb1714",EnableAddRedundance:"a3c345a1-515d-43bf-a076-66751a93622d",EnableDataCopyOptimization:"cfc335df-1dbf-4161-a064-f1af065f6c68",EnableMaxWithForContentWhenFitWidth:"637faf69-30c1-4474-9261-49e23412936d",EnableCalculateTabIndexForPages:"93f74e84-8c55-4d9e-bc7b-7ba5a20125f7",EnableBoundingRegionHighlighter:"6a3bf015-e844-4b5a-8cbb-9c66bb99a91a",FixMipInOtherClouds:"a49d15e1-9220-44fb-b03e-d47192b8658b",FixPreRenderFailAtNativeRender:"3d2c5a96-abcf-45e2-bdfa-431b1508e395",EnableSearchShortcut:"a453caa6-e880-4064-96bb-ae3c44746bf9",EnableContextMenuForSelection:"1ee4d89b-b13c-4e63-b9f1-ca6f239e670a",EnableShortDebounceForSelectedText:"99f34832-3967-4830-ba07-ecd40f3dab46",StoreZoomOptionInLocalStorage:"89052fb8-0b3a-4b59-b3e0-6080f93648e2",UseGetPreloadedPkgForDataFiles:"5c21b59d-928a-4380-bae1-40e5b837840a",ControllOutlineDefaultOn:"9bdd2522-14b5-4596-af41-46f373a91cb0",DisableLinearizationKS:"71854f59-e080-4bd2-b0df-32627399482d",ProhibitScreenshotForMip:"12f17caf-bf43-4c05-ab6e-c5799004c938",ScheduleAsMicroWhenAfterPreRender:"ce16786a-cabb-4a3c-8ef7-5bada95d4bd0",ProgressiveLoadingForSmallFilesKS:"b3a7c00c-8c01-45d6-86f3-3ffa7db1a061"},f=function(){function a(){}return a.initialize=function(b){var c,f;a.activatedKillSwitches=[];try{for(var g=(0,d.BW)(Object.keys(e)),h=g.next();!h.done;h=g.next()){var i=e[h.value];b(i)&&a.activatedKillSwitches.push(i)}}catch(a){c={error:a}}finally{try{h&&!h.done&&(f=g.return)&&f.call(g)}finally{if(c)throw c.error}}},a.isActivated=function(b){var c=e[b];return a.activatedKillSwitches.includes(c)},Object.defineProperty(a,"activatedKillSwitches",{get:function(){return a._activatedKillSwitches},set:function(b){a._activatedKillSwitches=b},enumerable:!1,configurable:!0}),a._activatedKillSwitches=[],a}(),g=f.initialize}
,,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>d});let d=new(c("odsp.util_126")).v7("urlLite")}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>d});let d=new(c("odsp.util_126")).v7("MicroServiceDataSource.key.microServiceDataSource")}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>g});var d=c("odsp.util_126"),e=c(284),f=c(28);let g=new d.v7({name:"offlineDetection",factory:new d.Jz((0,f.a)({ODB:60362})?class{onChange(a){return this._detector.onChange(a)}get offline(){return this._detector.offline}constructor(){this._detector=(0,e.a)(!0)}}:class{onChange(){return()=>{}}get offline(){return!1}})})}
,(a,b,c)=>{"use strict";var d,e;c.d(b,{a:()=>f}),(e=d||(d={}))[e.Loading=0]="Loading",e[e.Files=1]="Files",e[e.FilePicker=2]="FilePicker",e[e.FolderPicker=3]="FolderPicker",e[e.Photos=4]="Photos",e[e.TextFileEditor=5]="TextFileEditor",e[e.AccountChooser=6]="AccountChooser",e[e.StorageInfo=7]="StorageInfo",e[e.StorageOptions=8]="StorageOptions",e[e.AppData=9]="AppData",e[e.Error=10]="Error",e[e.SyncOnboarding=11]="SyncOnboarding",e[e.Share=12]="Share",e[e.OneUp=14]="OneUp",e[e.PhotoPreferences=15]="PhotoPreferences",e[e.Embed=16]="Embed",e[e.SyncPlaceholders=17]="SyncPlaceholders",e[e.Restore=18]="Restore",e[e.ValidatePermission=20]="ValidatePermission",e[e.RansomwareDetection=21]="RansomwareDetection",e[e.Settings=22]="Settings",e[e.Unlock=23]="Unlock",e[e.MobileAppUpsell=24]="MobileAppUpsell",e[e.FileRequest=26]="FileRequest",e[e.CreateList=27]="CreateList",e[e.ManageVault=28]="ManageVault",e[e.RequestAccess=29]="RequestAccess",e[e.TraceMe=30]="TraceMe",e[e.FileBrowser=31]="FileBrowser",e[e.TagPreferences=32]="TagPreferences",e[e.PhotoStream=33]="PhotoStream",e[e.Convergence=34]="Convergence",e[e.DocumentOptions=35]="DocumentOptions",e[e.DeviceBackups=37]="DeviceBackups",e[e.Search=38]="Search",e[e.NotificationOptions=39]="NotificationOptions",e[e.ContentAssembly=40]="ContentAssembly",e[e.MetaOSAuthPopup=41]="MetaOSAuthPopup",e[e.CloudImport=42]="CloudImport",e[e.DigitalLegacy=43]="DigitalLegacy",e[e.SharingSettings=301]="SharingSettings",e[e.SyncSettings=302]="SyncSettings",e[e.StorageSettings=303]="StorageSettings",e[e.AccessPolicySettings=304]="AccessPolicySettings",e[e.ComplianceSettings=305]="ComplianceSettings",e[e.NotificationSettings=306]="NotificationSettings",e[e.GeoLocations=307]="GeoLocations";let f=d}
,,,,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>q,b:()=>r,c:()=>p,d:()=>f,e:()=>g,f:()=>l,g:()=>t,h:()=>i,i:()=>s,j:()=>o,k:()=>n,l:()=>j,m:()=>k,n:()=>m,o:()=>u});var d,e,f,g,h=c(4);let i="OneUpLightSpeed.fastOneUp.boot",j="OneUpLightSpeed.fastOneUp.getSingleItem",k="OneUpLightSpeed.getSingleItem.preloadRLDSData",l="OneUpLightSpeed.getSingleItem.callRLDS_gListDataInvalid",m="OneUpLightSpeed.getSingleItem.race.callRLDS",n="OneUpLightSpeed.fastOneUp.getSingleItemFavoriteStatus",o="OneUpLightSpeed.getSingleItem.ensureParentItem",p=(0,h.kb)()?5e3:3e5,q=(0,h.kb)()?5e3:12e4,r=(0,h.kb)()?5e3:12e4;function s(a,b){let c=Error(a);return c.name=b||a,c}function t(a){if(!a)return"NA";if(a<0)return"Unknown";let b=Math.log(a)/Math.LN2|0;return`${1<<b%10}-${1<<b%10+1}${b<10?" B":` ${"KMGTPEZY"[b/10-1|0]}iB`}`}function u(a){if(a)try{let b=JSON.stringify(a),c=RegExp(/\"http[s]*:\/\/(.*?)\"/,"g");return b.replace(c,'"<sanitized>"')}catch(a){return"failed to sanitize raw error for logging"}return""}(d=f||(f={})).rldsApiError="rldsApiError",d.viewerInitLoadingError="viewerInitLoadingError",d.genericViewerLoadingError="genericViewerLoadingError",d.actionError="actionError",d.reactRenderError="reactRenderError",d.processOneUpItemError="processOneUpItemError",d.rldsApiErrorNoAccess="rldsApiErrorNoAccess",(e=g||(g={})).inlineOneUpFirstPage="inlineOneUpFirstPage",e.inlineOneUpSlide="inlineOneUpSlide",e.fastOneUp="fastOneUp"}
,,,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>v});var d=c("odsp.util_126"),e=c(42),f=c(15),g=c(46),h=c(76),i=c(2),j=c(156),k=c(159),l=c(233),m=c(288),n=c(244),o=c(289),p=c(549);let q={ODB:620},r=!d.Ov.isActivated("763D3497-0EC0-46CC-AD63-596FE4F157E0","02/24/2025","Fetch common domain download url"),s={Prefer:"redeemSharingLink"};class t{async getItemCurrentVersion(a,b){let c=this.getItemUrl(a,b),d=`${c}/versions?$select=id`,{value:e}=await this._sendVroomRequest(c,d,a,b||{},"versions",{});return e.length>0?e[0].id:""}async getDownloadUrl(a,b={}){let c=this._urlCache;if(!b.forceRefresh){let{url:b,time:e}=c.get(a.key)||{};if(!d.Ov.isActivated("BCD7B9B4-8CA3-4350-87D0-90643D190FE6","11/01/2023","Enable download url cache")&&b&&e>Date.now()-27e5)return b}if(b.excludeTempAuth&&a.downloadUrlNoAuth)return a.downloadUrlNoAuth;if(a.downloadUrl&&""!==a.downloadUrl&&a.itemGeneratedTimeStamp&&Date.now()-a.itemGeneratedTimeStamp<27e5)return a.downloadUrl;let e=b.excludeTempAuth?{Prefer:"pactoken=N"}:void 0,f=this.getItemUrl(a,b),g=r&&this._pageContext.isCommonDomainRequestContext?`${f}?select=id,@content.downloadUrl,content.unifiedDomainDownloadUrlNoAuth`:`${f}?select=id,@content.downloadUrl`;return this._sendVroomRequest(f,g,a,b,"itemDownloadUrl",e).then(b=>{let d=(r&&this._pageContext.isCommonDomainRequestContext&&b["@content.unifiedDomainDownloadUrlNoAuth"]||b["@content.downloadUrl"]).replace(/[?&]ApiVersion=[^&]+/,"");return c.set(a.key,{url:d,time:Date.now()}),d})}async getThumbnailUrl(a,b={}){let c=this.getItemUrl(a,b),{width:d,height:e}=b.size||{},f=d&&e?`c${Math.ceil(d)}x${Math.ceil(e)}`:"large",g=`${c}/thumbnails/0/${f}/content?prefer=noredirect,closestavailablesize`;try{return await this._sendVroomRequest(c,g,a,b,"thumbnailUrl",b.headers||{},"blob",a=>{let{response:b}=a;return{blobUrl:URL.createObjectURL(b)}})}catch(a){return"code"in a&&(a.code=`${a.code}: VroomFetchError`),{error:a}}}async getDownloadToken(a){let{url:b,item:c,apiName:d}=a;if(b&&this._pageContext.webAbsoluteUrl){let a=new e.a(b).authority;return a!==new e.a(this._pageContext.webAbsoluteUrl).authority?this._identityDataSource.getSharePointToken({webAbsoluteUrl:a,apiQosName:d??"GraphDataSource"}).then(a=>{let{accessToken:b,isBadger:c}=a;return`${c?"badger":"bearer"} ${b}`}):void 0}let f=this._itemUrlHelper.getItemUrlParts(c.key);if(f.isCrossDomain)return this._identityDataSource.getSharePointToken({webAbsoluteUrl:new e.a(f.fullItemUrl).authority,apiQosName:d??"GraphDataSource"}).then(a=>{let{accessToken:b,isBadger:c}=a;return`${c?"badger":"bearer"} ${b}`})}async getAuthenticationParams(a,b){let{apiVersion:c=this._metaVroomVersion}=b||{},d=await this.getAccessToken(a,{...b,apiVersion:c});return this._getAuthenticationParamsSync(d)}getItemUrl(a,b={}){let{useDirectEndpoint:c=!this._pageContext.isSPO,isPath:d=!1,apiVersion:e="v2.0",allowCookies:f=!1}=b,g=this._getGraphBaseUrl(a,{useDirectEndpoint:c,apiVersion:e,allowCookies:f}),{graph:h}=a;if(h&&h.driveId&&"root"!==h.itemId){let{driveId:a="me",itemId:b="root"}=h;return`${g}/drives/${encodeURIComponent(a)}${"root"===b?"/root":`/items/${encodeURIComponent(b)}`}${d?":":""}`}{let b,c=a.graph,e=c&&c.driveId;if(e&&(b=`${g}/drives/${encodeURIComponent(e)}`),!b)return"";let f=this._itemUrlHelper.getItemUrlParts(a.key),{listRelativeItemUrl:h}=this._itemUrlHelper.getUrlParts({path:f.serverRelativeItemUrl,listUrl:f.serverRelativeListUrl});return`${b}/root${h?`:/${encodeURI(h)}${d?"":":"}`:`${d?":":""}`}`}}async getAccessToken(a,b={}){let{apiVersion:c,forceRefresh:d=!1,apiName:f="GraphDataSource"}=b,g=this._getAccessTokenFromItem(a,{apiVersion:c});if(g){let{accessToken:a,proofToken:b,tokenExpiry:c}=g;if(!d&&!(0,k.a)((0,l.default)({authToken:a},{proofToken:l.optional(b),expiry:l.optional(c?new Date(c):void 0)}),3e5))return g}let h=this._itemUrlHelper.getItemUrlParts(a.key).fullItemUrl;return await this._identityDataSource.getSharePointToken({webAbsoluteUrl:new e.a(h).authority,forceRefresh:d,apiQosName:f})}async getMetaPac(a,b,c={}){let{apiVersion:d=this._metaVroomVersion,forceRefresh:e=!1}=c,f=this._getAccessTokenFromItem(b,{apiVersion:d});if(f){let{metaPac:a}=f;if(!e&&a&&!(0,k.a)({authToken:a},3e5))return f}let g=await a.consumeAsync(o.a),h=await g?.refreshAuthToken();if(h){let{driveAccessCode:a,driveAccessCodeV21:b}=h;if(a&&"v2.0"===d)return{metaPac:a};if(b&&"v2.1"===d)return{metaPac:b}}throw Error("Cannot find valid MeTA access code")}async redeemSharingLink(a,b){let c=this.getItemUrl(a),d=(0,p.a)(b);return this._sendVroomRequest(c,d,a,void 0,"redeemSharingLink",s)}async getItemBySharingLink(a){let b=(0,p.a)(a);return this._vroomDataRequestor.send({apiName:"GetItemBySharingLink",path:`${b}/listItem?$select=sharepointIds`,headers:s})}_getAccessTokenFromItem(a,b={}){let{apiVersion:c}=b;return"v2.1"===c?a.graph?.sessionTokenV21:a.graph?.sessionToken}_getAuthenticationParamsSync(a){if(a){let{accessToken:b,proofToken:c}=a,d={};return b&&(d.access_token=b),c&&(d.prooftoken=c),d}return{}}_getGraphBaseUrl(a,b){let{useDirectEndpoint:c,apiVersion:d}=b,f=this._itemUrlHelper.getItemUrlParts(a.key),g=f.fullListUrl;if(!c)return"https://graph.microsoft.com/v1.0";if(g)return`${new e.a(g).authority}/_api/${d}`;if(!f.isCrossDomain&&!f.isCrossList)return this._urlDataSource.getApiBaseUrl({apiVersion:d});{let b=this._itemUrlHelper.getItemUrlParts(a.key).fullItemUrl;return`${new e.a(b).authority}/_api/${d}`}}_sendVroomRequest(a,b,c,d={},f,g,h,i){let{isCrossDomain:j}=this._itemUrlHelper.getItemUrlParts(c.key);d.apiName&&(f=`${d.apiName}.${f}`);let k=!j;return(k?Promise.resolve(void 0):this._identityDataSource.getSharePointToken({webAbsoluteUrl:new e.a(a).authority,apiQosName:f})).then(a=>this._vroomDataRequestor.send({apiName:f,path:`${b}`,accessToken:k?void 0:a,qosExtraData:d.qosExtraData,allowCookies:k,headers:g,responseType:h,parseResponse:i}))}get _metaVroomVersion(){return d.lU.isFeatureEnabled(q)?"v2.1":"v2.0"}constructor(a,b){this._urlDataSource=b.urlDataSource,this._itemUrlHelper=b.itemUrlHelper,this._pageContext=b.pageContext,this._urlCache=new Map,this._vroomDataRequestor=b.vroomDataRequestor,this._identityDataSource=b.identityDataSource}}t.dependencies={urlDataSource:j.b,itemUrlHelper:f.c,pageContext:i.a,vroomDataRequestor:h.a,identityDataSource:g.resourceKey};let u=n.legacyGraphDataSourceKey,v=m.a?u:(0,d.hl)("oneup-lightspeed/GraphDataSource",t)}
,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>y,b:()=>z,c:()=>g,d:()=>j,e:()=>t,f:()=>f,g:()=>w,h:()=>e,i:()=>i,j:()=>u,k:()=>v,l:()=>h,m:()=>x,n:()=>p,o:()=>r,p:()=>m,q:()=>l,r:()=>o,s:()=>n,t:()=>C,u:()=>q,v:()=>D,w:()=>k,x:()=>s,y:()=>A,z:()=>B});var d=c("odsp.util_126");let e=()=>d.Ov.isActivated("facbf24e-8794-4b51-9003-45d3abd49d9b","09/28/2023","Fix sharee can not save pdf change"),f=()=>d.Ov.isActivated("0e5640e9-b84f-4cd2-abf5-46e9e6177353","12/02/2023","Do not send version request for view only PDF"),g=()=>d.Ov.isActivated("5b9870f7-f2fd-4892-baf4-5cdf182ff84f","29/02/2024","Do not activate esign new design"),h=()=>d.Ov.isActivated("068F8934-7C5F-4B80-A3C6-6CB83E3E7188","02/27/2024","Send PDF full page load perf data"),i=()=>d.Ov.isActivated("3c48928f-2237-4566-bc7d-8eeb1da30f4a","01/09/2025","load Chinese traditional font"),j=()=>d.Ov.isActivated("EE02F3C9-6475-4A21-92FD-34501A13F529","07/11/2024","disable open in app on mobile"),k=()=>d.Ov.isActivated("afc23a17-7c59-482b-977e-03721de0334e","01/16/2025","Disable temp auth deprecation for all scenarios"),l=()=>d.Ov.isActivated("F8DA2D1F-DFA4-4517-9725-12E716766315","08/07/2024","Disable temp auth deprecation for legacy OneUp PDF viewer and new inline OneUp PDF viewer"),m=()=>d.Ov.isActivated("74E95D32-2C34-478C-812F-C3D8516E7845","08/07/2024","Disable temp auth deprecation for new fast OneUp PDF viewer where prefetches the download url"),n=()=>d.Ov.isActivated("67d4a9e9-0fd8-4493-88e7-a9866c728b0a","08/29/2024","Disable temp auth deprecation for the embedded OneUp PDF viewer"),o=()=>d.Ov.isActivated("e66ba878-0389-4296-9158-6f0fce24ae33","09/10/2024","Add RUMOne log for temp auth deprecation"),p=()=>d.Ov.isActivated("87c18969-8b19-468b-b5c2-03558ae814af","02/06/2025","Disable temp auth deprecation for PDF conversion"),q=()=>d.Ov.isActivated("ec9f89cd-e773-4158-ae47-68d5097f6e54","08/13/2024","Refactor the implmentation for versions API"),r=()=>d.Ov.isActivated("f65d78e0-eb8a-4de0-a500-a48ec644f91d","08/14/2024","Pdf copy the file content by chunks to reduce memory usage"),s=()=>d.Ov.isActivated("06cef174-4981-4e0e-9051-f82587e53a2b","10/02/2024","Prevent double render in PDF viewer"),t=()=>d.Ov.isActivated("31cda21c-8300-4326-b8c9-7c43106da470","12/02/2024","Disable print permission for not-allowed pdf"),u=()=>d.Ov.isActivated("0e5ca4e9-7964-4974-8ad5-e100b53f5d3a","01/06/2025","Log EvTrace events"),v=()=>d.Ov.isActivated("103f498e-12ee-4b29-b8eb-6db3dbb5338a","08/07/2025","Enable prefetching MIP token for PDF viewer"),w=()=>d.Ov.isActivated("d09b030f-0278-4aca-b639-2f341e5cf2b5","08/20/2025","Enable expose errorcode from parser to qos event for PDF viewer"),x=()=>d.Ov.isActivated("371d515c-de3d-45d6-b573-c655e6b005b6","08/29/2025","Skip paid check for PDF paid features"),y=()=>d.Ov.isActivated("734590f7-a90b-45da-a2ef-f7c9dc4e3a77","09/04/2025","Close right pane when entering PDF edit mode"),z=()=>d.Ov.isActivated("27bb7877-16ac-4d8d-ae40-e9c05d84f68e","09/26/2025","Close right pane when entering PDF extract mode"),A=()=>d.Ov.isActivated("9cc8f79a-00b4-4871-8d19-ea30eb16b815","09/28/2025","Support Ctrl+P for triggering the print functionality in PDF viewer"),B=()=>d.Ov.isActivated("356b083d-ccfb-468d-afa0-359aaa38deac","10/09/2025","Use new manifest for pdf web worker in embed scenarios"),C=()=>d.Ov.isActivated("9c51f2f7-36a0-4c35-99e0-80ceb73d598e","11/04/2025","Enable print functionality for PDF viewer"),D=()=>d.Ov.isActivated("a0c5d778-67b5-4c2f-b1e8-54ab9d93bb62","12/10/2025","Enable show sticky note for PDF viewer")}
,(a,b,c)=>{"use strict";function d(a){return!!a?.match(/https?:\/\/[^\/]+\/transform\/.*/)}function e(a){let b=a.getResponseHeader("X-CorrelationId")||void 0,c=a.getResponseHeader("X-Onedrive-Thumbnailfailurereason")||a.getResponseHeader("X-ErrorCode")||void 0,d=a.getResponseHeader("X-OneDriveMeTA-Region")||void 0,e=a.getResponseHeader("X-OneDriveMeTA-Build")||void 0,f=a.getResponseHeader("X-Onedrivemeta-Version")||void 0;return{correlationId:b,errorCode:c,errorType:a.getResponseHeader("X-Errortype")||void 0,region:d,build:e,version:f,allResponseHeaders:a.getAllResponseHeaders()||void 0}}function f({headers:a}){let b=a.get("X-Correlationid")||void 0,c=a.get("X-Onedrive-Thumbnailfailurereason")||a.get("X-ErrorCode")||void 0,d=a.get("X-OneDriveMeTA-Region")||void 0,e=a.get("X-OneDriveMeTA-Build")||void 0,f=a.get("X-Onedrivemeta-Version")||void 0;return{correlationId:b,errorCode:c,errorType:a.get("X-Errortype")||void 0,region:d,build:e,version:f}}function g(a){if(a){let b=a.match(/https:\/\/([a-z0-9]+)-medias/),c=a.match(/\/transform\/([a-z]+)?/),d=a.match(/inputFormat=([a-z0-9]+)/);return{urlOrigin:b?.[1],urlPath:c?.[1],inputFormat:d?.[1]}}}c.d(b,{a:()=>g,b:()=>d,c:()=>f,d:()=>e})}
,,,,,,,,,,,,,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>m,b:()=>i,c:()=>g,d:()=>k});var d=c("react-lib"),e=c("fui.util_178");let f=!1,g=()=>{f||((0,e.fU)({icons:{PdfExtract:d.createElement("svg",{width:"16",height:"16",viewBox:"0 0 15 17",xmlns:"http://www.w3.org/2000/svg"},d.createElement("path",{d:"M4 0C2.89543 0 2 0.895431 2 2V12C2 13.1046 2.89543 14 4 14H5.20703C5.11588 13.6777 5.05337 13.3434 5.02242 13H4C3.44772 13 3 12.5523 3 12V2C3 1.44772 3.44772 1 4 1H10C10.5523 1 11 1.44772 11 2V7.02242C11.3434 7.05337 11.6777 7.11588 12 7.20703V2C12 0.89543 11.1046 0 10 0H4ZM3.5 15H5.59972C5.78261 15.3578 6.00354 15.6929 6.25717 16H3.5C1.567 16 0 14.433 0 12.5V4.00001C0 3.25973 0.402199 2.61339 1 2.26758V12.5C1 13.8807 2.11929 15 3.5 15ZM10.5 8C12.9853 8 15 10.0147 15 12.5C15 14.9853 12.9853 17 10.5 17C8.01472 17 6 14.9853 6 12.5C6 10.0147 8.01472 8 10.5 8ZM12.8532 12.854L12.8557 12.8514C12.9026 12.804 12.938 12.7495 12.9621 12.6914C12.9861 12.6333 12.9996 12.5697 13 12.503L13 12.5L13 12.497C12.9996 12.4303 12.9861 12.3667 12.9621 12.3086C12.9377 12.2496 12.9015 12.1944 12.8536 12.1464L10.8536 10.1464C10.6583 9.95118 10.3417 9.95118 10.1464 10.1464C9.95118 10.3417 9.95118 10.6583 10.1464 10.8536L11.2929 12H8.5C8.22386 12 8 12.2239 8 12.5C8 12.7761 8.22386 13 8.5 13H11.2929L10.1464 14.1464C9.95118 14.3417 9.95118 14.6583 10.1464 14.8536C10.3417 15.0488 10.6583 15.0488 10.8536 14.8536L12.8532 12.854Z",fill:"currentColor"})),PdfMerge:d.createElement("svg",{width:"16",height:"16",viewBox:"0 0 15 10",xmlns:"http://www.w3.org/2000/svg"},d.createElement("path",{d:"M0 0.5C0 0.223858 0.223858 0 0.5 0H2.1528C3.15253 0 4.10455 0.427517 4.76873 1.17473L6.97867 3.66091C7.45309 4.19463 8.1331 4.5 8.8472 4.5H13.2929L9.64645 0.853554C9.45118 0.658291 9.45118 0.341709 9.64645 0.146447C9.84171 -0.0488154 10.1583 -0.0488154 10.3536 0.146447L14.8536 4.64645C15.0488 4.84171 15.0488 5.15829 14.8536 5.35355L10.3536 9.85355C10.1583 10.0488 9.84171 10.0488 9.64645 9.85355C9.45118 9.65829 9.45118 9.34171 9.64645 9.14645L13.2929 5.5H8.8472C8.1331 5.5 7.45309 5.80537 6.97867 6.33909L4.76873 8.82527C4.10455 9.57248 3.15253 10 2.1528 10H0.5C0.223858 10 0 9.77614 0 9.5C0 9.22386 0.223858 9 0.5 9H2.1528C2.8669 9 3.54691 8.69463 4.02133 8.16091L6.23127 5.67473C6.46908 5.40718 6.7438 5.18062 7.0444 5C6.7438 4.81938 6.46908 4.59282 6.23127 4.32527L4.02133 1.83909C3.54691 1.30537 2.8669 1 2.1528 1H0.5C0.223858 1 0 0.776142 0 0.5Z",fill:"currentColor"}))}}),f=!0)},h=!1,i=()=>{h||((0,e.fU)({icons:{PdfEncryptLock:d.createElement("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"},d.createElement("path",{d:"M7 11C7.55229 11 8 10.5523 8 10C8 9.44771 7.55229 9 7 9C6.44771 9 6 9.44771 6 10C6 10.5523 6.44771 11 7 11ZM3 4H4V3C4 1.34315 5.34315 0 7 0C8.65685 0 10 1.34315 10 3V4H11C12.6569 4 14 5.34315 14 7V13C14 14.6569 12.6569 16 11 16H3C1.34315 16 0 14.6569 0 13V7C0 5.34315 1.34315 4 3 4ZM7 1C5.89543 1 5 1.89543 5 3V4H9V3C9 1.89543 8.10457 1 7 1ZM13 7C13 5.89543 12.1046 5 11 5H3C1.89543 5 1 5.89543 1 7V13C1 14.1046 1.89543 15 3 15H11C12.1046 15 13 14.1046 13 13V7Z",fill:"currentColor"})),PdfEncryptUnlock:d.createElement("svg",{width:"15",height:"17",viewBox:"0 0 15 17",fill:"none",xmlns:"http://www.w3.org/2000/svg"},d.createElement("path",{d:"M7 12C7.55229 12 8 11.5523 8 11C8 10.4477 7.55229 10 7 10C6.44771 10 6 10.4477 6 11C6 11.5523 6.44771 12 7 12ZM12 1C10.8954 1 10 1.89543 10 3V5H11C12.6569 5 14 6.34315 14 8V14C14 15.6569 12.6569 17 11 17H3C1.34315 17 0 15.6569 0 14V8C0 6.34315 1.34315 5 3 5H9V3C9 1.34315 10.3431 0 12 0C13.6569 0 15 1.34315 15 3V3.5C15 3.77614 14.7761 4 14.5 4C14.2239 4 14 3.77614 14 3.5V3C14 1.89543 13.1046 1 12 1ZM11 6H3C1.89543 6 1 6.89543 1 8V14C1 15.1046 1.89543 16 3 16H11C12.1046 16 13 15.1046 13 14V8C13 6.89543 12.1046 6 11 6Z",fill:"currentColor"}))}}),h=!0)},j=!1,k=()=>{j||((0,e.fU)({icons:{TextBulletListSquare:d.createElement("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},d.createElement("path",{d:"M3.75 5C4.16421 5 4.5 4.66421 4.5 4.25C4.5 3.83579 4.16421 3.5 3.75 3.5C3.33579 3.5 3 3.83579 3 4.25C3 4.66421 3.33579 5 3.75 5ZM4.5 7.25C4.5 7.66421 4.16421 8 3.75 8C3.33579 8 3 7.66421 3 7.25C3 6.83579 3.33579 6.5 3.75 6.5C4.16421 6.5 4.5 6.83579 4.5 7.25ZM3.75 11C4.16421 11 4.5 10.6642 4.5 10.25C4.5 9.83579 4.16421 9.5 3.75 9.5C3.33579 9.5 3 9.83579 3 10.25C3 10.6642 3.33579 11 3.75 11ZM6 4.5C6 4.22386 6.22386 4 6.5 4H10.5C10.7761 4 11 4.22386 11 4.5C11 4.77614 10.7761 5 10.5 5H6.5C6.22386 5 6 4.77614 6 4.5ZM6.5 7C6.22386 7 6 7.22386 6 7.5C6 7.77614 6.22386 8 6.5 8H10.5C10.7761 8 11 7.77614 11 7.5C11 7.22386 10.7761 7 10.5 7H6.5ZM6 10.5C6 10.2239 6.22386 10 6.5 10H10.5C10.7761 10 11 10.2239 11 10.5C11 10.7761 10.7761 11 10.5 11H6.5C6.22386 11 6 10.7761 6 10.5ZM2.75 0H11.25C12.7688 0 14 1.23122 14 2.75V11.25C14 12.7688 12.7688 14 11.25 14H2.75C1.23122 14 0 12.7688 0 11.25V2.75C0 1.23122 1.23122 0 2.75 0ZM1 2.75V11.25C1 12.2165 1.7835 13 2.75 13H11.25C12.2165 13 13 12.2165 13 11.25V2.75C13 1.7835 12.2165 1 11.25 1H2.75C1.7835 1 1 1.7835 1 2.75Z",fill:"currentColor"})),TextBulletListSquareFill:d.createElement("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"},d.createElement("path",{d:"M0 2.75C0 1.23122 1.23122 0 2.75 0H11.25C12.7688 0 14 1.23122 14 2.75V11.25C14 12.7688 12.7688 14 11.25 14H2.75C1.23122 14 0 12.7688 0 11.25V2.75ZM3.75 5C4.16421 5 4.5 4.66421 4.5 4.25C4.5 3.83579 4.16421 3.5 3.75 3.5C3.33579 3.5 3 3.83579 3 4.25C3 4.66421 3.33579 5 3.75 5ZM4.5 7.25C4.5 6.83579 4.16421 6.5 3.75 6.5C3.33579 6.5 3 6.83579 3 7.25C3 7.66421 3.33579 8 3.75 8C4.16421 8 4.5 7.66421 4.5 7.25ZM3.75 11C4.16421 11 4.5 10.6642 4.5 10.25C4.5 9.83579 4.16421 9.5 3.75 9.5C3.33579 9.5 3 9.83579 3 10.25C3 10.6642 3.33579 11 3.75 11ZM6 4.5C6 4.77614 6.22386 5 6.5 5H10.5C10.7761 5 11 4.77614 11 4.5C11 4.22386 10.7761 4 10.5 4H6.5C6.22386 4 6 4.22386 6 4.5ZM6.5 7C6.22386 7 6 7.22386 6 7.5C6 7.77614 6.22386 8 6.5 8H10.5C10.7761 8 11 7.77614 11 7.5C11 7.22386 10.7761 7 10.5 7H6.5ZM6 10.5C6 10.7761 6.22386 11 6.5 11H10.5C10.7761 11 11 10.7761 11 10.5C11 10.2239 10.7761 10 10.5 10H6.5C6.22386 10 6 10.2239 6 10.5Z",fill:"currentColor"}))}}),j=!0)},l=!1,m=()=>{l||((0,e.fU)({icons:{PdfCompress:d.createElement("svg",{width:"13",height:"17",viewBox:"0 0 13 17",fill:"none",xmlns:"http://www.w3.org/2000/svg"},d.createElement("path",{d:"M6.5 0C6.77614 0 7 0.223858 7 0.5V4.29289L8.14645 3.14645C8.34171 2.95118 8.65829 2.95118 8.85355 3.14645C9.04882 3.34171 9.04882 3.65829 8.85355 3.85355L6.85355 5.85355C6.65829 6.04882 6.34171 6.04882 6.14645 5.85355L4.14645 3.85355C3.95118 3.65829 3.95118 3.34171 4.14645 3.14645C4.34171 2.95118 4.65829 2.95118 4.85355 3.14645L6 4.29289V0.5C6 0.223858 6.22386 0 6.5 0ZM0.5 8.5C0.5 8.22386 0.723858 8 1 8H12C12.2761 8 12.5 8.22386 12.5 8.5C12.5 8.77614 12.2761 9 12 9H1C0.723858 9 0.5 8.77614 0.5 8.5ZM7 12.7071V16.5C7 16.7761 6.77614 17 6.5 17C6.22386 17 6 16.7761 6 16.5V12.7071L4.85355 13.8536C4.65829 14.0488 4.34171 14.0488 4.14645 13.8536C3.95118 13.6583 3.95118 13.3417 4.14645 13.1464L6.14645 11.1464C6.34171 10.9512 6.65829 10.9512 6.85355 11.1464L8.85355 13.1464C9.04882 13.3417 9.04882 13.6583 8.85355 13.8536C8.65829 14.0488 8.34171 14.0488 8.14645 13.8536L7 12.7071Z",fill:"currentColor"}))}}),l=!0)}}
,,(a,b,c)=>{"use strict";var d,e;c.d(b,{a:()=>f}),(e=d||(d={}))[e.Files=0]="Files",e[e.Recent=1]="Recent",e[e.DocumentLibraries=2]="DocumentLibraries",e[e.SharedWithMe=3]="SharedWithMe",e[e.DocsInCommon=4]="DocsInCommon",e[e.RecycleBin=5]="RecycleBin",e[e.Photos=6]="Photos",e[e.Search=7]="Search",e[e.AllMyPhotos=8]="AllMyPhotos",e[e.AccountChooserPicker=9]="AccountChooserPicker",e[e.AccountChooserMobileSDK=10]="AccountChooserMobileSDK",e[e.Popular=11]="Popular",e[e.RecentUnpopular=12]="RecentUnpopular",e[e.SecondStageRecycleBin=13]="SecondStageRecycleBin",e[e.Apps=14]="Apps",e[e.Subsites=15]="Subsites",e[e.RecentActivity=18]="RecentActivity",e[e.ExternallyShared=19]="ExternallyShared",e[e.SharedByMe=20]="SharedByMe",e[e.Favorites=21]="Favorites",e[e.DetailsPane=22]="DetailsPane",e[e.Channels=24]="Channels",e[e.PhotoStream=25]="PhotoStream",e[e.PhoneLink=26]="PhoneLink",e[e.DefaultDocLib=27]="DefaultDocLib",e[e.ListSyncIssues=28]="ListSyncIssues",e[e.OneDriveHome=29]="OneDriveHome",e[e.TeamsDownloads=30]="TeamsDownloads",e[e.MyLists=31]="MyLists",e[e.Selection=32]="Selection",e[e.People=33]="People",e[e.Meetings=34]="Meetings",e[e.RecentLists=35]="RecentLists",e[e.MyOrganizationAssets=36]="MyOrganizationAssets",e[e.LargestFiles=37]="LargestFiles",e[e.StockImages=38]="StockImages",e[e.Bing=39]="Bing",e[e.Local=40]="Local",e[e.ChannelSharedList=41]="ChannelSharedList",e[e.SharedByUser=42]="SharedByUser",e[e.FromALink=43]="FromALink",e[e.Lists=44]="Lists";let f=d}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>d});let d=new(c("odsp.util_126")).v7("identity")}
,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>N,b:()=>K,c:()=>I,d:()=>J,e:()=>d.pW,f:()=>L,g:()=>m.b,h:()=>z,i:()=>M,j:()=>A});var d=c("odsp.util_126"),e=c(23),f=c(151),g=c(100),h=c(136),i=c(22),j=c(158),k=c(878),l=c(28),m=c(214),n=c(526);let o=!d.Ov.isActivated("303D5922-4E07-4EDD-80D5-786E09050BF3");var p=c(268),q=c(269),r=c(157);let s=!d.Ov.isActivated("5364DEEA-64D3-4E13-8CA5-11D9FAABABB9");var t=c(418),u=c(49);let v=!d.Ov.isActivated("972B8112-B077-4390-AFD5-B3B2AA03CF84");var w=c(879),x=c(880),y=c(267);function z(a){let b=a[y.a];if(!b)return;let{mp:c,rsf:d,rsi:e}=JSON.parse(`${b||""}`);return{mountPoint:c,remoteSpFolderById:d,remoteSpItem:e}}function A(a){if(!a)return{};let{mountPoint:b,remoteSpFolderById:c,remoteSpItem:d}=a;return{[y.a]:JSON.stringify({mp:b,rsf:c,rsi:d})}}let B={ODB:60210},C={ODB:!d.Ov.isActivated("7B7FA902-74E1-41A3-B7FA-5E99A7C60744","10/25/2021","Enables the CallerId and CallerScenarioId query provided on inbound links to be logged in extra data of Page.View engagement event.")},D=!d.Ov.isActivated("D583FA81-FDE5-486B-9BFC-5AFAF2252239"),E=!d.Ov.isActivated("25ABC593-FB06-42D5-AE05-E3F978701388"),F=(0,l.a)(C),G=!d.Ov.isActivated("FDB12575-D304-4940-9AEE-4AD11A9906F7"),H=!d.Ov.isActivated("09e512fc-b889-4b29-aa3c-eb0d8a5bf90a");function I(a){let{defaultRootItemId:b,viewParams:c,listUrl:e,viewId:g,key:l}=a,p=(0,d.pW)(l),q={...c};for(let a of(delete q[i.b.idParamKey],o&&(delete q[i.b.cid],delete q[i.b.mid],delete q[i.b.mcid],delete q[i.b.sortBy],delete q[i.b.sortDirection],delete q[j.a],delete q[k.i],delete q[k.o],delete q[k.l],delete q[k.c],delete q[k.m],t.a||(delete q[k.n],delete q[i.b.authKey])),D&&(delete q[i.b.contextualFilter],delete q[i.b.extensionFilter],delete q[i.b.searchConversationId],delete q[i.b.dateFilterType],delete q[i.b.beginDate],delete q[i.b.endDate],delete q[i.b.scope]),delete q[i.b.rootFolderParamKey],delete q[i.b.queryTypeParamKey],delete q[i.b.queryParamKey],delete q[i.b.listUrlKey],H&&(0,u.a)()&&(delete q[i.b.webUrlKey],delete q[i.b.routingKey],delete q[i.b.shareTokenKey]),d.Ov.isActivated("0405907e-3935-4959-bd2c-b5a5b89f8acb","09/09/2022","preserve search filters in oneUp and exiting oneUp in odb, return to search when exiting oneUp in odb/spo")||(delete q[i.b.dateFilterKey],delete q[i.b.userFiltersKey]),delete q[i.b.typeFiltersKey],delete q[i.b.remoteItem],delete q[i.b.sortFieldKey],G&&delete q[i.b.isAscendingKey],delete q[i.b.groupByKey],delete q[i.b.viewIdKey],delete q[i.b.personIdKey],delete q[i.b.meetingIdKey],delete q[i.b.emailIdKey],Object.keys(c)))i.c.test(a)&&delete q[a];return delete q[i.b.searchScopeKey],delete q[i.b.disableQueryAlterationKey],delete q[i.b.itemId],delete q[i.b.playlistLayout],(0,f.a)(q,p),delete q[i.b.parentIdParamKey],delete q[i.b.parentQueryTypeParamKey],delete q[i.b.pageParamKey],delete q[i.b.sharedLibraryCreated],p[i.b.idParamKey]===b&&(delete q[i.b.idParamKey],delete q[i.b.rootFolderParamKey]),d.Ov.isActivated("81A798A6-1C14-40C3-BD52-2A60351DCF87","11/8/2021","Only preserve view id when navigating within same list")&&((q[i.b.listUrlKey]!==c[i.b.listUrlKey]||(0,m.b)(p)!==h.a.Files||(g||"").replace("{","").replace("}","")===q[i.b.viewIdKey])&&delete q[i.b.viewIdKey],q[i.b.newTargetListUrlKey]===e&&(delete q[i.b.newTargetListUrlKey],delete q[i.b.viewPathKey])),delete q[i.b.uniqueParamKey],F&&(delete q[i.b.callerId],delete q[i.b.callerScenarioId]),delete q[n.a],v&&(delete q[x.a],delete q[x.e],delete q[x.b],delete q[x.c],delete q[x.d],delete q[w.a],delete q.login_hint,delete q.forcefastoneup),q}function J(a,b){let c=Number(a[i.b.queryTypeParamKey])||h.a.Files,d={[i.b.idParamKey]:a[i.b.idParamKey]||b||"",[i.b.driveIdParamKey]:a[i.b.driveIdParamKey]||"",[i.b.driveEndpointParamKey]:a[i.b.driveEndpointParamKey]||"",[i.b.listUrlKey]:a[i.b.listUrlKey]||"",[i.b.queryTypeParamKey]:`${c||""}`,[i.b.queryParamKey]:a[i.b.queryParamKey]||"",[i.b.typeFiltersKey]:a[i.b.typeFiltersKey]||"",[i.b.userFiltersKey]:a[i.b.userFiltersKey]||"",[i.b.dateFilterKey]:a[i.b.dateFilterKey]||"",[i.b.uniqueParamKey]:a[i.b.uniqueParamKey]||"",[i.b.disableQueryAlterationKey]:(0,l.a)(B)&&a[i.b.disableQueryAlterationKey]||"",[i.b.metadataSearchIdKey]:a[i.b.metadataSearchIdKey]||""};return a[i.b.searchScopeKey]&&(d[i.b.searchScopeKey]=a[i.b.searchScopeKey]||""),o&&a[i.b.cid]&&(d[i.b.cid]=a[i.b.cid]||""),E&&(d[i.b.contextualFilter]=a[i.b.contextualFilter]||"",d[i.b.extensionFilter]=a[i.b.extensionFilter]||"",d[i.b.searchConversationId]=a[i.b.searchConversationId]||"",d[i.b.dateFilterType]=a[i.b.dateFilterType]||"",d[i.b.beginDate]=a[i.b.beginDate]||"",d[i.b.endDate]=a[i.b.endDate]||"",d[i.b.scope]=a[i.b.scope]||""),s&&(d[n.a]=a[n.a]||""),c===h.a.ChannelSharedList&&(d[i.b.channelIdKey]=a[i.b.channelIdKey]||"",d[i.b.groupIdKey]=a[i.b.groupIdKey]||""),(0,e.a)(d,void 0,!0)}function K(a){let b,c,f;if(d.Ov.isActivated("2CFC06AF-7448-498E-ADB8-F185A6DE6D14")){let b,c=a[i.b.parentIdParamKey],d=a[i.b.parentQueryTypeParamKey];return(c||d)&&((b={})[i.b.idParamKey]=a[i.b.idParamKey],b[i.b.listUrlKey]=a[i.b.listUrlKey],d&&(b[i.b.queryTypeParamKey]=a[i.b.queryTypeParamKey])),b?(0,e.a)(b,void 0,!0):""}return c=a[p.a],f=a[q.a],(c||f)&&((b={})[r.b]=a[r.b],b[r.e]=a[r.e],f&&(b[q.b]=a[q.b])),b?(0,e.a)(b,void 0,!0):""}function L(a,b){let c=Number(a[i.b.pageParamKey]);switch(c){case g.a.FilePicker:case g.a.FileBrowser:case g.a.TextFileEditor:case g.a.Error:case g.a.Share:case g.a.Embed:case g.a.Restore:case g.a.Settings:case g.a.MobileAppUpsell:case g.a.FileRequest:return c}return K(a)&&b?g.a.OneUp:g.a.Files}function M(a){return a===h.a.RecycleBin||a===h.a.SecondStageRecycleBin}function N(){return window.location.protocol+"//"+window.location.host}}
,(a,b,c)=>{"use strict";var d,e,f,g;c.d(b,{a:()=>i,b:()=>j,c:()=>h,d:()=>e,e:()=>d});let h="https://portal.office.com/",i="https://aadrm.com",j={Msa:"msa_auth:",Graph:"graph_auth:",MsaStrongAuth:"msa_strong_auth:",PhoneLink:"phone_link:",Substrate:"substrate_auth:"};(f=d||(d={}))[f.STI=1]="STI",f[f.Default=2]="Default",(g=e||(e={}))[g.Default=1]="Default",g[g.Search=2]="Search"}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>e});var d=c("odsp.util_126");let e=new d.v7({name:"isCopilotEnabled",factory:new d.Uo(()=>!1)})}
,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>e});var d=c("odsp.util_126");let e=new d.v7({name:"SpHttpDataSource.async.key",loader:new d.dE(()=>Promise.all([c.e("ondemand.resx"),c.e(76)]).then(c.bind(c,771)).then(a=>a.resourceKey))});new d.v7({name:"SpHttpDataSource.async.key",loader:new d.dE(()=>Promise.all([c.e("ondemand.resx"),c.e(76)]).then(c.bind(c,771)).then(a=>a.typeResourceKey))})}
,,(a,b,c)=>{"use strict";c.d(b,{a:()=>i,b:()=>h,c:()=>j});var d=c(110);let e="text/plain",f={abap:e,ada:e,adp:e,ahk:e,as:e,as3:e,asc:e,ascx:"text/xml",asm:e,asp:e,awk:e,bash:e,bash_login:e,bash_logout:e,bash_profile:e,bashrc:e,bat:"text/x-bat",bib:e,bsh:"text/x-java",build:e,builder:e,c:"text/x-cpp","c++":"text/x-c++src",capfile:e,cc:"text/x-c++src",cfc:e,cfm:e,cfml:e,cl:e,clj:e,cls:e,cmake:e,cmd:"text/x-bat",coffee:"text/coffeescript",cpp:"text/x-cpp",cpt:"text/xml",cpy:e,cs:"text/x-csharp",cshtml:"text/x-cshtml",cson:"text/coffeescript",csproj:"text/xml",css:"text/css",ctp:"text/html",cxx:"text/x-c++src",d:e,db:e,ddl:e,di:e,dif:e,diff:e,disco:"text/xml",dml:e,dtd:"text/xml",dtml:"text/xml",el:e,emakefile:e,erb:e,erl:e,f:e,f90:e,f95:e,fs:"text/x-fsharp",fsi:"text/x-fsharp",fsscript:"text/x-fsharp",fsx:"text/x-fsharp",gemfile:e,gemspec:"text/ruby",gitconfig:"text/x-ini",go:e,groovy:e,gvy:e,h:"text/x-cpp","h++":"text/x-c++hdr",haml:e,handlebars:"text/x-handlebars-template",hbs:"text/x-handlebars-template",hcp:e,hh:"text/x-c++hdr",hpp:"text/x-cpp",hrl:e,hs:e,htc:"text/javascript",htm:"text/html",html:"text/html",hxx:"text/x-c++hdr",idl:"text/x-c++hdr",iim:e,inc:"text/html",inf:e,ini:"text/x-ini",inl:"text/x-c++src",ipp:"text/x-c++src",irbrc:e,jade:"text/x-jade",jav:"text/x-java-source",java:"text/x-java-source",js:"text/javascript",json:"application/json",jsp:e,jsx:"text/javascript",l:e,less:"text/x-less",lhs:e,lisp:e,log:e,lst:e,ltx:e,lua:"text/x-lua",m:e,mak:e,make:e,markdn:"text/x-web-markdown",markdown:"text/x-web-markdown",md:"text/x-web-markdown",mdown:"text/x-web-markdown",mkdn:"text/x-web-markdown",ml:e,mli:e,mll:e,mly:e,mm:e,mud:e,nfo:e,opml:"text/xml",osascript:e,osts:"text/javascript",out:e,p:e,pas:e,patch:e,php:"application/x-php",php2:"application/x-php",php3:"application/x-php",php4:"application/x-php",php5:"application/x-php",phtml:"text/html",pl:e,plist:e,pm:e,pod:e,pp:e,profile:e,properties:e,ps1:"text/x-powershell",ps1xml:"text/x-powershell",psd1:"text/x-powershell",psm1:"text/x-powershell",pt:"text/xml",py:"text/python",pyw:e,r:e,rake:e,rb:"text/ruby",rbx:e,rc:e,re:e,reg:e,rest:e,resw:"text/xml",resx:"text/xml",rhtml:e,rjs:e,rprofile:e,rpy:e,rss:"text/xml",rst:e,rxml:e,s:e,sass:"text/scss",scala:e,scm:e,sconscript:e,sconstruct:e,script:e,scss:"text/scss",sgml:"text/xml",sh:e,shtml:"text/html",sml:"text/xml",sql:e,sty:e,t:e,tcl:e,tex:e,text:e,textile:e,tld:"text/xml",tli:"text/x-c++hdr",tmpl:"text/html",tpl:"text/html",ts:"text/typescript",txt:e,vb:"text/x-vb",vi:e,vim:e,wsdl:"text/xml",xaml:"text/xml",xhtml:"text/html",xml:"text/xml",xoml:"text/xml",xsd:"text/xml",xsl:e,xslt:e,yaml:e,yaws:e,yml:e,zsh:e};function g(a){return((a&&"."===a[0]?a.substring(1):a)||"").toLowerCase()}function h(a,b){return!!a&&i(a,b)}function i(a,b){var c;return c=g(c=a),f.hasOwnProperty(c)&&(b===d.a.File||b===d.a.Media||b===d.a.Unknown)}function j(a){let b=g(a);return f.hasOwnProperty(b)?f[b]:void 0}}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>n,b:()=>o});var d=c("tslib_533"),e=c(66),f=c(85);let g="0.16.26";var h=c(37),i=c(887),j=c(446),k=c(211),l=function(){function a(){}return a.dispose=function(){},a.retreive=function(a,b,c){return(0,d.yv)(this,void 0,void 0,function(){return(0,d.SO)(this,function(d){return[2,(0,j.c)(a,b,c)]})})},a.update=function(a,b){return(0,d.yv)(this,void 0,void 0,function(){return(0,d.SO)(this,function(c){switch(c.label){case 0:return[4,(0,j.d)(a,b)];case 1:return c.sent(),[2]}})})},a}(),m="GetWasmAsset",n=function(){function a(){var a=this;this.wasmModuleInnerInitPromise={},this.initialize=function(b){if(void 0===b&&(b="Main"),!a.wasmModuleInnerInitPromise[b]){var c=h.a.wasmModuleInit.find(function(a){return a.type||"Main"===b});c&&(a.wasmModuleInnerInitPromise[b]=a.convertModuleInit(c))}},this.convertModuleInit=function(b){return(0,d.yv)(a,void 0,void 0,function(){var a,c,g,h,i,j,l,n;return(0,d.SO)(this,function(d){switch(d.label){case 0:if(a=b.wasmUrl,c=b.noCache,g=b.wasmJsUrlOrBlob,h=b.dataUrl,i=b.type,c)return[3,4];d.label=1;case 1:return d.trys.push([1,3,,4]),[4,this.getWasmBinaryFromCache(a,i)];case 2:return j=d.sent(),[3,4];case 3:return l=d.sent(),n=new e.c(e.b.WasmCacheFailed,"Fail to work on wasm cache, reason: ".concat(l)),f.a.logError(n.toCaughtError()),[3,4];case 4:if(j)return[3,6];return[4,(0,k.c)(a,{credentials:"same-origin"},m)];case 5:j=d.sent(),d.label=6;case 6:return 0===j.byteLength&&f.a.logError(new e.c(e.b.WasmModuleInitFailed,"The wasm binary is empty and the module instantiation will fail, wasmUrl=".concat(encodeURIComponent(a))).toCaughtError()),[2,{wasmBinary:j,wasmJsUrlOrBlob:g,dataUrl:h,type:i}]}})})}}return a.getInstance=function(){return a.instance||(a.instance=new a),a.instance},a.prototype.getModuleInnerInit=function(a){return void 0===a&&(a="Main"),this.initialize(a),this.wasmModuleInnerInitPromise[a]},a.prototype.dispose=function(){var a;this.wasmModuleInnerInitPromise={},null==(a=this.wasmDataCache)||a.dispose()},a.prototype.getWasmBinaryFromCache=function(a,b){return(0,d.yv)(this,void 0,void 0,function(){var c,n,o,p,q;return(0,d.SO)(this,function(d){switch(d.label){case 0:if(!(!h.a.disableExternalWasmCache&&((0,i.a)()||(0,i.b)())))return[3,2];return[4,this.setExternalWasmCache()];case 1:return d.sent(),[3,3];case 2:this.wasmDataCache=l,d.label=3;case 3:if(!this.wasmDataCache)throw"The wasmDataCache is not defined";c="".concat(b||"Main"),d.label=4;case 4:return d.trys.push([4,6,,7]),[4,this.wasmDataCache.retreive(j.a,c,g)];case 5:if((n=d.sent())&&0!==n.byteLength)return f.a.logVerbose({message:"PDF WASM Cache hit. key: ".concat(c)}),[2,n];return[3,7];case 6:return o=d.sent(),p=new e.c(e.b.WasmCacheFailed,"Fail to read from wasm cache, key: ".concat(c," error: ").concat(o)),f.a.logError(p.toCaughtError()),[3,7];case 7:return f.a.logVerbose({message:"PDF WASM Cache miss. key: ".concat(c)}),[4,(0,k.c)(a,{credentials:"same-origin"},m)];case 8:return q=d.sent(),this.wasmDataCache.update(j.a,{key:c,value:q,version:g}).catch(function(a){var b=new e.c(e.b.WasmCacheFailed,"Fail to update wasm cache, error: ".concat(a));f.a.logError(b.toCaughtError())}),"Main"===c&&this.deleteOldWasmCache().catch(function(a){var b=new e.c(e.b.WasmCacheFailed,"Fail to delete old wasm cache, error: ".concat(a));f.a.logError(b.toCaughtError())}),[2,q]}})})},a.prototype.setExternalWasmCache=function(){return(0,d.yv)(this,void 0,void 0,function(){var a;return(0,d.SO)(this,function(b){switch(b.label){case 0:return[4,c.e(33).then(c.bind(c,474))];case 1:return a=b.sent(),this.wasmDataCache=a.ExternalWasmCache,[2]}})})},a.prototype.deleteOldWasmCache=function(){return(0,d.yv)(this,void 0,void 0,function(){return(0,d.SO)(this,function(a){return[2,(0,j.b)(j.a,"".concat("Main","-"))]})})},a}(),o=n.getInstance().initialize}
,,,,,,,(a,b,c)=>{"use strict";var d,e,f,g;c.d(b,{a:()=>d}),(f=d||(d={}))[f.File=0]="File",f[f.Folder=1]="Folder",f[f.Media=2]="Media",f[f.OneNote=3]="OneNote",f[f.Unknown=4]="Unknown",f[f.Error=5]="Error",f[f.App=6]="App",f[f.Subsite=7]="Subsite",f[f.Shortcut=8]="Shortcut",f[f.Album=9]="Album",f[f.MultiShare=10]="MultiShare",(g=e||(e={}))[g.None=0]="None",g[g.CommentsDisabled=1]="CommentsDisabled",g[g.CommentsInTable=2]="CommentsInTable",g[g.CommentsMigrating=4]="CommentsMigrating",g[g.LikesMigrating=8]="LikesMigrating"}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>au,b:()=>av});var d=c("odsp.util_126"),e=c(20),f=c(270),g=c(13),h=c(23),i=c(40),j=c(16),k=c(108),l=c(81),m=c(74);let n=new d.v7({name:"isOneDriveHomeEnabled",factory:new d.Uo(()=>!1)}),o=new d.v7({name:"isPeopleEnabled",factory:new d.Uo(()=>!1)});var p=c(39),q=c(266),r=c(2),s=c(28);let t={ODB:62543},u={pageContext:r.a},v=function(a){let{pageContext:b}=a,c=(0,s.a)(t)||!(0,q.a)()&&1===(0,p.c)(90115,b);return v=()=>c,c},w=new d.v7({name:"isExtraCommandsAvailableForSWM",factory:{dependencies:u,create:a=>({instance:()=>v(a)})}}),x=new d.v7({name:"isOpenSharedFolderInPeopleEnabled.key",factory:new d.Uo(()=>!1)}),y=new d.v7({name:"forceLoadAllFoldersInCurrentPage",factory:new d.Uo(!1)});var z=c(433),A=c(136),B=c(22),C=c(100);let D=[".aspx",".ascx",".master",".xsf",".xap",".swf",".jar",".asmx",".htc",".ashx",".json",".soap",".svc",".xamlx"];class E{static isAllowed(a){return!(D.indexOf(a.toLocaleLowerCase())>=0)}}var F=c(147),G=c(151),H=c(140),I=c(527),J=c(57);let K=!d.Ov.isActivated("CDDAA141-CBD4-42B5-B007-A9A9340B8D9F"),L=new d.v7({name:"addDefaultParentViewOnViewerOpenUrls.key",factory:new d.Uo(!1)});var M=c(228),N=c(49);let O=new d.v7("defaultGetOneUpUrl");var P=c(157);let Q=d.Ov.isActivated("B5E93E94-1B94-4DAD-A80C-CEA0480476F6"),R=d.Ov.isActivated("19AD57B9-24E4-498D-87BC-9E654AB9BC6C"),S=d.Ov.isActivated("4649E01E-99EF-4594-B706-26503617CB32"),T=d.Ov.isActivated("a5e1d64c-8940-4ce7-9446-9ba2565085ed"),U=!d.Ov.isActivated("A5F231F5-952B-4C65-83F6-5C95EB21696A"),V=d.Ov.isActivated("abced38e-0985-46bf-aced-9b0a3588e876"),W=d.Ov.isActivated("af3aa13c-ce50-4c89-8096-1c364a522896"),X="wopiframe.aspx",Y="doc.aspx",Z={ODB:!0},$={ODB:!0},_={ODB:1064},aa={platformDetection:J.a,isOneDriveHomeEnabled:n,isPeopleEnabled:o,isInlineOneDriveSharedFolderEnabled:w.optional,isOpenSharedFolderInPeopleEnabled:x.optional,addDefaultParentViewOnViewerOpenUrls:L.optional,forceLoadAllFoldersInCurrentPage:y.optional,defaultGetOneUpUrl:O.optional},ab=new d.v7({name:"GetDefaultClickUrl",factory:{dependencies:aa,create:a=>{let{isPeopleEnabled:b,isInlineOneDriveSharedFolderEnabled:c,isOpenSharedFolderInPeopleEnabled:e,addDefaultParentViewOnViewerOpenUrls:f,forceLoadAllFoldersInCurrentPage:n}=a;return{instance:function(o){var p;let q,{defaultRootItemId:r,pageContext:t,isDocSet:u,listId:v,listItemId:w,itemKey:x,itemType:y,itemList:D,itemOpenUrl:J,itemOpenInOfficeOnlineUrl:L,itemPreviewIFrameUrl:M,itemQueryType:O,itemOfficeBundle:P,itemContentTypeId:Q,itemUrls:R,itemUrlHelper:T,itemSubsite:U,itemExtension:aa,itemFSObjType:ab,itemTranslationLanguages:ae,isUnifiedAppSupportedFile:af,welcomePageCustomized:ag,viewParams:ah,parentItemKey:ai,parentItemLink:aj,supportsOneUp:ak,urlType:al="default",additionalViewParams:am,driveType:an,isRootFolder:ao,isItemInOtherUsersOneDrive:ap,mySiteOwner:aq,mainLinkInfo:ar,parentViewParams:as,routingKey:at}=o,{page:au=(0,H.f)(ah)}=o,av=T.getItemUrlParts(x),aw=av.serverRelativeWebUrl,ax=(0,H.e)(x),ay=(0,H.c)({key:x,viewParams:ah,defaultRootItemId:r}),az=ah[B.b.parentQueryTypeParamKey];am&&(0,G.a)(ay,am);let aA={...ay},aB={};(0,N.a)()&&ar?.ShareTokenString&&(aw&&!ap&&!ah?.[B.b.remoteItem]&&aA[B.b.listUrlKey]&&(aB[B.b.webUrlKey]=aw),at&&(aB[B.b.routingKey]=at),aB[B.b.shareTokenKey]=ar.ShareTokenString);let aC=()=>o.getMediaUrl?.()||a.defaultGetOneUpUrl?.({...o,parentView:az})||ac({itemKey:x,parentItemKey:ai,params:aA,supportsOneUp:ak,itemUrlHelper:T,page:au,addDefaultParentViewOnViewerOpenUrls:f,itemExtension:aa,parentView:az,parentViewParams:as,mainLinkViewParams:aB}),aD=!!m.l&&(0,s.a)(Z),aE=!m.l||(0,s.a)($),aF=an===I.a.business,aG=n||au===C.a.FilePicker||au===C.a.FileBrowser;aG&&(ay[B.b.pageParamKey]=au);let aH=ax[B.b.queryTypeParamKey];if((!aH||Number(aH)===A.a.Files)&&a.isOneDriveHomeEnabled()&&(ay[B.b.queryTypeParamKey]=A.a.Files),au===C.a.FilePicker&&y!==z.a.Folder||O&&(0,H.i)(O)&&!(0,H.i)((0,H.g)(ax)))return"";let aI="focus"===al&&!(P&&av.isCrossDomain),aJ=av.fullItemUrl,aK="current"===al?z.a.Folder:"external"===al?z.a.Unknown:y;if(delete ay[B.b.noAuthRedirect],(0,H.b)(ah)&&"existing"===al||aI)q=aC();else if(af)q=L||"";else if(P&&P.enableDefaultClick)q=aC();else switch(aK){case z.a.Media:q=aC();break;case z.a.Folder:let aL=av.geoRelation!==g.a.sameGeo;if(delete ay[B.b.navParamKey],delete ay[B.b.viewerKey],!aG&&U&&(aL||U.isExternal)&&!aD)return U.serverRelativeUrl;if(!aG&&D&&(aL||D.isExternal)&&!aD)return av.fullItemUrl||"";if(u&&(!aE||ag))return J||"";if(aG||!av.isCrossList&&av.siteRelation===g.d.sameSite||Number(t.webTemplate)===i.b.mySite&&t.isNoScriptEnabled&&av.isCrossDomain&&!aF&&(!aL||aD))ao&&aq&&ap&&b()&&c?.()&&(ay[B.b.emailIdKey]=aq,ay[B.b.queryTypeParamKey]=A.a.People),!V&&ar?.ShareTokenString&&aw&&(0,N.a)()&&ay[B.b.listUrlKey]&&!ap&&(ay[B.b.webUrlKey]=aw,ay[B.b.shareTokenKey]=ar.ShareTokenString),q=`#${(0,h.a)(ay,void 0,!1)}`;else if(ap&&(!S||e?.()))ao&&aq&&b()&&c?.()&&(ay[B.b.emailIdKey]=aq,ay[B.b.queryTypeParamKey]=A.a.People),!W&&ar?.ShareTokenString&&(0,N.a)()&&(at&&(ay[B.b.routingKey]=at),ay[B.b.shareTokenKey]=ar.ShareTokenString),q=`#${(0,h.a)(ay,void 0,!1)}`;else if(ay[B.b.remoteItem])q=`#${(0,h.a)(ay)}`;else{if(J&&new j.b(J).getScheme()){q=J;break}q=l.a(av.fullItemUrl||"")}break;case z.a.Shortcut:q=R&&R[k.b.shortcutTarget]||J||"";break;case z.a.File:if(aa&&(0,F.a)(aa,aK))q=au===C.a.TextFileEditor&&E.isAllowed(aa||"")?function(a){let{itemKey:b,parentItemKey:c,parentItemLink:e,viewParams:f,supportsOneUp:g,defaultRootItemId:i,addDefaultParentViewOnViewerOpenUrls:j}=a,k=(0,H.c)({key:b,viewParams:f,defaultRootItemId:i}),l=(0,d.pW)(c||""),m=l[B.b.idParamKey];if("root"===m){let a=(0,d.pW)(b)[B.b.listUrlKey];a&&(m=a)}if(k[B.b.parentIdParamKey]=m,K){let a=j?A.a.Files:void 0,b=l[B.b.queryTypeParamKey]||a;void 0!==b&&(k[B.b.parentQueryTypeParamKey]=b)}else k[B.b.parentQueryTypeParamKey]=l[B.b.queryTypeParamKey];k[B.b.pageParamKey]=C.a.TextFileEditor,delete k[B.b.queryTypeParamKey];let n="";return!g&&e?(delete k[B.b.parentQueryTypeParamKey],n=e,`${e}?${(0,h.a)(k,void 0,!0)}`):(Number(f[B.b.pageParamKey])!==C.a.TextFileEditor&&(n=(0,H.a)()+window.location.pathname),`${n}#${(0,h.a)(k,void 0,!0)}`)}({itemKey:x,parentItemKey:ai,parentItemLink:aj,viewParams:ah,supportsOneUp:ak,defaultRootItemId:r,addDefaultParentViewOnViewerOpenUrls:f}):aC();else if(ae&&ae.length>0||Q&&Q.indexOf("0x0101009D1CB255DA76424F860D91F20E6C4118002A50BFCFB7614729B56886FADA02339B")>-1)if(J){let a=new j.b(J);a.setQueryParameter("stay","true"),q=a.toString()}else q="";else if((0,s.a)(_)&&ad(J,aJ)){if(".aspx"===`${aa}`.toLowerCase()&&J)return J;q=aC()}else q=J||x&&"#"+x;break;default:q=(0,s.a)(_)&&ad(J,aJ)&&aa?aC():J||x&&"#"+x}if(v&&(aK===z.a.File&&M&&(-1!==M.toLowerCase().indexOf(X)||-1!==M.toLowerCase().indexOf(Y))||aK===z.a.OneNote)){let a=new j.b(q);(a.getLastPathSegment().toLowerCase()===X||a.getLastPathSegment().toLowerCase()===Y)&&(a.setQueryParameter("1"===ab?"IsFolder":"IsList","1"),a.setQueryParameter("ListId",v),a.setQueryParameter("ListItemId",w||""),q=a.toString())}return(p=q)&&-1!==p.toLowerCase().indexOf("/_layouts/doc.aspx?")&&(p=(p=p.toLowerCase()).replace("/_layouts/doc.aspx","/_layouts/15/doc.aspx")),q=p}}}}});function ac(a){let{itemKey:b,parentItemKey:c,supportsOneUp:e,itemUrlHelper:f,page:g,addDefaultParentViewOnViewerOpenUrls:i,itemExtension:j,parentView:k,parentViewParams:l,mainLinkViewParams:m}=a,n=a.params||{};if(!R&&n[B.b.parentDriveIdParamKey]&&b&&k){let a=(0,d.pW)(b)[P.b];n[P.b]=a,n[B.b.parentQueryTypeParamKey]=k}if(!e){let a=f.getItemUrlParts(b),c=a.serverRelativeItemUrl||"",d={[B.b.idParamKey]:c,[B.b.parentIdParamKey]:c.substring(0,c.lastIndexOf("/"))};return`${a.fullListUrl}?${(0,h.a)(d,void 0)}`}let o=(0,d.pW)(c||"");n[B.b.parentIdParamKey]=o[B.b.idParamKey],U&&l&&l[B.b.viewIdKey]&&(n[B.b.viewIdKey]=l[B.b.viewIdKey]);let p=(0,H.h)(n);if(p){let{mountPoint:a,remoteSpItem:b}=p;if(b){let c={mountPoint:a,remoteSpItem:{listFullUrl:b.listFullUrl,rootFolder:o[B.b.idParamKey],webAbsoluteUrl:b.webAbsoluteUrl}};(0,G.a)(n,(0,H.j)(c))}}if(K){let a=i?A.a.Files:void 0,b=o[B.b.queryTypeParamKey]||a;void 0!==b&&(n[B.b.parentQueryTypeParamKey]=b)}else n[B.b.parentQueryTypeParamKey]=o[B.b.queryTypeParamKey];for(let a in!R&&n[B.b.parentDriveIdParamKey]&&b||(delete o[B.b.idParamKey],delete o[B.b.queryTypeParamKey]),!R&&n[B.b.parentDriveIdParamKey]&&n[B.b.parentIdParamKey]&&(delete o[B.b.parentIdParamKey],delete n[B.b.parentIdParamKey]),delete o[B.b.uniqueParamKey],n){let b=n[a];(null==b||""===b&&0>a.indexOf("FilterValue"))&&delete n[a]}return g&&g!==C.a.Files&&(n[B.b.pageParamKey]=`${g}`),!T&&(n[B.b.shareTokenKey]&&delete n[B.b.shareTokenKey],(0,N.a)()&&n&&m&&(n={...n,...m})),Q||".research"!==j||(n[B.b.navModeKey]=1),"#"+(0,h.a)(n,o,!1)}function ad(a,b){return M.a?(0,M.b)(a,b):!!(a&&b&&(0,f.a)(a)===(0,f.a)(b))}function ae(a){let b,c,e,f,g;return c="ms-powerpoint"===(b=a.appMap?a.appMap.toLowerCase():void 0),e="ms-word"===b,f="ms-visio"===b,g="ms-excel"===b,(c||e||f||g||!1)&&!!(a&&a.openUrl&&a.appMap)&&!d.lU.isFeatureEnabled({ODB:826,OneDrive:!0})}var af=c(15),ag=c(32),ah=c(271),ai=c(528);let aj=ai.b.protocolCommand;var ak=c(531),al=c(82),am=c(111),an=c(529),ao=c(17),ap=c(112);let aq=d.Ov.isActivated("a5e1d64c-8940-4ce7-9446-9ba2565085ed"),ar=d.Ov.isActivated("c8636355-f925-4b6c-932c-70b5008f78eb"),as=d.Ov.isActivated("a3745abe-801e-48b9-ba8d-a05e8ecd7e7e");class at{getDefaultClickUrlForOneUp(a,b){if(!a||!a.key)return"";let c=this._navigation.viewParams,d=c[B.b.parentQueryTypeParamKey],e=b?.parentItem,f=(0,H.f)(c),g=this._itemUrlHelper.getItemUrlParts("").serverRelativeItemUrl||"",h=(0,H.c)({key:a.key,viewParams:c,defaultRootItemId:g}),j={};if((0,N.a)()&&a.mainLinkInfo?.ShareTokenString){let b=(0,an.a)({oneUpProps:this._oneUpStore.getOneUpProperties(),appPageContext:this._pageContext,item:a});if(!aq&&b?.webServerRelativeUrl&&c[B.b.listUrlKey]&&!c?.[B.b.remoteItem]){let a=b&&Number(b.webTemplate)===i.b.mySite,c=!(0,ap.a)(this._pageContext);(!(a&&!b.isMySiteOwner&&c)||as)&&(j[B.b.webUrlKey]=b.webServerRelativeUrl)}!ar&&this._pageContext.isCommonDomainRequestContext&&b?.routingKey&&(j[B.b.routingKey]=b.routingKey),j[B.b.shareTokenKey]=a.mainLinkInfo.ShareTokenString}let k=()=>ac({itemKey:a.key,parentItemKey:e?.key,params:h,supportsOneUp:!0,itemUrlHelper:this._itemUrlHelper,page:f,addDefaultParentViewOnViewerOpenUrls:this._addDefaultParentViewOnViewerOpenUrls,parentView:d,parentViewParams:b?.parentViewParams,mainLinkViewParams:j}),l={itemKey:a.key,viewParams:c,itemUrlHelper:this._itemUrlHelper,pageContext:this._pageContext,isDocSet:a.isDocSet,listId:this._pageContext.listId,listItemId:a.properties&&a.properties.ID,itemType:a.type,itemList:a.list,itemOpenUrl:a.openUrl,itemPreviewIFrameUrl:a.previewIFrameUrl,itemQueryType:a.queryType,itemOfficeBundle:a.officeBundle,itemContentTypeId:a.contentTypeId,itemUrls:a.urls,itemSubsite:void 0,itemExtension:a.extension,itemFSObjType:a.properties?.FSObjType,itemTranslationLanguages:a.properties?._SPTranslatedLanguages,isUnifiedAppSupportedFile:ae(a),welcomePageCustomized:a.properties?.WelcomePageCustomized,getMediaUrl:k,parentItemKey:e&&e.key,supportsOneUp:!0,urlType:b?.urlType,defaultRootItemId:g,page:f,mainLinkInfo:a.mainLinkInfo,parentViewParams:b?.parentViewParams},m=this._getDefaultClickUrl(l);return this._isFastOneUp&&(m=m.replace("#","?")),m}getOpenInOfficeClientUrl(a,b,c){var d,e,f;let g,h=a.appMap,i=a.properties&&a.properties.path||this.getItemUrl(a.key),j=-1!==[".jpg",".jpeg",".bmp",".png",".gif",".onetoc2",".one",".odc"].indexOf((a.extension||"").toLowerCase()),k=a.queryType===A.a.SharedWithMe&&("ms-word"===a.appMap||"ms-powerpoint"===a.appMap);return d=ag.a.hasItemPermission(a,ag.a.editListItems)&&!j&&(!ah.c(a)||ah.b(a,this._pageContext.userId))||k?aj.Edit:aj.View,e=this._platform?.isChrome&&this._platform?.isMac,f=this._pageContext.isSPO,g=ai.a.none,e&&(g=ai.a.encodeCommand),ai.b.createProtocolHandlerUrl(h,i,d,"",g,f)}getKey(a){return(0,H.d)(a)}getItemUrl(a=""){let b=this._itemUrlHelper.getItemUrlParts(a);return l.a(b?.fullItemUrl||"")}getOpenInOfficeOnlineUrl(a,b){let c;return c=ae(a)?ak.a.GetWopiDocEditUrl(a,b||"",this._pageContext.env):ak.a.GetWopiFrameEditUrl(a),this._ensureLayouts15(c||a.openUrl||"")}getApiBaseUrl(a){let b=a?.apiVersion==="v2.1"?a.apiVersion:"v2.0";return`${(0,am.b)(this._pageContext)}/_api/${b}`}getKeyParams(a){return(0,H.e)(a)}getPageType(a){return(0,H.f)(a)}getQueryType(a=this._navigation.viewParams){return(0,H.g)(a)}_ensureLayouts15(a){return a&&-1!==a.toLowerCase().indexOf("/_layouts/doc.aspx?")&&(a=(a=a.toLowerCase()).replace("/_layouts/doc.aspx","/_layouts/15/doc.aspx")),a}constructor(a,b){this._pageContext=b.pageContext,this._navigation=b.navigation,this._itemUrlHelper=b.itemUrlHelper,this._getDefaultClickUrl=b.getDefaultClickUrl,this._platform=b.platform,this._isFastOneUp=b.isFastOneUp,this._addDefaultParentViewOnViewerOpenUrls=b.addDefaultParentViewOnViewerOpenUrls,this._oneUpStore=b.oneUpStore}}at.dependencies={navigation:e.a,pageContext:r.a,itemUrlHelper:af.c,getDefaultClickUrl:ab,platform:J.a,isFastOneUp:al.j.optional,addDefaultParentViewOnViewerOpenUrls:L.optional,oneUpStore:ao.b};let au=at,av=(0,d.hl)("OneUpUrlDataSource",at)}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>h,b:()=>d,c:()=>j,d:()=>e,e:()=>f,f:()=>l,g:()=>o,h:()=>i,i:()=>m,j:()=>g,k:()=>n,l:()=>k});let d="id",e="listId",f="listurl",g="viewid",h="groupBy",i="sortField",j="isAscending",k="weburl",l="searchid",m="typeFilters",n="viewpath",o="q"}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>d});let d="action"}
,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>i,b:()=>h});var d=c("odsp.util_126");let e=d.lU.isFeatureEnabled,f={ODB:61286},g={ODB:62524},h=new d.v7({name:"isOneUpTempAuthDeprecationEnabled",factory:{dependencies:{},create:()=>({instance:e(f)})}}),i=new d.v7({name:"isMeTATempAuthDeprecationEnabled",factory:{dependencies:{isOneUpTempAuthDeprecationEnabled:h},create:a=>({instance:a.isOneUpTempAuthDeprecationEnabled&&e(g)})}})}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>d});let d=new(c("odsp.util_126")).v7({name:"shouldTreatCidAsClickId",factory:{dependencies:{},create:()=>({instance:!1})}})}
,,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>e,b:()=>t,c:()=>s});var d,e,f=c("odsp.util_126"),g=c(116),h=c(147),i=c(57),j=c(2);let k=new f.v7({name:"isZipPreviewerEnabled.key",factory:new f.Uo(!0)});var l=c(51),m=c(296),n=c(4),o=c(297),p=c(119);(d=e||(e={})).Error="Error",d.WAC="WAC",d.Html="Html",d.MSPdf="MSPdf",d.Pdf="Pdf",d.OnePlayerVideo="OnePlayerVideo",d.OnePlayerAudio="OnePlayerAudio",d.Panorama="Panorama",d.Image360="Image360",d.Zip="Zip",d.ThreeD="3d",d.TextFile="TextFile",d.Photo="Photo",d.Thumbnail="Thumbnail",d.FileHandler="FileHandler",d.Copilot="Copilot",d.Other="Other",d.Unknown="Unknown";let q=[".opus",".url",".mht",".mhtml",".xltx",".xlt",".xltm"],r=[{extension:".opus"},{extension:".url"},{extension:".mht",originalViewer:"Html"},{extension:".mhtml",originalViewer:"Html"},{extension:".xltx",originalViewer:"WAC"},{extension:".xlt",originalViewer:"WAC"},{extension:".xltm",originalViewer:"WAC"}];(0,n.Bb)()||(q.push(".aspx"),r.push({extension:".aspx"}));let s=new f.v7({name:"ViewerTypeHelper",factory:{dependencies:{platformDetection:i.a,pdfViewerHelper:l.b,fileHandlerHelper:m.a,pageContext:j.a,isZipPreviewerEnabled:k},create:({platformDetection:a,pdfViewerHelper:b,fileHandlerHelper:c,pageContext:d,isZipPreviewerEnabled:e})=>{let f=!a.isMobile;return{instance:{getValidViewerTypes:function(a){return!a||a.isPlaceholder?"Unknown":function(a){if((0,n.Oc)()){if((0,n.fc)()&&a.extension&&t(a).length>0)return"Other"}else if((0,n.fc)()&&a.extension&&-1!==q.indexOf(a.extension))return"Other"}(a)||(a.error?"Error":a.folder||a.itemStatus===g.b.ConditionalAccessBlocked||a.lifeCycleStatus&&a.lifeCycleStatus.isMalwareDetected||(0,n.Kb)()&&a?.properties?.ProgId==="OneNote.Notebook"?"Other":a.officeBundle||a.wopiFrameUrl?"WAC":a.htmlConversion?"Html":b.isSupportedFileType(a)?"MSPdf":a.video?"OnePlayerVideo":a.audio?"OnePlayerAudio":a.panorama?"Panorama":f&&a.image360?"Image360":a.model3d?"3d":e&&a.zip?"Zip":(0,n.ac)(d)&&a.extension&&(a.extension===o.e||a.extension===o.d||(0,p.b)(a.extension))?"Copilot":a.extension&&(0,h.b)(a.extension,a.type)?"TextFile":a.photo?"Photo":a.thumbnail?"Thumbnail":c.hasFileHandler(a)?"FileHandler":"Other")}}}}}});function t(a){return r.filter(b=>b.extension===a.extension)}}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>f});var d=c(75);let e=(0,c(299).a)(),f=class extends d.a.withManager(e){}}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>d});let d=c("odsp.util_126").Ov.isActivated("8F5B46F5-FE0A-4975-A57F-C047F6A9896F")}
,,(a,b,c)=>{"use strict";c.d(b,{a:()=>g});var d=c("tslib_533"),e=/\{(\d+)\}/g;function f(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];return a.replace(e,function(a,c){var d=b[Number(c)];return null!==d?"".concat(d):""})}var g=function(){function a(a){this._strings=a}return Object.defineProperty(a.prototype,"strings",{get:function(){return this._strings},set:function(a){this._strings=a},enumerable:!1,configurable:!0}),a.prototype.get=function(a,b){if(!this._strings)return"";var c=this._strings[a];return b?f.apply(void 0,(0,d.lt)([c],(0,d.pM)(b),!1)):c},a}()}
,,,,,,,,,,(a,b,c)=>{"use strict";function d(){g=self._pdfSessionPerfMarks=[]}function e(){return void 0===h&&(h=!!performance&&"function"==typeof performance.mark&&"function"==typeof performance.clearMarks&&"function"==typeof performance.now),h}function f(){return"undefined"!=typeof MSPDF_PERF_LAB&&MSPDF_PERF_LAB}c.d(b,{a:()=>i});var g,h,i=function(){function a(){}return a.initialize=function(b){a._markNamePrefix=b.markNamePrefix||"",d()},a.mark=function(b){a._mark(b)},a.debugMark=function(b){f()&&a._mark(b)},a.getMarkerTime=function(b,c){if(void 0===c&&(c=!0),!e())return NaN;var d=c?a.addPrefix(b):b,f=performance.getEntriesByName(d,"mark");return(null==f?void 0:f.length)>0?Math.round(f[0].startTime):NaN},a.getDurationBetweenMarks=function(b,c){return a.getMarkerTime(c)-a.getMarkerTime(b)},a.enterPerfTestSession=function(a){f()&&(this._curSessionName=a,this._sessionId+=1)},a.sessionMark=function(b,c){if(f()&&"Unknown"!==a._curSessionName){var d={stage:b,startTime:e()?performance.now():Date.now(),extraData:c},h=a.sessionMarkName,i=g,j=i.find(function(a){return a.name===h});j?j.data.push(d):i.push({name:h,data:[d]})}},a.getSessionMarkerData=function(){var b=a.sessionMarkName,c=g.find(function(a){return a.name===b});return null==c?void 0:c.data},a.clearMarks=function(b){if(e()){var c=[];b&&(c=b.map(a.addPrefix)),performance.getEntriesByType("mark").filter(function(b){return c.length>0?c.indexOf(b.name)>=0:0===b.name.lastIndexOf(a.namePrefix,0)}).forEach(function(a){performance.clearMarks(a.name)}),d()}},a.addPrefix=function(b){var c=a.namePrefix;return 0===b.lastIndexOf(c,0)?b:c+b},a._mark=function(b){if(e()){var c=a.addPrefix(b);performance.mark(c)}},Object.defineProperty(a,"namePrefix",{get:function(){return a._markNamePrefix+"MsPdf."},enumerable:!1,configurable:!0}),Object.defineProperty(a,"sessionMarkName",{get:function(){return a.addPrefix("".concat(a._curSessionName,"_").concat(this._sessionId))},enumerable:!1,configurable:!0}),a._markNamePrefix="",a._curSessionName="Unknown",a._sessionId=-1,a}()}
,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>e,b:()=>g});let d="rgba(31,31,31,.88)",e="#141414",f={themePrimary:"#0F6CBD",themeLighterAlt:"#092c47",themeLighter:"#043862",themeLight:"#004c87",themeTertiary:"#0078D4",themeSecondary:"#0078d4",themeDarkAlt:"#ffffff",themeDarker:"#82c7ff",themeDark:"#6cb8f6",neutralLighterAlt:"#201f1e",neutralLighter:"#252423",neutralLight:"#292827",neutralQuaternaryAlt:"#323130",neutralQuaternary:"#3b3a39",neutralTertiaryAlt:"#484644",neutralTertiary:"#797775",neutralSecondaryAlt:"#979693",neutralSecondary:"#a19f9d",neutralPrimary:"#f3f2f1",neutralPrimaryAlt:"#c8c6c4",neutralDark:"#faf9f8",black:"#ffffff",white:"#1b1a19",redDark:"#F1707B",whiteTranslucent40:d,orange:"#E38585"},g={semanticColors:{bodyBackground:d,bodyStandoutBackground:f.neutralLight,buttonText:f.black,buttonTextPressed:f.neutralDark,buttonTextHovered:f.neutralPrimary,bodySubtext:f.neutralSecondary,disabledBackground:f.neutralQuaternaryAlt,errorText:f.redDark,inputBackgroundChecked:f.themePrimary,menuBackground:f.neutralLighter,menuItemBackgroundHovered:f.neutralQuaternaryAlt,menuItemBackgroundPressed:f.neutralQuaternary,menuDivider:f.neutralTertiaryAlt,menuIcon:f.themeDarkAlt,menuHeader:f.black,menuItemText:f.neutralPrimary,menuItemTextHovered:f.neutralDark,messageText:f.neutralPrimary,buttonBackground:d,buttonBackgroundHovered:"#424242",buttonBackgroundPressed:"#000000",primaryButtonBackground:f.themeTertiary,primaryButtonBackgroundHovered:f.themeLight,primaryButtonBackgroundPressed:f.themeLighter,primaryButtonText:f.black,primaryButtonTextHovered:f.black,primaryButtonTextPressed:f.black,primaryButtonTextDisabled:"#605e5c",buttonBorder:"#808080",variantBorder:f.neutralQuaternary,infoBackground:f.neutralQuaternaryAlt,infoIcon:f.neutralPrimaryAlt,errorIcon:f.redDark,warningIcon:f.neutralPrimaryAlt,blockingIcon:"#442726",severeWarningIcon:"#FCE100",successIcon:"#92C353",errorBackground:"#442726",blockingBackground:"#442726",warningBackground:"#433519",severeWarningBackground:"#4F2A0F",successBackground:"#393D1B",inputBorder:"#525252"},palette:f,isInverted:!0}}
,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>l});var d=c("odsp.util_126"),e=c(10),f=c(32),g=c(2),h=c(635),i=c(46);let j=!d.Ov.isActivated("F7F844A1-C5CA-40D4-A9F1-D446600D3D5F"),k={oneUpStateStore:e.f,pageContext:g.a,getExecutor:h.a.async.lazy,identityDataSource:i.resourceKey},l=new d.v7({name:"SaveAction",factory:{dependencies:k,create:a=>({instance:{evaluateAction:b=>{let c=(a.oneUpStateStore.getViewerState(b.item.key)?.saveData?.fileUpload||!1)&&f.a.hasItemPermission(b.item,f.a.editListItems),d=a.pageContext;return{isAvailable:c,id:"SaveAction",onExecute:async c=>(await a.getExecutor()).executeSave({item:b.item,parentItem:b.parentItem,fileUpload:c.fileUpload,pageContext:d,oneUpStateStore:a.oneUpStateStore,saveascopy:c.saveascopy||!1,identityDataSource:a.identityDataSource,qosEvent:c.qosEvent}),customerPromise:j?{startSchema:{pillar:"Edit"},computeVeto:()=>"Save Failure"}:void 0}}}})}})}
,,(a,b,c)=>{"use strict";let d;c.d(b,{a:()=>v});var e=c("odsp.util_126"),f=c(0),g=c(17),h=c(10),i=c(607),j=c(2),k=c(529),l=c(347),m=c(371),n=c(39),o=c(298),p=c(28),q=c(240);let r={pageContext:j.a.optional,isCopilotLiteEnabled:q.a},s=new e.v7({name:"isODCopilotCustomInstructionsEnabled",factory:{dependencies:r,create:a=>({instance:()=>(function(a){let{pageContext:b,isCopilotLiteEnabled:c}=a;return void 0===d&&(d=c()&&((0,p.a)(o.d)||!!(b&&1===(0,n.c)(90254,b)))),!!d})(a)})}}),t=!e.Ov.isActivated("91C06EED-7FA1-4B7C-B58E-47440AB436F6"),u={oneUpStore:g.b,oneUpStateStore:h.f,getExecutor:m.a.async.lazy,canOpenCopilot:l.a,appPageContext:j.a,isODCopilotCustomInstructionEnabled:t?s:void 0},v=new e.v7({name:"openCopilotPaneAction",factory:{dependencies:u,create:a=>({instance:{evaluateAction:b=>({isAvailable:a.canOpenCopilot.isCopilotSupportedForItem(b.item),id:"OpenCopilotPaneAction",onExecute:async()=>{let d=new e.G7,g=(0,k.a)({oneUpProps:a.oneUpStore.getOneUpProperties(),appPageContext:a.appPageContext,item:b.item}),h=(0,i.a)({item:b.item,currentPageContext:g,appPageContext:a.appPageContext}),j=a.isODCopilotCustomInstructionEnabled?.()?await c.e(43).then(c.bind(c,842)):void 0,l={currentPageContext:g,copilotCustomInstruction:j?.odCopilotInstruction,loadConversationHistory:!!(window.event&&window.event instanceof MouseEvent&&window.event.shiftKey),fileConstraint:h,onLoadSuccess:()=>{d.resolve({resultType:f.b.Success})},onLoadError:a=>{d.reject(a)}};return(await a.getExecutor()).showCopilotPane(l),d.promise}})}})}})}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>f});var d=c(186),e=c(372);let f=()=>{let{palette:a,semanticColors:b}=d.b,c=`${b.buttonBackground} !important`,f=`${b.buttonBorder} !important`,g={background:c,paddingLeft:"8px",paddingRight:"8px",margin:"auto 6px auto 6px",color:a.black,height:"32px",width:"auto",border:`1px solid ${f}`,".ms-Button-menuIcon":{marginTop:"2px",color:a.black},".ms-Button-flexContainer":{backgroundColor:"transparent !important"}};return(0,e.a)(g)}}
,,,,,,,(a,b,c)=>{"use strict";let d;c.d(b,{a:()=>j,b:()=>i,c:()=>h,d:()=>f,e:()=>m,f:()=>aI,g:()=>aN,h:()=>aJ,i:()=>aL,j:()=>aK,k:()=>aM,l:()=>aa});var e=c("fui.core_517");let f="data-tabster",g="a[href], button:not([disabled]), input:not([disabled]), select:not([disabled]), textarea:not([disabled]), *[tabindex], *[contenteditable], details > summary, audio[controls], video[controls]",h={Source:0,Target:1},i={Both:0,Vertical:1,Horizontal:2,Grid:3,GridLinear:4},j={Unlimited:0,Limited:1,LimitedTrapFocus:2};function k(a,b){var c;return null==(c=a.storageEntry(b))?void 0:c.tabster}function l(a,b,c){var d,e;let g,h=c||a._noop?void 0:b.getAttribute(f),i=a.storageEntry(b);if(h)if(h===(null==(d=null==i?void 0:i.attr)?void 0:d.string))return;else try{let a=JSON.parse(h);if("object"!=typeof a)throw Error(`Value is not a JSON object, got '${h}'.`);g={string:h,object:a}}catch(a){}else if(!i)return;i||(i=a.storageEntry(b,!0)),i.tabster||(i.tabster={});let j=i.tabster||{},k=(null==(e=i.attr)?void 0:e.object)||{},l=(null==g?void 0:g.object)||{};for(let c of Object.keys(k))if(!l[c]){if("root"===c){let b=j[c];b&&a.root.onRoot(b,!0)}switch(c){case"deloser":case"root":case"groupper":case"modalizer":case"restorer":case"mover":let d=j[c];d&&(d.dispose(),delete j[c]);break;case"observed":delete j[c],a.observedElement&&a.observedElement.onObservedElementUpdate(b);break;case"focusable":case"outline":case"uncontrolled":case"sys":delete j[c]}}for(let c of Object.keys(l)){let d=l.sys;switch(c){case"deloser":j.deloser?j.deloser.setProps(l.deloser):a.deloser&&(j.deloser=a.deloser.createDeloser(b,l.deloser));break;case"root":j.root?j.root.setProps(l.root):j.root=a.root.createRoot(b,l.root,d),a.root.onRoot(j.root);break;case"modalizer":j.modalizer?j.modalizer.setProps(l.modalizer):a.modalizer&&(j.modalizer=a.modalizer.createModalizer(b,l.modalizer,d));break;case"restorer":j.restorer?j.restorer.setProps(l.restorer):a.restorer&&l.restorer&&(j.restorer=a.restorer.createRestorer(b,l.restorer));break;case"focusable":j.focusable=l.focusable;break;case"groupper":j.groupper?j.groupper.setProps(l.groupper):a.groupper&&(j.groupper=a.groupper.createGroupper(b,l.groupper,d));break;case"mover":j.mover?j.mover.setProps(l.mover):a.mover&&(j.mover=a.mover.createMover(b,l.mover,d));break;case"observed":a.observedElement&&(j.observed=l.observed,a.observedElement.onObservedElementUpdate(b));break;case"uncontrolled":j.uncontrolled=l.uncontrolled;break;case"outline":a.outline&&(j.outline=l.outline);break;case"sys":j.sys=l.sys;break;default:console.error(`Unknown key '${c}' in data-tabster attribute value.`)}}g?i.attr=g:(0===Object.keys(j).length&&(delete i.tabster,delete i.attr),a.storageEntry(b,!1))}let m="tabster:movefocus",n="tabster:mover:movefocus",o="tabster:mover:memorized-element",p="tabster:groupper:movefocus",q="tabster:restorer:restore-focus",r="undefined"!=typeof CustomEvent?CustomEvent:function(){};class s extends r{constructor(a,b){super(a,{bubbles:!0,cancelable:!0,composed:!0,detail:b}),this.details=b}}class t extends s{constructor(a){super("tabster:focusin",a)}}class u extends s{constructor(a){super("tabster:focusout",a)}}class v extends s{constructor(a){super(m,a)}}class w extends s{constructor(a){super("tabster:mover:state",a)}}class x extends s{constructor(a){super("tabster:modalizer:active",a)}}class y extends s{constructor(a){super("tabster:modalizer:inactive",a)}}class z extends s{constructor(){super(q)}}class A extends s{constructor(a){super("tabster:root:focus",a)}}class B extends s{constructor(a){super("tabster:root:blur",a)}}let C={createMutationObserver:a=>new MutationObserver(a),createTreeWalker:(a,b,c,d)=>a.createTreeWalker(b,c,d),getParentNode:a=>a?a.parentNode:null,getParentElement:a=>a?a.parentElement:null,nodeContains:(a,b)=>!!(b&&(null==a?void 0:a.contains(b))),getActiveElement:a=>a.activeElement,querySelector:(a,b)=>a.querySelector(b),querySelectorAll:(a,b)=>Array.prototype.slice.call(a.querySelectorAll(b),0),getElementById:(a,b)=>a.getElementById(b),getFirstChild:a=>(null==a?void 0:a.firstChild)||null,getLastChild:a=>(null==a?void 0:a.lastChild)||null,getNextSibling:a=>(null==a?void 0:a.nextSibling)||null,getPreviousSibling:a=>(null==a?void 0:a.previousSibling)||null,getFirstElementChild:a=>(null==a?void 0:a.firstElementChild)||null,getLastElementChild:a=>(null==a?void 0:a.lastElementChild)||null,getNextElementSibling:a=>(null==a?void 0:a.nextElementSibling)||null,getPreviousElementSibling:a=>(null==a?void 0:a.previousElementSibling)||null,appendChild:(a,b)=>a.appendChild(b),insertBefore:(a,b,c)=>a.insertBefore(b,c),getSelection:a=>{var b;return(null==(b=a.ownerDocument)?void 0:b.getSelection())||null},getElementsByName:(a,b)=>a.ownerDocument.getElementsByName(b)},D="undefined"!=typeof DOMRect?DOMRect:class{constructor(a,b,c,d){this.left=a||0,this.top=b||0,this.right=(a||0)+(c||0),this.bottom=(b||0)+(d||0)}},E=0;try{document.createTreeWalker(document,NodeFilter.SHOW_ELEMENT),d=!1}catch(a){d=!0}function F(a){let b=a(),c=b.__tabsterInstanceContext;return c||(c={elementByUId:{},basics:{Promise:b.Promise||void 0,WeakRef:b.WeakRef||void 0},containerBoundingRectCache:{},lastContainerBoundingRectCacheId:0,fakeWeakRefs:[],fakeWeakRefsStarted:!1},b.__tabsterInstanceContext=c),c}class G{constructor(a){this._target=a}deref(){return this._target}static cleanup(a,b){return!a._target||!(!b&&Q(a._target.ownerDocument,a._target))&&(delete a._target,!0)}}class H{constructor(a,b,c){let d;const e=F(a);e.WeakRef?d=new e.WeakRef(b):(d=new G(b),e.fakeWeakRefs.push(d)),this._ref=d,this._data=c}get(){let a,b=this._ref;return b&&((a=b.deref())||delete this._ref),a}getData(){return this._data}}function I(a,b){let c=F(a);c.fakeWeakRefs=c.fakeWeakRefs.filter(a=>!G.cleanup(a,b))}function J(a,b,c){if(b.nodeType!==Node.ELEMENT_NODE)return;let e=d?c:{acceptNode:c};return C.createTreeWalker(a,b,NodeFilter.SHOW_ELEMENT,e,!1)}function K(a,b){let c=b.__tabsterCacheId,d=F(a),e=c?d.containerBoundingRectCache[c]:void 0;if(e)return e.rect;let f=b.ownerDocument&&b.ownerDocument.documentElement;if(!f)return new D;let g=0,h=0,i=f.clientWidth,j=f.clientHeight;if(b!==f){let a=b.getBoundingClientRect();g=Math.max(g,a.left),h=Math.max(h,a.top),i=Math.min(i,a.right),j=Math.min(j,a.bottom)}let k=new D(g<i?g:-1,h<j?h:-1,g<i?i-g:0,h<j?j-h:0);return c||(b.__tabsterCacheId=c="r-"+ ++d.lastContainerBoundingRectCacheId),d.containerBoundingRectCache[c]={rect:k,element:b},d.containerBoundingRectCacheTimer||(d.containerBoundingRectCacheTimer=window.setTimeout(()=>{for(let a of(d.containerBoundingRectCacheTimer=void 0,Object.keys(d.containerBoundingRectCache)))delete d.containerBoundingRectCache[a].element.__tabsterCacheId;d.containerBoundingRectCache={}},50)),k}function L(a,b,c){let d=M(b);if(!d)return!1;let e=K(a,d),f=b.getBoundingClientRect(),g=f.height*(1-c),h=Math.max(0,e.top-f.top)+Math.max(0,f.bottom-e.bottom);return 0===h||h<=g}function M(a){let b=a.ownerDocument;if(b){for(let b=C.getParentElement(a);b;b=C.getParentElement(b))if(b.scrollWidth>b.clientWidth||b.scrollHeight>b.clientHeight)return b;return b.documentElement}return null}function N(a){return!!a.__shouldIgnoreFocus}function O(a,b){let c=F(a),d=b.__tabsterElementUID;return d||(d=b.__tabsterElementUID=function(a){let b=new Uint32Array(4);if(a.crypto&&a.crypto.getRandomValues)a.crypto.getRandomValues(b);else if(a.msCrypto&&a.msCrypto.getRandomValues)a.msCrypto.getRandomValues(b);else for(let a=0;a<b.length;a++)b[a]=0xffffffff*Math.random();let c=[];for(let a=0;a<b.length;a++)c.push(b[a].toString(36));return c.push("|"),c.push((++E).toString(36)),c.push("|"),c.push(Date.now().toString(36)),c.join("")}(a())),!c.elementByUId[d]&&Q(b.ownerDocument,b)&&(c.elementByUId[d]=new H(a,b)),d}function P(a,b){let c=F(a);for(let a of Object.keys(c.elementByUId)){let d=c.elementByUId[a],e=d&&d.get();(!e||!b||C.nodeContains(b,e))&&delete c.elementByUId[a]}}function Q(a,b){return C.nodeContains(null==a?void 0:a.body,b)}function R(a,b){let c=a.matches||a.matchesSelector||a.msMatchesSelector||a.webkitMatchesSelector;return c&&c.call(a,b)}let S=0;class T{constructor(a,b,c){const d=a.getWindow;this._tabster=a,this._element=new H(d,b),this._props={...c},this.id="i"+ ++S}getElement(){return this._element.get()}getProps(){return this._props}setProps(a){this._props={...a}}}class U{constructor(a,b,c,d,f){var g;this._focusIn=a=>{if(this._fixedTarget){let a=this._fixedTarget.get();a&&(0,e.MHx)(a);return}let b=this.input;if(this.onFocusIn&&b){let c=a.relatedTarget;this.onFocusIn(this,this._isBackward(!0,b,c),c)}},this._focusOut=a=>{if(this._fixedTarget)return;this.useDefaultAction=!1;let b=this.input;if(this.onFocusOut&&b){let c=a.relatedTarget;this.onFocusOut(this,this._isBackward(!1,b,c),c)}};const h=a(),i=h.document.createElement("i");i.tabIndex=0,i.setAttribute("role","none"),i.setAttribute("data-tabster-dummy",""),i.setAttribute("aria-hidden","true");const j=i.style;j.position="fixed",j.width=j.height="1px",j.opacity="0.001",j.zIndex="-1",j.setProperty("content-visibility","hidden"),i.__shouldIgnoreFocus=!0,this.input=i,this.isFirst=c.isFirst,this.isOutside=b,this._isPhantom=null!=(g=c.isPhantom)&&g,this._fixedTarget=f,i.addEventListener("focusin",this._focusIn),i.addEventListener("focusout",this._focusOut),i.__tabsterDummyContainer=d,this._isPhantom&&(this._disposeTimer=h.setTimeout(()=>{delete this._disposeTimer,this.dispose()},0),this._clearDisposeTimeout=()=>{this._disposeTimer&&(h.clearTimeout(this._disposeTimer),delete this._disposeTimer),delete this._clearDisposeTimeout})}dispose(){var a;this._clearDisposeTimeout&&this._clearDisposeTimeout();let b=this.input;b&&(delete this._fixedTarget,delete this.onFocusIn,delete this.onFocusOut,delete this.input,b.removeEventListener("focusin",this._focusIn),b.removeEventListener("focusout",this._focusOut),delete b.__tabsterDummyContainer,null==(a=C.getParentNode(b))||a.removeChild(b))}setTopLeft(a,b){var c;let d=null==(c=this.input)?void 0:c.style;d&&(d.top=`${a}px`,d.left=`${b}px`)}_isBackward(a,b,c){return a&&!c?!this.isFirst:!!(c&&b.compareDocumentPosition(c)&Node.DOCUMENT_POSITION_FOLLOWING)}}class V{constructor(a,b,c,d,e,f){this._element=b,this._instance=new X(a,b,this,c,d,e,f)}_setHandlers(a,b){this._onFocusIn=a,this._onFocusOut=b}moveOut(a){var b;null==(b=this._instance)||b.moveOut(a)}moveOutWithDefaultAction(a,b){var c;null==(c=this._instance)||c.moveOutWithDefaultAction(a,b)}getHandler(a){return a?this._onFocusIn:this._onFocusOut}setTabbable(a){var b;null==(b=this._instance)||b.setTabbable(this,a)}dispose(){this._instance&&(this._instance.dispose(this),delete this._instance),delete this._onFocusIn,delete this._onFocusOut}static moveWithPhantomDummy(a,b,c,d,f){let g=new U(a.getWindow,!0,{isPhantom:!0,isFirst:!0}).input;if(g){let h,i;if("BODY"===b.tagName)h=b,i=c&&d||!c&&!d?C.getFirstElementChild(b):null;else{let e,f;c&&(!d||d&&!a.focusable.isFocusable(b,!1,!0,!0))?(h=b,i=d?b.firstElementChild:null):(h=C.getParentElement(b),i=c&&d||!c&&!d?b:C.getNextElementSibling(b));do(f=_(e=c&&d||!c&&!d?C.getPreviousElementSibling(i):i))===b?i=c&&d||!c&&!d?e:C.getNextElementSibling(e):f=null;while(f)}(null==h?void 0:h.dispatchEvent(new v({by:"root",owner:h,next:null,relatedEvent:f})))&&(C.insertBefore(h,g,i),(0,e.MHx)(g))}}static addPhantomDummyWithTarget(a,b,c,d){let e=new U(a.getWindow,!0,{isPhantom:!0,isFirst:!0},void 0,new H(a.getWindow,d)).input;if(e){let a,d;!b.querySelector(g)||c?(a=C.getParentElement(b),d=c?b:C.getNextElementSibling(b)):(a=b,d=C.getFirstElementChild(b)),a&&C.insertBefore(a,e,d)}}}class W{constructor(a){this._updateQueue=new Set,this._lastUpdateQueueTime=0,this._changedParents=new WeakSet,this._dummyElements=[],this._dummyCallbacks=new WeakMap,this._domChanged=a=>{var b;this._changedParents.has(a)||(this._changedParents.add(a),this._updateDummyInputsTimer||(this._updateDummyInputsTimer=null==(b=this._win)?void 0:b.call(this).setTimeout(()=>{for(let a of(delete this._updateDummyInputsTimer,this._dummyElements)){let b=a.get();if(b){let a=this._dummyCallbacks.get(b);if(a){let c=C.getParentNode(b);(!c||this._changedParents.has(c))&&a()}}}this._changedParents=new WeakSet},100)))},this._win=a}add(a,b){!this._dummyCallbacks.has(a)&&this._win&&(this._dummyElements.push(new H(this._win,a)),this._dummyCallbacks.set(a,b),this.domChanged=this._domChanged)}remove(a){this._dummyElements=this._dummyElements.filter(b=>{let c=b.get();return c&&c!==a}),this._dummyCallbacks.delete(a),0===this._dummyElements.length&&delete this.domChanged}dispose(){var a;let b=null==(a=this._win)?void 0:a.call(this);this._updateTimer&&(null==b||b.clearTimeout(this._updateTimer),delete this._updateTimer),this._updateDummyInputsTimer&&(null==b||b.clearTimeout(this._updateDummyInputsTimer),delete this._updateDummyInputsTimer),this._changedParents=new WeakSet,this._dummyCallbacks=new WeakMap,this._dummyElements=[],this._updateQueue.clear(),delete this.domChanged,delete this._win}updatePositions(a){this._win&&(this._updateQueue.add(a),this._lastUpdateQueueTime=Date.now(),this._scheduledUpdatePositions())}_scheduledUpdatePositions(){var a;this._updateTimer||(this._updateTimer=null==(a=this._win)?void 0:a.call(this).setTimeout(()=>{if(delete this._updateTimer,this._lastUpdateQueueTime+100<=Date.now()){let a=new Map,b=[];for(let c of this._updateQueue)b.push(c(a));for(let a of(this._updateQueue.clear(),b))a();a.clear()}else this._scheduledUpdatePositions()},100))}}class X{constructor(a,b,c,d,f,g,h){this._wrappers=[],this._isOutside=!1,this._transformElements=new Set,this._onFocusIn=(a,b,c)=>{this._onFocus(!0,a,b,c)},this._onFocusOut=(a,b,c)=>{this._onFocus(!1,a,b,c)},this.moveOut=a=>{var b;let c=this._firstDummy,d=this._lastDummy;if(c&&d){this._ensurePosition();let f=c.input,g=d.input,h=null==(b=this._element)?void 0:b.get();if(f&&g&&h){let b;a?(f.tabIndex=0,b=f):(g.tabIndex=0,b=g),b&&(0,e.MHx)(b)}}},this.moveOutWithDefaultAction=(a,b)=>{var c;let d=this._firstDummy,f=this._lastDummy;if(d&&f){this._ensurePosition();let g=d.input,h=f.input,i=null==(c=this._element)?void 0:c.get();if(g&&h&&i){let c;a?!d.isOutside&&this._tabster.focusable.isFocusable(i,!0,!0,!0)?c=i:(d.useDefaultAction=!0,g.tabIndex=0,c=g):(f.useDefaultAction=!0,h.tabIndex=0,c=h),c&&i.dispatchEvent(new v({by:"root",owner:i,next:null,relatedEvent:b}))&&(0,e.MHx)(c)}}},this.setTabbable=(a,b)=>{var c,d;for(let c of this._wrappers)if(c.manager===a){c.tabbable=b;break}let e=this._getCurrent();if(e){let a=e.tabbable?0:-1,b=null==(c=this._firstDummy)?void 0:c.input;b&&(b.tabIndex=a),(b=null==(d=this._lastDummy)?void 0:d.input)&&(b.tabIndex=a)}},this._addDummyInputs=()=>{this._addTimer||(this._addTimer=this._getWindow().setTimeout(()=>{delete this._addTimer,this._ensurePosition(),this._addTransformOffsets()},0))},this._addTransformOffsets=()=>{this._tabster._dummyObserver.updatePositions(this._computeTransformOffsets)},this._computeTransformOffsets=a=>{var b,c;let d=(null==(b=this._firstDummy)?void 0:b.input)||(null==(c=this._lastDummy)?void 0:c.input),e=this._transformElements,f=new Set,g=0,h=0,i=this._getWindow();for(let b=d;b&&b.nodeType===Node.ELEMENT_NODE;b=C.getParentElement(b)){let c=a.get(b);if(void 0===c){let d=i.getComputedStyle(b).transform;d&&"none"!==d&&(c={scrollTop:b.scrollTop,scrollLeft:b.scrollLeft}),a.set(b,c||null)}c&&(f.add(b),e.has(b)||b.addEventListener("scroll",this._addTransformOffsets),g+=c.scrollTop,h+=c.scrollLeft)}for(let a of e)f.has(a)||a.removeEventListener("scroll",this._addTransformOffsets);return this._transformElements=f,()=>{var a,b;null==(a=this._firstDummy)||a.setTopLeft(g,h),null==(b=this._lastDummy)||b.setTopLeft(g,h)}};const i=b.get();if(!i)throw Error("No element");this._tabster=a,this._getWindow=a.getWindow,this._callForDefaultAction=h;const j=i.__tabsterDummy;if((j||this)._wrappers.push({manager:c,priority:d,tabbable:!0}),j)return j;i.__tabsterDummy=this;const k=null==f?void 0:f.dummyInputsPosition,l=i.tagName;this._isOutside=k?2===k:(g||"UL"===l||"OL"===l||"TABLE"===l)&&"LI"!==l&&"TD"!==l&&"TH"!==l,this._firstDummy=new U(this._getWindow,this._isOutside,{isFirst:!0},b),this._lastDummy=new U(this._getWindow,this._isOutside,{isFirst:!1},b);const m=this._firstDummy.input;m&&a._dummyObserver.add(m,this._addDummyInputs),this._firstDummy.onFocusIn=this._onFocusIn,this._firstDummy.onFocusOut=this._onFocusOut,this._lastDummy.onFocusIn=this._onFocusIn,this._lastDummy.onFocusOut=this._onFocusOut,this._element=b,this._addDummyInputs()}dispose(a,b){var c,d,e,f;if(0===(this._wrappers=this._wrappers.filter(c=>c.manager!==a&&!b)).length){for(let a of(delete(null==(c=this._element)?void 0:c.get()).__tabsterDummy,this._transformElements))a.removeEventListener("scroll",this._addTransformOffsets);this._transformElements.clear();let a=this._getWindow();this._addTimer&&(a.clearTimeout(this._addTimer),delete this._addTimer);let b=null==(d=this._firstDummy)?void 0:d.input;b&&this._tabster._dummyObserver.remove(b),null==(e=this._firstDummy)||e.dispose(),null==(f=this._lastDummy)||f.dispose()}}_onFocus(a,b,c,d){var e;let f=this._getCurrent();f&&(!b.useDefaultAction||this._callForDefaultAction)&&(null==(e=f.manager.getHandler(a))||e(b,c,d))}_getCurrent(){return this._wrappers.sort((a,b)=>a.tabbable!==b.tabbable?a.tabbable?-1:1:a.priority-b.priority),this._wrappers[0]}_ensurePosition(){var a,b,c;let d=null==(a=this._element)?void 0:a.get(),e=null==(b=this._firstDummy)?void 0:b.input,f=null==(c=this._lastDummy)?void 0:c.input;if(d&&e&&f)if(this._isOutside){let a=C.getParentNode(d);if(a){let b=C.getNextSibling(d);b!==f&&C.insertBefore(a,f,b),C.getPreviousElementSibling(d)!==e&&C.insertBefore(a,e,d)}}else{C.getLastElementChild(d)!==f&&C.appendChild(d,f);let a=C.getFirstElementChild(d);a&&a!==e&&a.parentNode&&C.insertBefore(a.parentNode,e,a)}}}function Y(a){let b=null;for(let c=C.getLastElementChild(a);c;c=C.getLastElementChild(c))b=c;return b||void 0}function Z(a,b,c,d){let e=a.storageEntry(b,!0),f=!1;if(!e.aug){if(void 0===d)return f;e.aug={}}if(void 0===d){if(c in e.aug){let a=e.aug[c];delete e.aug[c],null===a?b.removeAttribute(c):b.setAttribute(c,a),f=!0}}else{let a;c in e.aug||(a=b.getAttribute(c)),void 0!==a&&a!==d&&(e.aug[c]=a,null===d?b.removeAttribute(c):b.setAttribute(c,d),f=!0)}return void 0===d&&0===Object.keys(e.aug).length&&(delete e.aug,a.storageEntry(b,!1)),f}function $(a){return"INPUT"===a.tagName&&!!a.name&&"radio"===a.type}function _(a){var b;return(null==(b=null==a?void 0:a.__tabsterDummyContainer)?void 0:b.get())||null}function aa(a,b){let c=JSON.stringify(a);return!0===b?c:{[f]:c}}class ab extends V{constructor(a,b,c,d){super(a,b,1,d,void 0,!0),this._onDummyInputFocus=a=>{var b;if(a.useDefaultAction)this._setFocused(!1);else{this._tabster.keyboardNavigation.setNavigatingWithKeyboard(!0);let c=this._element.get();if(c){this._setFocused(!0);let b=this._tabster.focusedElement.getFirstOrLastTabbable(a.isFirst,{container:c,ignoreAccessibility:!0});if(b)return void(0,e.MHx)(b)}null==(b=a.input)||b.blur()}},this._setHandlers(this._onDummyInputFocus),this._tabster=a,this._setFocused=c}}class ac extends T{constructor(a,b,c,d,f){super(a,b,d),this._isFocused=!1,this._setFocused=a=>{var b;if(this._setFocusedTimer&&(this._tabster.getWindow().clearTimeout(this._setFocusedTimer),delete this._setFocusedTimer),this._isFocused===a)return;let c=this._element.get();c&&(a?(this._isFocused=!0,null==(b=this._dummyManager)||b.setTabbable(!1),c.dispatchEvent(new A({element:c}))):this._setFocusedTimer=this._tabster.getWindow().setTimeout(()=>{var a;delete this._setFocusedTimer,this._isFocused=!1,null==(a=this._dummyManager)||a.setTabbable(!0),c.dispatchEvent(new B({element:c}))},0))},this._onFocusIn=a=>{let b=this._tabster.getParent,c=this._element.get(),d=a.composedPath()[0];do{if(d===c)return void this._setFocused(!0);d=d&&b(d)}while(d)},this._onFocusOut=()=>{this._setFocused(!1)},this._onDispose=c;const g=a.getWindow;this.uid=O(g,b),this._sys=f,(a.controlTab||a.rootDummyInputs)&&this.addDummyInputs();const h=g().document;h.addEventListener(e.pMf,this._onFocusIn),h.addEventListener(e.XG4,this._onFocusOut),this._add()}addDummyInputs(){this._dummyManager||(this._dummyManager=new ab(this._tabster,this._element,this._setFocused,this._sys))}dispose(){var a;this._onDispose(this);let b=this._tabster.getWindow(),c=b.document;c.removeEventListener(e.pMf,this._onFocusIn),c.removeEventListener(e.XG4,this._onFocusOut),this._setFocusedTimer&&(b.clearTimeout(this._setFocusedTimer),delete this._setFocusedTimer),null==(a=this._dummyManager)||a.dispose(),this._remove()}moveOutWithDefaultAction(a,b){let c=this._dummyManager;if(c)c.moveOutWithDefaultAction(a,b);else{let c=this.getElement();c&&ab.moveWithPhantomDummy(this._tabster,c,!0,a,b)}}_add(){}_remove(){}}class ad{constructor(a,b){this._autoRootWaiting=!1,this._roots={},this._forceDummy=!1,this.rootById={},this._autoRootCreate=()=>{var a;let b=this._win().document,c=b.body;if(c){this._autoRootUnwait(b);let d=this._autoRoot;if(d)return!function(a,b,c){let d;if(c){let b=a.getAttribute(f);if(b)try{d=JSON.parse(b)}catch(a){}}d||(d={});var e=d;for(let a of Object.keys(b)){let c=b[a];c?e[a]=c:delete e[a]}Object.keys(d).length>0?a.setAttribute(f,aa(d,!0)):a.removeAttribute(f)}(c,{root:d},!0),l(this._tabster,c),null==(a=k(this._tabster,c))?void 0:a.root}else this._autoRootWaiting||(this._autoRootWaiting=!0,b.addEventListener("readystatechange",this._autoRootCreate))},this._onRootDispose=a=>{delete this._roots[a.id]},this._tabster=a,this._win=a.getWindow,this._autoRoot=b,a.queueInit(()=>{this._autoRoot&&this._autoRootCreate()})}_autoRootUnwait(a){a.removeEventListener("readystatechange",this._autoRootCreate),this._autoRootWaiting=!1}dispose(){let a=this._win();this._autoRootUnwait(a.document),delete this._autoRoot,Object.keys(this._roots).forEach(a=>{this._roots[a]&&(this._roots[a].dispose(),delete this._roots[a])}),this.rootById={}}createRoot(a,b,c){let d=new ac(this._tabster,a,this._onRootDispose,b,c);return this._roots[d.id]=d,this._forceDummy&&d.addDummyInputs(),d}addDummyInputs(){this._forceDummy=!0;let a=this._roots;for(let b of Object.keys(a))a[b].addDummyInputs()}static getRootByUId(a,b){let c=a().__tabsterInstance;return c&&c.root.rootById[b]}static getTabsterContext(a,b,c){var d,e,f,g;let h,i,j,l,m,n,o,p;if(void 0===c&&(c={}),!b.ownerDocument)return;let{checkRtl:q,referenceElement:r}=c,s=a.getParent;a.drainInitQueue();let t=!1,u=r||b,v={};for(;u&&(!h||q);){let c=k(a,u);if(q&&void 0===o){let a=u.dir;a&&(o="rtl"===a.toLowerCase())}if(!c){u=s(u);continue}let g=u.tagName;(c.uncontrolled||"IFRAME"===g||"WEBVIEW"===g)&&a.focusable.isVisible(u)&&(p=u),!l&&(null==(d=c.focusable)?void 0:d.excludeFromMover)&&!j&&(t=!0);let r=c.modalizer,w=c.groupper,x=c.mover;!i&&r&&(i=r),!j&&w&&(!i||r)&&(i?(!w.isActive()&&w.getProps().tabbability&&i.userId!==(null==(e=a.modalizer)?void 0:e.activeId)&&(i=void 0,j=w),n=w):j=w),!l&&x&&(!i||r)&&(!w||u!==b)&&u.contains(b)&&(l=x,m=!!j&&j!==w),c.root&&(h=c.root),(null==(f=c.focusable)?void 0:f.ignoreKeydown)&&Object.assign(v,c.focusable.ignoreKeydown),u=s(u)}if(!h){let c=a.root;c._autoRoot&&(null==(g=b.ownerDocument)?void 0:g.body)&&(h=c._autoRootCreate())}return j&&!l&&(m=!0),h?{root:h,modalizer:i,groupper:j,mover:l,groupperBeforeMover:m,modalizerInGroupper:n,rtl:q?!!o:void 0,uncontrolled:p,excludedFromMover:t,ignoreKeydown:a=>!!v[a.key]}:void 0}static getRoot(a,b){var c;let d=a.getParent;for(let e=b;e;e=d(e)){let b=null==(c=k(a,e))?void 0:c.root;if(b)return b}}onRoot(a,b){b?delete this.rootById[a.uid]:this.rootById[a.uid]=a}}class ae{constructor(){this._callbacks=[]}dispose(){this._callbacks=[],delete this._val}subscribe(a){let b=this._callbacks;0>b.indexOf(a)&&b.push(a)}subscribeFirst(a){let b=this._callbacks,c=b.indexOf(a);c>=0&&b.splice(c,1),b.unshift(a)}unsubscribe(a){let b=this._callbacks.indexOf(a);b>=0&&this._callbacks.splice(b,1)}setVal(a,b){this._val!==a&&(this._val=a,this._callCallbacks(a,b))}getVal(){return this._val}trigger(a,b){this._callCallbacks(a,b)}_callCallbacks(a,b){this._callbacks.forEach(c=>c(a,b))}}class af{constructor(a){this._tabster=a}dispose(){}getProps(a){let b=k(this._tabster,a);return b&&b.focusable||{}}isFocusable(a,b,c,d){return!!R(a,g)&&(!!b||-1!==a.tabIndex)&&(c||this.isVisible(a))&&(d||this.isAccessible(a))}isVisible(a){var b,c;let d,e;if(!a.ownerDocument||a.nodeType!==Node.ELEMENT_NODE||(e=null==(b=(d=a.ownerDocument).defaultView)?void 0:b.getComputedStyle(a),null===a.offsetParent&&d.body!==a&&(null==e?void 0:e.position)!=="fixed"||(null==e?void 0:e.visibility)==="hidden"||(null==e?void 0:e.position)==="fixed"&&("none"===e.display||(null==(c=a.parentElement)?void 0:c.offsetParent)===null&&d.body!==a.parentElement)||0))return!1;let f=a.ownerDocument.body.getBoundingClientRect();return 0!==f.width||0!==f.height}isAccessible(a){var b;for(let c=a;c;c=C.getParentElement(c)){let a=k(this._tabster,c);if(this._isHidden(c)||!(null==(b=null==a?void 0:a.focusable)?void 0:b.ignoreAriaDisabled)&&this._isDisabled(c))return!1}return!0}_isDisabled(a){return a.hasAttribute("disabled")}_isHidden(a){var b;let c=a.getAttribute("aria-hidden");return!(!c||"true"!==c.toLowerCase()||(null==(b=this._tabster.modalizer)?void 0:b.isAugmented(a)))}findFirst(a,b){return this.findElement({...a},b)}findLast(a,b){return this.findElement({isBackward:!0,...a},b)}findNext(a,b){return this.findElement({...a},b)}findPrev(a,b){return this.findElement({...a,isBackward:!0},b)}findDefault(a,b){return this.findElement({...a,acceptCondition:b=>this.isFocusable(b,a.includeProgrammaticallyFocusable)&&!!this.getProps(b).isDefault},b)||null}findAll(a){return this._findElements(!0,a)||[]}findElement(a,b){let c=this._findElements(!1,a,b);return c?c[0]:c}_findElements(a,b,c){var d,e,f;let{container:g,currentElement:h=null,includeProgrammaticallyFocusable:i,useActiveModalizer:j,ignoreAccessibility:k,modalizerId:l,isBackward:m,onElement:n}=b;c||(c={});let o=[],{acceptCondition:p}=b,q=!!p;if(!g)return null;p||(p=a=>this.isFocusable(a,i,!1,k));let r={container:g,modalizerUserId:void 0===l&&j?null==(d=this._tabster.modalizer)?void 0:d.activeId:l||(null==(f=null==(e=ad.getTabsterContext(this._tabster,g))?void 0:e.modalizer)?void 0:f.userId),from:h||g,isBackward:m,isFindAll:a,acceptCondition:p,hasCustomCondition:q,includeProgrammaticallyFocusable:i,ignoreAccessibility:k,cachedGrouppers:{},cachedRadioGroups:{}},s=J(g.ownerDocument,g,a=>this._acceptElement(a,r));if(!s)return null;let t=b=>{var d,e;let f=null!=(d=r.foundElement)?d:r.foundBackward;return(f&&o.push(f),a)?(!f||(r.found=!1,delete r.foundElement,delete r.foundBackward,delete r.fromCtx,r.from=f,!n||!!n(f)))&&!!(f||b):(f&&c&&(c.uncontrolled=null==(e=ad.getTabsterContext(this._tabster,f))?void 0:e.uncontrolled),!!(b&&!f))};if(h||(c.outOfDOMOrder=!0),h&&C.nodeContains(g,h))s.currentNode=h;else if(m){let a=Y(g);if(!a)return null;if(this._acceptElement(a,r)===NodeFilter.FILTER_ACCEPT&&!t(!0))return r.skippedFocusable&&(c.outOfDOMOrder=!0),o;s.currentNode=a}do m?s.previousNode():s.nextNode();while(t())return r.skippedFocusable&&(c.outOfDOMOrder=!0),o.length?o:null}_acceptElement(a,b){var c,d,e;let f;if(b.found)return NodeFilter.FILTER_ACCEPT;let g=b.foundBackward;if(g&&(a===g||!C.nodeContains(g,a)))return b.found=!0,b.foundElement=g,NodeFilter.FILTER_ACCEPT;let h=b.container;if(a===h)return NodeFilter.FILTER_SKIP;if(!C.nodeContains(h,a)||_(a)||C.nodeContains(b.rejectElementsFrom,a))return NodeFilter.FILTER_REJECT;let i=b.currentCtx=ad.getTabsterContext(this._tabster,a);if(!i)return NodeFilter.FILTER_SKIP;if(N(a))return this.isFocusable(a,void 0,!0,!0)&&(b.skippedFocusable=!0),NodeFilter.FILTER_SKIP;if(!b.hasCustomCondition&&("IFRAME"===a.tagName||"WEBVIEW"===a.tagName))if(this.isVisible(a)&&(null==(c=i.modalizer)?void 0:c.userId)===(null==(d=this._tabster.modalizer)?void 0:d.activeId))return b.found=!0,b.rejectElementsFrom=b.foundElement=a,NodeFilter.FILTER_ACCEPT;else return NodeFilter.FILTER_REJECT;if(!b.ignoreAccessibility&&!this.isAccessible(a))return this.isFocusable(a,!1,!0,!0)&&(b.skippedFocusable=!0),NodeFilter.FILTER_REJECT;let j=b.fromCtx;j||(j=b.fromCtx=ad.getTabsterContext(this._tabster,b.from));let k=null==j?void 0:j.mover,l=i.groupper,m=i.mover;if(void 0!==(f=null==(e=this._tabster.modalizer)?void 0:e.acceptElement(a,b))&&(b.skippedFocusable=!0),void 0===f&&(l||m||k)){let c=null==l?void 0:l.getElement(),d=null==k?void 0:k.getElement(),e=null==m?void 0:m.getElement();if(e&&C.nodeContains(d,e)&&C.nodeContains(h,d)&&(!c||!m||C.nodeContains(d,c))&&(m=k,e=d),c)if(c!==h&&C.nodeContains(h,c)){if(!C.nodeContains(c,a))return NodeFilter.FILTER_REJECT}else l=void 0;if(e)if(C.nodeContains(h,e)){if(!C.nodeContains(e,a))return NodeFilter.FILTER_REJECT}else m=void 0;l&&m&&(e&&c&&!C.nodeContains(c,e)?m=void 0:l=void 0),l&&(f=l.acceptElement(a,b)),m&&(f=m.acceptElement(a,b))}if(void 0===f&&(f=b.acceptCondition(a)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP)===NodeFilter.FILTER_SKIP&&this.isFocusable(a,!1,!0,!0)&&(b.skippedFocusable=!0),f===NodeFilter.FILTER_ACCEPT&&!b.found){if(!b.isFindAll&&$(a)&&!a.checked){let c=a.name,d=b.cachedRadioGroups[c];if(!d&&(d=function(a){let b;if(!$(a))return;let c=a.name,d=Array.from(C.getElementsByName(a,c));return{name:c,buttons:new Set(d=d.filter(a=>!!$(a)&&(a.checked&&(b=a),!0))),checked:b}}(a))&&(b.cachedRadioGroups[c]=d),(null==d?void 0:d.checked)&&d.checked!==a)return NodeFilter.FILTER_SKIP}b.isBackward?(b.foundBackward=a,f=NodeFilter.FILTER_SKIP):(b.found=!0,b.foundElement=a)}return f}}let ag="Enter",ah="Escape",ai="Home",aj="ArrowLeft",ak="ArrowUp",al="ArrowRight",am="ArrowDown",an={2:0,3:1,1:2};class ao extends ae{constructor(a,b){super(),this._init=()=>{let a=this._win(),b=a.document;b.addEventListener(e.pMf,this._onFocusIn,!0),b.addEventListener(e.XG4,this._onFocusOut,!0),a.addEventListener("keydown",this._onKeyDown,!0);let c=C.getActiveElement(b);c&&c!==b.body&&this._setFocusedElement(c),this.subscribe(this._onChanged)},this._onFocusIn=a=>{let b=a.composedPath()[0];b&&this._setFocusedElement(b,a.detail.relatedTarget,a.detail.isFocusedProgrammatically)},this._onFocusOut=a=>{var b;this._setFocusedElement(void 0,null==(b=a.detail)?void 0:b.originalEvent.relatedTarget)},this._validateFocusedElement=a=>{},this._onKeyDown=a=>{if("Tab"!==a.key||a.ctrlKey)return;let b=this.getVal();if(!b||!b.ownerDocument||"true"===b.contentEditable)return;let c=this._tabster,d=c.controlTab,f=ad.getTabsterContext(c,b);if(!f||f.ignoreKeydown(a))return;let g=a.shiftKey,h=ao.findNextTabbable(c,f,void 0,b,void 0,g,!0),i=f.root.getElement();if(!i)return;let j=null==h?void 0:h.element,l=function(a,b){var c;let d=a.getParent,e=b;do{let b=null==(c=k(a,e))?void 0:c.uncontrolled;if(b&&a.uncontrolled.isUncontrolledCompletely(e,!!b.completely))return e;e=d(e)}while(e)}(c,b);if(j){let k=h.uncontrolled;if(f.uncontrolled||C.nodeContains(k,b)){if(!h.outOfDOMOrder&&k===f.uncontrolled||l&&!C.nodeContains(l,j))return;V.addPhantomDummyWithTarget(c,b,g,j);return}if(k&&c.focusable.isVisible(k)||"IFRAME"===j.tagName&&c.focusable.isVisible(j)){i.dispatchEvent(new v({by:"root",owner:i,next:j,relatedEvent:a}))&&V.moveWithPhantomDummy(c,null!=k?k:j,!1,g,a);return}(d||(null==h?void 0:h.outOfDOMOrder))&&i.dispatchEvent(new v({by:"root",owner:i,next:j,relatedEvent:a}))&&(a.preventDefault(),a.stopImmediatePropagation(),(0,e.MHx)(j))}else!l&&i.dispatchEvent(new v({by:"root",owner:i,next:null,relatedEvent:a}))&&f.root.moveOutWithDefaultAction(g,a)},this._onChanged=(a,b)=>{var c,d;if(a)a.dispatchEvent(new t(b));else{let a=null==(c=this._lastVal)?void 0:c.get();if(a){let c={...b},e=ad.getTabsterContext(this._tabster,a),f=null==(d=null==e?void 0:e.modalizer)?void 0:d.userId;f&&(c.modalizerId=f),a.dispatchEvent(new u(c))}}},this._tabster=a,this._win=b,a.queueInit(this._init)}dispose(){super.dispose();let a=this._win(),b=a.document;b.removeEventListener(e.pMf,this._onFocusIn,!0),b.removeEventListener(e.XG4,this._onFocusOut,!0),a.removeEventListener("keydown",this._onKeyDown,!0),this.unsubscribe(this._onChanged);let c=this._asyncFocus;c&&(a.clearTimeout(c.timeout),delete this._asyncFocus),delete ao._lastResetElement,delete this._nextVal,delete this._lastVal}static forgetMemorized(a,b){var c,d;let e=ao._lastResetElement,f=e&&e.get();f&&C.nodeContains(b,f)&&delete ao._lastResetElement,(f=null==(d=null==(c=a._nextVal)?void 0:c.element)?void 0:d.get())&&C.nodeContains(b,f)&&delete a._nextVal,(f=(e=a._lastVal)&&e.get())&&C.nodeContains(b,f)&&delete a._lastVal}getFocusedElement(){return this.getVal()}getLastFocusedElement(){var a;let b=null==(a=this._lastVal)?void 0:a.get();return b&&(!b||Q(b.ownerDocument,b))||(this._lastVal=b=void 0),b}focus(a,b,c,d){return!!this._tabster.focusable.isFocusable(a,b,!1,c)&&(a.focus({preventScroll:d}),!0)}focusDefault(a){let b=this._tabster.focusable.findDefault({container:a});return!!b&&(this._tabster.focusedElement.focus(b),!0)}getFirstOrLastTabbable(a,b){var c;let d,{container:e,ignoreAccessibility:f}=b;if(e){let b=ad.getTabsterContext(this._tabster,e);b&&(d=null==(c=ao.findNextTabbable(this._tabster,b,e,void 0,void 0,!a,f))?void 0:c.element)}return d&&!C.nodeContains(e,d)&&(d=void 0),d||void 0}_focusFirstOrLast(a,b){let c=this.getFirstOrLastTabbable(a,b);return!!c&&(this.focus(c,!1,!0),!0)}focusFirst(a){return this._focusFirstOrLast(!0,a)}focusLast(a){return this._focusFirstOrLast(!1,a)}resetFocus(a){if(!this._tabster.focusable.isVisible(a))return!1;if(this._tabster.focusable.isFocusable(a,!0,!0,!0))this.focus(a);else{let b=a.getAttribute("tabindex"),c=a.getAttribute("aria-hidden");a.tabIndex=-1,a.setAttribute("aria-hidden","true"),ao._lastResetElement=new H(this._win,a),this.focus(a,!0,!0),this._setOrRemoveAttribute(a,"tabindex",b),this._setOrRemoveAttribute(a,"aria-hidden",c)}return!0}requestAsyncFocus(a,b,c){let d=this._tabster.getWindow(),e=this._asyncFocus;if(e){if(an[a]>an[e.source])return;d.clearTimeout(e.timeout)}this._asyncFocus={source:a,callback:b,timeout:d.setTimeout(()=>{this._asyncFocus=void 0,b()},c)}}cancelAsyncFocus(a){let b=this._asyncFocus;(null==b?void 0:b.source)===a&&(this._tabster.getWindow().clearTimeout(b.timeout),this._asyncFocus=void 0)}_setOrRemoveAttribute(a,b,c){null===c?a.removeAttribute(b):a.setAttribute(b,c)}_setFocusedElement(a,b,c){var d,e;if(this._tabster._noop)return;let f={relatedTarget:b};if(a){let b=null==(d=ao._lastResetElement)?void 0:d.get();if(ao._lastResetElement=void 0,b===a||N(a))return;f.isFocusedProgrammatically=c;let g=ad.getTabsterContext(this._tabster,a),h=null==(e=null==g?void 0:g.modalizer)?void 0:e.userId;h&&(f.modalizerId=h)}let g=this._nextVal={element:a?new H(this._win,a):void 0,detail:f};a&&a!==this._val&&this._validateFocusedElement(a),this._nextVal===g&&this.setVal(a,f),this._nextVal=void 0}setVal(a,b){super.setVal(a,b),a&&(this._lastVal=new H(this._win,a))}static findNextTabbable(a,b,c,d,e,f,g){let h=c||b.root.getElement();if(!h)return null;let i=null,j=ao._isTabbingTimer,k=a.getWindow();j&&k.clearTimeout(j),ao.isTabbing=!0,ao._isTabbingTimer=k.setTimeout(()=>{delete ao._isTabbingTimer,ao.isTabbing=!1},0);let l=b.modalizer,m=b.groupper,n=b.mover,o=b=>{if(i=b.findNextTabbable(d,e,f,g),d&&!(null==i?void 0:i.element)){let e=b!==l&&C.getParentElement(b.getElement());if(e){let h=ad.getTabsterContext(a,d,{referenceElement:e});if(h){let d=b.getElement(),j=f?d:d&&Y(d)||d;j&&(i=ao.findNextTabbable(a,h,c,j,e,f,g))&&(i.outOfDOMOrder=!0)}}}};if(m&&n)o(b.groupperBeforeMover?m:n);else if(m)o(m);else if(n)o(n);else if(l)o(l);else{let b={};i={element:a.focusable[f?"findPrev":"findNext"]({container:h,currentElement:d,referenceElement:e,ignoreAccessibility:g,useActiveModalizer:!0},b),outOfDOMOrder:b.outOfDOMOrder,uncontrolled:b.uncontrolled}}return i}}ao.isTabbing=!1;class ap extends V{constructor(a,b,c,d){super(c,a,4,d,!0),this._setHandlers((d,f,g)=>{var h,i;let j=a.get(),k=d.input;if(j&&k){let a=ad.getTabsterContext(c,k);if(a){let l;(l=null==(h=b.findNextTabbable(g||void 0,void 0,f,!0))?void 0:h.element)||(l=null==(i=ao.findNextTabbable(c,a,void 0,d.isOutside?k:function(a,b){let c=a,d=null;for(;c&&!d;)d=b?C.getPreviousElementSibling(c):C.getNextElementSibling(c),c=C.getParentElement(c);return d||void 0}(j,!f),void 0,f,!0))?void 0:i.element),l&&(0,e.MHx)(l)}}})}}class aq extends T{constructor(a,b,c,d,e){super(a,b,d),this._shouldTabInside=!1,this.makeTabbable(!1),this._onDispose=c,a.controlTab||(this.dummyManager=new ap(this._element,this,a,e))}dispose(){var a;this._onDispose(this),this._element.get(),null==(a=this.dummyManager)||a.dispose(),delete this.dummyManager,delete this._first}findNextTabbable(a,b,c,d){let e,f=this.getElement();if(!f)return null;let g=_(a)===f;if(!this._shouldTabInside&&a&&C.nodeContains(f,a)&&!g)return{element:void 0,outOfDOMOrder:!0};let h=this.getFirst(!0);if(!a||!C.nodeContains(f,a)||g)return{element:h,outOfDOMOrder:!0};let i=this._tabster,k=null,l=!1;if(this._shouldTabInside&&h){let g={};k=i.focusable[c?"findPrev":"findNext"]({container:f,currentElement:a,referenceElement:b,ignoreAccessibility:d,useActiveModalizer:!0},g),l=!!g.outOfDOMOrder,k||this._props.tabbability!==j.LimitedTrapFocus||(k=i.focusable[c?"findLast":"findFirst"]({container:f,ignoreAccessibility:d,useActiveModalizer:!0},g),l=!0),e=g.uncontrolled}return{element:k,uncontrolled:e,outOfDOMOrder:l}}makeTabbable(a){this._shouldTabInside=a||!this._props.tabbability}isActive(a){var b;let c=this.getElement()||null,d=!0;for(let a=C.getParentElement(c);a;a=C.getParentElement(a)){let c=null==(b=k(this._tabster,a))?void 0:b.groupper;c&&!c._shouldTabInside&&(d=!1)}let e=d?!!this._props.tabbability&&this._shouldTabInside:void 0;if(e&&a){let a=this._tabster.focusedElement.getFocusedElement();a&&(e=a!==this.getFirst(!0))}return e}getFirst(a){var b;let c,d=this.getElement();if(d){if(a&&this._tabster.focusable.isFocusable(d))return d;!(c=null==(b=this._first)?void 0:b.get())&&(c=this._tabster.focusable.findFirst({container:d,useActiveModalizer:!0})||void 0)&&this.setFirst(c)}return c}setFirst(a){a?this._first=new H(this._tabster.getWindow,a):delete this._first}acceptElement(a,b){let c,d=b.cachedGrouppers,e=C.getParentElement(this.getElement()),f=e&&ad.getTabsterContext(this._tabster,e),g=null==f?void 0:f.groupper,h=(null==f?void 0:f.groupperBeforeMover)?g:void 0,i=a=>{let b,c=d[a.id];return c?b=c.isActive:(b=this.isActive(!0),c=d[a.id]={isActive:b}),b};if(h&&(c=h.getElement(),!i(h)&&c&&b.container!==c&&C.nodeContains(b.container,c)))return b.skippedFocusable=!0,NodeFilter.FILTER_REJECT;let j=i(this),k=this.getElement();if(k&&!0!==j){let e;if(k===a&&g&&(c||(c=g.getElement()),c&&!i(g)&&C.nodeContains(b.container,c)&&c!==b.container)||k!==a&&C.nodeContains(k,a))return b.skippedFocusable=!0,NodeFilter.FILTER_REJECT;let f=d[this.id];if((e="first"in f?f.first:f.first=this.getFirst(!0))&&b.acceptCondition(e))return(b.rejectElementsFrom=k,b.skippedFocusable=!0,e!==b.from)?(b.found=!0,b.foundElement=e,NodeFilter.FILTER_ACCEPT):NodeFilter.FILTER_REJECT}}}class ar{constructor(a,b){this._current={},this._grouppers={},this._init=()=>{let a=this._win();this._tabster.focusedElement.subscribeFirst(this._onFocus);let b=a.document,c=C.getActiveElement(b);c&&this._onFocus(c),b.addEventListener("mousedown",this._onMouseDown,!0),a.addEventListener("keydown",this._onKeyDown,!0),a.addEventListener(p,this._onMoveFocus)},this._onGroupperDispose=a=>{delete this._grouppers[a.id]},this._onFocus=a=>{a&&this._updateCurrent(a)},this._onMouseDown=a=>{let b=a.target;for(;b&&!this._tabster.focusable.isFocusable(b);)b=this._tabster.getParent(b);b&&this._updateCurrent(b)},this._onKeyDown=a=>{if(a.key!==ag&&a.key!==ah||a.ctrlKey||a.altKey||a.shiftKey||a.metaKey)return;let b=this._tabster.focusedElement.getFocusedElement();b&&this.handleKeyPress(b,a)},this._onMoveFocus=a=>{var b;let c=a.composedPath()[0],d=null==(b=a.detail)?void 0:b.action;c&&void 0!==d&&!a.defaultPrevented&&(1===d?this._enterGroupper(c):this._escapeGroupper(c),a.stopImmediatePropagation())},this._tabster=a,this._win=b,a.queueInit(this._init)}dispose(){let a=this._win();this._tabster.focusedElement.cancelAsyncFocus(1),this._current={},this._updateTimer&&(a.clearTimeout(this._updateTimer),delete this._updateTimer),this._tabster.focusedElement.unsubscribe(this._onFocus),a.document.removeEventListener("mousedown",this._onMouseDown,!0),a.removeEventListener("keydown",this._onKeyDown,!0),a.removeEventListener(p,this._onMoveFocus),Object.keys(this._grouppers).forEach(a=>{this._grouppers[a]&&(this._grouppers[a].dispose(),delete this._grouppers[a])})}createGroupper(a,b,c){let d=this._tabster,e=new aq(d,a,this._onGroupperDispose,b,c);this._grouppers[e.id]=e;let f=d.focusedElement.getFocusedElement();return f&&C.nodeContains(a,f)&&!this._updateTimer&&(this._updateTimer=this._win().setTimeout(()=>{delete this._updateTimer,f===d.focusedElement.getFocusedElement()&&this._updateCurrent(f)},0)),e}forgetCurrentGrouppers(){this._current={}}_updateCurrent(a){var b;this._updateTimer&&(this._win().clearTimeout(this._updateTimer),delete this._updateTimer);let c=this._tabster,d={};for(let e=c.getParent(a);e;e=c.getParent(e)){let f=null==(b=k(c,e))?void 0:b.groupper;if(f){d[f.id]=!0,this._current[f.id]=f;let b=f.isActive()||a!==e&&(!f.getProps().delegated||f.getFirst(!1)!==a);f.makeTabbable(b)}}for(let a of Object.keys(this._current)){let b=this._current[a];b.id in d||(b.makeTabbable(!1),b.setFirst(void 0),delete this._current[a])}}_enterGroupper(a,b){let c=this._tabster,d=ad.getTabsterContext(c,a),e=(null==d?void 0:d.groupper)||(null==d?void 0:d.modalizerInGroupper),f=null==e?void 0:e.getElement();if(e&&f&&(a===f||e.getProps().delegated&&a===e.getFirst(!1))){let d=c.focusable.findNext({container:f,currentElement:a,useActiveModalizer:!0});if(d&&(!b||b&&f.dispatchEvent(new v({by:"groupper",owner:f,next:d,relatedEvent:b}))))return b&&(b.preventDefault(),b.stopImmediatePropagation()),d.focus(),d}return null}_escapeGroupper(a,b,c){let d=this._tabster,e=ad.getTabsterContext(d,a),f=(null==e?void 0:e.groupper)||(null==e?void 0:e.modalizerInGroupper),g=null==f?void 0:f.getElement();if(f&&g&&C.nodeContains(g,a)){let e;if(a!==g||c)e=f.getFirst(!0);else{let a=C.getParentElement(g),b=a?ad.getTabsterContext(d,a):void 0;e=null==(f=null==b?void 0:b.groupper)?void 0:f.getFirst(!0)}if(e&&(!b||b&&g.dispatchEvent(new v({by:"groupper",owner:g,next:e,relatedEvent:b}))))return f&&f.makeTabbable(!1),e.focus(),e}return null}moveFocus(a,b){return 1===b?this._enterGroupper(a):this._escapeGroupper(a)}handleKeyPress(a,b,c){let d=this._tabster,e=ad.getTabsterContext(d,a);if(e&&((null==e?void 0:e.groupper)||(null==e?void 0:e.modalizerInGroupper))){if(d.focusedElement.cancelAsyncFocus(1),e.ignoreKeydown(b))return;if(b.key===ag)this._enterGroupper(a,b);else if(b.key===ah){let e=d.focusedElement.getFocusedElement();d.focusedElement.requestAsyncFocus(1,()=>{(e===d.focusedElement.getFocusedElement()||(!c||e)&&c)&&this._escapeGroupper(a,b,c)},0)}}}}class as extends ae{constructor(a){super(),this._onChange=a=>{this.setVal(a,void 0)},this._keyborg=(0,e.Uih)(a()),this._keyborg.subscribe(this._onChange)}dispose(){super.dispose(),this._keyborg&&(this._keyborg.unsubscribe(this._onChange),(0,e.upw)(this._keyborg),delete this._keyborg)}setNavigatingWithKeyboard(a){var b;null==(b=this._keyborg)||b.setVal(a)}isNavigatingWithKeyboard(){var a;return!!(null==(a=this._keyborg)?void 0:a.isNavigatingWithKeyboard())}}let at=0,au="aria-hidden";class av extends V{constructor(a,b,c){super(b,a,2,c),this._setHandlers((c,d)=>{var f,g;let h,i=a.get(),j=i&&(null==(f=ad.getRoot(b,i))?void 0:f.getElement()),k=c.input;if(j&&k){let a=_(k),c=ad.getTabsterContext(b,a||k);c&&(h=null==(g=ao.findNextTabbable(b,c,j,k,void 0,d,!0))?void 0:g.element),h&&(0,e.MHx)(h)}})}}class aw extends T{constructor(a,b,c,d,e,f){super(a,b,d),this._wasFocused=0,this.userId=d.id,this._onDispose=c,this._activeElements=f,a.controlTab||(this.dummyManager=new av(this._element,a,e))}makeActive(a){if(this._isActive!==a){this._isActive=a;let b=this.getElement();if(b){let c=this._activeElements,d=c.map(a=>a.get()).indexOf(b);a?d<0&&c.push(new H(this._tabster.getWindow,b)):d>=0&&c.splice(d,1)}this._dispatchEvent(a)}}focused(a){return a||(this._wasFocused=++at),this._wasFocused}setProps(a){a.id&&(this.userId=a.id),this._props={...a}}dispose(){var a;this.makeActive(!1),this._onDispose(this),null==(a=this.dummyManager)||a.dispose(),delete this.dummyManager,this._activeElements=[],this._remove()}isActive(){return!!this._isActive}contains(a){return C.nodeContains(this.getElement(),a)}findNextTabbable(a,b,c,d){var e,f;let g;if(!this.getElement())return null;let h=this._tabster,i=null,j=!1,k=a&&(null==(e=ad.getRoot(h,a))?void 0:e.getElement());if(k){let e={};!(i=h.focusable[c?"findPrev":"findNext"]({container:k,currentElement:a,referenceElement:b,ignoreAccessibility:d,useActiveModalizer:!0},e))&&this._props.isTrapped&&(null==(f=h.modalizer)?void 0:f.activeId)?(null===(i=h.focusable[c?"findLast":"findFirst"]({container:k,ignoreAccessibility:d,useActiveModalizer:!0},e))&&(i=a),j=!0):j=!!e.outOfDOMOrder,g=e.uncontrolled}return{element:i,uncontrolled:g,outOfDOMOrder:j}}_dispatchEvent(a,b){let c=this.getElement(),d=!1;if(c){for(let e of b?this._activeElements.map(a=>a.get()):[c])if(e){let b={id:this.userId,element:c},f=a?new x(b):new y(b);e.dispatchEvent(f),f.defaultPrevented&&(d=!0)}}return d}_remove(){}}class ax{constructor(a,b,c){this._onModalizerDispose=a=>{let b=a.id,c=a.userId,d=this._parts[c];if(delete this._modalizers[b],d&&(delete d[b],0===Object.keys(d).length)){let a;delete this._parts[c];let b=this._activationHistory,d=[];for(let e=b.length;e--;){let f=b[e];f!==c&&f!==a&&(a=f,(f||d.length>0)&&d.unshift(f))}if(this._activationHistory=d,this.activeId===c){let a=d[0],b=a?Object.values(this._parts[a])[0]:void 0;this.setActive(b)}}},this._onKeyDown=a=>{var b;if(a.key!==ah)return;let c=this._tabster,d=c.focusedElement.getFocusedElement();if(d){let e=ad.getTabsterContext(c,d),f=null==e?void 0:e.modalizer;if(e&&!e.groupper&&(null==f?void 0:f.isActive())&&!e.ignoreKeydown(a)){let d=f.userId;if(d){let e=this._parts[d];if(e){let d=Object.keys(e).map(a=>{var b;let d,f=e[a],g=f.getElement();return g&&(d=null==(b=k(c,g))?void 0:b.groupper),f&&g&&d?{el:g,focusedSince:f.focused(!0)}:{focusedSince:0}}).filter(a=>a.focusedSince>0).sort((a,b)=>a.focusedSince>b.focusedSince?-1:+(a.focusedSince<b.focusedSince));if(d.length){let e=d[0].el;e&&(null==(b=c.groupper)||b.handleKeyPress(e,a,!0))}}}}}},this._onFocus=(a,b)=>{var c;let d=this._tabster,e=a&&ad.getTabsterContext(d,a);if(!e||!a)return;let f=this._augMap;for(let b=a;b;b=C.getParentElement(b))f.has(b)&&(f.delete(b),Z(d,b,au));let g=e.modalizer,h=k(d,a),i=null==h?void 0:h.modalizer;if(i&&(i.focused(),i.userId===this.activeId&&h.groupper)){let b=d.getParent(a),e=b&&(null==(c=ad.getTabsterContext(d,b))?void 0:c.modalizer);if(!e)return void this.setActive(void 0);g=e}if(null==g||g.focused(),(null==g?void 0:g.userId)===this.activeId){this.currentIsOthersAccessible=null==g?void 0:g.getProps().isOthersAccessible;return}if(b.isFocusedProgrammatically||this.currentIsOthersAccessible||(null==g?void 0:g.getProps().isAlwaysAccessible))this.setActive(g);else{let b=this._win();b.clearTimeout(this._restoreModalizerFocusTimer),this._restoreModalizerFocusTimer=b.setTimeout(()=>this._restoreModalizerFocus(a),100)}},this._tabster=a,this._win=a.getWindow,this._modalizers={},this._parts={},this._augMap=new WeakMap,this._aug=[],this._alwaysAccessibleSelector=b,this._accessibleCheck=c,this._activationHistory=[],this.activeElements=[],a.controlTab||a.root.addDummyInputs(),this._win().addEventListener("keydown",this._onKeyDown,!0),a.queueInit(()=>{this._tabster.focusedElement.subscribe(this._onFocus)})}dispose(){let a=this._win();a.removeEventListener("keydown",this._onKeyDown,!0),Object.keys(this._modalizers).forEach(a=>{this._modalizers[a]&&(this._modalizers[a].dispose(),delete this._modalizers[a])}),a.clearTimeout(this._restoreModalizerFocusTimer),a.clearTimeout(this._hiddenUpdateTimer),this._parts={},delete this.activeId,this.activeElements=[],this._augMap=new WeakMap,this._aug=[],this._tabster.focusedElement.unsubscribe(this._onFocus)}createModalizer(a,b,c){var d;let e=new aw(this._tabster,a,this._onModalizerDispose,b,c,this.activeElements),f=e.id,g=b.id;this._modalizers[f]=e;let h=this._parts[g];h||(h=this._parts[g]={}),h[f]=e;let i=null!=(d=this._tabster.focusedElement.getFocusedElement())?d:null;return a!==i&&C.nodeContains(a,i)&&(g!==this.activeId?this.setActive(e):e.makeActive(!0)),e}isAugmented(a){return this._augMap.has(a)}hiddenUpdate(){this._hiddenUpdateTimer||(this._hiddenUpdateTimer=this._win().setTimeout(()=>{delete this._hiddenUpdateTimer,this._hiddenUpdate()},250))}setActive(a){let b=null==a?void 0:a.userId,c=this.activeId;if(c===b)return;if(this.activeId=b,c){let a=this._parts[c];if(a)for(let b of Object.keys(a))a[b].makeActive(!1)}if(b){let a=this._parts[b];if(a)for(let b of Object.keys(a))a[b].makeActive(!0)}this.currentIsOthersAccessible=null==a?void 0:a.getProps().isOthersAccessible,this.hiddenUpdate();let d=this._activationHistory;d[0]!==b&&(void 0!==b||d.length>0)&&d.unshift(b)}focus(a,b,c){let d=this._tabster,e=ad.getTabsterContext(d,a),f=null==e?void 0:e.modalizer;if(f){this.setActive(f);let a=f.getProps(),e=f.getElement();if(e){if(void 0===b&&(b=a.isNoFocusFirst),!b&&d.keyboardNavigation.isNavigatingWithKeyboard()&&d.focusedElement.focusFirst({container:e})||(void 0===c&&(c=a.isNoFocusDefault),!c&&d.focusedElement.focusDefault(e)))return!0;d.focusedElement.resetFocus(e)}}return!1}activate(a){var b;let c=a?null==(b=ad.getTabsterContext(this._tabster,a))?void 0:b.modalizer:void 0;return(!a||!!c)&&(this.setActive(c),!0)}acceptElement(a,b){var c;let d=b.modalizerUserId,e=null==(c=b.currentCtx)?void 0:c.modalizer;if(d)for(let b of this.activeElements){let c=b.get();if(c&&(C.nodeContains(a,c)||c===a))return NodeFilter.FILTER_SKIP}let f=d===(null==e?void 0:e.userId)||!d&&(null==e?void 0:e.getProps().isAlwaysAccessible)?void 0:NodeFilter.FILTER_SKIP;return void 0!==f&&(b.skippedFocusable=!0),f}_hiddenUpdate(){var a;let b=this._tabster,c=b.getWindow().document.body,d=this.activeId,e=this._parts,f=[],g=[],h=this._alwaysAccessibleSelector,i=h?Array.from(C.querySelectorAll(c,h)):[],j=[];for(let a of Object.keys(e)){let b=e[a];for(let c of Object.keys(b)){let e=b[c],h=e.getElement(),k=e.getProps().isAlwaysAccessible;h&&(a===d?(j.push(h),this.currentIsOthersAccessible||f.push(h)):k?i.push(h):g.push(h))}}let k=this._augMap,l=f.length>0?[...f,...i]:void 0,m=[],n=new WeakMap,o=(a,c)=>{var d;let e=a.tagName;if("SCRIPT"===e||"STYLE"===e)return;let f=!1;k.has(a)?c?f=!0:(k.delete(a),Z(b,a,au)):c&&!(null==(d=this._accessibleCheck)?void 0:d.call(this,a,j))&&Z(b,a,au,"true")&&(k.set(a,!0),f=!0),f&&(m.push(new H(b.getWindow,a)),n.set(a,!0))},p=a=>{var c;for(let d=C.getFirstElementChild(a);d;d=C.getNextElementSibling(d)){let a=!1,e=!1,f=!1;if(l){let g=b.getParent(d);for(let b of l){if(d===b){a=!0;break}if(C.nodeContains(d,b)){e=!0;break}C.nodeContains(b,g)&&(f=!0)}e||(null==(c=d.__tabsterElementFlags)?void 0:c.noDirectAriaHidden)?p(d):a||f||o(d,!0)}else o(d,!1)}};l||i.forEach(a=>o(a,!1)),g.forEach(a=>o(a,!0)),c&&p(c),null==(a=this._aug)||a.map(a=>a.get()).forEach(a=>{a&&!n.get(a)&&o(a,!1)}),this._aug=m,this._augMap=n}_restoreModalizerFocus(a){var b;let c=null==a?void 0:a.ownerDocument;if(!a||!c)return;let d=this._tabster.focusedElement.getFocusedElement(),e=d&&(null==(b=ad.getTabsterContext(this._tabster,d))?void 0:b.modalizer);if(!d||d&&(null==e?void 0:e.userId)===this.activeId)return;let f=this._tabster,g=ad.getTabsterContext(f,a),h=null==g?void 0:g.modalizer,i=this.activeId;if(!h&&!i||h&&i===h.userId)return;let j=null==g?void 0:g.root.getElement();if(j){let b=f.focusable.findFirst({container:j,useActiveModalizer:!0});if(b){if(a.compareDocumentPosition(b)&document.DOCUMENT_POSITION_PRECEDING&&!(b=f.focusable.findLast({container:j,useActiveModalizer:!0})))throw Error("Something went wrong.");f.focusedElement.focus(b);return}}a.blur()}}class ay extends V{constructor(a,b,c,d){super(b,a,3,d),this._onFocusDummyInput=a=>{var b,c;let d=this._element.get(),f=a.input;if(d&&f){let g,h=ad.getTabsterContext(this._tabster,d);h&&(g=null==(b=ao.findNextTabbable(this._tabster,h,void 0,f,void 0,!a.isFirst,!0))?void 0:b.element);let i=null==(c=this._getMemorized())?void 0:c.get();i&&this._tabster.focusable.isFocusable(i)&&(g=i),g&&(0,e.MHx)(g)}},this._tabster=b,this._getMemorized=c,this._setHandlers(this._onFocusDummyInput)}}class az extends T{constructor(a,b,c,d,e){var f;super(a,b,d),this._visible={},this._onIntersection=a=>{for(let b of a){let a,c=b.target,d=O(this._win,c),e=this._fullyVisible;if(b.intersectionRatio>=.25?2==(a=b.intersectionRatio>=.75?2:1)&&(e=d):a=0,this._visible[d]!==a){void 0===a?(delete this._visible[d],e===d&&delete this._fullyVisible):(this._visible[d]=a,this._fullyVisible=e);let b=this.getState(c);b&&c.dispatchEvent(new w(b))}}},this._win=a.getWindow,this.visibilityTolerance=null!=(f=d.visibilityTolerance)?f:.8,(this._props.trackState||this._props.visibilityAware)&&(this._intersectionObserver=new IntersectionObserver(this._onIntersection,{threshold:[0,.25,.5,.75,1]}),this._observeState()),this._onDispose=c;const g=()=>d.memorizeCurrent?this._current:void 0;a.controlTab||(this.dummyManager=new ay(this._element,a,g,e))}dispose(){var a;this._onDispose(this),this._intersectionObserver&&(this._intersectionObserver.disconnect(),delete this._intersectionObserver),delete this._current,delete this._fullyVisible,delete this._allElements,delete this._updateQueue,this._unobserve&&(this._unobserve(),delete this._unobserve);let b=this._win();this._setCurrentTimer&&(b.clearTimeout(this._setCurrentTimer),delete this._setCurrentTimer),this._updateTimer&&(b.clearTimeout(this._updateTimer),delete this._updateTimer),null==(a=this.dummyManager)||a.dispose(),delete this.dummyManager}setCurrent(a){a?this._current=new H(this._win,a):this._current=void 0,(this._props.trackState||this._props.visibilityAware)&&!this._setCurrentTimer&&(this._setCurrentTimer=this._win().setTimeout(()=>{var a;delete this._setCurrentTimer;let b=[];for(let c of(this._current!==this._prevCurrent&&(b.push(this._current),b.push(this._prevCurrent),this._prevCurrent=this._current),b)){let b=null==c?void 0:c.get();if(b&&(null==(a=this._allElements)?void 0:a.get(b))===this){let a=this._props;if(b&&(void 0!==a.visibilityAware||a.trackState)){let a=this.getState(b);a&&b.dispatchEvent(new w(a))}}}}))}getCurrent(){var a;return(null==(a=this._current)?void 0:a.get())||null}findNextTabbable(a,b,c,d){let e,f=this.getElement(),g=f&&_(a)===f;if(!f)return null;let h=null,i=!1;if(this._props.tabbable||g||a&&!C.nodeContains(f,a)){let g={};h=this._tabster.focusable[c?"findPrev":"findNext"]({currentElement:a,referenceElement:b,container:f,ignoreAccessibility:d,useActiveModalizer:!0},g),i=!!g.outOfDOMOrder,e=g.uncontrolled}return{element:h,uncontrolled:e,outOfDOMOrder:i}}acceptElement(a,b){var c,d;if(!ao.isTabbing)return(null==(c=b.currentCtx)?void 0:c.excludedFromMover)?NodeFilter.FILTER_REJECT:void 0;let{memorizeCurrent:e,visibilityAware:f,hasDefault:g=!0}=this._props,h=this.getElement();if(h&&(e||f||g)&&(!C.nodeContains(h,b.from)||_(b.from)===h)){let a;if(e){let c=null==(d=this._current)?void 0:d.get();c&&b.acceptCondition(c)&&(a=c)}if(!a&&g&&(a=this._tabster.focusable.findDefault({container:h,useActiveModalizer:!0})),!a&&f&&(a=this._tabster.focusable.findElement({container:h,useActiveModalizer:!0,isBackward:b.isBackward,acceptCondition:a=>{var c;let d=O(this._win,a),e=this._visible[d];return h!==a&&!!(null==(c=this._allElements)?void 0:c.get(a))&&b.acceptCondition(a)&&(2===e||1===e&&(1===f||!this._fullyVisible))}})),a)return b.found=!0,b.foundElement=a,b.rejectElementsFrom=h,b.skippedFocusable=!0,NodeFilter.FILTER_ACCEPT}}_observeState(){let a=this.getElement();if(this._unobserve||!a||"undefined"==typeof MutationObserver)return;let b=this._win(),c=this._allElements=new WeakMap,d=this._tabster.focusable,e=this._updateQueue=[],f=C.createMutationObserver(a=>{for(let b of a){let a=b.target,c=b.removedNodes,d=b.addedNodes;if("attributes"===b.type)"tabindex"===b.attributeName&&e.push({element:a,type:2});else{for(let a=0;a<c.length;a++)e.push({element:c[a],type:3});for(let a=0;a<d.length;a++)e.push({element:d[a],type:1})}}l()}),g=(a,b)=>{var d,e;let f=c.get(a);f&&b&&(null==(d=this._intersectionObserver)||d.unobserve(a),c.delete(a)),f||b||(c.set(a,this),null==(e=this._intersectionObserver)||e.observe(a))},h=a=>{let b=d.isFocusable(a);c.get(a)?b||g(a,!0):b&&g(a)},i=a=>{let{mover:c}=m(a);if(c&&c!==this)if(!(c.getElement()===a&&d.isFocusable(a)))return;else g(a);let e=J(b.document,a,a=>{let{mover:b,groupper:c}=m(a);if(b&&b!==this)return NodeFilter.FILTER_REJECT;let e=null==c?void 0:c.getFirst(!0);return c&&c.getElement()!==a&&e&&e!==a?NodeFilter.FILTER_REJECT:(d.isFocusable(a)&&g(a),NodeFilter.FILTER_SKIP)});if(e)for(e.currentNode=a;e.nextNode(););},j=a=>{c.get(a)&&g(a,!0);for(let b=C.getFirstElementChild(a);b;b=C.getNextElementSibling(b))j(b)},l=()=>{!this._updateTimer&&e.length&&(this._updateTimer=b.setTimeout(()=>{for(let{element:a,type:b}of(delete this._updateTimer,e))switch(b){case 2:h(a);break;case 1:i(a);break;case 3:j(a)}e=this._updateQueue=[]},0))},m=a=>{let b={};for(let c=a;c;c=C.getParentElement(c)){let a=k(this._tabster,c);if(a&&(a.groupper&&!b.groupper&&(b.groupper=a.groupper),a.mover)){b.mover=a.mover;break}}return b};e.push({element:a,type:1}),l(),f.observe(a,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["tabindex"]}),this._unobserve=()=>{f.disconnect()}}getState(a){let b=O(this._win,a);if(b in this._visible){let c=this._visible[b]||0;return{isCurrent:this._current?this._current.get()===a:void 0,visibility:c}}}}class aA{constructor(a,b){this._init=()=>{let a=this._win();a.addEventListener("keydown",this._onKeyDown,!0),a.addEventListener(n,this._onMoveFocus),a.addEventListener(o,this._onMemorizedElement),this._tabster.focusedElement.subscribe(this._onFocus)},this._onMoverDispose=a=>{delete this._movers[a.id]},this._onFocus=a=>{var b;let c=a,d=a;for(let e=C.getParentElement(a);e;e=C.getParentElement(e)){let a=null==(b=k(this._tabster,e))?void 0:b.mover;a&&(a.setCurrent(d),c=void 0),!c&&this._tabster.focusable.isFocusable(e)&&(c=d=e)}},this._onKeyDown=async a=>{var b;let c;if(this._ignoredInputTimer&&(this._win().clearTimeout(this._ignoredInputTimer),delete this._ignoredInputTimer),null==(b=this._ignoredInputResolve)||b.call(this,!1),a.ctrlKey||a.altKey||a.shiftKey||a.metaKey)return;let d=a.key;if(d===am?c=2:d===al?c=4:d===ak?c=1:d===aj?c=3:"PageDown"===d?c=6:"PageUp"===d?c=5:d===ai?c=7:"End"===d&&(c=8),!c)return;let e=this._tabster.focusedElement.getFocusedElement();!e||await this._isIgnoredInput(e,d)||this._moveFocus(e,c,a)},this._onMoveFocus=a=>{var b;let c=a.composedPath()[0],d=null==(b=a.detail)?void 0:b.key;c&&void 0!==d&&!a.defaultPrevented&&(this._moveFocus(c,d),a.stopImmediatePropagation())},this._onMemorizedElement=a=>{var b;let c=a.composedPath()[0],d=null==(b=a.detail)?void 0:b.memorizedElement;if(c){let b=ad.getTabsterContext(this._tabster,c),e=null==b?void 0:b.mover;e&&(d&&!C.nodeContains(e.getElement(),d)&&(d=void 0),e.setCurrent(d),a.stopImmediatePropagation())}},this._tabster=a,this._win=b,this._movers={},a.queueInit(this._init)}dispose(){var a;let b=this._win();this._tabster.focusedElement.unsubscribe(this._onFocus),null==(a=this._ignoredInputResolve)||a.call(this,!1),this._ignoredInputTimer&&(b.clearTimeout(this._ignoredInputTimer),delete this._ignoredInputTimer),b.removeEventListener("keydown",this._onKeyDown,!0),b.removeEventListener(n,this._onMoveFocus),b.removeEventListener(o,this._onMemorizedElement),Object.keys(this._movers).forEach(a=>{this._movers[a]&&(this._movers[a].dispose(),delete this._movers[a])})}createMover(a,b,c){let d=new az(this._tabster,a,this._onMoverDispose,b,c);return this._movers[d.id]=d,d}moveFocus(a,b){return this._moveFocus(a,b)}_moveFocus(a,b,c){var d,f;let g,h,j,l=this._tabster,m=ad.getTabsterContext(l,a,{checkRtl:!0});if(!m||!m.mover||m.excludedFromMover||c&&m.ignoreKeydown(c))return null;let n=m.mover,o=n.getElement();if(m.groupperBeforeMover){let a=m.groupper;if(!a||a.isActive(!0))return null;for(let b=C.getParentElement(a.getElement());b&&b!==o;b=C.getParentElement(b))if(null==(f=null==(d=k(l,b))?void 0:d.groupper)?void 0:f.isActive(!0))return null}if(!o)return null;let p=l.focusable,q=n.getProps(),r=q.direction||i.Both,s=r===i.Both,t=s||r===i.Vertical,u=s||r===i.Horizontal,w=r===i.GridLinear,x=w||r===i.Grid,y=q.cyclic,z=0,A=0;if(x&&(z=Math.ceil((j=a.getBoundingClientRect()).left),A=Math.floor(j.right)),m.rtl&&(4===b?b=3:3===b&&(b=4)),2===b&&t||4===b&&(u||x))if((g=p.findNext({currentElement:a,container:o,useActiveModalizer:!0}))&&x){let a=Math.ceil(g.getBoundingClientRect().left);!w&&A>a&&(g=void 0)}else!g&&y&&(g=p.findFirst({container:o,useActiveModalizer:!0}));else if(1===b&&t||3===b&&(u||x))if((g=p.findPrev({currentElement:a,container:o,useActiveModalizer:!0}))&&x){let a=Math.floor(g.getBoundingClientRect().right);!w&&a>z&&(g=void 0)}else!g&&y&&(g=p.findLast({container:o,useActiveModalizer:!0}));else if(7===b)x?p.findElement({container:o,currentElement:a,useActiveModalizer:!0,isBackward:!0,acceptCondition:b=>{var c;if(!p.isFocusable(b))return!1;let d=Math.ceil(null!=(c=b.getBoundingClientRect().left)?c:0);return b!==a&&z<=d||(g=b,!1)}}):g=p.findFirst({container:o,useActiveModalizer:!0});else if(8===b)x?p.findElement({container:o,currentElement:a,useActiveModalizer:!0,acceptCondition:b=>{var c;if(!p.isFocusable(b))return!1;let d=Math.ceil(null!=(c=b.getBoundingClientRect().left)?c:0);return b!==a&&z>=d||(g=b,!1)}}):g=p.findLast({container:o,useActiveModalizer:!0});else if(5===b){if(p.findElement({currentElement:a,container:o,useActiveModalizer:!0,isBackward:!0,acceptCondition:a=>!!p.isFocusable(a)&&(!L(this._win,a,n.visibilityTolerance)||(g=a,!1))}),x&&g){let a=Math.ceil(g.getBoundingClientRect().left);p.findElement({currentElement:g,container:o,useActiveModalizer:!0,acceptCondition:b=>{if(!p.isFocusable(b))return!1;let c=Math.ceil(b.getBoundingClientRect().left);return z<c||a>=c||(g=b,!1)}})}h=!1}else if(6===b){if(p.findElement({currentElement:a,container:o,useActiveModalizer:!0,acceptCondition:a=>!!p.isFocusable(a)&&(!L(this._win,a,n.visibilityTolerance)||(g=a,!1))}),x&&g){let a=Math.ceil(g.getBoundingClientRect().left);p.findElement({currentElement:g,container:o,useActiveModalizer:!0,isBackward:!0,acceptCondition:b=>{if(!p.isFocusable(b))return!1;let c=Math.ceil(b.getBoundingClientRect().left);return z>c||a<=c||(g=b,!1)}})}h=!0}else if(x){let c,d,e=1===b,f=z,h=Math.ceil(j.top),i=A,k=Math.floor(j.bottom),l=0;p.findAll({container:o,currentElement:a,isBackward:e,onElement:a=>{let b=a.getBoundingClientRect(),g=Math.ceil(b.left),j=Math.ceil(b.top),m=Math.floor(b.right),n=Math.floor(b.bottom);if(e&&h<n||!e&&k>j)return!0;let o=Math.ceil(Math.min(i,m))-Math.floor(Math.max(f,g)),p=Math.ceil(Math.min(i-f,m-g));if(o>0&&p>=o){let b=o/p;b>l&&(c=a,l=b)}else if(0===l){let b,e,l=(b=i<g?g-i:m<f?f-m:0,e=k<j?j-k:n<h?h-n:0,0===b?e:0===e?b:Math.sqrt(b*b+e*e));(void 0===d||l<d)&&(d=l,c=a)}else if(l>0)return!1;return!0}}),g=c}return g&&(!c||c&&o.dispatchEvent(new v({by:"mover",owner:o,next:g,relatedEvent:c})))?(void 0!==h&&function(a,b,c){let d=M(b);if(d){let e=K(a,d),f=b.getBoundingClientRect();c?d.scrollTop+=f.top-e.top:d.scrollTop+=f.bottom-e.bottom}}(this._win,g,h),c&&(c.preventDefault(),c.stopImmediatePropagation()),(0,e.MHx)(g),g):null}async _isIgnoredInput(a,b){if("true"===a.getAttribute("aria-expanded")&&a.hasAttribute("aria-activedescendant"))return!0;if(R(a,"input, textarea, *[contenteditable]")){let c,d=0,e=0,f=0;if("INPUT"===a.tagName||"TEXTAREA"===a.tagName){let c=a.type;if(f=(a.value||"").length,"email"===c||"number"===c){if(f){let c=C.getSelection(a);if(c){let a=c.toString().length,d=b===aj||b===ak;if(c.modify("extend",d?"backward":"forward","character"),a!==c.toString().length)return c.modify("extend",d?"forward":"backward","character"),!0;f=0}}}else{let b=a.selectionStart;if(null===b)return"hidden"===c;d=b||0,e=a.selectionEnd||0}}else"true"===a.contentEditable&&(c=new(function(a){let b=F(a);if(b.basics.Promise)return b.basics.Promise;throw Error("No Promise defined.")}(this._win))(b=>{this._ignoredInputResolve=a=>{delete this._ignoredInputResolve,b(a)};let c=this._win();this._ignoredInputTimer&&c.clearTimeout(this._ignoredInputTimer);let{anchorNode:g,focusNode:h,anchorOffset:i,focusOffset:j}=C.getSelection(a)||{};this._ignoredInputTimer=c.setTimeout(()=>{var b,c,k;delete this._ignoredInputTimer;let{anchorNode:l,focusNode:m,anchorOffset:n,focusOffset:o}=C.getSelection(a)||{};if(l!==g||m!==h||n!==i||o!==j){null==(b=this._ignoredInputResolve)||b.call(this,!1);return}if(d=n||0,e=o||0,f=(null==(c=a.textContent)?void 0:c.length)||0,l&&m&&C.nodeContains(a,l)&&C.nodeContains(a,m)&&l!==a){let b=!1,c=a=>{if(a===l)b=!0;else if(a===m)return!0;let f=a.textContent;if(f&&!C.getFirstChild(a)){let a=f.length;b?m!==l&&(e+=a):(d+=a,e+=a)}let g=!1;for(let b=C.getFirstChild(a);b&&!g;b=b.nextSibling)g=c(b);return g};c(a)}null==(k=this._ignoredInputResolve)||k.call(this,!0)},0)}));if(c&&!await c||d!==e||d>0&&(b===aj||b===ak||b===ai)||d<f&&(b===al||b===am||"End"===b))return!0}return!1}}class aB{constructor(a){this._isUncontrolledCompletely=a}isUncontrolledCompletely(a,b){var c;let d=null==(c=this._isUncontrolledCompletely)?void 0:c.call(this,a,b);return void 0===d?b:d}}class aC extends T{constructor(a,b,c){var d;if(super(a,b,c),this._hasFocus=!1,this._onFocusOut=a=>{var b;let c=null==(b=this._element)?void 0:b.get();c&&null===a.relatedTarget&&c.dispatchEvent(new z),c&&!C.nodeContains(c,a.relatedTarget)&&(this._hasFocus=!1)},this._onFocusIn=()=>{this._hasFocus=!0},this._props.type===h.Source){const a=null==(d=this._element)?void 0:d.get();null==a||a.addEventListener("focusout",this._onFocusOut),null==a||a.addEventListener("focusin",this._onFocusIn),this._hasFocus=C.nodeContains(a,a&&C.getActiveElement(a.ownerDocument))}}dispose(){var a;if(this._props.type===h.Source){let b=null==(a=this._element)?void 0:a.get();null==b||b.removeEventListener("focusout",this._onFocusOut),null==b||b.removeEventListener("focusin",this._onFocusIn),this._hasFocus&&this._tabster.getWindow().document.body.dispatchEvent(new z)}}}class aD{constructor(a){this._stack=[],this._getWindow=a}push(a){var b;(null==(b=this._stack[this._stack.length-1])?void 0:b.get())!==a&&(this._stack.length>aD.DEPTH&&this._stack.shift(),this._stack.push(new H(this._getWindow,a)))}pop(a){var b;void 0===a&&(a=()=>!0);let c=this._getWindow().document;for(let d=this._stack.length-1;d>=0;d--){let d=null==(b=this._stack.pop())?void 0:b.get();if(d&&C.nodeContains(c.body,C.getParentElement(d))&&a(d))return d}}}aD.DEPTH=10;class aE{constructor(a){this._onRestoreFocus=a=>{var b,c;this._focusedElementState.cancelAsyncFocus(2);let d=a.composedPath()[0];if(d){let a=null==(c=null==(b=k(this._tabster,d))?void 0:b.restorer)?void 0:c.getProps().id;this._focusedElementState.requestAsyncFocus(2,()=>this._restoreFocus(d,a),0)}},this._onFocusIn=a=>{var b;if(!a)return;let c=k(this._tabster,a);(null==(b=null==c?void 0:c.restorer)?void 0:b.getProps().type)===h.Target&&this._history.push(a)},this._restoreFocus=(a,b)=>{var c;let d=this._getWindow().document;if(C.getActiveElement(d)!==d.body||!this._keyboardNavState.isNavigatingWithKeyboard()&&C.nodeContains(d.body,a))return;let e=a=>{var b,c;let d=null==(c=null==(b=k(this._tabster,a))?void 0:b.restorer)?void 0:c.getProps();return d?d.id:null};null==(c=this._history.pop(a=>b===e(a)))||c.focus()},this._tabster=a,this._getWindow=a.getWindow,this._getWindow().addEventListener(q,this._onRestoreFocus),this._history=new aD(this._getWindow),this._keyboardNavState=a.keyboardNavigation,this._focusedElementState=a.focusedElement,this._focusedElementState.subscribe(this._onFocusIn)}dispose(){let a=this._getWindow();this._focusedElementState.unsubscribe(this._onFocusIn),this._focusedElementState.cancelAsyncFocus(2),a.removeEventListener(q,this._onRestoreFocus)}createRestorer(a,b){let c=new aC(this._tabster,a,b);return b.type===h.Target&&C.getActiveElement(a.ownerDocument)===a&&this._history.push(a),c}}class aF{static _overrideAttachShadow(a){let b=a.Element.prototype.attachShadow;b.__origAttachShadow||(Element.prototype.attachShadow=function(a){let c=b.call(this,a);for(let a of aF._shadowObservers)a._addSubObserver(c);return c},Element.prototype.attachShadow.__origAttachShadow=b)}constructor(a){this._isObserving=!1,this._callbackWrapper=(a,b)=>{for(let b of a)if("childList"===b.type){let a=b.removedNodes,c=b.addedNodes;for(let b=0;b<a.length;b++)this._walkShadows(a[b],!0);for(let a=0;a<c.length;a++)this._walkShadows(c[a])}this._callback(a,b)},this._callback=a,this._observer=new MutationObserver(this._callbackWrapper),this._subObservers=new Map}_addSubObserver(a){if(!(!this._options||!this._callback||this._subObservers.has(a))&&this._options.subtree&&function(a,b){var c,d;if(!a||!b)return!1;let e=b;for(;e;){if(e===a)return!0;e="function"!=typeof e.assignedElements&&(null==(c=e.assignedSlot)?void 0:c.parentNode)?null==(d=e.assignedSlot)?void 0:d.parentNode:e.nodeType===document.DOCUMENT_FRAGMENT_NODE?e.host:e.parentNode}return!1}(this._root,a)){let b=new MutationObserver(this._callbackWrapper);this._subObservers.set(a,b),this._isObserving&&b.observe(a,this._options),this._walkShadows(a)}}disconnect(){for(let a of(this._isObserving=!1,delete this._options,aF._shadowObservers.delete(this),this._subObservers.values()))a.disconnect();this._subObservers.clear(),this._observer.disconnect()}observe(a,b){let c=a.nodeType===Node.DOCUMENT_NODE?a:a.ownerDocument,d=null==c?void 0:c.defaultView;c&&d&&(aF._overrideAttachShadow(d),aF._shadowObservers.add(this),this._root=a,this._options=b,this._isObserving=!0,this._observer.observe(a,b),this._walkShadows(a))}_walkShadows(a,b){let c=a.nodeType===Node.DOCUMENT_NODE?a:a.ownerDocument;if(c){if(a===c)a=c.body;else{let b=a.shadowRoot;if(b)return void this._addSubObserver(b)}c.createTreeWalker(a,NodeFilter.SHOW_ELEMENT,{acceptNode:a=>{if(a.nodeType===Node.ELEMENT_NODE)if(b){let b=this._subObservers.get(a);b&&(b.disconnect(),this._subObservers.delete(a))}else{let b=a.shadowRoot;b&&this._addSubObserver(b)}return NodeFilter.FILTER_SKIP}}).nextNode()}}takeRecords(){let a=this._observer.takeRecords();for(let b of this._subObservers.values())a.push(...b.takeRecords());return a}}aF._shadowObservers=new Set;class aG{constructor(a){this.keyboardNavigation=a.keyboardNavigation,this.focusedElement=a.focusedElement,this.focusable=a.focusable,this.root=a.root,this.uncontrolled=a.uncontrolled,this.core=a}}class aH{constructor(a,b){var c,d;this._forgetMemorizedElements=[],this._wrappers=new Set,this._initQueue=[],this._version="8.5.5",this._noop=!1,this.getWindow=()=>{if(!this._win)throw Error("Using disposed Tabster.");return this._win},this._storage=function(a){let b=a.__tabsterInstanceContext;return new((null==b?void 0:b.basics.WeakMap)||WeakMap)}(a),this._win=a;const e=this.getWindow;(null==b?void 0:b.DOMAPI)&&function(a){for(let b of Object.keys(a))C[b]=a[b]}({...b.DOMAPI}),this.keyboardNavigation=new as(e),this.focusedElement=new ao(this,e),this.focusable=new af(this),this.root=new ad(this,null==b?void 0:b.autoRoot),this.uncontrolled=new aB((null==b?void 0:b.checkUncontrolledCompletely)||(null==b?void 0:b.checkUncontrolledTrappingFocus)),this.controlTab=null==(c=null==b?void 0:b.controlTab)||c,this.rootDummyInputs=!!(null==b?void 0:b.rootDummyInputs),this._dummyObserver=new W(e),this.getParent=null!=(d=null==b?void 0:b.getParent)?d:C.getParentNode,this.internal={stopObserver:()=>{this._unobserve&&(this._unobserve(),delete this._unobserve)},resumeObserver:a=>{if(!this._unobserve){let b=e().document;this._unobserve=function(a,b,c,d){let e;if("undefined"==typeof MutationObserver)return()=>{};let g=b.getWindow;function h(b,c){e||(e=F(g).elementByUId),i(b,c);let d=J(a,b,a=>i(a,c));if(d)for(;d.nextNode(););}function i(a,d){if(!a.getAttribute)return NodeFilter.FILTER_SKIP;let h=a.__tabsterElementUID;return h&&e&&(d?delete e[h]:null!=e[h]||(e[h]=new H(g,a))),(k(b,a)||a.hasAttribute(f))&&c(b,a,d),NodeFilter.FILTER_SKIP}let j=C.createMutationObserver(a=>{var d,e,g,i,j;let k=new Set;for(let j of a){let a=j.target,l=j.removedNodes,m=j.addedNodes;if("attributes"===j.type)j.attributeName!==f||k.has(a)||c(b,a);else{for(let c=0;c<l.length;c++){let f=l[c];k.add(f),h(f,!0),null==(e=(d=b._dummyObserver).domChanged)||e.call(d,a)}for(let c=0;c<m.length;c++)h(m[c]),null==(i=(g=b._dummyObserver).domChanged)||i.call(g,a)}}k.clear(),null==(j=b.modalizer)||j.hiddenUpdate()});return d&&h(g().document.body),j.observe(a,{childList:!0,subtree:!0,attributes:!0,attributeFilter:[f]}),()=>{j.disconnect()}}(b,this,l,a)}}},function a(b){let c=F(b);c.fakeWeakRefsStarted||(c.fakeWeakRefsStarted=!0,c.WeakRef=c.basics.WeakRef),c.fakeWeakRefsTimer||(c.fakeWeakRefsTimer=b().setTimeout(()=>{c.fakeWeakRefsTimer=void 0,I(b),a(b)},12e4))}(e),this.queueInit(()=>{this.internal.resumeObserver(!0)})}_mergeProps(a){var b;a&&(this.getParent=null!=(b=a.getParent)?b:this.getParent)}createTabster(a,b){let c=new aG(this);return a||this._wrappers.add(c),this._mergeProps(b),c}disposeTabster(a,b){b?this._wrappers.clear():this._wrappers.delete(a),0===this._wrappers.size&&this.dispose()}dispose(){var a,b,c,d,e,f,g,h,i;let j;this.internal.stopObserver();let k=this._win;if(null==k||k.clearTimeout(this._initTimer),delete this._initTimer,this._initQueue=[],this._forgetMemorizedElements=[],k&&this._forgetMemorizedTimer&&(k.clearTimeout(this._forgetMemorizedTimer),delete this._forgetMemorizedTimer),null==(a=this.outline)||a.dispose(),null==(b=this.crossOrigin)||b.dispose(),null==(c=this.deloser)||c.dispose(),null==(d=this.groupper)||d.dispose(),null==(e=this.mover)||e.dispose(),null==(f=this.modalizer)||f.dispose(),null==(g=this.observedElement)||g.dispose(),null==(h=this.restorer)||h.dispose(),this.keyboardNavigation.dispose(),this.focusable.dispose(),this.focusedElement.dispose(),this.root.dispose(),this._dummyObserver.dispose(),(j=F(i=this.getWindow)).fakeWeakRefsStarted=!1,j.fakeWeakRefsTimer&&(i().clearTimeout(j.fakeWeakRefsTimer),j.fakeWeakRefsTimer=void 0,j.fakeWeakRefs=[]),P(this.getWindow),this._storage=new WeakMap,this._wrappers.clear(),k){let a;(a=k.__tabsterInstanceContext)&&(a.elementByUId={},delete a.WeakRef,a.containerBoundingRectCache={},a.containerBoundingRectCacheTimer&&k.clearTimeout(a.containerBoundingRectCacheTimer),a.fakeWeakRefsTimer&&k.clearTimeout(a.fakeWeakRefsTimer),a.fakeWeakRefs=[],delete k.__tabsterInstanceContext),delete k.__tabsterInstance,delete this._win}}storageEntry(a,b){let c=this._storage,d=c.get(a);return d?!1===b&&0===Object.keys(d).length&&c.delete(a):!0===b&&(d={},c.set(a,d)),d}forceCleanup(){!this._win||(this._forgetMemorizedElements.push(this._win.document.body),this._forgetMemorizedTimer||(this._forgetMemorizedTimer=this._win.setTimeout(()=>{delete this._forgetMemorizedTimer;for(let a=this._forgetMemorizedElements.shift();a;a=this._forgetMemorizedElements.shift())P(this.getWindow,a),ao.forgetMemorized(this.focusedElement,a)},0),I(this.getWindow,!0)))}queueInit(a){var b;this._win&&(this._initQueue.push(a),this._initTimer||(this._initTimer=null==(b=this._win)?void 0:b.setTimeout(()=>{delete this._initTimer,this.drainInitQueue()},0)))}drainInitQueue(){if(!this._win)return;let a=this._initQueue;this._initQueue=[],a.forEach(a=>a())}}function aI(a,b){let c=a.__tabsterInstance;return c?c.createTabster(!1,b):(c=new aH(a,b),a.__tabsterInstance=c,c.createTabster())}function aJ(a){let b=a.core;return b.groupper||(b.groupper=new ar(b,b.getWindow)),b.groupper}function aK(a){let b=a.core;return b.mover||(b.mover=new aA(b,b.getWindow)),b.mover}function aL(a,b,c){let d=a.core;return d.modalizer||(d.modalizer=new ax(d,b,c)),d.modalizer}function aM(a){let b=a.core;return b.restorer||(b.restorer=new aE(b)),b.restorer}function aN(a,b){a.core.disposeTabster(a,b)}}
,,(a,b,c)=>{"use strict";c.d(b,{a:()=>g,b:()=>h});var d=c("tslib_533"),e=c("react-lib"),f=e.createContext(void 0),g=function(a){var b=a.children,c=(0,d.dc)(a,["children"]);return e.createElement(f.Provider,{value:c},b)},h=function(){return e.useContext(f)}}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>j,b:()=>k,c:()=>n,d:()=>l,e:()=>i});var d=c("tslib_533"),e=c("react-lib"),f=c(202),g=c(37),h=c(73),i=function(a){var b=e.useRef();return e.useEffect(function(){b.current=a}),b.current};function j(a){var b=e.useRef(a);b.current=a;var c=e.useRef();return c.current||(c.current=function(){for(var a=[],c=0;c<arguments.length;c++)a[c]=arguments[c];return b.current.apply(null,a)})}var k=function(a,b){var c=e.useRef(!1);e.useEffect(function(){if(b){var d=function(){c.current=!0},e=function(){if(c.current){c.current=!1;return}b()};return a.on(h.e.ResponsiveResize,d),a.on(h.e.ScaleChanged,e),a.on(h.e.RotationChanged,b),function(){a.off(h.e.ResponsiveResize,d),a.off(h.e.ScaleChanged,e),a.off(h.e.RotationChanged,b)}}},[a,b])},l=function(a){var b=(0,d.pM)(e.useState(!1),2),c=b[0],f=b[1];return e.useEffect(function(){var b=function(){f(!0)},c=function(){f(!1)};return a.on(h.e.ZoomStart,b),a.on(h.e.ZoomEnd,c),function(){a.off(h.e.ZoomStart,b),a.off(h.e.ZoomEnd,c)}},[a]),c},m=function(a){var b=(0,d.pM)(e.useState(!1),2),c=b[0],f=b[1];return e.useEffect(function(){var b=function(){f(!0)},c=function(){f(!1)};return a.on(h.e.Pinching,b),a.on(h.e.ZoomEnd,c),function(){a.off(h.e.Pinching,b),a.off(h.e.ZoomEnd,c)}},[a]),c},n=function(a){var b,c=(0,f.b)().enablePreRender,d=m(a);return(null==(b=g.a.features)?void 0:b.enableOptimizedPinch)&&c&&d}}
,(a,b)=>{"use strict";if("object"==typeof performance&&"function"==typeof performance.now){var c,d,e,f,g=performance;b.unstable_now=function(){return g.now()}}else{var h=Date,i=h.now();b.unstable_now=function(){return h.now()-i}}if("undefined"==typeof window||"function"!=typeof MessageChannel){var j=null,k=null,l=function(){if(null!==j)try{var a=b.unstable_now();j(!0,a),j=null}catch(a){throw setTimeout(l,0),a}};c=function(a){null!==j?setTimeout(c,0,a):(j=a,setTimeout(l,0))},d=function(a,b){k=setTimeout(a,b)},e=function(){clearTimeout(k)},b.unstable_shouldYield=function(){return!1},f=b.unstable_forceFrameRate=function(){}}else{var m=window.setTimeout,n=window.clearTimeout;if("undefined"!=typeof console){var o=window.cancelAnimationFrame;"function"!=typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),"function"!=typeof o&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var p=!1,q=null,r=-1,s=5,t=0;b.unstable_shouldYield=function(){return b.unstable_now()>=t},f=function(){},b.unstable_forceFrameRate=function(a){0>a||125<a?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):s=0<a?Math.floor(1e3/a):5};var u=new MessageChannel,v=u.port2;u.port1.onmessage=function(){if(null!==q){var a=b.unstable_now();t=a+s;try{q(!0,a)?v.postMessage(null):(p=!1,q=null)}catch(a){throw v.postMessage(null),a}}else p=!1},c=function(a){q=a,p||(p=!0,v.postMessage(null))},d=function(a,c){r=m(function(){a(b.unstable_now())},c)},e=function(){n(r),r=-1}}function w(a,b){var c=a.length;for(a.push(b);;){var d=c-1>>>1,e=a[d];if(void 0!==e&&0<z(e,b))a[d]=b,a[c]=e,c=d;else break}}function x(a){return void 0===(a=a[0])?null:a}function y(a){var b=a[0];if(void 0!==b){var c=a.pop();if(c!==b){a[0]=c;for(var d=0,e=a.length;d<e;){var f=2*(d+1)-1,g=a[f],h=f+1,i=a[h];if(void 0!==g&&0>z(g,c))void 0!==i&&0>z(i,g)?(a[d]=i,a[h]=c,d=h):(a[d]=g,a[f]=c,d=f);else if(void 0!==i&&0>z(i,c))a[d]=i,a[h]=c,d=h;else break}}return b}return null}function z(a,b){var c=a.sortIndex-b.sortIndex;return 0!==c?c:a.id-b.id}var A=[],B=[],C=1,D=null,E=3,F=!1,G=!1,H=!1;function I(a){for(var b=x(B);null!==b;){if(null===b.callback)y(B);else if(b.startTime<=a)y(B),b.sortIndex=b.expirationTime,w(A,b);else break;b=x(B)}}function J(a){if(H=!1,I(a),!G)if(null!==x(A))G=!0,c(K);else{var b=x(B);null!==b&&d(J,b.startTime-a)}}function K(a,c){G=!1,H&&(H=!1,e()),F=!0;var f=E;try{for(I(c),D=x(A);null!==D&&(!(D.expirationTime>c)||a&&!b.unstable_shouldYield());){var g=D.callback;if("function"==typeof g){D.callback=null,E=D.priorityLevel;var h=g(D.expirationTime<=c);c=b.unstable_now(),"function"==typeof h?D.callback=h:D===x(A)&&y(A),I(c)}else y(A);D=x(A)}if(null!==D)var i=!0;else{var j=x(B);null!==j&&d(J,j.startTime-c),i=!1}return i}finally{D=null,E=f,F=!1}}var L=f;b.unstable_IdlePriority=5,b.unstable_ImmediatePriority=1,b.unstable_LowPriority=4,b.unstable_NormalPriority=3,b.unstable_Profiling=null,b.unstable_UserBlockingPriority=2,b.unstable_cancelCallback=function(a){a.callback=null},b.unstable_continueExecution=function(){G||F||(G=!0,c(K))},b.unstable_getCurrentPriorityLevel=function(){return E},b.unstable_getFirstCallbackNode=function(){return x(A)},b.unstable_next=function(a){switch(E){case 1:case 2:case 3:var b=3;break;default:b=E}var c=E;E=b;try{return a()}finally{E=c}},b.unstable_pauseExecution=function(){},b.unstable_requestPaint=L,b.unstable_runWithPriority=function(a,b){switch(a){case 1:case 2:case 3:case 4:case 5:break;default:a=3}var c=E;E=a;try{return b()}finally{E=c}},b.unstable_scheduleCallback=function(a,f,g){var h=b.unstable_now();switch(g="object"==typeof g&&null!==g&&"number"==typeof(g=g.delay)&&0<g?h+g:h,a){case 1:var i=-1;break;case 2:i=250;break;case 5:i=0x3fffffff;break;case 4:i=1e4;break;default:i=5e3}return i=g+i,a={id:C++,callback:f,priorityLevel:a,startTime:g,expirationTime:i,sortIndex:-1},g>h?(a.sortIndex=g,w(B,a),null===x(A)&&a===x(B)&&(H?e():H=!0,d(J,g-h))):(a.sortIndex=i,w(A,a),G||F||(G=!0,c(K))),a},b.unstable_wrapCallback=function(a){var b=E;return function(){var c=E;E=b;try{return a.apply(this,arguments)}finally{E=c}}}}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>j,b:()=>i,c:()=>h});var d=c("tslib_533"),e=c("react-lib"),f=e.createContext(void 0),g=e.createContext(function(){}),h=function(){return e.useContext(f)},i=function(){var a=e.useContext(g);return{updateSaveFreeText:e.useCallback(function(b){a(function(a){return(0,d.q5)((0,d.q5)({},a),{saveFreeText:b})})},[a]),updateEnableAutoSizerHeightGrowing:e.useCallback(function(b){a(function(a){return(0,d.q5)((0,d.q5)({},a),{enableAutoSizerHeightGrowing:b})})},[a])}},j=function(a){var b=a.children,c=a.enableFreeText,h=a.freeTextHandler,i=a.freeTextContainer,j=a.setInitialFontAttributes,k=(0,d.pM)(e.useState({saveFreeText:function(){},enableAutoSizerHeightGrowing:function(){}}),2),l=k[0],m=k[1],n=(0,d.q5)((0,d.q5)({},l),{enableFreeText:c,freeTextHandler:h,freeTextContainer:i,setInitialFontAttributes:j});return e.createElement(g.Provider,{value:m},e.createElement(f.Provider,{value:n},b))}}
,,(a,b,c)=>{"use strict";c.d(b,{a:()=>n,b:()=>e,c:()=>l,d:()=>m});var d,e,f=c("tslib_533"),g=c("react-lib");(d=e||(e={})).Hidden="hidden",d.Running="running",d.Success="success",d.Error="error",d.Info="info";var h=function(a,b){switch(b.type){case e.Hidden:return{type:b.type,text:"",link:"",linkText:"",percentComplete:0};case e.Success:return{type:b.type,text:b.text,link:b.link,linkText:b.linkText,disableAutoHide:b.disableAutoHide,percentComplete:1,onClickButton:b.onClickClose};case e.Error:return{type:b.type,text:b.text,link:"",linkText:"",percentComplete:0,onClickButton:b.onClickClose};case e.Info:return{type:b.type,text:b.text,infoIconName:b.infoIconName,shouldAutoFocus:b.shouldAutoFocus,onClickButton:b.onClickClose};default:case e.Running:return{type:b.type,text:b.text,link:"",linkText:"",percentComplete:b.percentComplete,onClickButton:b.onClickExpand}}},i={type:e.Hidden,text:"",link:"",linkText:"",percentComplete:0,onClickButton:function(){}},j=g.createContext(i),k=g.createContext(function(){}),l=function(){return g.useContext(j)},m=function(){return g.useContext(k)},n=function(a){var b=a.children,c=(0,f.pM)(g.useReducer(h,i),2),d=c[0],e=c[1];return g.createElement(j.Provider,{value:d},g.createElement(k.Provider,{value:e},b))}}
,(a,b,c)=>{var d=0/0,e=/^\s+|\s+$/g,f=/^[-+]0x[0-9a-f]+$/i,g=/^0b[01]+$/i,h=/^0o[0-7]+$/i,i=parseInt,j="object"==typeof c.g&&c.g&&c.g.Object===Object&&c.g,k="object"==typeof self&&self&&self.Object===Object&&self,l=j||k||Function("return this")(),m=Object.prototype.toString,n=Math.max,o=Math.min,p=function(){return l.Date.now()};function q(a){var b=typeof a;return!!a&&("object"==b||"function"==b)}function r(a){if("number"==typeof a)return a;if("symbol"==typeof(b=a)||b&&"object"==typeof b&&"[object Symbol]"==m.call(b))return d;if(q(a)){var b,c="function"==typeof a.valueOf?a.valueOf():a;a=q(c)?c+"":c}if("string"!=typeof a)return 0===a?a:+a;a=a.replace(e,"");var j=g.test(a);return j||h.test(a)?i(a.slice(2),j?2:8):f.test(a)?d:+a}a.exports=function(a,b,c){var d,e,f,g,h,i,j=0,k=!1,l=!1,m=!0;if("function"!=typeof a)throw TypeError("Expected a function");function s(b){var c=d,f=e;return d=e=void 0,j=b,g=a.apply(f,c)}function t(a){var c=a-i,d=a-j;return void 0===i||c>=b||c<0||l&&d>=f}function u(){var a,c,d,e=p();if(t(e))return v(e);h=setTimeout(u,(a=e-i,c=e-j,d=b-a,l?o(d,f-c):d))}function v(a){return(h=void 0,m&&d)?s(a):(d=e=void 0,g)}function w(){var a,c=p(),f=t(c);if(d=arguments,e=this,i=c,f){if(void 0===h)return j=a=i,h=setTimeout(u,b),k?s(a):g;if(l)return h=setTimeout(u,b),s(i)}return void 0===h&&(h=setTimeout(u,b)),g}return b=r(b)||0,q(c)&&(k=!!c.leading,f=(l="maxWait"in c)?n(r(c.maxWait)||0,b):f,m="trailing"in c?!!c.trailing:m),w.cancel=function(){void 0!==h&&clearTimeout(h),j=0,d=i=e=h=void 0},w.flush=function(){return void 0===h?g:v(p())},w}}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>k});var d=c(106),e=c(21),f=c(0),g=c("odsp.util_126"),h=c(2);let i="UserLicensedForCopilot",j="UserNotLicensedForCopilot",k=new g.v7({name:"isUserCopilotLicensed",factory:{dependencies:{pageContext:h.a.optional},create:({pageContext:a})=>{let b=!1,c=(0,d.a)();return window.sessionStorage.getItem("_isRunningTABTest")?(c.availability.isLicenseCheckBypassed=!0,b=!0):(b=!!a?.canUserUseSPCopilot,new f.a({name:b?i:j}).end({resultType:f.b.Success}),e.a.logData({name:b?i:j})),c.availability.isLicensed=b,c.availability.siteSubscriptionId=a?.siteSubscriptionId,{instance:()=>b}}}})}
,,(a,b,c)=>{"use strict";c.d(b,{a:()=>i,b:()=>l,c:()=>k,d:()=>m,e:()=>n});var d=c("tslib_533"),e=c(66),f=c(65),g=c(58),h="Fetch",i=3,j=function(a){var b;return null==(b=a.split(/[#?]/)[0].split(".").pop())?void 0:b.trim()};function k(a,b,c){return(0,d.yv)(this,void 0,void 0,function(){var f,h,i,k,l,m,n,o,p,q;return(0,d.SO)(this,function(d){switch(d.label){case 0:f=0,h="inferredExtension=".concat(j(a)),d.label=1;case 1:return d.trys.push([1,7,,8]),[4,fetch(a,b)];case 2:if(i=d.sent(),f=1,k=i.ok,l=i.status,m=i.statusText,n=i.headers,f=2,!k)throw new e.a(l,m,c,"Unexpected HTTP status ".concat(l," from fetch, ").concat(h," stage: ").concat(f),n);f=3,d.label=3;case 3:return d.trys.push([3,5,,6]),[4,i.arrayBuffer()];case 4:if(o=d.sent(),f=4,0===o.byteLength)throw new e.a(void 0,"EmptyFile",c,"Empty response from fetch ".concat(h," stage: ").concat(f),n,!0);return f=5,[2,o];case 5:throw(p=d.sent()).name===g.a||"NetworkError"===p.name?p:new e.a(void 0,"FailToReadResponse",c,"Failed to read response from fetch, ".concat(h," stage: ").concat(f," ").concat(p.name," ").concat(p.message),n);case 6:return[3,8];case 7:throw(q=d.sent()).name===g.a||"NetworkError"===q.name?q:new e.a(void 0,q.name,c,"".concat(q.message,", ").concat(h," stage: ").concat(f));case 8:return[2]}})})}function l(a,b,c,j,k){return(0,d.yv)(this,void 0,void 0,function(){var l,m,n,o,p,q,r,s;function t(g){return(0,d.yv)(this,void 0,void 0,function(){var i,j,m,n,p,q;return(0,d.SO)(this,function(r){switch(r.label){case 0:if(!g)return[2];return j=void 0===(i=(b||{}).headers)?{}:i,[4,fetch(a,(0,d.q5)((0,d.q5)({},b),{headers:(0,d.q5)((0,d.q5)({},j),{Range:"bytes=".concat(g.start,"-").concat(g.end-1)})}))];case 1:if((m=r.sent()).ok)return[3,2];throw n=new e.a(m.status,m.statusText,k,"Fetch request by range failed. fileSize: ".concat(c)),f.a.error(h,n),n;case 2:return[4,m.arrayBuffer()];case 3:p=r.sent(),o+=p.byteLength,q=new Uint8Array(p),l.set(q,g.start),r.label=4;case 4:return[2]}})})}return(0,d.SO)(this,function(a){switch(a.label){case 0:for(l=new Uint8Array(c),m=[],o=0,p=0,q=n=Math.ceil(c/i);m.length<i;)m.push({start:p,end:q}),p=q,q=Math.min(q+n,c);a.label=1;case 1:return a.trys.push([1,3,,4]),[4,Promise.all(m.map(t))];case 2:if(a.sent(),f.a.verbose(h,"Download by range completed"),o!==c)throw r=new e.c(e.b.RangeDownloadSizeMismatch,"Download by range failed. Incorrect size. fileSize: ".concat(c,", downloaded length: ").concat(o)),f.a.error(h,r),r;return[2,l.buffer];case 3:throw s=a.sent(),f.a.error(h,new e.c(e.b.FileDownloadFailed,"Download by range failed. e: ".concat(s,", fileSize: ").concat(c))),s.name!==g.a&&j(),s;case 4:return[2]}})})}function m(a,b,c,e,f,g,h){return(0,d.yv)(this,void 0,void 0,function(){var i;return(0,d.SO)(this,function(d){switch(d.label){case 0:return i={credentials:"same-origin",signal:e.signal},[4,n(b,c,g,h)];case 1:return i.headers=d.sent(),[4,k(a,i,f)];case 2:return[2,new Uint8Array(d.sent())]}})})}function n(a,b,c,e){return(0,d.yv)(this,void 0,void 0,function(){var f;return(0,d.SO)(this,function(d){switch(d.label){case 0:if(f={},void 0!==a&&void 0!==b&&(f.Range="bytes=".concat(a,"-").concat(b)),!e)return[3,2];return[4,e()];case 1:d.sent().forEach(function(a){f[a.name]=a.value}),d.label=2;case 2:return c&&(f.Authorization=c),[2,f]}})})}}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>g,b:()=>h,c:()=>j,d:()=>i,e:()=>f,f:()=>l,g:()=>m,h:()=>k,i:()=>e,j:()=>o});var d=c("odsp.util_126");let e="copilot1",f="copilot2",g="copilot3",h="copilot5",i="copilot7",j="copilot8",k="copilot9",l="copilot10",m="copilot11",n=!d.Ov.isActivated("5ee2b528-6fb0-4d67-9f0f-3abdeb6b9b6f");function o(a){return a===e||a===f||a===g||"copilot4"===a||n&&(a===h||"copilot6"===a||a===i||a===j||a===k||a===l||a===m||"copilot12"===a||"copilot13"===a)}}
,,(a,b,c)=>{"use strict";c.d(b,{a:()=>g,b:()=>f});var d=c(144),e=c(22);function f(a){let b=a[e.b.queryTypeParamKey];return b||(b=a[e.b.parentQueryTypeParamKey]),b?Number(b):d.a.Files}let g=f}
,,(a,b,c)=>{"use strict";c.d(b,{a:()=>d});let d=new(c("odsp.util_126")).v7({name:"dataRequestNoRedirect.key.dataRequestNoRedirect",factory:{dependencies:{},create:()=>({instance:void 0})}})}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>d});let d=new(c("odsp.util_126")).v7("itemComment")}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>l});var d=c("tslib_533"),e=c(182),f=c("react-lib"),g=c(37),h=c(340),i=c(219),j=c(234),k="dynamic-print-style",l=f.forwardRef(function(a,b){var c,l,m=a.filename,n=a.url,o=a.enablePrint,p=void 0===o||o,q=a.onDocumentLoaded,r=a.onFirstRenderVisible,s=f.useRef(null),t=f.useRef(void 0),u=(0,d.pM)(f.useState(!0),2),v=u[0],w=u[1],x=(0,d.pM)(f.useState(!0),2),y=x[0],z=x[1],A=(0,d.pM)(f.useState(!0),2),B=A[0],C=A[1],D=f.useRef(!1);f.useImperativeHandle(b,function(){return{getFilename:function(){return void 0===m?(0,h.a)(n):m},getViewer:function(){return s.current}}},[m,n]),f.useEffect(function(){e.a.mark("Start")},[]),f.useEffect(function(){var a=document.getElementById(k);if(B&&p)a&&document.head.removeChild(a);else if(!a){var b=document.createElement("style");b.id=k,b.innerHTML="\n            @media print {\n              * {\n                display: none !important;\n              }\n            }\n          ",document.head.appendChild(b)}},[B,p]);var E=f.useCallback(function(a){w(a.isFormFieldAllowed),z(a.isAnnotAllowed),C(a.isPrintAllowed),null==q||q(a)},[q]),F=f.useCallback(function(){D.current||(e.a.mark("FirstRenderCompleted"),null==r||r(),D.current=!0)},[r]);return f.createElement(i.a,{isAnnotationEnabled:!!a.enableEdit&&y,isFormFillingEnabled:!!a.enableEdit&&!!(null==(c=g.a.features)?void 0:c.enableFormFilling)&&v,isFreeTextEnabled:!!a.enableEdit&&!!(null==(l=g.a.features)?void 0:l.enableFreeText)&&y},f.createElement(j.a,(0,d.q5)({key:n,componentRef:s},a,{defaultPageNumber:t.current||a.defaultPageNumber,defaultScale:a.defaultScale,onDocumentLoaded:E,onFirstRenderVisible:F})))})}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>h,b:()=>f,c:()=>g});var d=c("tslib_533"),e=c("react-lib"),f=e.createContext({}),g=function(){return e.useContext(f)},h=function(a){var b=a.children,c=(0,d.dc)(a,["children"]);return e.createElement(f.Provider,{value:c},b)}}
,(a,b,c)=>{"use strict";var d,e;c.d(b,{a:()=>d}),(e=d||(d={})).Reset="Reset",e.Add="Add",e.Delete="Delete",e.Unknown="Unknown"}
,,,,,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>g,b:()=>h});var d=c("odsp.util_126"),e=c(81),f=c(270);let g=!d.Ov.isActivated("960440C4-4144-497B-83AA-14E753E48334");function h(a,b){if(g){if(!a||!b)return!1;try{if((0,f.a)(a)===b)return!0}catch(a){}try{if(a===b||a===(0,f.a)(b))return!0}catch(a){}return!1}return a===(b&&e.a(b))}}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>k});var d=c(112),e=c("odsp.util_126"),f=c(2),g=c(28);let h={ODB:-1434},i={pageContext:f.a},j=function(a){let{pageContext:b}=a,c=!(0,d.a)(b)&&!(0,g.a)(h);return j=()=>c,c},k=new e.v7({name:"isFavoritesEnabled",factory:{dependencies:i,create:a=>({instance:()=>j(a)})}})}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>g});var d=c(13),e=c(6);let f=c("odsp.util_126").Ov.isActivated("4F1CD7E0-DB72-441F-B805-84BDF8650728");function g(a,b){let{appPageContext:c}=b;return(!!f||!!new e.a(a).authority)&&new d.b({context:c}).getUrlParts({path:a}).geoRelation!==d.a.unknown}}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>e});var d=c("odsp.util_126");let e=new d.v7({name:"alwaysUseTokenFetcherForVroom",factory:new d.Uo(!1)})}
,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>bu});var d,e,f,g,h,i,j=c("tslib_533");c(890);var k=c(183),l=c(12),m=c(341),n=c(309),o=c(84),p=c(245),q=c.n(p),r=c(342),s=c(66);(d=g||(g={})).MipFileSizeExceeded="MipFileSizeExceeded",d.MipWasmLoadFailed="MipWasmLoadFailed",d.MipFetchTokenFailed="MipFetchTokenFailed",d.MipInitializationFailed="MipInitializationFailed",d.MipDecryptionFailed="MipDecryptionFailed",d.MipFetchTokenNotSupported="MipFetchTokenNotSupported",d.MipFetchTokenUnknownError="MipFetchTokenUnknownError",d.MipUnknownError="MipUnknownError",d.MipFileUnencrypted="MipFileUnencrypted",d.MipBadInputError="MipBadInputError",d.MipInsufficientBufferError="MipInsufficientBufferError",d.MipFileIOError="MipFileIOError",d.MipNetworkError="MipNetworkError",d.MipInternalError="MipInternalError",d.MipJustificationRequired="MipJustificationRequired",d.MipNotSupportedOperation="MipNotSupportedOperation",d.MipPrivilegedRequired="MipPrivilegedRequired",d.MipAccessDenied="MipAccessDenied",d.MipConsentDenied="MipConsentDenied",d.MipNoPermissions="MipNoPermissions",d.MipNoAuthToken="MipNoAuthToken",d.MipDisabledService="MipDisabledService",d.MipProxyAuthError="MipProxyAuthError",d.MipNoPolicy="MipNoPolicy",d.MipOperationCancelled="MipOperationCancelled",d.MipAdhocProtectionRequired="MipAdhocProtectionRequired",d.MipDeprecatedApi="MipDeprecatedApi",d.MipTemplateNotFound="MipTemplateNotFound",d.MipLabelNotFound="MipLabelNotFound",d.MipLabelDisabled="MipLabelDisabled",d.MipDoubleKeyDisabled="MipDoubleKeyDisabled",d.MipLicenseNotRegistered="MipLicenseNotRegistered",d.MipContentFormatNotSupported="MipContentFormatNotSupported",d.MipTemplateArchived="MipTemplateArchived",d.MipCustomerKeyUnavailable="MipCustomerKeyUnavailable",d.MipDelegateResponse="MipDelegateResponse",d.MipCount="MipCount",(e=h||(h={})).Trace="Trace",e.Info="Info",e.Warning="Warning",e.Error="Error",e.UnKnown="UnKnown";var t=c(343),u=c(92),v=c(65),w=c(182),x=c(85),y=c(64),z=c(588),A=c(888);let B=Symbol("Comlink.proxy"),C=Symbol("Comlink.endpoint"),D=Symbol("Comlink.releaseProxy"),E=Symbol("Comlink.thrown"),F=a=>"object"==typeof a&&null!==a||"function"==typeof a,G=new Map([["proxy",{canHandle:a=>F(a)&&a[B],serialize(a){let{port1:b,port2:c}=new MessageChannel;return H(a,b),[c,[c]]},deserialize:a=>(a.start(),K(a,[],void 0))}],["throw",{canHandle:a=>F(a)&&E in a,serialize:({value:a})=>[a instanceof Error?{isError:!0,value:{message:a.message,name:a.name,stack:a.stack}}:{isError:!1,value:a},[]],deserialize(a){if(a.isError)throw Object.assign(Error(a.value.message),a.value);throw a.value}}]]);function H(a,b=self){b.addEventListener("message",function c(d){let e;if(!d||!d.data)return;let{id:f,type:g,path:h}=Object.assign({path:[]},d.data),i=(d.data.argumentList||[]).map(O);try{var j,k;let b=h.slice(0,-1).reduce((a,b)=>a[b],a),c=h.reduce((a,b)=>a[b],a);switch(g){case"GET":e=c;break;case"SET":b[h.slice(-1)[0]]=O(d.data.value),e=!0;break;case"APPLY":e=c.apply(b,i);break;case"CONSTRUCT":j=new c(...i),e=Object.assign(j,{[B]:!0});break;case"ENDPOINT":{let{port1:b,port2:c}=new MessageChannel;H(a,c),k=[b],M.set(b,k),e=b}break;case"RELEASE":e=void 0;break;default:return}}catch(a){e={value:a,[E]:0}}Promise.resolve(e).catch(a=>({value:a,[E]:0})).then(a=>{let[d,e]=N(a);b.postMessage(Object.assign(Object.assign({},d),{id:f}),e),"RELEASE"===g&&(b.removeEventListener("message",c),I(b))})}),b.start&&b.start()}function I(a){"MessagePort"===a.constructor.name&&a.close()}function J(a){if(a)throw Error("Proxy has been released and is not useable")}function K(a,b=[],c=function(){}){let d=!1,e=new Proxy(c,{get(c,f){if(J(d),f===D)return()=>P(a,{type:"RELEASE",path:b.map(a=>a.toString())}).then(()=>{I(a),d=!0});if("then"===f){if(0===b.length)return{then:()=>e};let c=P(a,{type:"GET",path:b.map(a=>a.toString())}).then(O);return c.then.bind(c)}return K(a,[...b,f])},set(c,e,f){J(d);let[g,h]=N(f);return P(a,{type:"SET",path:[...b,e].map(a=>a.toString()),value:g},h).then(O)},apply(c,e,f){J(d);let g=b[b.length-1];if(g===C)return P(a,{type:"ENDPOINT"}).then(O);if("bind"===g)return K(a,b.slice(0,-1));let[h,i]=L(f);return P(a,{type:"APPLY",path:b.map(a=>a.toString()),argumentList:h},i).then(O)},construct(c,e){J(d);let[f,g]=L(e);return P(a,{type:"CONSTRUCT",path:b.map(a=>a.toString()),argumentList:f},g).then(O)}});return e}function L(a){var b;let c=a.map(N);return[c.map(a=>a[0]),(b=c.map(a=>a[1]),Array.prototype.concat.apply([],b))]}let M=new WeakMap;function N(a){for(let[b,c]of G)if(c.canHandle(a)){let[d,e]=c.serialize(a);return[{type:"HANDLER",name:b,value:d},e]}return[{type:"RAW",value:a},M.get(a)||[]]}function O(a){switch(a.type){case"HANDLER":return G.get(a.name).deserialize(a.value);case"RAW":return a.value}}function P(a,b,c){return new Promise(d=>{let e=[,,,,].fill(0).map(()=>Math.floor(Math.random()*Number.MAX_SAFE_INTEGER).toString(16)).join("-");a.addEventListener("message",function b(c){c.data&&c.data.id&&c.data.id===e&&(a.removeEventListener("message",b),d(c.data))}),a.start&&a.start(),a.postMessage(Object.assign({id:e},b),c)})}var Q=c("react-lib"),R=c(58),S=c(73),T=function(a,b){void 0===b&&(b=1);var c=a.map(function(a){return a.height*b}),d=a.map(function(a){return a.width*b}),e=a.length;return{width:Math.max.apply(Math,(0,j.lt)([],(0,j.pM)(c),!1))+(R.j+R.k)*b,height:(R.h+(e-1)*R.i+R.g)*b+d.reduce(function(a,b){return a+b},0)}},U=function(){function a(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){void 0===e&&(e=!1),void 0===f&&(f=!1),void 0===g&&(g=!0),void 0===h&&(h=!0),void 0===i&&(i=!0),void 0===j&&(j=!0),void 0===k&&(k=!0),void 0===l&&(l=!0),void 0===m&&(m=!0),this._isMipDecrypted=!1,this._isFileEncrypted=!1,this._isAnnotAllowed=!0,this._isFormFieldAllowed=!0,this._isCopyAllowed=!0,this._isEditAllowed=!0,this._isPrintAllowed=!0,this._isCopyAccessibleAllowed=!0,this._isSignAllowed=!0,this._scale=1,this._rotation=S.f.Degree0,this._originalLayoutSize=a,this._layoutSize=a,this._pageCount=b,this._originalPageSizes=c,this._pageSizes=c,v.a.verbose("PdfMetadata","Page count ".concat(b,", layout size (").concat(a.width,", ").concat(a.height,")")),this._mip=!!d,this._isMipDecrypted=e,this._isFileEncrypted=f,this._isSigned=n,this._isAnnotAllowed=g,this._isFormFieldAllowed=h,this._isCopyAllowed=i,this._isEditAllowed=j,this._isPrintAllowed=k,this._isCopyAccessibleAllowed=l,this._isSignAllowed=m,this._hasOutline=o,this._isOutlineDefaultOff=!this._hasOutline,this._needPassword=!1}return a.prototype.updateOriginalLayoutForProgressiveLoading=function(a,b){var c=this,d=this.inverted?b.map(function(a){var b=a.width;return{width:a.height,height:b}}):b,e=a.width!==this.originalLayoutSize.width||a.height!==this.originalLayoutSize.height||d.length!==this.originalPageSizes.length||d.some(function(a,b){var d=a.width,e=a.height;return d!==c._originalPageSizes[b].width||e!==c._originalPageSizes[b].height});return e&&(this._originalPageSizes=d,this._originalLayoutSize=this.inverted?T(this.originalPageSizes):a,this._originalLayoutSize=this.inverted?T(b):a,this.updateSizes()),e},a.prototype.addRotation=function(a){this._rotation=(this._rotation+a)%(S.f.Degree270+1),this.updateSizes()},Object.defineProperty(a.prototype,"scale",{get:function(){return this._scale},set:function(a){this._scale=a,this.updateSizes()},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"pageCount",{get:function(){return this._pageCount},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"rotation",{get:function(){return this._rotation},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"originalLayoutSize",{get:function(){return this._originalLayoutSize},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"layoutSize",{get:function(){return this._layoutSize},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"originalPageSizes",{get:function(){return this._originalPageSizes},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"pageSizes",{get:function(){return this._pageSizes},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"inverted",{get:function(){return this.rotation===S.f.Degree90||this.rotation===S.f.Degree270},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"mip",{get:function(){return this._mip},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"isMipDecrypted",{get:function(){return this._isMipDecrypted},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"isFileEncrypted",{get:function(){return this._isFileEncrypted},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"needPassword",{get:function(){return this._needPassword},set:function(a){this._needPassword=a},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"isSigned",{get:function(){return this._isSigned},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"hasOutline",{get:function(){return this._hasOutline},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"isAnnotAllowed",{get:function(){return this._isAnnotAllowed},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"isFormFieldAllowed",{get:function(){return this._isFormFieldAllowed},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"isCopyAllowed",{get:function(){return this._isCopyAllowed},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"isEditAllowed",{get:function(){return this._isEditAllowed},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"isPrintAllowed",{get:function(){return this._isPrintAllowed},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"isCopyAccessibleAllowed",{get:function(){return this._isCopyAccessibleAllowed},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"isSignAllowed",{get:function(){return this._isSignAllowed},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"isOutlineDefaultOff",{get:function(){return this._isOutlineDefaultOff},set:function(a){this._isOutlineDefaultOff=a},enumerable:!1,configurable:!0}),a.prototype.getDocPermissions=function(){return[{type:"Annot",isAllowed:this.isAnnotAllowed},{type:"Copy",isAllowed:this.isCopyAllowed},{type:"CopyAccessible",isAllowed:this.isCopyAccessibleAllowed},{type:"Edit",isAllowed:this.isEditAllowed},{type:"FormField",isAllowed:this.isFormFieldAllowed},{type:"Print",isAllowed:this.isPrintAllowed},{type:"Sign",isAllowed:this.isSignAllowed}]},a.prototype.updateSizes=function(){this.updatePageSizes(),this.updateLayoutSize()},a.prototype.updatePageSizes=function(){var a=this;this._pageSizes=this.originalPageSizes.map(function(b){var c=b.width*a.scale,d=b.height*a.scale,e=!a.inverted;return{width:e?c:d,height:e?d:c}})},a.prototype.updateLayoutSize=function(){this._layoutSize=this.inverted?T(this.originalPageSizes,this.scale):{width:this.originalLayoutSize.width*this.scale,height:this.originalLayoutSize.height*this.scale}},a}(),V=c(37),W=function(a){return(0,j.yv)(void 0,void 0,void 0,function(){var b,c,d,e;return(0,j.SO)(this,function(f){switch(f.label){case 0:if(b=void 0,!(null==(e=V.a.features)?void 0:e.enableEncrypt))return[3,2];return[4,a.hasSignature()];case 1:b=!!f.sent(),f.label=2;case 2:if(c=void 0,u.a.isActivated("AddOutlineCheck"))return[3,4];return[4,a.hasOutline()];case 3:c=!!f.sent(),f.label=4;case 4:return[4,a.getDocumentMetaData()];case 5:return[2,new U((d=f.sent()).layoutSize,d.pageCount,d.pagesSize,d.isMip,d.isMipDecrypted,d.isFileEncrypted,d.isAnnotAllowed,d.isFormFieldAllowed,d.isCopyAllowed,d.isEditAllowed,d.isPrintAllowed,d.isCopyAccessibleAllowed,d.isSignAllowed,b,c)]}})})},X=function(){function a(a,b,c){this._viewHandler=a,this._inputEvtHandler=b,this._metadata=c}return a.getInstance=function(b,c){return(0,j.yv)(this,void 0,void 0,function(){var d,e;return(0,j.SO)(this,function(f){switch(f.label){case 0:return d=a.bind,e=[void 0,b,c],[4,W(b)];case 1:return[2,new(d.apply(a,e.concat([f.sent()])))]}})})},a.prototype.dispose=function(){this._viewHandler.dispose()},a.prototype.initMetadata=function(){return(0,j.yv)(this,void 0,void 0,function(){var a;return(0,j.SO)(this,function(b){switch(b.label){case 0:return a=this,[4,W(this.viewHandler)];case 1:return a._metadata=b.sent(),[2]}})})},a.prototype.getOutlineData=function(){return(0,j.yv)(this,void 0,void 0,function(){return(0,j.SO)(this,function(a){return[2,this._viewHandler.getOutlineData()]})})},a.prototype.updateOriginalLayoutForProgressiveLoading=function(){return(0,j.yv)(this,void 0,void 0,function(){var a,b;return(0,j.SO)(this,function(c){switch(c.label){case 0:return[4,this._viewHandler.getDocumentLayoutSize()];case 1:return a=c.sent(),[4,this._viewHandler.getPageSizes()];case 2:return b=c.sent(),[2,this._metadata.updateOriginalLayoutForProgressiveLoading(a,b)]}})})},Object.defineProperty(a.prototype,"viewHandler",{get:function(){return this._viewHandler},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"inputEvtHandler",{get:function(){return this._inputEvtHandler},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"metadata",{get:function(){return this._metadata},enumerable:!1,configurable:!0}),a}(),Y=c(784),Z=c(208),$=c.n(Z),_=c(424),aa=c(589),ab=c(414),ac=u.a.isActivated("EnableShortDebounceForSelectedText")?500:50,ad=function(a){function b(b,c,d,e,f,g,h,i,k){var l=a.call(this,b)||this;return l.isSelecting=!1,l.scrollIntoView=$()(function(){if(l.searchScrollPayload){var a=l.searchScrollPayload,b=a.page,c=a.x,d=a.y,e=a.width,f=a.height,g=l.metadata,h=g.originalPageSizes,i=g.rotation,j=g.scale,k=(0,_.d)(new o.b(c,d,e,f),h[b],j,i).origin;l.goToPageFn(b,k,!0)}},500),l.handleTextSelected=$()(function(){var a;if(l.selectedText&&""!==l.selectedText){m.a.read(l.l10n.get("textSelectedAria",[l.selectedText]));var b=l.selectionEndPoint;l.selectionBeginPoint&&b&&l.selectionBeginPoint.y<b.y&&(b=l.selectionBeginPoint),null==(a=l.onTextSelected)||a.call(l,l.selectedText,b)}},ac),l.onKeyDown=function(a){return(0,j.yv)(l,void 0,void 0,function(){return(0,j.SO)(this,function(b){switch(b.label){case 0:if(!a.ctrlKey)return[3,5];switch(a.code){case"KeyA":return[3,1];case"KeyC":return[3,3]}return[3,4];case 1:return a.preventDefault(),[4,this.viewHandler.selectAll()];case 2:return b.sent(),[3,5];case 3:return this.copyToClipboard(),[3,5];case 4:return[3,5];case 5:return[2]}})})},l.copyToClipboard=function(){l.selectedText&&window.navigator.clipboard.writeText(l.selectedText)},l.getPageText=function(a){return(0,j.yv)(l,void 0,void 0,function(){return(0,j.SO)(this,function(b){return[2,this.viewHandler.getPageText(a)]})})},l.renderRect=function(a,b){return(0,j.yv)(l,void 0,void 0,function(){var c,d,e,f,g,h,i=this;return(0,j.SO)(this,function(j){switch(j.label){case 0:return c=this.metadata.layoutSize,d=(0,r.a)(),e=a.scale(d),f=u.a.isActivated("EnableAddRedundance")?0:Math.ceil(d),e.x-=f,e.y-=f,e.width+=2*f,e.height+=2*f,[4,this.viewHandler.selectRender(e,{width:(0,r.b)(c.width),height:(0,r.b)(c.height)})];case 1:return(g=j.sent())&&(h=(0,aa.a)(g),requestAnimationFrame(function(){i.setStatesFn(h),null==b||b()})),[2]}})})},l.pointerDown=!1,l.layoutManager=c,l.l10n=d,l.setStatesFn=e,l.goToPageFn=f,l.scrollViewerFn=g,l.onTextSelected=h,l.onTextDeselected=i,l.refreshViewPortForProgressiveLoadingFn=k,l}return(0,j.e2)(b,a),b.prototype.onNotification=function(a){var b;return(0,j.yv)(this,void 0,void 0,function(){var c,d,e,f,g,h,i;return(0,j.SO)(this,function(j){switch(j.label){case 0:switch(a.name){case 13:return[3,1];case 4:return[3,2];case 2:return[3,6];case 7:return[3,8]}return[3,9];case 1:return this.selectedText=a.payload,!this.pointerDown&&this.isSelecting&&this.handleTextSelected(),[3,10];case 2:return d=(c=a.payload).left,e=c.top,f=c.right,g=c.bottom,h=(0,aa.b)(d,e,f,g,this.metadata.scale),[4,null==(b=this.refreshViewPortForProgressiveLoadingFn)?void 0:b.call(this)];case 3:if(j.sent())return[3,5];return[4,this.renderRect(h)];case 4:j.sent(),j.label=5;case 5:case 9:return[3,10];case 6:return i=this.layoutManager.viewportRectRelativeToDocument,[4,this.renderRect(i)];case 7:return j.sent(),[3,10];case 8:return this.searchScrollPayload=a.payload,this.scrollIntoView(),[3,10];case 10:return[2]}})})},b.prototype.onPointerDown=function(a){0===a.button&&(this.pointerDown=!0,this.selectionBeginPoint=a?new o.a(a.clientX,a.clientY):void 0,this.deselectText(),this.isSelecting=!0)},b.prototype.onPointerMove=function(a){this.pointerDown&&this.trySelectionAutoScroll(a)},b.prototype.onPointerUp=function(a){this.pointerDown&&(this.selectionEndPoint=a?new o.a(a.clientX,a.clientY):void 0,this.pointerDown=!1,this.cancelSelectionScrollTimer(),this.selectText(),this.isSelecting=!1)},b.prototype.selectText=function(){this.handleTextSelected()},b.prototype.deselectText=function(){var a,b=this.selectedText;this.selectedText="",b&&!this.selectedText&&(null==(a=this.onTextDeselected)||a.call(this,b))},b.prototype.onGripperMove=function(a){this.trySelectionAutoScroll(a)},b.prototype.onGirpperUp=function(){this.cancelSelectionScrollTimer()},b.prototype.hasTextSelected=function(){return!!this.selectedText},b.prototype.trySelectionAutoScroll=function(a){var b,c,d=this;this.cancelSelectionScrollTimer();var e=this.layoutManager.rootRect,f=e.y,g=f+e.getClientHeight(),h=a.y<=f,i=a.y>=g;if(!(h||i))return!1;var j=h?a.y-f:a.y-g;return this.selectionAutoScrollTimerId=(b=function(){var a;null==(a=d.scrollViewerFn)||a.call(d,0,Math.min(R.c,j*R.d))},c=R.b,b(),window.setInterval(b,c)),!0},b.prototype.cancelSelectionScrollTimer=function(){this.selectionAutoScrollTimerId&&(window.clearInterval(this.selectionAutoScrollTimerId),this.selectionAutoScrollTimerId=void 0)},b}(ab.a),ae=c(211),af=c(340),ag="PdfDocumentLoader",ah=function(){function a(a,b,c,d,e,f){void 0===c&&(c=0),void 0===d&&(d=!1),this.url=a,this.token=e,this._filename=void 0===b?(0,af.a)(this.url):b,this._fileSize=c,this._enableRanges=d,this.abortController=new AbortController,this.getAuthHeaders=f}return a.prototype.dispose=function(){this.abortController.abort()},a.prototype.fetch=function(){return(0,j.yv)(this,void 0,void 0,function(){var a,b,c,d,e,f,g,h,i,k,l,m=this;return(0,j.SO)(this,function(j){switch(j.label){case 0:this.abortController.abort(),a=this._enableRanges&&0!==this._fileSize,j.label=1;case 1:if(j.trys.push([1,8,,9]),b=(this.abortController=new AbortController).signal,c={},!this.getAuthHeaders)return[3,3];return[4,this.getAuthHeaders()];case 2:j.sent().forEach(function(a){c[a.name]=a.value}),j.label=3;case 3:if(this.token&&(c.Authorization=this.token),d={credentials:"same-origin",signal:b,headers:c},!a)return[3,5];return[4,(0,ae.b)(this.url,d,this._fileSize,function(){m.abortController.abort()},"GetDocument")];case 4:return f=j.sent(),[3,7];case 5:return[4,(0,ae.c)(this.url,d,"GetDocument")];case 6:f=j.sent(),j.label=7;case 7:return e=f,v.a.verbose(ag,"The document is fetched"),g=new Uint8Array(e,0,e.byteLength),this._fileSize=g.byteLength,[2,g];case 8:if((h=j.sent()).name===R.a)return v.a.info(ag,"Aborted the document fetching request"),[2];throw i="NetworkError"===h.name?h.status:void 0,k=z.a.getTempAuthLogFields(this.url,this.token),l=new s.c(s.b.FileDownloadFailed,"Fail to download the PDF file, \n          status: ".concat(i,", \n          downloadByRange?: ").concat(a,", \n          fileSize: ").concat(this._fileSize,", \n          noTempAuth: ").concat(k.noTempAuth,", \n          useToken: ").concat(k.useToken)),x.a.logError(l.toCaughtError()),h;case 9:return[2]}})})},Object.defineProperty(a.prototype,"filename",{get:function(){return this._filename},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"fileSize",{get:function(){return this._fileSize},enumerable:!1,configurable:!0}),a}(),ai=function(){function a(a){this._needPassword=!1,this.noFailedAttempt=!0,this.onNeedPassword=a,this._needPassword=!1}return a.prototype.tryOpen=function(a,b){var c;return void 0===a&&(a=""),(0,j.yv)(this,void 0,void 0,function(){return(0,j.SO)(this,function(d){switch(d.label){case 0:if(!this._viewHandler)return[2,!1];return[4,this._viewHandler.openDocument(a)];case 1:if(d.sent())return[2,!0];return this.noFailedAttempt?(null==(c=this.onNeedPassword)||c.call(this),this.noFailedAttempt=!1,this._needPassword=!0):null==b||b(),[2,!1]}})})},a.prototype.reOpenDocumentWithOwnerPassword=function(a,b,c,d){return(0,j.yv)(this,void 0,void 0,function(){var e,f;return(0,j.SO)(this,function(g){switch(g.label){case 0:if(!this._viewHandler)return[2];g.label=1;case 1:return g.trys.push([1,3,,4]),[4,this._viewHandler.reloadUnchangedFileWithOwnerPassword(a,d)];case 2:return(e=g.sent())?null==b||b():e||null==c||c(),[3,4];case 3:return f=g.sent(),v.a.error("PdfDocumentOpener",f),[3,4];case 4:return[2]}})})},Object.defineProperty(a.prototype,"viewHandler",{set:function(a){this._viewHandler=a},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"needPassword",{get:function(){return this._needPassword},enumerable:!1,configurable:!0}),a.prototype.reset=function(){this.noFailedAttempt=!0,this._needPassword=!1},a}(),aj=function(){function a(a){this.dispatchEventFn=a}return a.prototype.onNotification=function(a){return(0,j.yv)(this,void 0,void 0,function(){var b,c,d,e,f,g,h,i,k,l;return(0,j.SO)(this,function(j){switch(a.name){case 26:c=(b=a.payload).pageIndex,d=b.left,e=b.top,f=b.right,g=b.bottom,h=b.text,i=b.fontSize,k=b.isMultiLine,l={pageIndex:c,rect:new o.b(d,e,f-d,g-e),text:h,fontSize:i,isMultiLine:k},this.dispatchEventFn(S.e.ShowTextField,l);break;case 27:this.dispatchEventFn(S.e.ShowTextField,void 0)}return[2]})})},a}(),ak="PdfFreeTextService",al=function(a){function b(b,c,d){var e=a.call(this,b)||this;return e.setInitialFontAttributes=function(a){e.initialFontAttribute=a},e.getAccDataInPage=function(a){return(0,j.yv)(e,void 0,void 0,function(){return(0,j.SO)(this,function(b){return[2,this.viewHandler.getAccDataInPage(a)]})})},e.applyFreeTextAttributes=function(){if(!u.a.isActivated("StoreFreeTextAttributeInLocalStorage"))try{var a=window.localStorage.getItem(R.r);if(a){var b=JSON.parse(a);e.setInitialFontAttributes(b)}}catch(a){v.a.error(ak,a)}},e.originalPageRects=c,e.dispatchEventFn=d,e.initialFontAttribute={fontSize:14,fontColor:R.q},e.applyFreeTextAttributes(),e}return(0,j.e2)(b,a),b.prototype.onNotification=function(a){return(0,j.yv)(this,void 0,void 0,function(){var b,c,d,e,f,g,h,i,k,l;return(0,j.SO)(this,function(m){if(0===this.originalPageRects.length)return[2];switch(b={},a.name){case 18:d=(c=a.payload).position,b={pageIndex:e=c.pageIndex,id:0,boundingBox:{left:d.x,top:d.y,right:0,bottom:0},text:"",textColor:this.initialFontAttribute.fontColor,fontSize:this.initialFontAttribute.fontSize,lineHeight:14*R.s/10,characterSpacing:R.o,newCreated:!0},(0,n.a)()&&(b.boundingBox.right=-(this.originalPageRects[e].width-d.x)),this.dispatchEventFn(S.e.ShowFreeText,b);break;case 19:l={left:h=(g=(f=a.payload.freeText).boundingBox).left,top:i=g.top,right:h+((k=g.right)-h),bottom:i+(g.bottom-i)},(0,n.a)()&&(l.right=-(this.originalPageRects[f.pageIndex].width-k),l.left=-(this.originalPageRects[f.pageIndex].width-h)),f.boundingBox=l,b=(0,j.q5)((0,j.q5)({},f),{newCreated:!1}),this.dispatchEventFn(S.e.ShowFreeText,b);break;case 20:this.dispatchEventFn(S.e.AnnotationChanged)}return[2]})})},b.prototype.storeFreeTextAttribute=function(){if(!u.a.isActivated("StoreFreeTextAttributeInLocalStorage"))try{var a=JSON.stringify(this.initialFontAttribute);window.localStorage.setItem(R.r,a)}catch(a){v.a.error(ak,a)}},b}(ab.a),am=c(590),an=c(591),ao=c(448),ap=function(a){switch(a){case"Text":return S.c.Text;case"Link":return S.c.Link;default:return S.c.Default}},aq=function(a){switch(a){case"Content":return 0;case"Cursor":return 1;case"Link":return 2;case"Search":return 3;case"Ink":return 4;case"Font":return 12;case"Document":return 5;case"Gripper":return 9;case"RangeRequest":return 10;case"FreeText":return 6;case"Watermark":return 7;case"Form":return 8;case"UpdateViewport":return 11;case"UndoRedo":return 13;case"Note":return 14;default:return 15}},ar=function(a){switch(a){case"DocumentSaved":return 0;case"InkStrokesAdded":return 1;case"InvalidateRect":return 4;case"InvalidateAll":return 2;case"DocumentSizeUpdated":return 3;case"SetDocumentDirty":return 8;case"ScrollIntoView":return 7;case"UpdateCursor":return 9;case"UpdateNumberOfFindResults":return 11;case"UpdateSelectedFindResult":return 12;case"UpdateLinkRect":return 10;case"UpdateSelectedText":return 13;case"NavigateTo":return 5;case"NavigateToDest":return 6;case"GripperPositionChanged":return 14;case"SendRangeRequest":return 15;case"DocumentReady":return 17;case"DocumentDownLoadComplete":return 16;case"ShowNewFreeText":return 18;case"ShowEditableFreeText":return 19;case"FreeTextChanged":return 20;case"WatermarkAdded":return 21;case"WatermarkEditsSaved":return 22;case"WatermarkDeleted":return 23;case"GetWatermarkInfos":return 24;case"SetWatermarkVisible":return 25;case"TextFieldFocused":return 26;case"TextFieldBlur":return 27;case"VisiblePagesLoaded":return 28;case"MissingFont":return 29;case"CanUndoRedoChanged":return 30;case"ShowEditableNote":return 32;default:return 33}},as=function(a){switch(a){case"DocumentSaved":return S.e.DocumentSaved;case"InkStrokesAdded":return S.e.InkStrokesAdded;case"InkAdded":return S.e.InkAdded;case"InkUpdated":return S.e.InkUpdated;case"SetDocumentDirty":return S.e.DocumentDirty;case"ShowEditableInk":return S.e.ShowEditableInk;case"ShowEraserableInk":return S.e.ShowErasableInk;default:throw"Unsupported notification name"}},at=function(a){a.preventDefault()},au=function(){function a(a){this.element=a}return a.prototype.activate=function(){this.element.addEventListener("touchmove",at,{passive:!1})},a.prototype.deactivate=function(){this.element.removeEventListener("touchmove",at)},a}(),av=function(a){function b(b,c,d,e,f){var g=a.call(this,b)||this;return g.onLongPress=function(){g.isGripperPosValid&&(g.isLongPress=!0,g.toggleGripperFn(!0),g.isGripperShown=!0)},g.onTouchMove=function(a,b){return(0,j.yv)(g,void 0,void 0,function(){var c;return(0,j.SO)(this,function(d){switch(d.label){case 0:if(!this.isGripperMoving)return[3,2];return a.preventDefault(),c=new o.a(a.touches[0].clientX,a.touches[0].clientY),this.contentService.onGripperMove(c),[4,this.inputEvtHandler.onPointerMove(b)];case 1:d.sent(),d.label=2;case 2:return[2]}})})},g.onTouchEnd=function(){return(0,j.yv)(g,void 0,void 0,function(){var a,b;return(0,j.SO)(this,function(c){switch(c.label){case 0:if(this.isGripperMoving||this.isLongPress?(this.contentService.onGirpperUp(),null==(b=this.contentService)||b.selectText()):(null==(a=this.contentService)||a.deselectText(),this.toggleGripperFn(!1),this.isGripperShown=!1),!this.isGripperMoving)return[3,2];return[4,this.inputEvtHandler.onPointerUp(new o.a(0,0))];case 1:c.sent(),c.label=2;case 2:return this.isGripperMoving=!1,this.isLongPress=!1,[2]}})})},g.onGripperTouchStart=function(a){return(0,j.yv)(g,void 0,void 0,function(){var b,c;return(0,j.SO)(this,function(d){switch(d.label){case 0:return this.isGripperMoving=!0,b=a?this.originalGripperPos.right:this.originalGripperPos.left,c=a?this.originalGripperPos.left:this.originalGripperPos.right,[4,this.inputEvtHandler.onPointerDown(b)];case 1:return d.sent(),[4,this.inputEvtHandler.onPointerMove(c)];case 2:return d.sent(),[2]}})})},g.gripperDeSelectText=function(){return(0,j.yv)(g,void 0,void 0,function(){return(0,j.SO)(this,function(a){switch(a.label){case 0:return[4,this.inputEvtHandler.onPointerUp(new o.a(0,0))];case 1:return a.sent(),[4,this.inputEvtHandler.onPointerDown(new o.a(0,0))];case 2:return a.sent(),[4,this.inputEvtHandler.onPointerUp(new o.a(0,0))];case 3:return a.sent(),[2]}})})},g.layoutManager=c,g.contentService=d,g.originalGripperPos={left:new o.a(0,0),right:new o.a(0,0)},g.isGripperMoving=!1,g.isLongPress=!1,g.isGripperPosValid=!1,g._isGripperShown=!1,g.toggleGripperFn=e,g.updateGripperPositionFn=f,g}return(0,j.e2)(b,a),b.prototype.onNotification=function(a){if(9===a.type&&14===a.name){var b=a.payload,c=b.leftGripperBoundingRect,d=b.rightGripperBoungdingRect;if(this.isGripperPosValid=c.right-c.left>0||d.right-d.left>0,this.isGripperPosValid){var e=function(a){return new o.a(a.left,(a.bottom+a.top)/2)};this.originalGripperPos.left=e(c),this.originalGripperPos.right=e(d),this.updateGripperPositionFn({left:(0,_.b)(c,!0,this.layoutManager.documentLeftToContent,this.layoutManager.scale,this.layoutManager.rotation),right:(0,_.b)(d,!0,this.layoutManager.documentLeftToContent,this.layoutManager.scale,this.layoutManager.rotation)})}}},Object.defineProperty(b.prototype,"isGripperShown",{get:function(){return this._isGripperShown},set:function(a){this._isGripperShown=a},enumerable:!1,configurable:!0}),b}(ab.a),aw="InputEvtService",ax=function(a){function b(b,c,d,e,f,g,h,i,k,l,m,n,p,q,r){var s=a.call(this,b)||this;return s._isFormFocused=!1,s.setMode=function(a){var b,c;a!==s.mode&&(s.mode=a,s.isEraseMode()?(s.updateCursor("Eraser"),null==(b=s.preventDefaultOnTouchMove)||b.activate()):s.isFreeTextMode()?s.updateCursor("FreeText"):(s.updateCursorFn(S.c.Default),null==(c=s.preventDefaultOnTouchMove)||c.deactivate()))},s.triggerPointerUp=function(a){return(0,j.yv)(s,void 0,void 0,function(){var b,c;return(0,j.SO)(this,function(d){switch(d.label){case 0:return b=this.layoutManager.convertPointFromClientToOriginalDocument(a),[4,null==(c=this.inputEvtHandler)?void 0:c.onPointerUp(b)];case 1:return d.sent(),[2]}})})},s.onPointerDown=function(a){return(0,j.yv)(s,void 0,void 0,function(){var b,c,d;return(0,j.SO)(this,function(e){switch(e.label){case 0:if(!this.shouldHandlePointerEvt(a.pointerType))return[2];return this.gripperService.toggleGripperFn(!1),this.isDisplayMode()&&(null==(c=this.contentService)||c.onPointerDown(a)),b=this,[4,null==(d=this.inputEvtHandler)?void 0:d.onPointerDown(this.getCursorInOriginDocument(new o.a(a.x,a.y)))];case 1:return b.isFormFocused=e.sent(),[2]}})})},s.onPointerMove=function(a){var b=a.x,c=a.y,d=a.pointerType;return(0,j.yv)(s,void 0,void 0,function(){var a,e,f,g,h;return(0,j.SO)(this,function(i){switch(i.label){case 0:if(!this.shouldHandlePointerEvt(d))return[2];return a=new o.a(b,c),(e=this.getCursorType())&&(f=this.layoutManager.convertPointFromClientToDocument(a),(null==(g=this.layoutManager.pageManager)?void 0:g.isPointInVisiblePages(f))?this.updateCursor(e):this.updateCursorFn(S.c.Default)),[4,null==(h=this.inputEvtHandler)?void 0:h.onPointerMove(this.getCursorInOriginDocument(a))];case 1:return i.sent(),[2]}})})},s.getCursorType=function(){switch(s.mode){case S.a.Erase:return"Eraser";case S.a.FreeText:return"FreeText";default:return null}},s.onPointerUp=function(a){return(0,j.yv)(s,void 0,void 0,function(){var b,c,d;return(0,j.SO)(this,function(e){switch(e.label){case 0:if(!this.shouldHandlePointerEvt(a.pointerType))return[2];return this.isDisplayMode()&&(null==(c=this.contentService)||c.onPointerUp(a)),b=this,[4,null==(d=this.inputEvtHandler)?void 0:d.onPointerUp(this.getCursorInOriginDocument(new o.a(a.x,a.y)))];case 1:return b.isFormFocused=e.sent(),[2]}})})},s.onClick=function(a){return(0,j.yv)(s,void 0,void 0,function(){var b,c,d,e;return(0,j.SO)(this,function(f){switch(f.label){case 0:if(b=a.type,c=a.detail,!("click"===b&&c>1&&c<4))return[3,2];return d=this,[4,null==(e=this.inputEvtHandler)?void 0:e.onMultiTapped(this.getCursorInOriginDocument(new o.a(a.x,a.y)),c)];case 1:d.isFormFocused=f.sent(),f.label=2;case 2:return[2]}})})},s.onTouchStart=function(a){return(0,j.yv)(s,void 0,void 0,function(){var b,c,d=this;return(0,j.SO)(this,function(e){switch(e.label){case 0:if(a.touches.length>1||(b=new o.a(a.touches[0].clientX,a.touches[0].clientY),this.touchDownPoint=b,this.isFreeTextMode()))return[2];if(c=this.getCursorInOriginDocument(b),this.isDisplayMode()&&(this.pressTimer=window.setTimeout(function(){return(0,j.yv)(d,void 0,void 0,function(){return(0,j.SO)(this,function(a){switch(a.label){case 0:return[4,this.inputEvtHandler.onMultiTapped(c,2)];case 1:return a.sent(),this.gripperService.onLongPress(),this.pressTimer&&(clearTimeout(this.pressTimer),this.pressTimer=void 0),[2]}})})},500)),this.gripperService.isGripperShown)return[3,2];return[4,this.inputEvtHandler.onPointerDown(c)];case 1:e.sent(),e.label=2;case 2:return[2]}})})},s.onTouchMove=function(a){return(0,j.yv)(s,void 0,void 0,function(){var b,c;return(0,j.SO)(this,function(d){switch(d.label){case 0:if(!this.isDisplayMode())return[2];return b=new o.a(a.touches[0].clientX,a.touches[0].clientY),c=this.getCursorInOriginDocument(b),this.resetTimer(),[4,this.gripperService.onTouchMove(a,c)];case 1:return d.sent(),[2]}})})},s.onTouchEnd=function(a){return(0,j.yv)(s,void 0,void 0,function(){var b,c;return(0,j.SO)(this,function(d){switch(d.label){case 0:if(a.changedTouches.length>1||(b=new o.a(a.changedTouches[0].clientX,a.changedTouches[0].clientY),!this.gripperService.isGripperShown&&this.isTouchMoving(b)))return[2];if(c=this.getCursorInOriginDocument(b),this.resetTimer(),!this.gripperService.isGripperShown)return[3,2];return[4,this.gripperService.onTouchEnd()];case 1:return d.sent(),[3,4];case 2:return[4,this.inputEvtHandler.onPointerUp(c)];case 3:d.sent(),d.label=4;case 4:return[2]}})})},s.onGripperTouchStart=function(a){return(0,j.yv)(s,void 0,void 0,function(){return(0,j.SO)(this,function(b){switch(b.label){case 0:return[4,this.gripperService.onGripperTouchStart(a)];case 1:return b.sent(),[2]}})})},s.gripperDeSelectText=function(){return(0,j.yv)(s,void 0,void 0,function(){return(0,j.SO)(this,function(a){switch(a.label){case 0:return[4,this.gripperService.gripperDeSelectText()];case 1:return a.sent(),[2]}})})},s.pasteTextIntoFormField=function(){return(0,j.yv)(s,void 0,void 0,function(){var a,b;return(0,j.SO)(this,function(c){switch(c.label){case 0:a="",c.label=1;case 1:return c.trys.push([1,4,,5]),[4,window.navigator.clipboard.readText()];case 2:if(0===(a=c.sent()).length)return[2];return[4,this.inputEvtHandler.pasteIntoFormField(a)];case 3:return c.sent(),[3,5];case 4:return b=c.sent(),v.a.error(aw,b),[2];case 5:return[2]}})})},s.formCopyAndCut=function(a,b){return(0,j.yv)(s,void 0,void 0,function(){var c,d,e,f,g,h,i,k,l;return(0,j.SO)(this,function(j){switch(j.label){case 0:return[4,this.inputEvtHandler.getFormSelectedText()];case 1:c=j.sent(),j.label=2;case 2:return j.trys.push([2,4,,5]),[4,window.navigator.clipboard.writeText(c)];case 3:return j.sent(),[3,5];case 4:return d=j.sent(),v.a.error(aw,d),[2];case 5:if(!("KeyX"===a&&c))return[3,11];if(null!=(i=this.inputEvtHandler))return[3,6];return e=void 0,[3,9];case 6:return g=(f=i).onKeyDown,[4,null==(k=this.inputEvtHandler)?void 0:k.getVirtualKeyFromEvt("Delete")];case 7:return h=[j.sent()],[4,null==(l=this.inputEvtHandler)?void 0:l.getModifierKeyFromEvt("None")];case 8:e=g.apply(f,h.concat([j.sent(),b])),j.label=9;case 9:return[4,e];case 10:j.sent(),j.label=11;case 11:return[2]}})})},s.onKeyDown=function(a,b){return(0,j.yv)(s,void 0,void 0,function(){return(0,j.SO)(this,function(c){switch(c.label){case 0:if(!(this.isDisplayMode()&&!this.isFormFocused&&a.ctrlKey))return[3,2];return[4,this.contentService.onKeyDown(a)];case 1:return c.sent(),[2];case 2:if(!(this.isFormFillingEnabledFn()&&(0,ao.b)()))return[3,4];return[4,this.handleKeyDownForForm(a,b)];case 3:c.sent(),c.label=4;case 4:return[2]}})})},s.isFormFillingEnabledFn=q,s.mode=S.a.None,s.layoutManager=c,s.l10n=d,s.contentService=e,s.gripperService=new av(b,c,e,f,g),s.pressTimer=void 0,s.updateCursorFn=n,r&&(s.preventDefaultOnTouchMove=new au(r)),s.goToPageFn=h,s.scrollByFn=i,s.scrollToFn=k,s.focusOnVirtualForwardFormFn=l,s.focusOnVirtualBackwardFormFn=m,s.onFormFocusFn=p,s}return(0,j.e2)(b,a),b.prototype.dispose=function(){var a;null==(a=this.preventDefaultOnTouchMove)||a.deactivate()},b.prototype.onNotification=function(a){switch(a.type){case 1:9===a.name&&this.isDisplayMode()&&this.updateCursorFn(ap(a.payload));break;case 9:this.gripperService.onNotification(a)}},b.prototype.isTouchMoving=function(a){var b=this.touchDownPoint&&a.distanceTo(this.touchDownPoint)>5;return this.touchDownPoint=void 0,b},b.prototype.resetTimer=function(){"number"==typeof this.pressTimer&&(clearTimeout(this.pressTimer),this.pressTimer=void 0)},b.prototype.getCursorInOriginDocument=function(a){return this.layoutManager.convertPointFromClientToOriginalDocument(a)},b.prototype.isDisplayMode=function(){return this.mode===S.a.None},b.prototype.isEraseMode=function(){return this.mode===S.a.Erase||this.mode===S.a.PointErase},b.prototype.isFreeTextMode=function(){return this.mode===S.a.FreeText},b.prototype.shouldHandlePointerEvt=function(a){return!a||"mouse"===a||!this.isDisplayMode()},b.prototype.isFormValidChars=function(a){return 1===a.length||a===an.a.Enter},b.prototype.updateCursor=function(a){return(0,j.yv)(this,void 0,void 0,function(){var b;return(0,j.SO)(this,function(c){switch(c.label){case 0:return[4,this.getCustomCursor(a)];case 1:return(b=c.sent())&&this.updateCursorFn(b),[2]}})})},b.prototype.getCustomCursor=function(a){return(0,j.yv)(this,void 0,void 0,function(){var b;return(0,j.SO)(this,function(c){switch(c.label){case 0:if(this.cursorHelper)return[3,2];return b=this,[4,(0,am.a)()];case 1:b.cursorHelper=c.sent(),c.label=2;case 2:switch(a){case"Eraser":return[2,this.cursorHelper.getEraserCursor()];case"FreeText":return[2,this.cursorHelper.getFreeTextCursor()];default:return[2,void 0]}}})})},Object.defineProperty(b.prototype,"isFormFocused",{get:function(){return this._isFormFocused},set:function(a){this.onFormFocusFn(a),this._isFormFocused=a},enumerable:!1,configurable:!0}),b.prototype.handleKeyDownForForm=function(a,b){var c,d,e,f,g,h,i;return(0,j.yv)(this,void 0,void 0,function(){var k,l,n,o,p,q,r,s,t,u,v,w,x,y,z;return(0,j.SO)(this,function(j){switch(j.label){case 0:if(k=a.key,Object.values(an.a).includes(k)&&a.preventDefault(),this.isFormValidChars(k)&&this.isFormFocused&&a.preventDefault(),!(l=1!==k.length))return[3,2];return[4,null==(c=this.inputEvtHandler)?void 0:c.getVirtualKeyFromEvt(k)];case 1:l=0===j.sent(),j.label=2;case 2:if(l)return[2];if(!a.ctrlKey)return[3,6];if("KeyC"!==a.code&&"KeyX"!==a.code)return[3,4];return[4,this.formCopyAndCut(a.code,b)];case 3:case 5:return j.sent(),[2];case 4:if("KeyV"!==a.code)return[3,6];return[4,this.pasteTextIntoFormField()];case 6:if(!(this.isFormValidChars(k)&&!a.ctrlKey))return[3,12];if(o=void 0,k!==an.a.Enter)return[3,8];return[4,null==(d=this.inputEvtHandler)?void 0:d.getVirtualKeyFromEvt(k)];case 7:return o=j.sent(),[3,9];case 8:o=k.charCodeAt(0),j.label=9;case 9:return q=(p=this.inputEvtHandler).onChar,r=[o],[4,null==(e=this.inputEvtHandler)?void 0:e.getModifierKeyFromEvt("None")];case 10:return[4,q.apply(p,r.concat([j.sent()]))];case 11:return n=j.sent(),k!==an.a.Space||n||this.goToPageFn(b+1),[2];case 12:if(!(v=a.shiftKey))return[3,14];return[4,null==(f=this.inputEvtHandler)?void 0:f.getModifierKeyFromEvt("Shift")];case 13:v=j.sent(),j.label=14;case 14:if(u=v)return[3,17];if(!(w=a.ctrlKey))return[3,16];return[4,null==(g=this.inputEvtHandler)?void 0:g.getModifierKeyFromEvt("Control")];case 15:w=j.sent(),j.label=16;case 16:u=w,j.label=17;case 17:if(t=u)return[3,19];return[4,null==(h=this.inputEvtHandler)?void 0:h.getModifierKeyFromEvt("None")];case 18:t=j.sent(),j.label=19;case 19:if(s=t,null!=(i=this.inputEvtHandler))return[3,20];return x=void 0,[3,22];case 20:return z=(y=i).onKeyDown,[4,this.inputEvtHandler.getVirtualKeyFromEvt(k)];case 21:x=z.apply(y,[j.sent(),s,b]),j.label=22;case 22:return[4,x];case 23:if(n=j.sent(),k===an.a.Tab&&(this.isFormFocused=n),n)k===an.a.Tab&&m.a.read(this.l10n.get("formFieldAria"));else switch(k){case an.a.Home:this.scrollToFn(0,0);break;case an.a.End:this.scrollToFn(0,this.layoutManager.documentSize.height);break;case an.a.ArrowDown:this.scrollByFn(0,100);break;case an.a.ArrowUp:this.scrollByFn(0,-100);break;case an.a.ArrowLeft:this.scrollByFn(-100,0);break;case an.a.ArrowRight:this.scrollByFn(100,0);break;case an.a.Tab:a.shiftKey?this.focusOnVirtualBackwardFormFn(b):this.focusOnVirtualForwardFormFn(b)}return[2]}})})},b.prototype.addFreeText=function(){var a,b;return(0,j.yv)(this,void 0,void 0,function(){var c;return(0,j.SO)(this,function(d){switch(d.label){case 0:return c=new o.a(document.documentElement.clientWidth/2,document.documentElement.clientHeight/2),[4,null==(a=this.inputEvtHandler)?void 0:a.onPointerDown(this.layoutManager.convertPointFromClientToOriginalDocument(c))];case 1:return d.sent(),[4,null==(b=this.inputEvtHandler)?void 0:b.onPointerUp(this.layoutManager.convertPointFromClientToOriginalDocument(c))];case 2:return d.sent(),m.a.read(this.l10n.get("freeTextAdded")),[2]}})})},b}(ab.a),ay=function(a){function b(b,c,d,e){var f=a.call(this,b)||this;return f.onNotification=function(a){switch(a.name){case 10:var b=a.payload,c=b.left,d=b.top,e=b.right,g=b.bottom;if(c===e||d===g)f.dispatchEventFn(S.e.ClearHighlightLink);else{var h=(0,aa.b)(c,d,e,g,f.metadata.scale),i=f.layoutManager.viewportRectRelativeToContent.origin.symmetricMap();h.origin=h.origin.plus(i),f.dispatchEventFn(S.e.HighlightLink,h)}break;case 5:var j=a.payload;f.navigateToWebLink(j);break;case 6:f.dispatchEventFn(S.e.ClearHighlightLink);var k=a.payload,l=k.page,m=k.x,n=k.y;f.navigateToDocumentLink(l,new o.a(m,n))}},f.getLinkInfosInPage=function(a,b){return(0,j.yv)(f,void 0,void 0,function(){return(0,j.SO)(this,function(c){return[2,this.viewHandler.getLinkInfosInPage(a,b?1:this.metadata.scale)]})})},f.layoutManager=c,f.goToPageFn=d,f.dispatchEventFn=e,f}return(0,j.e2)(b,a),b.prototype.navigateToDocumentLink=function(a,b){b.scale(this.metadata.scale),this.goToPageFn(a,b)},b.prototype.navigateToWebLink=function(a){(0,af.b)(a)?this.navigateToUrlViaATag(a):v.a.warn("PdfLinkService","Unsupported web link")},b.prototype.navigateToUrlViaATag=function(a){var b=document.createElement("a");b.setAttribute("href",a),b.setAttribute("target","_blank"),b.setAttribute("rel","noopener noreferrer"),b.click()},b}(ab.a),az=c(436);(f=i||(i={}))[f.Left=0]="Left",f[f.Right=1]="Right",f[f.Up=2]="Up",f[f.Down=3]="Down";var aA=function(a){var b=a.layoutSize;if(b.width*b.height!=0){var c=new o.b(0,0,b.width,b.height),d=a.rect.intersect(c);return d?(0,j.q5)((0,j.q5)({},a),{rect:d,layoutSize:{width:(0,r.b)(b.width),height:(0,r.b)(b.height)}}):void 0}},aB=function(a,b){if(a){var c=a.rect;return b&&c.x!==b.x&&c.y!==b.y?[{rect:new o.b(b.x,c.y,c.width,c.height),layoutSize:a.layoutSize},a]:[a]}},aC=function(a){function b(b,c,d,e){var f=a.call(this,b)||this;return f.firstRender=!0,f.itemQueue=[],f.msgQueue=az.a.getInstance(),f.setStatesFn=c,f.handleErrorFn=d,f.onInitialMetadataUpdated=e,f.viewHandler.setDPR((0,r.a)()),f}return(0,j.e2)(b,a),b.prototype.clear=function(){this.itemQueue=[],this.viewHandler.clearRender()},b.prototype.render=function(a){var b,c,d=aB(aA(a),null==(c=this.lastItemInQueue)?void 0:c.rect);d&&0!==d.length&&((b=this.itemQueue).push.apply(b,(0,j.lt)([],(0,j.pM)(d),!1)),this.updateMetadata(a.triggerType),this.itemQueue.length===d.length&&this.doRender(d[0]),this.internalRender())},b.prototype.updateMetadata=function(a){var b=this;if(this.lastItemInQueue){var c=this.lastItemInQueue,d=c.rect,e=c.layoutSize,f=c.rotation,g=o.b.create(d);this.msgQueue.add({target:this.viewHandler.setRenderingMetadata,args:[g.scale((0,r.a)()),e,f],onsuccess:function(){var c;"Init"===a&&(null==(c=b.onInitialMetadataUpdated)||c.call(b))},onerror:this.handleErrorFn},!0)}},b.prototype.internalRender=function(){for(;this.itemQueue.length>=2;)this.doRender(this.itemQueue[1],this.itemQueue[0]),this.itemQueue.shift()},b.prototype.doRender=function(a,b){var c=this,d=o.b.create(a.rect),e="Scroll"===a.triggerType,f=void 0;if(e&&b){var g=b.rect,h=d.intersect(g);if(h){if(d.y!==g.y){var j=d.y<g.y;f=j?i.Up:i.Down,d.height-=h.height,d.y=j?d.y:g.y+g.height}else if(d.x!==g.x){var k=d.x<g.x;f=k?i.Left:i.Right,d.width-=h.width,d.x=k?d.x:g.x+g.width}}}d.scale((0,r.a)()),v.a.verbose("PdfRenderService","Rect to render: ".concat(d.toString(),", in layout(").concat(a.layoutSize.width,", ").concat(a.layoutSize.height)),this.msgQueue.add({target:this.viewHandler.scrollRender,args:[d,a.layoutSize,a.rotation,e,f],onsuccess:function(b){var d,e=!1;if(b){var f=b.layoutSize,g=b.rotation;if(b&&(!f||f.width===(0,r.b)(c.metadata.layoutSize.width))&&(void 0===g||g===c.metadata.rotation)){b.triggerType=a.triggerType;var h=(0,aa.a)(b);c.firstRender?(h.firstRender=!0,c.firstRender=!1):h.originRelativeToDoc=h.origin,c.setStatesFn(h),e=!0}}null==(d=a.onCompleted)||d.call(a,e)},onerror:function(b){var d;a.onError?a.onError(b):null==(d=c.handleErrorFn)||d.call(c,b)}})},Object.defineProperty(b.prototype,"lastItemInQueue",{get:function(){return this.itemQueue.length>=1?this.itemQueue[this.itemQueue.length-1]:void 0},enumerable:!1,configurable:!0}),b}(ab.a),aD=function(a){function b(b){return a.call(this,b)||this}return(0,j.e2)(b,a),b.prototype.onNotification=function(a){var b,c;return(0,j.yv)(this,void 0,void 0,function(){var d,e,f,g;return(0,j.SO)(this,function(h){switch(h.label){case 0:switch(a.name){case 11:return[3,1];case 12:return[3,4]}return[3,5];case 1:if(e=(d=a.payload).totalResultCount,f=d.isFinalResult,0!==e)return[3,3];return[4,this.stopSearch()];case 2:h.sent(),h.label=3;case 3:return null==(b=this.callbacks)||b.onTotalResultUpdate(e,f),[3,6];case 4:return g=a.payload,null==(c=this.callbacks)||c.onHitIndexUpdate(g),[3,6];case 5:return[3,6];case 6:return[2]}})})},b.prototype.startSearch=function(a,b,c,d){return(0,j.yv)(this,void 0,void 0,function(){return(0,j.SO)(this,function(e){switch(e.label){case 0:return d&&(this.callbacks=d),[4,this.viewHandler.startSearch(a,b,c)];case 1:return e.sent(),[2]}})})},b.prototype.goToNextSearchResult=function(a){return(0,j.yv)(this,void 0,void 0,function(){return(0,j.SO)(this,function(b){switch(b.label){case 0:return[4,this.viewHandler.goToNextSearchResult(a)];case 1:return b.sent(),[2]}})})},b.prototype.stopSearch=function(){return(0,j.yv)(this,void 0,void 0,function(){return(0,j.SO)(this,function(a){switch(a.label){case 0:return[4,this.viewHandler.stopSearch()];case 1:return a.sent(),[2]}})})},b}(ab.a),aE=c(437),aF=function(){function a(){}return a.computeNewScale=function(a,b){var c=3*this.normalizeDelta(a),d=Math.pow(1.1,Math.ceil(Math.abs(c)));return aE.a.normalizeScale(c>=0?b*d:b/d,2)},a.normalizeDelta=function(a){var b=a.deltaX,c=a.deltaY,d=Math.atan2(c,b),e=135*Math.PI/180,f=Math.sqrt(b*b+c*c);switch(-45*Math.PI/180<d&&d<e&&(f=-f),a.deltaMode){case WheelEvent.DOM_DELTA_PIXEL:return f/900;case WheelEvent.DOM_DELTA_LINE:return f/30;default:return f}},a}(),aG=function(a,b,c){return(a-1)*(b-c)},aH=function(a){function b(b,c,d,e,f,g,h){var i=a.call(this,b)||this;return i.unfinishedZoomingList=[],i.throttledWheelZoom=q()(function(a){var b=aF.computeNewScale(a,i.metadata.scale);i.isValidScale(b)&&(i.curZoomOpt=void 0,i.blurZoom(b),i.debouncedRender())},100),i.debouncedRender=$()(function(){i.render()},200),i.blurZoom=function(a,b){if(!i.isValidScale(a))return!1;i.dispatchEventFn(S.e.ZoomStart),i.lastZoomSnapshot||i.refreshLastZoomSnapshot();var c,d=i.layoutManager.rootRect;b?i.metadata.layoutSize.width*a<=d.getClientWidth()&&(b.x=d.getClientWidth()/2):b=new o.a(d.getClientWidth()/2,d.getClientHeight()/2),v.a.verbose("PdfZoomService","newScale: ".concat(a,", anchor: (").concat(b.x,", ").concat(b.y,")"));var e=new o.a(d.getScrollLeft(),d.getScrollTop()),f=i.getViewportScrollVector(e,a/i.metadata.scale,b),g=i.lastZoomSnapshot,h=g.scale,j=g.visibleDocumentOrigin,k=a/(i.blurred?h:i.metadata.scale),l=i.getScaledVisibleDocumentOrigin(i.blurred?j:i.getCurrentVisibleDocumentOrigin(),k,b);i.scale=a,i.layoutManager.resetContentSize(),i.layoutManager.scrollPosition=new o.a(i.layoutManager.isDocumentWiderThanViewport()?Math.min(f.x,i.metadata.layoutSize.width-d.getClientWidth()):0,i.layoutManager.isDocumentHigherThanViewport()?Math.min(f.y,i.metadata.layoutSize.height-d.getClientHeight()):0);var m=1>Math.abs(e.x-d.getScrollLeft())&&(1>Math.abs(e.y-d.getScrollTop())||i.metadata.layoutSize.height<=d.getClientHeight());return i.triggerBlurDraw(l,k,m),i.blurred=!0,m||null==(c=i.preventScrollFn)||c.call(i),!0},i.render=function(){var a;if(!(i.unfinishedZoomingList.length>0)||i.unfinishedZoomingList[i.unfinishedZoomingList.length-1]!==i.metadata.scale){if((null==(a=i.lastZoomSnapshot)?void 0:a.scale)===i.metadata.scale&&0===i.unfinishedZoomingList.length)return void i.dispatchEventFn(S.e.ZoomEnd);i.unfinishedZoomingList.push(i.metadata.scale),requestAnimationFrame(function(){var a={scale:i.metadata.scale,visibleDocumentOrigin:i.getCurrentVisibleDocumentOrigin()};i.renderFn("Zoom").then(function(b){var c=i.unfinishedZoomingList.findIndex(function(b){return b===a.scale});i.unfinishedZoomingList.splice(c,1),0===i.unfinishedZoomingList.length&&i.dispatchEventFn(S.e.ZoomEnd),b&&(i.blurred=!1,i.refreshLastZoomSnapshot(a))})})}},i.layoutManager=c,i.renderFn=d,i.setStatesFn=e,i.dispatchEventFn=f,i.preventScrollFn=g,i.onScaleUpdated=h,aE.a.setMinMaxScale(i.minScale,i.maxScale),i}return(0,j.e2)(b,a),b.prototype.initScale=function(a){void 0===a&&(a=S.i.FitSize),this.updateZoomOpt(a),this.scale=this.getZoomScale(a)},b.prototype.isResponsiveZoomValid=function(){return!!this.curZoomOpt&&this.isValidScale(this.curZoomOpt)},b.prototype.responsiveZoom=function(a){if(!this.curZoomOpt)return!1;if(!a)return this.zoom(this.curZoomOpt);var b=this.getZoomScale(this.curZoomOpt);return!!this.isValidScale(b)&&(this.scale=b,!0)},b.prototype.zoom=function(a,b){var c=this.getZoomScale(a);if(!this.isValidScale(c))return!1;this.updateZoomOpt(a);var d=this.blurZoom(c,b);return this.debouncedRender(),d},b.prototype.wheelZoom=function(a){this.throttledWheelZoom(a)},b.prototype.isValidScale=function(a){var b=this.getZoomScale(a);return b>=this.minScale&&b<=this.maxScale&&b!==this.metadata.scale},Object.defineProperty(b.prototype,"minScale",{get:function(){return Math.min(R.z,this.getZoomScale(S.i.FitWidth),this.getZoomScale(S.i.FitSize))},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"maxScale",{get:function(){return Math.max(R.y,this.getZoomScale(S.i.FitWidth),this.getZoomScale(S.i.FitSize))},enumerable:!1,configurable:!0}),b.prototype.getZoomOpt=function(){return this.curZoomOpt},Object.defineProperty(b.prototype,"scale",{set:function(a){var b;this.metadata.scale=a,null==(b=this.onScaleUpdated)||b.call(this,a,this.curZoomOpt)},enumerable:!1,configurable:!0}),b.prototype.refreshLastZoomSnapshot=function(a){this.lastZoomSnapshot=a||{scale:this.metadata.scale,visibleDocumentOrigin:this.getCurrentVisibleDocumentOrigin()}},b.prototype.updateZoomOpt=function(a){this.curZoomOpt="number"==typeof a?void 0:a},b.prototype.getZoomScale=function(a){var b=this.convertScaleToNumber(a);return aE.a.normalizeScale(b,2)},b.prototype.convertScaleToNumber=function(a){if("number"==typeof a)return a;var b,c=this.layoutManager.rootRect,d=this.metadata.scale;if(a===S.i.FitWidth)return(c.getClientWidth()-10)/(this.metadata.layoutSize.width/d);var e=(null==(b=this.layoutManager.pageManager)?void 0:b.getCurrentPage())||0,f=this.metadata.pageSizes[e],g=f.width,h=f.height;return Math.min((c.getClientHeight()+20)/(h/d),(c.getClientWidth()-10)/(g/d+2*R.l))},b.prototype.getViewportScrollVector=function(a,b,c){var d=new o.a(this.layoutManager.documentLeftToViewport,0),e=(d.y+a.y)*(b-1)+aG(b,c.y,d.y),f=Math.max(0,a.y+e),g=aG(b,c.x,d.x),h=g>d.x?g-d.x:a.x;return new o.a(h,f)},b.prototype.triggerBlurDraw=function(a,b,c){var d=this,e=this.getCurrentVisibleDocumentOrigin(),f=c?new o.a(0,0):new o.a(a.x-e.x,a.y-e.y);requestAnimationFrame(function(){d.setStatesFn({prevOrigin:f,ratio:b})})},b.prototype.getScaledVisibleDocumentOrigin=function(a,b,c){return new o.a(a.x-aG(b,c.x,a.x),a.y-aG(b,c.y,a.y))},b.prototype.getCurrentVisibleDocumentOrigin=function(){return new o.a(this.layoutManager.visibleDocumentLeftToViewport,0)},b}(ab.a),aI=function(){function a(){this.element=document.body}return a.prototype.initialize=function(a){this.element=a},a.prototype.setWidth=function(a){var b=this;requestAnimationFrame(function(){b.element.style.width="".concat(a,"px")})},a.prototype.getClientWidth=function(){return this.element.clientWidth},a.prototype.getWidth=function(){return this.element.getBoundingClientRect().width},a.prototype.setHeight=function(a){var b=this;requestAnimationFrame(function(){b.element.style.height="".concat(a,"px")})},a.prototype.getClientHeight=function(){return this.element.clientHeight},a.prototype.getHeight=function(){return this.element.getBoundingClientRect().height},a.prototype.setSize=function(a,b){this.setHeight(b),this.setWidth(a)},a.prototype.setScrollLeft=function(a){var b=this;requestAnimationFrame(function(){b.element.scrollLeft=a,b.element===document.body&&(document.documentElement.scrollLeft=a)})},a.prototype.getScrollLeft=function(){return Math.round(this.element.scrollLeft)||0},a.prototype.setScrollTop=function(a){var b=this;requestAnimationFrame(function(){b.element.scrollTop=a,b.element===document.body&&(document.documentElement.scrollTop=a)})},a.prototype.getScrollTop=function(){return Math.round(this.element.scrollTop)||0},a.prototype.setScrollLocation=function(a){this.setScrollLeft(a.x),this.setScrollTop(a.y)},Object.defineProperty(a.prototype,"x",{get:function(){return this.element.getBoundingClientRect().x},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"y",{get:function(){return this.element.getBoundingClientRect().y},enumerable:!1,configurable:!0}),a}(),aJ=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return(0,j.e2)(b,a),b.prototype.setScrollLeft=function(b){this.scrollLeft=b,a.prototype.setScrollLeft.call(this,this.scrollLeft)},b.prototype.getScrollLeft=function(){return void 0===this.scrollLeft&&(this.scrollLeft=a.prototype.getScrollLeft.call(this)),this.scrollLeft},b.prototype.setScrollTop=function(b){this.scrollTop=b,a.prototype.setScrollTop.call(this,this.scrollTop)},b.prototype.getScrollTop=function(){return void 0===this.scrollTop&&(this.scrollTop=a.prototype.getScrollTop.call(this)),this.scrollTop},b.prototype.clear=function(){this.scrollTop=void 0,this.scrollLeft=void 0},b.prototype.reset=function(){this.setScrollTop(0),this.setScrollLeft(0),this.clear()},b}(aI),aK=function(a){function b(){return null!==a&&a.apply(this,arguments)||this}return(0,j.e2)(b,a),b.prototype.setWidth=function(b){var c,d=(null==(c=this.element.parentElement)?void 0:c.clientWidth)||0;this.width=b>d?b:d,a.prototype.setWidth.call(this,this.width)},b.prototype.getWidth=function(){return void 0===this.width&&(this.width=a.prototype.getWidth.call(this)),this.width},b.prototype.setHeight=function(b){this.height=b,a.prototype.setHeight.call(this,b)},b.prototype.getHeight=function(){return void 0===this.height&&(this.height=a.prototype.getHeight.call(this)),this.height},b.prototype.clear=function(){this.width=void 0,this.height=void 0},b.prototype.reset=function(){this.setHeight(0),this.setWidth(0),this.clear()},b}(aI),aL=function(a,b,c){return 1-(Math.max(0,b-c.y)+Math.max(0,c.y+c.height-b-a))/c.height},aM=function(){function a(a,b){var c=this;this.isPageVisible=function(a){var b=c.getYPosOfPage(a),d=c.rootRect.getScrollTop();return b+c.metadata.pageSizes[a].height>d&&b<d+c.rootRect.getClientHeight()},this.getScaledOriginalPageRects=function(a){void 0===a&&(a=c.metadata.scale);var b,d,e=[],f=c.metadata.originalPageSizes,g=R.i*a,h=c.metadata.originalLayoutSize.width*a,i=R.h*a;try{for(var k=(0,j.BW)(f),l=k.next();!l.done;l=k.next()){var m=l.value,n=m.width*a,p=m.height*a;e.push(new o.b((h-n)/2,i,n,p)),i+=p+g}}catch(a){b={error:a}}finally{try{l&&!l.done&&(d=k.return)&&d.call(k)}finally{if(b)throw b.error}}return e},this.getScaledOriginalPageRectByIndex=function(a,b){void 0===b&&(b=c.metadata.scale);var d=c.metadata.pageSizes,e=b/c.metadata.scale,f=R.i*b,g=d.slice(0,a).reduce(function(a,b){return a+b.height*e+f},R.h*b),h=d[a],i=h.width*e,j=h.height*e,k=(c.metadata.layoutSize.width-h.width)/2*e;return new o.b(k,g,i,j)},this.metadata=a,this.rootRect=b,this._currentIndex=this.getCurrentPage()}return a.prototype.getVisiblePageRects=function(){return this.getVisiblePages().map(function(a){return a.rect})},a.prototype.getAccessiblePages=function(a,b){void 0===b&&(b=1);var c,d=this.getVisiblePages().filter(function(b){return a.includes(b.index)});if(0===d.length||0===b)return d;b=Math.abs(b);for(var e=[],f=this.metadata.pageSizes,g=this.metadata.pageCount,h=d[0].index,i=d[0].rect.y,k=h-1;k>=h-b&&!(k<0);k--){var l=f[k],m=l.width,n=l.height;i=i-this.pageGap-n,e.push({index:k,rect:new o.b(0,i,m,n)})}(c=e.reverse()).push.apply(c,(0,j.lt)([],(0,j.pM)(d),!1));var p=d[d.length-1].index;i=d[d.length-1].rect.y;for(var q=p;q<p+b&&!(q>=g-1);q++){i=i+f[q].height+this.pageGap;var r=f[q+1],m=r.width,n=r.height;e.push({index:q+1,rect:new o.b(0,i,m,n)})}return e},a.prototype.isPointInVisiblePages=function(a){var b,c,d=a.x,e=a.y,f=this.getVisiblePages(),g=-1;try{for(var h=(0,j.BW)(f),i=h.next();!i.done;i=h.next()){var k=i.value,l=k.index,m=k.rect;if(e>=m.y&&e<=m.bottom&&d>=m.x&&d<=m.right){g=l;break}}}catch(a){b={error:a}}finally{try{i&&!i.done&&(c=h.return)&&c.call(h)}finally{if(b)throw b.error}}return!(g<0)},a.prototype.getPageIndexFromPointInOriginalLayout=function(a){var b,c,d=a.x,e=a.y,f=-1,g=this.metadata.originalLayoutSize.width,h=R.h;try{for(var i=(0,j.BW)(this.metadata.originalPageSizes),k=i.next();!k.done;k=i.next()){var l=k.value,m=l.width,n=l.height;f++;var p=new o.b((g-m)/2,h,m,n);if(e>=p.y&&e<=p.bottom&&d>=p.x&&d<=p.right)return f;h+=n+R.i}}catch(a){b={error:a}}finally{try{k&&!k.done&&(c=i.return)&&c.call(i)}finally{if(b)throw b.error}}return f},a.prototype.getCurrentPage=function(){var a=this.getVisiblePages();if(0===a.length)return 0;if(1===a.length)return a[0].index;var b=this.rootRect.getClientHeight(),c=this.rootRect.getScrollTop();return aL(b,c,a[0].rect)>=aL(b,c,a[1].rect)?a[0].index:a[1].index},a.prototype.getYPosOfPage=function(a){var b=this.metadata.pageCount;if(a<0||a>=b)return -1;for(var c=this.metadata.pageSizes,d=this.pageGap,e=R.h*this.metadata.scale,f=0;f<a;f++)e+=c[f].height+d;return e},a.prototype.getOriginalPageRects=function(){var a,b,c=R.h,d=[],e=this.metadata.originalLayoutSize.width;try{for(var f=(0,j.BW)(this.metadata.originalPageSizes),g=f.next();!g.done;g=f.next()){var h=g.value;d.push(new o.b((e-h.width)/2,c,h.width,h.height)),c+=h.height+R.i}}catch(b){a={error:b}}finally{try{g&&!g.done&&(b=f.return)&&b.call(f)}finally{if(a)throw a.error}}return d},a.prototype.getVisiblePages=function(){for(var a=[],b=this.metadata.pageSizes,c=this.metadata.layoutSize.width,d=this.rootRect.getScrollTop(),e=d+this.rootRect.getClientHeight(),f=R.h*this.metadata.scale,g=0;g<b.length;g++){var h=b[g],i=h.width,j=h.height;if(f<d&&f+j>d||f>=d&&f<e)a.push({index:g,rect:new o.b((c-i)/2,f,i,j)});else if(f>=e)break;f+=j+this.pageGap}return a},Object.defineProperty(a.prototype,"currentIndex",{get:function(){return this._currentIndex},set:function(a){this._currentIndex=a},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"pageGap",{get:function(){return R.i*this.metadata.scale},enumerable:!1,configurable:!0}),a}(),aN=function(){function a(){var a=this;this.convertPointFromClientToOriginalDocument=function(b){var c,d=a.convertPointFromClientToDocument(b);return d.scale(1/((null==(c=a._metadata)?void 0:c.scale)||1)),d},this.convertPointFromOriginalDocumentToClient=function(b){var c,d=new o.a(b.x,b.y);return a.convertPointFromClientToDocument(d.scale((null==(c=a._metadata)?void 0:c.scale)||1),!0)},this.getDistToViewportCenter=function(b){if(a.pageManager&&a._metadata){var c=a.pageManager.getYPosOfPage(b)+a._metadata.pageSizes[b].height/2;return Math.abs(a.rootRect.getScrollTop()+a.rootRect.getClientHeight()/2-c)}},this._rootRect=new aJ,this._contentRect=new aK}return a.prototype.initialize=function(a,b,c){this._rootRect.initialize(a),this._contentRect.initialize(b),this._onScrollPositionUpdated=c},Object.defineProperty(a.prototype,"metadata",{set:function(a){this._metadata=a,this._pageManager=a?new aM(a,this._rootRect):void 0},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"scrollPosition",{set:function(a){var b;this.rootRect.setScrollLocation(a),null==(b=this._onScrollPositionUpdated)||b.call(this,a.x,a.y)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"scrollLeft",{set:function(a){var b;this.rootRect.setScrollLeft(a),null==(b=this._onScrollPositionUpdated)||b.call(this,a,this.rootRect.getScrollTop())},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"scrollTop",{set:function(a){var b;this.rootRect.setScrollTop(a),null==(b=this._onScrollPositionUpdated)||b.call(this,this.rootRect.getScrollLeft(),a)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"documentSize",{get:function(){var a;return(null==(a=this._metadata)?void 0:a.layoutSize)||{width:0,height:0}},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"rootRect",{get:function(){return this._rootRect},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"contentRect",{get:function(){return this._contentRect},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"pageManager",{get:function(){return this._pageManager},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"currentScrollPosition",{get:function(){return new o.a(this.rootRect.getScrollLeft(),this.rootRect.getScrollTop())},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"scale",{get:function(){var a;return(null==(a=this._metadata)?void 0:a.scale)||1},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"rotation",{get:function(){var a;return(null==(a=this._metadata)?void 0:a.rotation)||0},enumerable:!1,configurable:!0}),a.prototype.resetContentSize=function(){this.contentRect.setSize(this.documentSize.width,this.documentSize.height)},a.prototype.scrollRootByPage=function(a,b,c){void 0===b&&(b=new o.a(0,0)),void 0===c&&(c=!1);var d,e,f=(null==(d=this._metadata)?void 0:d.pageCount)||0;if(a<0||a>=f)return!1;var g=null==(e=this.pageManager)?void 0:e.getYPosOfPage(a);if(void 0===g)return!1;var h=new o.a(b.x,g+b.y),i=this.rootRect;return(!c||h.y<i.getScrollTop()||h.y>i.getScrollTop()+i.getClientHeight())&&(this.scrollTop=h.y),(!c||0!==i.getScrollLeft()&&0!==h.x&&(h.x<i.getScrollLeft()||h.x>i.getScrollLeft()+i.getClientWidth()))&&(this.scrollLeft=h.x),!0},a.prototype.convertPointFromClientToDocument=function(a,b){void 0===b&&(b=!1);var c=b?1:-1,d=new o.a(c*this.rootRect.x,c*this.rootRect.y);return this.convertPointFromViewportToDocument(a.plus(d),b)},a.prototype.isDocumentWiderThanViewport=function(){return this.documentSize.width>this.rootRect.getClientWidth()},a.prototype.isDocumentHigherThanViewport=function(){return this.documentSize.height>this.rootRect.getClientHeight()},Object.defineProperty(a.prototype,"viewportRectRelativeToContent",{get:function(){return new o.b(this.rootRect.getScrollLeft(),this.rootRect.getScrollTop(),this.rootRect.getClientWidth(),this.rootRect.getClientHeight())},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"viewportRectRelativeToDocument",{get:function(){var a=this.convertPointFromViewportToDocument(new o.a(0,0));return new o.b(a.x,a.y,this.rootRect.getClientWidth(),this.rootRect.getClientHeight())},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"visibleDocumentRectRelativeToContent",{get:function(){return new o.b(this.visibleDocumentLeftToContent,this.rootRect.getScrollTop(),this.visibleDocumentWidth,this.visibleDocumentHeight)},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"visibleDocumentWidth",{get:function(){return this.isDocumentWiderThanViewport()?this.rootRect.getClientWidth():this.documentSize.width},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"visibleDocumentHeight",{get:function(){return this.rootRect.getClientHeight()},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"visibleDocumentLeftToContent",{get:function(){return this.isDocumentWiderThanViewport()?this.rootRect.getScrollLeft():(this.rootRect.getClientWidth()-this.documentSize.width)/2},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"visibleDocumentLeftToViewport",{get:function(){return this.isDocumentWiderThanViewport()?0:(this.rootRect.getClientWidth()-this.documentSize.width)/2},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"documentLeftToViewport",{get:function(){return(this.contentRect.getWidth()-this.documentSize.width)/2-this.rootRect.getScrollLeft()},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"documentLeftToContent",{get:function(){return this.documentSize.width>this.contentRect.getWidth()?0:(this.contentRect.getWidth()-this.documentSize.width)/2},enumerable:!1,configurable:!0}),a.prototype.getDocumentInitialScrollLeft=function(){return(this.contentRect.getWidth()-this.rootRect.getClientWidth())/2},a.prototype.convertPointFromViewportToDocument=function(a,b){void 0===b&&(b=!1);var c=b?-1:1,d=new o.a(c*this.rootRect.getScrollLeft(),c*this.rootRect.getScrollTop()).plus(this.contentOffsetFromDocument.scale(c));return a.plus(d)},Object.defineProperty(a.prototype,"contentOffsetFromDocument",{get:function(){return new o.a(this.isDocumentWiderThanViewport()?0:(this.documentSize.width-this.rootRect.getClientWidth())/2,0)},enumerable:!1,configurable:!0}),a}(),aO=function(){return(0,j.yv)(void 0,void 0,void 0,function(){var a;return(0,j.SO)(this,function(b){switch(b.label){case 0:return b.trys.push([0,3,,4]),[4,navigator.pageInteractionRestrictionManager.requestRevokePermission()];case 1:return[4,b.sent().revoke([{name:"screenshot"}])];case 2:return b.sent(),[2,!0];case 3:throw a=b.sent(),new s.c(s.b.MipProhibitScreenshotFailed,"PageInteractionRestrictionManager revoke failed: ".concat(a.message));case 4:return[2]}})})},aP=c(148),aQ=c(419),aR=c(219),aS=c(438),aT=c(205),aU=c(431),aV=c(426),aW=c(466),aX=c(202),aY="DisplayHelper",aZ=function(a){return a instanceof DOMException&&"QuotaExceededError"===a.name},a$=function(){try{var a=window.localStorage.getItem(R.e);return a?JSON.parse(a):[]}catch(a){return v.a.error(aY,a),[]}},a_=function(a){window.localStorage.setItem(R.e,JSON.stringify(a))},a0=function(a){var b=1,c=function(a){try{a_(a)}catch(d){if(aZ(d)&&b<3){if(a.pop(),0===a.length)return;b++,c(a)}else v.a.error(aY,d)}};c(a)},a1=function(a,b){aZ(a)?b.length>0&&(b.pop(),a0(b)):v.a.error(aY,a)},a2=function(){function a(a,b,c,d,e){var f=this;this.storeInfoInLocalStorage=function(a){if(f.shouldCacheDisplayInfo&&f.uniqueId)try{var b={uniqueId:f.uniqueId,pos:a.pos,scale:a.scale,rotation:a.rotation},c=a$(),d=c.findIndex(function(a){return a.uniqueId===f.uniqueId});-1!==d&&c.splice(d,1),c.unshift(b),c.length>30&&c.pop();try{a_(c)}catch(a){var e=a$();a1(a,e)}}catch(a){v.a.error(aY,a)}},this.applyInfoInLocalStorage=function(){if(f.shouldUseCachedGlobalZoomOption&&f.applyGlobalZoomOptFromLocalStorage(),f.shouldCacheDisplayInfo&&f.uniqueId)try{var a=a$(),b=a.findIndex(function(a){return a.uniqueId===f.uniqueId});if(-1!==b){var c=a[b],d=c.pos,e=c.scale,g=c.rotation;void 0!==d&&void 0!==e&&void 0!==g&&(f.renderInfo={pos:d,scale:e,rotation:g})}}catch(a){v.a.error(aY,a)}},this.uniqueId=b,this.layoutManager=a,this.defaultPageNumber=d,this.shouldCacheDisplayInfo=!(d||e)&&c,this.shouldUseCachedGlobalZoomOption=!u.a.isActivated("StoreZoomOptionInLocalStorage")&&!e&&c,this.renderInfo={scale:e}}return a.prototype.storeGlobalZoomOptInLocalStorage=function(a){if(this.shouldUseCachedGlobalZoomOption)try{localStorage.setItem(R.u,a.toString())}catch(a){v.a.error(aY,a)}},Object.defineProperty(a.prototype,"initialRenderOptions",{get:function(){return this.renderInfo},enumerable:!1,configurable:!0}),Object.defineProperty(a.prototype,"initialPos",{get:function(){if(this.renderInfo.pos)return this.renderInfo.pos;var a,b=this.layoutManager.getDocumentInitialScrollLeft(),c=(null==(a=this.layoutManager.pageManager)?void 0:a.getYPosOfPage(this.defaultPageNumber?this.defaultPageNumber-1:0))||0;return new o.a(b,c)},enumerable:!1,configurable:!0}),a.prototype.applyGlobalZoomOptFromLocalStorage=function(){try{var a=localStorage.getItem(R.u);(a===S.i.FitSize||a===S.i.FitWidth)&&(this.renderInfo.scale=a)}catch(a){v.a.error(aY,a)}},a}(),a3=c("fui.util_178");(0,a3.ZW)([{rawString:".pdfOuter_526606d6{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;height:100%}.pdfViewer_526606d6{-webkit-box-flex:1;-ms-flex:1 1 0px;flex:1 1 0;overflow:auto;width:100%;height:100%;-moz-user-select:none;-webkit-user-select:none;-ms-user-select:none;user-select:none}.pdfContent_526606d6{position:relative;overflow:hidden;min-width:100%;min-height:100%}.fitWidth_526606d6{max-width:100%;min-width:unset}.fillSize_526606d6{width:100%;height:100%}.hidden_526606d6{visibility:hidden}"}]);let a4="pdfOuter_526606d6";var a5=c(86),a6=c(439),a7=c(467),a8=c(220),a9=Q.lazy(function(){return c.e(32).then(c.bind(c,826)).then(function(a){return{default:a.GripperContainer}})}),ba=Q.lazy(function(){return c.e(32).then(c.bind(c,772)).then(function(a){return{default:a.ContextMenu}})}),bb=Q.memo(Q.forwardRef(function(a,b){var c=a.showForGripper,d=a.rotation,e=a.gripperPos,f=a.enableCopilot,g=a.onRequestCopilot,h=(0,j.pM)(Q.useState({text:"",position:void 0}),2),i=h[0],k=h[1],l=(0,j.pM)(Q.useState(!1),2),m=l[0],n=l[1];return Q.useImperativeHandle(b,function(){return{updateContextualMenuForMouse:function(a,b){k({text:a,position:b}),n(!0)}}}),Q.createElement(Q.Fragment,null,c&&Q.createElement(Q.Suspense,{fallback:Q.createElement("div",null)},Q.createElement(a9,{rotation:d,gripperPos:e,enableCopilot:f,onRequestCopilot:g})),!u.a.isActivated("EnableContextMenuForSelection")&&!c&&m&&Q.createElement(Q.Suspense,{fallback:Q.createElement("div",null)},Q.createElement(ba,{text:i.text,position:i.position,enableCopilot:f,onRequestCopilot:g,onFocusPdfViewer:a.onFocusPdfViewer})))}));bb.displayName="ContextMenuContainer";var bc=c(203);(0,a3.ZW)([{rawString:".root_d3fbf39d{width:100%}.page_d3fbf39d{position:absolute;left:50%;-webkit-transform:translate(-50%, 0);transform:translate(-50%, 0);-webkit-box-shadow:0 .3px .9px 0 rgba(0,0,0,.1),0 1.6px 3.6px 0 rgba(0,0,0,.13);box-shadow:0 .3px .9px 0 rgba(0,0,0,.1),0 1.6px 3.6px 0 rgba(0,0,0,.13)}.page_d3fbf39d .childWrapper_d3fbf39d{width:100%;height:100%}"}]);var bd="PreRenderImgs",be=function(a){var b=(0,j.pM)(Q.useState(!1),2),c=b[0],d=b[1],e=(0,aX.b)(),f=e.eventBus,g=e.pageManager,h=Q.useRef(!1),i=Q.useRef([]);return Q.useEffect(function(){var a=function(){h.current=!0},b=function(a){var b=a.left,c=a.top;if(h.current&&g){h.current=!1;var d=g.getPageIndexFromPointInOriginalLayout(new o.a(b,c)),e="".concat(d);i.current.includes(e)||i.current.push(e)}};return f.on(S.e.DocumentDirty,a),f.on(S.e.InvalidateRect,b),function(){f.off(S.e.DocumentDirty,a),f.off(S.e.InvalidateRect,b)}},[f,g]),Q.useEffect(function(){var b=function(){0!==i.current.length&&(a(i.current),d(!0),i.current=[])};return f.on(S.e.Scrolling,b),function(){f.off(S.e.Scrolling,b)}},[f,a]),{isInvalidateRendering:c,setIsInvalidateRendering:d}},bf=function(){var a=(0,j.pM)(Q.useState(!1),2),b=a[0],c=a[1],d=(0,aX.b)().eventBus;return Q.useEffect(function(){var a=function(){c(!0)};return d.on(S.e.InitialDisplayInfoApplied,a),function(){d.off(S.e.InitialDisplayInfoApplied,a)}},[d]),b},bg=function(a){var b=a.visiblePages,c=a.pageCount,d=a.rotation,e=a.renderTargetPageRectByIndex,f=a.getPageSize,g=a.getPredictedMemUsage,h=a.getDistToViewportCenter,i=a.isPageVisible,k=(0,j.pM)(Q.useState({}),2),l=k[0],m=k[1],n=Q.useRef({}),o=(0,bc.e)(b),p=bf(),q=(0,bc.e)(p),r=Q.useRef([]),t=Q.useRef(0),u=Q.useRef(az.a.getInstance()),w=(0,bc.a)(function(a){var b,c=n.current[a];c&&(null==(b=c.dispose)||b.call(c),delete n.current[a])}),y=be((0,bc.a)(function(a){var b,c;try{for(var d=(0,j.BW)(a),e=d.next();!e.done;e=d.next()){var f=e.value;w(f)}}catch(a){b={error:a}}finally{try{e&&!e.done&&(c=d.return)&&c.call(d)}finally{if(b)throw b.error}}m(function(b){var c,d,e={};try{for(var f=(0,j.BW)(Object.entries(b)),g=f.next();!g.done;g=f.next()){var h=(0,j.pM)(g.value,2),i=h[0],k=h[1];a.includes(i)||(e[i]=k)}}catch(a){c={error:a}}finally{try{g&&!g.done&&(d=f.return)&&d.call(f)}finally{if(c)throw c.error}}return v.a.verbose(bd,"removeInvalidatedPagesFromCache, pages=".concat(JSON.stringify(a)," | setCachedImgMap to ").concat(JSON.stringify(Object.keys(e)))),e})})),z=y.isInvalidateRendering,A=y.setIsInvalidateRendering,B=(0,bc.a)(function(a,b){return(0,j.yv)(void 0,void 0,void 0,function(){var c,e;return(0,j.SO)(this,function(f){return b?(e=(c=document.createElement("canvas")).getContext("2d"),c.width=b.width,c.height=b.height,null==e||e.putImageData(b,0,0),v.a.verbose(bd,"completed for ".concat(a)),[2,new Promise(function(b,e){try{c.toBlob(function(c){if(c){var f=URL.createObjectURL(c),g="".concat(a);n.current[g]={usedMemory:c.size,rotation:d,dispose:function(){URL.revokeObjectURL(f)}},m(function(a){var b,c,d,e={};try{for(var h=(0,j.BW)(Object.entries(a)),i=h.next();!i.done;i=h.next()){var k=(0,j.pM)(i.value,2),l=k[0],m=k[1];e[l]=m}}catch(a){c={error:a}}finally{try{i&&!i.done&&(d=h.return)&&d.call(h)}finally{if(c)throw c.error}}return e[g]=(b={width:"100%",height:"100%"},void 0!==n.current[g]?Q.createElement("img",{src:f,style:b}):Q.createElement(Q.Fragment,null)),e}),b()}else e(new s.c(s.b.PreRenderError,"canvas.toBlob returns null"))})}catch(a){e(new s.c(s.b.PreRenderError,"Fail in canvas.toBlob: ".concat(a)))}})]):[2]})})}),C=Q.useCallback(function(){return Object.keys(n.current).map(function(a){return parseInt(a)})},[]),D=Q.useCallback(function(){var a,b=-1;return C().forEach(function(c){var d=null==h?void 0:h(c);void 0!==d&&(void 0===a||d>a)&&(a=d,b=c)}),{maxDTV:a,indexWithMaxDTV:"".concat(b)}},[C,h]),E=Q.useCallback(function(){var a=t.current=t.current+1,d=(0,j.pM)([Math.max.apply(Math,(0,j.lt)([],(0,j.pM)(b),!1))+a,Math.min.apply(Math,(0,j.lt)([],(0,j.pM)(b),!1))-a],2),e=d[0],f=d[1];e<c&&r.current.push(e),f>=0&&r.current.push(f)},[c,b]),F=(0,bc.a)(function(a){return(0,j.yv)(void 0,void 0,void 0,function(){var b,c,d,f,k,l;return(0,j.SO)(this,function(o){return(b=Object.values(n.current).map(function(a){return a.usedMemory}).reduce(function(a,b){return a+b},0),c=g(a)||0,v.a.verbose(bd,"tryRenderTargetPage ".concat(a,", usedMemMap=").concat(JSON.stringify(n.current),", predictedIncomingMemUsage=").concat(c)),b+c<0xa00000)?(r.current.shift(),[2,new Promise(function(b,c){u.current.setPreRenderTask({target:e,args:[a],isPageVisible:function(){return(null==i?void 0:i(a))||!1},onsuccess:function(c){B(a,c).catch(function(a){v.a.error(bd,a)}).finally(function(){b(!0)})},onerror:function(){var b="Failed to prerender page ".concat(a);v.a.error(bd,Error(b)),c(b)},oncancel:function(){v.a.verbose(bd,"cancel pre-render for ".concat(a)),b(!1)}})})]):(d=null==h?void 0:h(a),k=(f=D()).maxDTV,l=f.indexWithMaxDTV,void 0!==d&&void 0!==k&&d<k)?(w(l),m(function(a){var b,c,d={};try{for(var e=(0,j.BW)(Object.entries(a)),f=e.next();!f.done;f=e.next()){var g=(0,j.pM)(f.value,2),h=g[0],i=g[1];h!==l&&(d[h]=i)}}catch(a){b={error:a}}finally{try{f&&!f.done&&(c=e.return)&&c.call(e)}finally{if(b)throw b.error}}return v.a.verbose(bd,"setCachedImgMap - ".concat(JSON.stringify(Object.keys(d)))),d}),[2,F(a)]):(r.current=[],t.current=0,[2,!1])})})}),G=(0,bc.a)(function(){if(0===r.current.length&&(E(),0===r.current.length))return Promise.resolve(!1);var a=r.current[0];return C().includes(a)?(v.a.verbose(bd,"doRender return, page ".concat(a," hits the cache")),r.current.shift(),Promise.resolve(!0)):F(a)}),H=(0,bc.a)(function(a){return(0,j.yv)(void 0,void 0,void 0,function(){return(0,j.SO)(this,function(b){return a||v.a.verbose(bd,"renderInLoop"),[2,G().then(function(a){return a?H(!0):void v.a.verbose(bd,"The render loop is ended")},function(a){var b=new s.c(s.b.PreRenderError,"Exit render loop, reason: ".concat(a));x.a.logError(b.toCaughtError())})]})})});Q.useEffect(function(){(z||!q&&p||0!==b.length&&JSON.stringify(b)!==JSON.stringify(o))&&p&&(r.current=b.slice(),t.current=0,u.current.cancelPreRenderTask(),v.a.verbose(bd,"isInvalidateRendering=".concat(z,", visiblePages=").concat(JSON.stringify(b),", waitingList=").concat(JSON.stringify(r.current))),H(),A(!1))},[b,o,H,z,A,p,q]),Q.useEffect(function(){var a=u.current;return function(){a.cancelPreRenderTask()}},[]);var I=(0,bc.a)(function(a,b){var c,d,e={};try{for(var f=(0,j.BW)(Object.entries(l)),g=f.next();!g.done;g=f.next()){var h=(0,j.pM)(g.value,2),i=h[0],k=h[1],o=n.current[i];if(o){var p=o.rotation,q=a-p,r=q%2==0,s=b(parseInt(i)),t=s.width,u=s.height,v=(0,j.pM)(r?["100%","100%",0]:["".concat(u,"px"),"".concat(t,"px"),(u-t)/2],3),w=v[0],x=v[1],y=v[2],z={width:w,height:x,transform:"translate(".concat(-y,"px, ").concat(y,"px) rotate(").concat(q*R.A,"deg)")};e[i]=Q.cloneElement(k,{style:z})}}}catch(a){c={error:a}}finally{try{g&&!g.done&&(d=f.return)&&d.call(f)}finally{if(c)throw c.error}}m(e)});return Q.useEffect(function(){I(d,f)},[f,I,d]),l},bh=function(a){var b=a.renderPreRenderList,c=bg((0,j.dc)(a,["renderPreRenderList"]));return Q.createElement(Q.Fragment,null,b(function(a){return c[a]}))},bi=Q.memo(function(a){var b=a.pageInfos,c=a.metadata,d=a.curPageIndex,e=a.getScaledOriginalPageRectByIndex,f=a.getDistToViewportCenter,g=a.isPageVisible,h=(0,aX.b)(),i=h.viewHandler,k=h.dpr,l=h.eventBus,m=h.onFirstRenderVisibleFn,n=h.enablePreRender,o=(0,j.pM)(Q.useState(0),2),p=o[0],q=o[1];Q.useEffect(function(){var a=function(){q(function(a){return a+1})};return l.on(S.e.DocumentReloaded,a),function(){l.off(S.e.DocumentReloaded,a)}},[l]);var r=Q.useMemo(function(){var a=null==b?void 0:b.map(function(a){return a.index});return f&&a?a.sort(function(a,b){return(f(a)||0)-(f(b)||0)}):a||[]},[f,b]),s=Q.useMemo(function(){if(n){var a,e=null==(a=null==b?void 0:b.find(function(a){return a.index===d}))?void 0:a.rect;if(e&&void 0!==d){var f=c.pageSizes[d],g=f.width,h=f.height,i=(0,j.pM)([g/c.scale,h/c.scale],2),l=i[0],m=i[1],o=Math.min(k,3);return Math.round(Math.min(e.height/2,900)/m*o*l)/l}}},[d,k,n,c.pageSizes,c.scale,b]),t=Q.useCallback(function(a){if(void 0!==s){var b=c.originalPageSizes[a];return b.width*s*b.height*s*.5}},[c.originalPageSizes,s]),v=(0,bc.a)(function(a){var b=null==e?void 0:e(a,s),d=c.layoutSize,f=d.width,g=d.height;return i&&b&&void 0!==s?i.render(b,{width:f/c.scale*s,height:g/c.scale*s}):Promise.resolve(void 0)}),w=Q.useRef(!0),x=(0,bc.a)(function(a,b){var c=null==b?void 0:b(a);return!u.a.isActivated("FRTWithPrerender")&&c&&w.current&&(null==m||m(),w.current=!1),c}),y=(0,bc.d)(l),z=(0,bc.c)(l),A=(0,bc.a)(function(a){return Q.createElement("div",{className:"root_d3fbf39d"},null==b?void 0:b.map(function(b){var c=b.index,d=b.rect;return Q.createElement("div",{key:c,className:"page_d3fbf39d",style:(0,j.q5)((0,j.q5)({},{width:"".concat(d.width,"px"),height:"".concat(d.height,"px"),top:"".concat(d.y,"px")}),{backgroundColor:"#ffffff"})},Q.createElement("div",{className:"childWrapper_d3fbf39d",style:{visibility:y&&!z?"hidden":"visible"}},x(c,a)))}))}),B=Q.useCallback(function(a){return c.pageSizes[a]},[c.pageSizes]);return Q.createElement(Q.Fragment,null,n?Q.createElement(bh,{key:p,renderPreRenderList:A,visiblePages:r,pageCount:c.pageCount,rotation:c.rotation,renderTargetPageRectByIndex:v,getPredictedMemUsage:t,getDistToViewportCenter:f,isPageVisible:g,getPageSize:B}):A())});(0,a3.ZW)([{rawString:".root_4eb6d5c3{position:absolute}.root_4eb6d5c3 canvas{position:absolute;width:100%;height:100%}.canvasFixingExtraWhitePage_4eb6d5c3{left:0px}"}]);var bj=function(a){var b,c=document.createElement("canvas");return c.width=a.width,c.height=a.height,null==(b=c.getContext("2d"))||b.putImageData(a,0,0),c},bk=function(a,b){if(a.width&&a.height){var c,d=document.createElement("canvas");return d.width=a.width,d.height=a.height,null==(c=d.getContext("2d"))||c.drawImage(a,(null==b?void 0:b.x)||0,(null==b?void 0:b.y)||0),d}},bl=function(a){var b=a.width,c=a.height,d=a.top,e=a.left,f=a.renderResult,g=a.blurRenderResult,h=a.getViewportRectRelativeToContentOffset,i=(0,r.a)()*b,j=(0,r.a)()*c,k=(0,aX.b)(),l=k.eventBus,m=k.onFirstRenderVisibleFn,n=(0,bc.e)({left:e,top:d})||{left:e,top:d},p=Q.useRef(null),q=Q.useRef();Q.useLayoutEffect(function(){if(p.current&&b*c!=0&&!g){var a=new o.a(n.left-e,n.top-d).scale((0,r.a)()),f=bk(p.current,a),h=p.current.getContext("2d");null==h||h.clearRect(0,0,i,j),f&&(null==h||h.drawImage(f,0,0))}},[d,e,b,c,g,n.left,n.top,i,j]),Q.useLayoutEffect(function(){var a,b=p.current;if(b){var c=b.getContext("2d");if(!f){null==c||c.clearRect(0,0,i,j);return}var d=f.image,e=f.originRelativeToDoc,g=f.origin;if(null==(a=V.a.features)?void 0:a.enableCalculateOffsetAtDrawTimeFix){var k=null==h?void 0:h();k&&(g=f.origin.plus(k))}g.scale((0,r.a)()),null==c||c.clearRect(g.x,g.y,d.width,d.height),null==c||c.drawImage(bj(d),g.x,g.y),"Zoom"===f.triggerType?w.a.sessionMark("End",{rect:JSON.stringify({x:g.x*(0,r.a)(),y:g.y*(0,r.a)(),width:d.width,height:d.height})}):"Scroll"===f.triggerType&&e&&w.a.sessionMark("End",{rect:JSON.stringify({x:e.x,y:e.y,width:d.width,height:d.height})}),f.firstRender&&(null==m||m()),q.current=bk(b,new o.a(0,0))}},[j,i,f,m]);var s=(0,bc.c)(l);return Q.useLayoutEffect(function(){if(!s&&p.current&&q.current&&g){var a=p.current.getContext("2d");null==a||a.clearRect(0,0,i,j);var b=g.prevOrigin;b.scale((0,r.a)()).round();var c=q.current.width*(g.ratio||1);null==a||a.drawImage(q.current,0,0,q.current.width,q.current.height,b.x,b.y,c,c*q.current.height/q.current.width),w.a.sessionMark("RenderBlur")}},[g,s,j,i]),Q.createElement("div",{style:{width:"".concat(b,"px"),height:"".concat(c,"px"),left:"".concat(e,"px"),top:"".concat(d,"px")},className:"root_4eb6d5c3"},Q.createElement("canvas",{width:i,height:j,ref:p,style:{visibility:s?"hidden":"visible"},className:"canvasFixingExtraWhitePage_4eb6d5c3"}))},bm=Q.lazy(function(){return Promise.all([c.e("odsp.react.lib"),c.e(28)]).then(c.bind(c,822)).then(function(a){return{default:a.AnnotationOverlays}})}),bn=Q.lazy(function(){return c.e(30).then(c.bind(c,823)).then(function(a){return{default:a.NoteOverlaysContainer}})}),bo=Q.lazy(function(){return c.e(41).then(c.bind(c,824)).then(function(a){return{default:a.HighlightBoundingRegionCanvas}})}),bp=Q.lazy(function(){return c.e(27).then(c.bind(c,825)).then(function(a){return{default:a.AccessibleVirtualPanel}})}),bq=Q.forwardRef(function(a,b){var c,d,e,f,g,h,i,k=a.enableAnnotation,l=a.visibleDocumentRect,m=a.viewportRenderResult,n=a.getViewportRectRelativeToContentOffset,p=a.viewportBlurRenderResult,q=a.curPageIndex,r=a.visiblePageInfos,s=a.metadata,t=a.annotHandler,v=a.annotParams,w=a.viewHandler,x=a.contentRef,y=a.getScaledOriginalPageRectByIndex,z=a.getDistToViewportCenter,A=a.isPageVisible,B=a.onEditStateChanged,C=a.getPageTextFn,D=a.getLinkInfosFn,E=a.goToPageFn,F=a.enableCopilot,G=a.onRequestCopilot,H=a.toggleGripperFn,I=a.renderRectFn,J=a.renderViewportFn,K=a.syncModeFn,L=a.zoomOpt,M=a.highlightCanvasRect,N=a.highlightBoundingRegions,O=a.visibleDocumentLeftOffsetRelativeToContent,P=a.onFocusPdfViewer,R=(v||{}).mode,T=(0,a7.b)(),U=T.editState,W=T.dispatchEditAction,X=(0,aX.b)().eventBus,Y=(0,a5.a)(),Z=(0,j.pM)(Q.useState(!1),2),$=Z[0],_=Z[1],aa=(0,j.pM)(Q.useState({left:new o.a(0,0),right:new o.a(0,0)}),2),ab=aa[0],ac=aa[1],ad=Q.useRef(null),ae=(0,aU.b)().deSelectText,af=Q.useRef(),ag=Q.useRef(null),ah=Q.useCallback(function(){W({type:a8.a.Reset})},[W]);Q.useEffect(function(){af.current=B},[B]),Q.useEffect(function(){var a;null==(a=af.current)||a.call(af,U)},[U]),Q.useEffect(function(){ah()},[ah]),Q.useEffect(function(){var a=function(a){W({type:a8.a.Unknown,payload:{annotType:null==a?void 0:a.annotationType}})};return X.on(S.e.DocumentDirty,a),function(){X.off(S.e.DocumentDirty,a)}},[X,W]),Q.useEffect(function(){void 0!==R&&(null==t||t.setAnnotationMode(R),null==K||K(R))},[R,t,K]);var ai=Q.useCallback(function(){return(0,j.yv)(void 0,void 0,void 0,function(){return(0,j.SO)(this,function(a){switch(a.label){case 0:return X.dispatch(S.e.DocumentReloaded),ah(),[4,null==w?void 0:w.rotate(s.rotation)];case 1:return a.sent(),[4,null==J?void 0:J("Init")];case 2:return a.sent(),[2]}})})},[X,s.rotation,J,ah,w]);Q.useImperativeHandle(b,function(){return{reloadCurrentDocument:function(a){return(0,j.yv)(void 0,void 0,void 0,function(){return(0,j.SO)(this,function(b){switch(b.label){case 0:return[4,null==w?void 0:w.reloadCurrentDocument(a)];case 1:return b.sent(),[4,ai()];case 2:return b.sent(),[2]}})})},discardEdits:function(){return(0,j.yv)(void 0,void 0,void 0,function(){return(0,j.SO)(this,function(a){switch(a.label){case 0:return[4,null==w?void 0:w.dropAllChanges()];case 1:return a.sent(),[4,ai()];case 2:return a.sent(),[2]}})})},focusOnVirtualForwardForm:function(a){var b;null==(b=ad.current)||b.focusOnVirtualForwardForm(a)},focusOnVirtualBackwardForm:function(a){var b;null==(b=ad.current)||b.focusOnVirtualBackwardForm(a)},updateGripperPosition:function(a){ac(a)},toggleGripper:function(a){return(0,j.yv)(void 0,void 0,void 0,function(){return(0,j.SO)(this,function(b){switch(b.label){case 0:if(a===$)return[3,3];if(!$)return[3,2];return[4,null==ae?void 0:ae()];case 1:b.sent(),b.label=2;case 2:_(a),b.label=3;case 3:return[2]}})})},updateSelectedTextInfo:function(a,b){var c;null==(c=ag.current)||c.updateContextualMenuForMouse(a,b)}}},[ae,$,ai,w]);var aj=!u.a.isActivated("EnableMaxWithForContentWhenFitWidth")&&L===S.i.FitWidth;return Q.createElement("div",{className:"".concat("pdfContent_526606d6"," ").concat(aj?"fitWidth_526606d6":""),ref:x,style:{backgroundColor:Y.semanticColors.bodyBackground}},Q.createElement(bi,{pageInfos:r,metadata:s,curPageIndex:q,getScaledOriginalPageRectByIndex:y,getDistToViewportCenter:z,isPageVisible:A}),Q.createElement(bl,{width:l.width,height:l.height,left:l.x,top:l.y,renderResult:m,getViewportRectRelativeToContentOffset:n,blurRenderResult:p}),!u.a.isActivated("EnableBoundingRegionHighlighter")&&!!N&&!!Array.isArray(N)&&0!==N.length&&N.some(function(a){return a&&a.polygon&&Array.isArray(a.polygon)&&8===a.polygon.length&&"number"==typeof a.pageNumber&&a.pageNumber>0})&&Q.createElement(Q.Suspense,{fallback:Q.createElement("div",null)},Q.createElement(bo,{width:null!=(c=null==M?void 0:M.width)?c:0,height:null!=(d=null==M?void 0:M.height)?d:0,top:null!=(e=null==M?void 0:M.y)?e:0,left:null!=(f=null==M?void 0:M.x)?f:0,boundingRegions:N,scrollLeft:null!=(g=null==M?void 0:M.x)?g:0,scrollTop:null!=(h=null==M?void 0:M.y)?h:0,scale:s.scale,visibleDocumentLeftOffsetRelativeToContent:null!=O?O:0})),Q.createElement(Q.Suspense,{fallback:Q.createElement("div",null)},Q.createElement(bp,{ref:ad,scale:s.scale,rotation:s.rotation,mode:R,getPageTextFn:C,getLinkInfosFn:D,goToPageFn:E,toggleGripperFn:H})),k&&Q.createElement(Q.Suspense,{fallback:Q.createElement("div",null)},Q.createElement(a6.a,{metadata:s,annotHandler:t},Q.createElement(bm,(0,j.q5)({pageInfos:r,renderRectFn:I,getPageRectFn:y},v)))),(null==(i=V.a.features)?void 0:i.enableShowStickyNote)&&r&&Q.createElement(Q.Suspense,{fallback:Q.createElement("div",null)},Q.createElement(bn,{pageInfos:r,rotation:s.rotation,scale:s.scale,inverted:s.inverted})),Q.createElement(bb,{showForGripper:$,rotation:s.rotation,gripperPos:ab,enableCopilot:F,onRequestCopilot:G,onFocusPdfViewer:P,ref:ag}))});bq.displayName="PdfViewerRendererInner";var br=Q.memo(Q.forwardRef(function(a,b){return Q.createElement("div",null,Q.createElement(a7.a,null,Q.createElement(bq,(0,j.q5)({},a,{ref:b}))))}));br.displayName="PdfViewerRenderer";var bs={visibleDocumentRect:new o.b(0,0,0,0),metadata:new U({width:0,height:0},0,[]),viewportRenderResult:void 0,viewportBlurRenderResult:void 0,cursorType:S.c.Default,dpr:(0,r.a)(),fileReady:!1},bt="PdfViewer",bu=function(a){function b(b){var c=a.call(this,b)||this;return c.updateCurrentIndex=q()(function(){var a,b,d=c.pageManager;if(d){var e=d.getCurrentPage();e!==d.currentIndex&&(null==(b=(a=c.props).onCurrentPageChanged)||b.call(a,e),d.currentIndex=e)}c.eventBus.dispatch(S.e.Scrolling)},150),c.extract=function(a){return(0,j.yv)(c,void 0,void 0,function(){var b,c;return(0,j.SO)(this,function(d){switch(d.label){case 0:return[4,this.getCurrentFileData()];case 1:if(!(b=d.sent()))return[2];return[4,this.getManipulatorHandler()];case 2:return[2,null==(c=d.sent())?void 0:c.extract(b,a)]}})})},c.merge=function(a){return(0,j.yv)(c,void 0,void 0,function(){var b;return(0,j.SO)(this,function(c){switch(c.label){case 0:return[4,this.getManipulatorHandler()];case 1:return[2,null==(b=c.sent())?void 0:b.merge(a)]}})})},c.encrypt=function(a,b,d){return(0,j.yv)(c,void 0,void 0,function(){var c,e,f;return(0,j.SO)(this,function(g){switch(g.label){case 0:return[4,this.getCurrentFileData()];case 1:if(c=g.sent(),!(null==(e=V.a.features)?void 0:e.enableEncrypt)||!c)return[2];return[4,this.getManipulatorHandler()];case 2:return[2,null==(f=g.sent())?void 0:f.encrypt(c,a,b,d)]}})})},c.compress=function(a,b){return(0,j.yv)(c,void 0,void 0,function(){var c,d,e;return(0,j.SO)(this,function(f){switch(f.label){case 0:return[4,this.getCurrentFileData()];case 1:if(c=f.sent(),!(null==(d=V.a.features)?void 0:d.enableCompress)||!c)return[2];return[4,this.getManipulatorHandler()];case 2:return[2,null==(e=f.sent())?void 0:e.compress(c,a,b)]}})})},c.focus=function(){var a;null==(a=c.rootRef.current)||a.focus()},c.onOwnerPasswordValid=function(a){return(0,j.yv)(c,void 0,void 0,function(){var b=this;return(0,j.SO)(this,function(c){return[2,function(){return(0,j.yv)(b,void 0,void 0,function(){return(0,j.SO)(this,function(b){switch(b.label){case 0:return this.disposeForReload(),this.preventScrollRender=!1,[4,this.initDocument()];case 1:return b.sent(),null==a||a(),[2]}})})}]})})},c.reOpenDocumentWithOwnerPassword=function(a,b,d,e){return(0,j.yv)(c,void 0,void 0,function(){var c,f,g;return(0,j.SO)(this,function(h){switch(h.label){case 0:return f=(c=this.docOpener).reOpenDocumentWithOwnerPassword,g=[a],[4,this.onOwnerPasswordValid(b)];case 1:return[4,f.apply(c,g.concat([h.sent(),d,e]))];case 2:return h.sent(),[2]}})})},c.verifyPassword=function(a,b){return(0,j.yv)(c,void 0,void 0,function(){return(0,j.SO)(this,function(c){switch(c.label){case 0:return v.a.verbose(bt,"Verifying password"),[4,this.tryOpenDocument(a,b)];case 1:return c.sent(),[2]}})})},c.startSearch=function(a,b,d,e){return void 0===b&&(b=c.currentIndex),(0,j.yv)(c,void 0,void 0,function(){var c;return(0,j.SO)(this,function(f){switch(f.label){case 0:return[4,null==(c=this.searchService)?void 0:c.startSearch(a,b,d,e)];case 1:return f.sent(),[2]}})})},c.goToNextSearchResult=function(a){return(0,j.yv)(c,void 0,void 0,function(){var b,c;return(0,j.SO)(this,function(d){switch(d.label){case 0:return[4,null==(c=this.searchService)?void 0:c.goToNextSearchResult(a)];case 1:return d.sent(),this.props.onScrollPositionUpdated&&(b=this.currentScrollPosition,this.props.onScrollPositionUpdated(b.x,b.y)),[2]}})})},c.stopSearch=function(){return(0,j.yv)(c,void 0,void 0,function(){var a;return(0,j.SO)(this,function(b){switch(b.label){case 0:return[4,null==(a=this.searchService)?void 0:a.stopSearch()];case 1:return b.sent(),[2]}})})},c.scrollBy=function(a,b){var d;null==(d=c.rootRef.current)||d.scrollBy(a,b)},c.scrollTo=function(a,b,d){var e;null==(e=c.rootRef.current)||e.scrollTo({top:b,left:a,behavior:d})},c.goToPage=function(a,b,d,e){if(a<0)m.a.read(c.l10n.get("firstPagePrompt"));else if(a>=c.pageCount)m.a.read(c.l10n.get("lastPagePrompt"));else{var f=c.layoutManager.scrollRootByPage(a,b,d);a!==c.currentIndex&&f&&(e?m.a.read(e):m.a.read(c.l10n.get("currentPageNumberAria",[a+1])))}},c.zoom=function(a){var b,d,e;v.a.verbose(bt,"Received zoom evt"),w.a.sessionMark("Start"),(null==(b=c.zoomService)?void 0:b.isValidScale(a))&&(c.clearViewport(),null==(d=c.zoomService)||d.zoom(a),u.a.isActivated("StoreZoomOptionInLocalStorage")||a!==S.i.FitSize&&a!==S.i.FitWidth||null==(e=c.displayHelper)||e.storeGlobalZoomOptInLocalStorage(a))},c.rotate=function(a){return void 0===a&&(a=R.A),(0,j.yv)(c,void 0,void 0,function(){var b,c,d,e=this;return(0,j.SO)(this,function(f){switch(f.label){case 0:if(v.a.verbose(bt,"Received rotate evt"),this.clearViewport(),!(!this.rotateService&&this.viewContext))return[3,2];return[4,(0,Y.f)()];case 1:b=f.sent(),this.rotateService=new b(this.viewContext,this.layoutManager,this.l10n,this.renderViewport),f.label=2;case 2:return[4,null==(c=this.rotateService)?void 0:c.rotate(a,function(){var a,b,c;null==(a=e.zoomService)||a.responsiveZoom(!0),e.eventBus.dispatch(S.e.RotationChanged),null==(c=(b=e.props).onRotationChanged)||c.call(b)})];case 3:return f.sent(),null==(d=this.viewerRendererRef)||d.toggleGripper(!1),[2]}})})},c.print=function(a,b,d){return(0,j.yv)(c,void 0,void 0,function(){var c,e,f,g,h,i,k,l;return(0,j.SO)(this,function(j){switch(j.label){case 0:if(v.a.verbose(bt,"Received print evt"),e=(c=(null==(i=this.viewContext)?void 0:i.metadata)||{}).isPrintAllowed,f=c.needPassword,!e)throw g=new s.c(s.b.PrintNoPermission,"Has no print permission!"),x.a.logError(g.toCaughtError()),g;if(this.printService)return[3,2];return[4,(0,Y.d)()];case 1:h=j.sent(),this.printService=new h(this.getCurrentFileData),j.label=2;case 2:return this.pageManager&&this.viewContext&&(null==(k=this.printService)||k.initPagesPrinter(this.viewContext,this.pageManager.getScaledOriginalPageRects)),[4,null==(l=this.printService)?void 0:l.print(a,b,d,f)];case 3:return j.sent(),[2]}})})},c.cancelPrint=function(){var a;v.a.verbose(bt,"Received cancelPrint evt"),null==(a=c.printService)||a.cancel()},c.renderThumbnail=function(a,b,d,e){return void 0===e&&(e=!1),(0,j.yv)(c,void 0,void 0,function(){var c,f;return(0,j.SO)(this,function(g){switch(g.label){case 0:if(v.a.verbose(bt,"Received renderThumbnail evt"),!(!this.thumbnailService&&this.viewContext&&this.pageManager))return[3,2];return[4,(0,Y.g)()];case 1:c=g.sent(),this.thumbnailService=new c(this.viewContext,this.pageManager.getScaledOriginalPageRectByIndex),g.label=2;case 2:return[2,null==(f=this.thumbnailService)?void 0:f.renderThumbnail(a,b,d,e)]}})})},c.clearThumbnailCache=function(){var a;v.a.verbose(bt,"Received clear thumbnail evt"),null==(a=c.thumbnailService)||a.dispose()},c.getCurrentFileData=function(){return(0,j.yv)(c,void 0,void 0,function(){var a;return(0,j.SO)(this,function(b){return this.triggerInkDrying(),[2,null==(a=this.viewContext)?void 0:a.viewHandler.getCurrentFileData()]})})},c.getTelemetryData=function(){return(0,j.yv)(c,void 0,void 0,function(){var a;return(0,j.SO)(this,function(b){return[2,null==(a=this.viewContext)?void 0:a.viewHandler.getTelemetryData()]})})},c.hasSignature=function(){return(0,j.yv)(c,void 0,void 0,function(){var a,b,c;return(0,j.SO)(this,function(d){return[2,null==(c=null==(a=this.viewContext)?void 0:(b=a.viewHandler).hasSignature)?void 0:c.call(b)]})})},c.reloadCurrentDocument=function(a){return(0,j.yv)(c,void 0,void 0,function(){var b;return(0,j.SO)(this,function(c){switch(c.label){case 0:return[4,null==(b=this.viewerRendererRef)?void 0:b.reloadCurrentDocument(a)];case 1:return c.sent(),[2]}})})},c.discardEdits=function(){return(0,j.yv)(c,void 0,void 0,function(){var a;return(0,j.SO)(this,function(b){switch(b.label){case 0:return[4,null==(a=this.viewerRendererRef)?void 0:a.discardEdits()];case 1:return b.sent(),[2]}})})},c.triggerInkDrying=function(){c.eventBus.dispatch(S.e.TriggerInkDrying)},c.getEventHandlers=function(){return{onClick:c.onClick,onKeyDown:c.onKeyDown,onPointerDown:function(a){c.onPointerDown(a)},onPointerMove:function(a){c.onPointerMove(a)},onPointerUp:function(a){c.onPointerUp(a)},onTouchStart:function(a){c.onTouchStart(a)},onTouchMove:function(a){c.onTouchMove(a)},onTouchEnd:function(a){c.onTouchEnd(a)},onWheel:c.onWheel}},c.getEventBus=function(){return c.eventBus},c.getPageText=function(a){var b;return(null==(b=c.contentService)?void 0:b.getPageText(a))||Promise.resolve("")},c.getWorkerPerfMarks=function(){return c.viewWorker.getPerfMarks()},c.getCurrentPageIndex=function(){var a;return(null==(a=c.pageManager)?void 0:a.getCurrentPage())||0},c.getDocumentLeftToViewport=function(){var a;return null==(a=c.layoutManager)?void 0:a.visibleDocumentLeftToViewport},c.addFreeText=function(){return(0,j.yv)(c,void 0,void 0,function(){var a;return(0,j.SO)(this,function(b){switch(b.label){case 0:return[4,null==(a=this.inputEvtService)?void 0:a.addFreeText()];case 1:return b.sent(),[2]}})})},c.getWatermarkInfos=function(){return(0,j.yv)(c,void 0,void 0,function(){var a;return(0,j.SO)(this,function(b){switch(b.label){case 0:return[4,this.getWatermarkService()];case 1:return[4,null==(a=b.sent())?void 0:a.getWatermarkInfos()];case 2:return[2,JSON.stringify(b.sent()||[])]}})})},c.getWatermarkService=function(){return(0,j.yv)(c,void 0,void 0,function(){var a,b;return(0,j.SO)(this,function(c){switch(c.label){case 0:if(!((null==(b=V.a.features)?void 0:b.enableWatermark)&&!this.watermarkService&&this.viewContext))return[3,2];return[4,(0,Y.i)()];case 1:a=c.sent(),this.watermarkService=new a(this.viewContext,this.eventBus.dispatch.bind(this.eventBus),this.watermarkHandler),c.label=2;case 2:return[2,this.watermarkService]}})})},c.getOutlineData=function(){return(0,j.yv)(c,void 0,void 0,function(){var a,b;return(0,j.SO)(this,function(c){return[2,null==(b=null==(a=this.viewContext)?void 0:a.viewHandler)?void 0:b.getOutlineData()]})})},c.getDocPermissions=function(){var a;return(null==(a=c.viewContext)?void 0:a.metadata.getDocPermissions())||[]},c.undo=function(){return(0,j.yv)(c,void 0,void 0,function(){var a;return(0,j.SO)(this,function(b){return[2,(null==(a=this.undoRedoService)?void 0:a.undo())||!1]})})},c.redo=function(){return(0,j.yv)(c,void 0,void 0,function(){var a;return(0,j.SO)(this,function(b){return[2,(null==(a=this.undoRedoService)?void 0:a.redo())||!1]})})},c.storeDisplayInfo=function(){if(c.displayHelper||c.freeTextService){var a,b,d,e={pos:c.currentScrollPosition,scale:(null==(a=c.zoomService)?void 0:a.getZoomOpt())||c.scale,rotation:c.rotation};null==(b=c.displayHelper)||b.storeInfoInLocalStorage(e),null==(d=c.freeTextService)||d.storeFreeTextAttribute()}},c.setViewerRendererRef=function(a){c.viewerRendererRef=a},c.onScroll=function(){if(c.preventScrollRender){c.preventScrollRender=!1;return}c.renderViewport(),c.updateCurrentIndex()},c.onResize=function(){var a;v.a.verbose(bt,"Received resize evt"),c.resizeViewer(),null==(a=c.viewerRendererRef)||a.toggleGripper(!1)},c.onWheel=function(a){var b,d;a.ctrlKey&&(a.preventDefault(),null==(b=c.renderService)||b.clear(),null==(d=c.zoomService)||d.wheelZoom(a))},c.onKeyDown=function(a){return(0,j.yv)(c,void 0,void 0,function(){var b;return(0,j.SO)(this,function(c){switch(c.label){case 0:return[4,null==(b=this.inputEvtService)?void 0:b.onKeyDown(this.getNativeEvt(a),this.currentIndex)];case 1:return c.sent(),[2]}})})},c.onPointerDown=function(a){return(0,j.yv)(c,void 0,void 0,function(){var b,c,d,e;return(0,j.SO)(this,function(f){switch(f.label){case 0:return b=this.getNativeEvt(a),null==(d=null==(c=this.pinchable)?void 0:c.onPointerDown)||d.call(c,b),[4,null==(e=this.inputEvtService)?void 0:e.onPointerDown(b)];case 1:return f.sent(),[2]}})})},c.onPointerMove=function(a){return(0,j.yv)(c,void 0,void 0,function(){var b,c,d,e;return(0,j.SO)(this,function(f){switch(f.label){case 0:return b=this.getNativeEvt(a),null==(d=null==(c=this.pinchable)?void 0:c.onPointerMove)||d.call(c,b),[4,null==(e=this.inputEvtService)?void 0:e.onPointerMove(b)];case 1:return f.sent(),[2]}})})},c.onPointerUp=function(a){return(0,j.yv)(c,void 0,void 0,function(){var b,c,d,e;return(0,j.SO)(this,function(f){switch(f.label){case 0:return b=this.getNativeEvt(a),null==(d=null==(c=this.pinchable)?void 0:c.onPointerUp)||d.call(c,b),[4,null==(e=this.inputEvtService)?void 0:e.onPointerUp(b)];case 1:return f.sent(),[2]}})})},c.onPointerCancel=function(a){return(0,j.yv)(c,void 0,void 0,function(){var b,c;return(0,j.SO)(this,function(d){return null==(c=null==(b=this.pinchable)?void 0:b.onPointerUp)||c.call(b,this.getNativeEvt(a)),[2]})})},c.onPointerOut=function(a){return(0,j.yv)(c,void 0,void 0,function(){var b,c;return(0,j.SO)(this,function(d){return null==(c=null==(b=this.pinchable)?void 0:b.onPointerUp)||c.call(b,this.getNativeEvt(a)),[2]})})},c.onPointerLeave=function(a){return(0,j.yv)(c,void 0,void 0,function(){var b,c;return(0,j.SO)(this,function(d){return null==(c=null==(b=this.pinchable)?void 0:b.onPointerUp)||c.call(b,this.getNativeEvt(a)),[2]})})},c.onTouchStart=function(a){return(0,j.yv)(c,void 0,void 0,function(){var b,c,d;return(0,j.SO)(this,function(e){switch(e.label){case 0:return b=this.getNativeEvt(a),null==(c=this.pinchable)||c.onTouchStart(b),[4,null==(d=this.inputEvtService)?void 0:d.onTouchStart(b)];case 1:return e.sent(),[2]}})})},c.onTouchMove=function(a){return(0,j.yv)(c,void 0,void 0,function(){var b,c;return(0,j.SO)(this,function(d){switch(d.label){case 0:return null==(b=this.pinchable)||b.onTouchMove(this.getNativeEvt(a)),[4,null==(c=this.inputEvtService)?void 0:c.onTouchMove(a)];case 1:return d.sent(),[2]}})})},c.onTouchEnd=function(a){return(0,j.yv)(c,void 0,void 0,function(){var b,c,d;return(0,j.SO)(this,function(e){switch(e.label){case 0:return b=this.getNativeEvt(a),null==(c=this.pinchable)||c.onTouchEnd(b),[4,null==(d=this.inputEvtService)?void 0:d.onTouchEnd(b)];case 1:return e.sent(),[2]}})})},c.onClick=function(a){return(0,j.yv)(c,void 0,void 0,function(){var b;return(0,j.SO)(this,function(c){switch(c.label){case 0:return[4,null==(b=this.inputEvtService)?void 0:b.onClick(this.getNativeEvt(a))];case 1:return c.sent(),[2]}})})},c.onContextMenu=function(a){a.preventDefault()},c.onGlobalMouseMove=function(a){var b;c.isEvtInsideViewer(a)||null==(b=c.contentService)||b.onPointerMove(new o.a(a.clientX,a.clientY))},c.onGlobalMouseUp=function(a){return(0,j.yv)(c,void 0,void 0,function(){var b,c;return(0,j.SO)(this,function(d){switch(d.label){case 0:if((null==(b=this.props.annotParams)?void 0:b.mode)!==S.a.None||this.isEvtInsideViewer(a))return[2];return[4,null==(c=this.inputEvtService)?void 0:c.onPointerUp(a)];case 1:return d.sent(),[2]}})})},c.onBeforePageUnload=function(){x.a.logVerbose({name:y.a.DocumentLoad,message:"Before PDF Page Unload"}),c.pageLoaded=!1,c.storeDisplayInfo()},c.onPageUnload=function(){x.a.logVerbose({name:y.a.DocumentLoad,message:"PDF Page Unload"}),c.pageLoaded=!1},c.onWorkerMessage=function(a){return(0,j.yv)(c,void 0,void 0,function(){var b,c,d,e,f,g,h,i,k,l,m,n,o,p,q,r,t,u,v,w,y,z,A=this;return(0,j.SO)(this,function(j){switch(j.label){case 0:var B;switch((b={type:aq((B=a.data).type),name:ar(B.name),payload:B.payload}).type){case 0:return[3,1];case 1:case 9:return[3,7];case 2:return[3,8];case 3:return[3,9];case 4:case 5:return[3,10];case 6:return[3,11];case 7:return[3,13];case 8:return[3,16];case 11:return[3,18];case 10:return[3,19];case 12:return[3,21];case 13:return[3,22];case 14:return[3,24]}return[3,25];case 1:if(3!==b.name)return[3,3];return[4,null==(l=this.progressiveLoadingService)?void 0:l.onNotification(b)];case 2:return j.sent(),[3,26];case 3:if((c=4===b.name)&&this.eventBus.dispatch(S.e.InvalidateRect,b.payload),d=(null==(m=this.props.annotParams)?void 0:m.mode)||S.a.None,!(c&&(d===S.a.Highlight||d===S.a.Ink||(null==(n=V.a.features)?void 0:n.enableEnhancedInk)&&d===S.a.PointErase)))return[3,4];return this.eventBus.dispatch(S.e.InvalidateRectForAnnot,b.payload),[3,6];case 4:return[4,null==(o=this.contentService)?void 0:o.onNotification(b)];case 5:j.sent(),j.label=6;case 6:case 25:return[3,26];case 7:return null==(p=this.inputEvtService)||p.onNotification(b),[3,26];case 8:return null==(q=this.linkService)||q.onNotification(b),[3,26];case 9:return null==(r=this.searchService)||r.onNotification(b),[3,26];case 10:try{((e=as(a.data.name))===S.e.InkAdded||e===S.e.InkUpdated)&&this.eventBus.dispatch(S.e.AnnotationChanged),this.eventBus.dispatch(e,b.payload)}catch(a){}return[3,26];case 11:return[4,null==(t=this.freeTextService)?void 0:t.onNotification(b)];case 12:case 15:case 17:case 20:case 23:return j.sent(),[3,26];case 13:return[4,this.getWatermarkService()];case 14:return[4,null==(f=j.sent())?void 0:f.onNotification(b)];case 16:return[4,null==(u=this.formService)?void 0:u.onNotification(b)];case 18:return 28===b.name&&this.eventBus.dispatch(S.e.VisiblePagesLoaded,b.payload),[3,26];case 19:return[4,null==(v=this.progressiveLoadingService)?void 0:v.onNotification(b)];case 21:return h=(g=b.payload).name,i=g.charset,k=g.style,null==(w=this.fontProvider)||w.onMissingFont(h,i,k).then(function(a){a&&A.renderViewport("Init")}).catch(function(a){var b=new s.c(s.b.FontLoadFailed,"Fail to handle missing font: ".concat(h," error: ").concat(a));x.a.logError(b.toCaughtError())}),[3,26];case 22:return[4,null==(y=this.undoRedoService)?void 0:y.onNotification(b)];case 24:return null==(z=this.noteService)||z.onNotification(b),[3,26];case 26:return[2]}})})},c.onTextSelected=function(a,b){var d,e,f;null==(e=(d=c.props).onTextSelected)||e.call(d,a),null==(f=c.viewerRendererRef)||f.updateSelectedTextInfo(a,b)},c.onTextDeselected=function(a){var b,d,e;null==(d=(b=c.props).onTextDeselected)||d.call(b,a),null==(e=c.viewerRendererRef)||e.updateSelectedTextInfo("",void 0)},c.renderViewport=function(a){return void 0===a&&(a="Scroll"),(0,j.yv)(c,void 0,void 0,function(){var b,c,d,e=this;return(0,j.SO)(this,function(f){return this.layoutManager.rootRect.clear(),"Scroll"===a&&w.a.sessionMark("Start",{scrollPos:JSON.stringify({x:this.layoutManager.rootRect.getScrollLeft(),y:this.layoutManager.rootRect.getScrollTop()})}),b=this.layoutManager.viewportRectRelativeToDocument,this.setState({visibleDocumentRect:this.layoutManager.visibleDocumentRectRelativeToContent}),null==(d=(c=this.props).onRenderViewport)||d.call(c),[2,new Promise(function(c,d){var f,g;null==(f=e.renderService)||f.render({rect:b,layoutSize:e.layoutManager.documentSize,rotation:null==(g=e.viewContext)?void 0:g.metadata.rotation,triggerType:a,onCompleted:function(a){c(a)},onError:function(a){d(a)}})})]})})},c.updateRenderResult=function(a){var b,d;if(a&&!(null==(b=V.a.features)?void 0:b.enableCalculateOffsetAtDrawTimeFix)){var e=c.layoutManager.viewportRectRelativeToContent.origin.symmetricMap();a.origin=null==(d=a.origin)?void 0:d.plus(e)}c.setState({viewportRenderResult:a,viewportBlurRenderResult:void 0})},c.updateBlurRenderResult=function(a){c.setState({visibleDocumentRect:c.layoutManager.visibleDocumentRectRelativeToContent,viewportBlurRenderResult:a})},c.updateCursorType=function(a){var b,d;a!==c.state.cursorType&&(c.setState({cursorType:a}),Object.values(S.c).includes(a)&&(null==(d=(b=c.props).onCursorUpdate)||d.call(b,a)))},c.onFormFocus=function(a){if(c.context.isFormFillingEnabled&&c.props.formAttributes){var b,d,e,f=null==(b=c.rootRef.current)?void 0:b.hasAttribute(c.props.formAttributes);a&&!f?null==(d=c.rootRef.current)||d.setAttribute(c.props.formAttributes,"true"):!a&&f&&(null==(e=c.rootRef.current)||e.removeAttribute(c.props.formAttributes))}},c.getViewportRectRelativeToContentOffset=function(){var a;return null==(a=c.layoutManager)?void 0:a.viewportRectRelativeToContent.origin.symmetricMap()},(0,l.a)(c),c.state=bs,c.pageLoaded=!0,c.outerRef=Q.createRef(),c.outerRect=new aI,c.rootRef=Q.createRef(),c.contentRef=Q.createRef(),c.layoutManager=new aN,c.l10n=(0,aV.b)(),c.wasmDataProvider=aP.a.getInstance(),c.worker=new Worker(V.a.workerSrc),c.viewWorker=K(c.worker,[],void 0),c.viewWorker.setupEnv({wasmModuleInit:V.a.wasmModuleInit,enableLogging:!!V.a.enableLogging,activatedKillSwitches:u.a.activatedKillSwitches,globalVarNameForWorkerVer:V.a.globalVarNameForWorkerVer,mipPrefetchConfig:V.a.mipPrefetchConfig}),c.docLoader=new ah(b.url,b.filename,b.fileSize,b.enableDownloadByRange,b.token,b.getAuthHeaders),c.docOpener=new ai(b.onNeedPassword),c.eventBus=new t.a,c.preventScrollRender=!1,c}return(0,j.e2)(b,a),b.prototype.componentDidMount=function(){this.mounted=!0,this.outerRect.initialize(this.outerRef.current),this.layoutManager.initialize(this.rootRef.current,this.contentRef.current,this.props.onScrollPositionUpdated),this.updateOuterHeight(),this.setLocaleStrings(),this.initViewer()},b.prototype.componentDidUpdate=function(a,b){var c,d,e,f=this,g=this.props,h=g.url,i=g.height,j=g.localeStrings,k=g.enableEdit;h!==a.url?(this.reset(),this.initViewer()):i!==a.height&&(this.updateOuterHeight(),this.resizeViewer()),j!==a.localeStrings&&this.setLocaleStrings(),void 0!==k&&a.enableEdit!==k&&(null==(c=this.viewContext)||c.viewHandler.setEditEnabled(k)),(null==(d=this.progressiveLoadingService)?void 0:d.enabled)&&!b.fileReady&&this.state.fileReady&&(this.renderViewport("Init").then(function(){f.eventBus.dispatch(S.e.InitialDisplayInfoApplied)}),null==(e=this.progressiveLoadingService)||e.dispose())},b.prototype.componentWillUnmount=function(){var a,b,c;this.mounted=!1,this.initRenderRequestId&&cancelAnimationFrame(this.initRenderRequestId),this.dispose(),this.worker.terminate(),this.wasmDataProvider.dispose(),null==(a=this.fontProvider)||a.dispose(),null==(c=(b=this.props).onDocumentUnloaded)||c.call(b)},b.prototype.render=function(){var a,b,c,d,e,f,g,h,i,l,m,o,p,q=(0,A.a)(this.props.theme,this.props.darkMode),r=this.pageManager,s=this.context;return Q.createElement(k.a,{theme:(0,j.q5)({rtl:(0,n.a)()},q),className:"fillSize_526606d6"},Q.createElement(aV.a,{strings:this.strings},Q.createElement(aX.a,{dpr:this.state.dpr,eventBus:this.eventBus,pageManager:r,viewHandler:null==(a=this.viewContext)?void 0:a.viewHandler,onFirstRenderVisibleFn:this.props.onFirstRenderVisible,enablePreRender:this.state.fileReady&&this.props.enablePreRender},Q.createElement(aS.a,{enableFormFilling:s.isFormFillingEnabled,formHandler:this.formHandler},Q.createElement(aW.a,{undoRedoService:this.undoRedoService},Q.createElement(aU.a,{enableGripperContextualMenu:this.props.enableGripperContextualMenu||!1,onGripperTouchStart:null==(b=this.inputEvtService)?void 0:b.onGripperTouchStart,copyToClipboard:null==(c=this.contentService)?void 0:c.copyToClipboard,deSelectText:null==(d=this.inputEvtService)?void 0:d.gripperDeSelectText},Q.createElement(aT.a,{enableFreeText:s.isFreeTextEnabled,freeTextHandler:this.freeTextHandler,freeTextContainer:this.props.freeTextContainer,setInitialFontAttributes:null==(e=this.freeTextService)?void 0:e.setInitialFontAttributes},Q.createElement("div",{className:a4,ref:this.outerRef},Q.createElement("div",{className:"pdfViewer_526606d6",style:{cursor:this.state.cursorType},tabIndex:this.props.isRootFocusable&&!this.props.ariaHidden?0:-1,"aria-label":this.docLoader.filename,ref:this.rootRef,onClick:this.onClick,onContextMenu:this.onContextMenu,onKeyDown:this.onKeyDown,onPointerDown:this.onPointerDown,onPointerMove:this.onPointerMove,onPointerUp:this.onPointerUp,onPointerCancel:this.onPointerCancel,onPointerOut:this.onPointerOut,onPointerLeave:this.onPointerLeave,onTouchStart:this.onTouchStart,onTouchEnd:this.onTouchEnd},Q.createElement(aQ.a,{ariaHidden:!!this.props.ariaHidden,triggerPointerUp:null==(f=this.inputEvtService)?void 0:f.triggerPointerUp,focusOnPage:null==(g=this.viewerRendererRef)?void 0:g.focusOnVirtualBackwardForm},Q.createElement(br,{ref:this.setViewerRendererRef,enableAnnotation:s.isAnnotationEnabled,contentRef:this.contentRef,visibleDocumentRect:this.state.visibleDocumentRect,curPageIndex:null==r?void 0:r.getCurrentPage(),visiblePageInfos:null==r?void 0:r.getVisiblePages(),viewportRenderResult:this.state.viewportRenderResult,getViewportRectRelativeToContentOffset:this.getViewportRectRelativeToContentOffset,viewportBlurRenderResult:this.state.viewportBlurRenderResult,metadata:this.state.metadata,annotHandler:this.annotHandler,viewHandler:null==(h=this.viewContext)?void 0:h.viewHandler,annotParams:this.props.annotParams,getScaledOriginalPageRectByIndex:null==r?void 0:r.getScaledOriginalPageRectByIndex,getDistToViewportCenter:this.layoutManager.getDistToViewportCenter,isPageVisible:null==r?void 0:r.isPageVisible,getPageTextFn:null==(i=this.contentService)?void 0:i.getPageText,getLinkInfosFn:null==(l=this.linkService)?void 0:l.getLinkInfosInPage,renderRectFn:null==(m=this.contentService)?void 0:m.renderRect,renderViewportFn:this.renderViewport,goToPageFn:this.goToPage,toggleGripperFn:null==(o=this.viewerRendererRef)?void 0:o.toggleGripper,syncModeFn:null==(p=this.inputEvtService)?void 0:p.setMode,onEditStateChanged:this.props.onEditStateChanged,enableCopilot:this.props.enableCopilot,onRequestCopilot:this.props.onRequestCopilot,zoomOpt:this.zoomOpt,highlightCanvasRect:this.getHighlightCanvasRect(),highlightBoundingRegions:this.props.highlightBoundingRegions,visibleDocumentLeftOffsetRelativeToContent:this.layoutManager.visibleDocumentLeftToViewport,onFocusPdfViewer:this.focus})))))))))))},Object.defineProperty(b.prototype,"pageCount",{get:function(){var a;return(null==(a=this.viewContext)?void 0:a.metadata.pageCount)||0},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"currentIndex",{get:function(){var a=this.pageManager;return a?a.currentIndex:-1},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"currentScrollPosition",{get:function(){return this.layoutManager.currentScrollPosition},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"filename",{get:function(){return this.docLoader.filename},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"originalLayoutSize",{get:function(){var a;return(null==(a=this.viewContext)?void 0:a.metadata.originalLayoutSize)||{width:0,height:0}},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"layoutSize",{get:function(){var a;return(null==(a=this.viewContext)?void 0:a.metadata.layoutSize)||{width:0,height:0}},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"originalPageSizes",{get:function(){var a;return(null==(a=this.viewContext)?void 0:a.metadata.originalPageSizes)||[]},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"pageSizes",{get:function(){var a;return(null==(a=this.viewContext)?void 0:a.metadata.pageSizes)||[]},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"originalPageRects",{get:function(){var a=this.pageManager;return a?a.getOriginalPageRects():[]},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"scale",{get:function(){var a;return(null==(a=this.viewContext)?void 0:a.metadata.scale)||1},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"rotation",{get:function(){var a,b=null==(a=this.viewContext)?void 0:a.metadata.rotation;return b?b*R.A:0},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"isMip",{get:function(){var a;return(null==(a=this.viewContext)?void 0:a.metadata.mip)||!1},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"isMipDecrypted",{get:function(){var a;return(null==(a=this.viewContext)?void 0:a.metadata.isMipDecrypted)||!1},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"coordinateConverters",{get:function(){return{convertPointFromClientToOriginalDocument:this.layoutManager.convertPointFromClientToOriginalDocument,convertPointFromOriginalDocumentToClient:this.layoutManager.convertPointFromOriginalDocumentToClient}},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"zoomOpt",{get:function(){var a;return null==(a=this.zoomService)?void 0:a.getZoomOpt()},enumerable:!1,configurable:!0}),b.prototype.setLocaleStrings=function(){return(0,j.yv)(this,void 0,void 0,function(){var a,b;return(0,j.SO)(this,function(c){switch(c.label){case 0:if(a=this,b=this.props.localeStrings)return[3,2];return[4,(0,aV.c)()];case 1:b=c.sent(),c.label=2;case 2:return a.strings=b,this.l10n.strings=this.strings,[2]}})})},b.prototype.tryCreateProgressiveLoadingService=function(){return(0,j.yv)(this,void 0,void 0,function(){var a;return(0,j.SO)(this,function(b){switch(b.label){case 0:if(!(!this.progressiveLoadingService&&this.props.enableProgressiveLoading&&this.props.fileSize))return[3,3];return[4,(0,Y.e)()];case 1:return a=b.sent(),this.progressiveLoadingService=new a,[4,this.progressiveLoadingService.tryInitRangeDownload(this.props.url,this.props.fileSize,this.props.token,this.props.getAuthHeaders)];case 2:b.sent(),b.label=3;case 3:return[2]}})})},b.prototype.getFileData=function(){var a,b;return(0,j.yv)(this,void 0,void 0,function(){var c,d,e;return(0,j.SO)(this,function(f){switch(f.label){case 0:return[4,this.tryCreateProgressiveLoadingService()];case 1:if(f.sent(),(null==(a=this.progressiveLoadingService)?void 0:a.enabled)&&this.props.fileSize)return[2,[new Uint8Array(0),this.props.fileSize]];if(!this.mounted)return[2,[void 0,0]];if(!(c=null==(b=this.progressiveLoadingService)?void 0:b.getFileData()))return[3,2];return e=c,[3,4];case 2:return[4,this.docLoader.fetch()];case 3:e=f.sent(),f.label=4;case 4:if(d=e,!this.mounted||!d)return[2,[void 0,0]];return this.setState({fileReady:!0}),[2,[d,d.length]]}})})},b.prototype.initProgressiveLoadingService=function(a){var b;return(0,j.yv)(this,void 0,void 0,function(){var c,d,e,f,g,h=this;return(0,j.SO)(this,function(i){return(null==(b=this.progressiveLoadingService)?void 0:b.enabled)&&this.viewContext&&(c=function(){var a,b;h.setState({fileReady:!0}),h.viewContext&&(null==(b=(a=h.props).onDocumentLoaded)||b.call(a,h.viewContext.metadata))},d=function(b,c,d){return(0,j.yv)(h,void 0,void 0,function(){return(0,j.SO)(this,function(e){switch(e.label){case 0:return[4,a.onRangeRequestDone(b,c,d)];case 1:return e.sent(),[2]}})})},e=function(a){var b;null==(b=h.docLoadScenario)||b.fail(a)},f=function(){return(0,j.yv)(h,void 0,void 0,function(){return(0,j.SO)(this,function(a){switch(a.label){case 0:return[4,this.initDocument()];case 1:return a.sent(),[2]}})})},g=function(){return(0,j.yv)(h,void 0,void 0,function(){return(0,j.SO)(this,function(b){switch(b.label){case 0:return[4,a.resetStream()];case 1:return b.sent(),[4,a.closeDocument()];case 2:return b.sent(),this.disposeForReload(),this.initViewer(!0),[2]}})})},this.progressiveLoadingService.initProgressiveLoadingService(this.viewContext,this.layoutManager,this.renderViewport,g,f,c,d,e),this.bindWorkerMessage()),[2]})})},b.prototype.initViewer=function(a){var b,c,d,e,f,g,h,i,k,l,m,n,o,p,q,r,t,z,A,B,C,D,E,F,G,H,I,J;return void 0===a&&(a=!1),(0,j.yv)(this,void 0,void 0,function(){var K,L,M,N,O,P,Q,R,S,T,U,W,Y,Z,$,_,aa,ab,ac,ad,ae=this;return(0,j.SO)(this,function(af){switch(af.label){case 0:a||(this.docLoadScenario=x.a.createScenario({name:y.a.DocumentLoad,extraData:this.tempAuthLogFields})),af.label=1;case 1:if(af.trys.push([1,22,,23]),u.a.isActivated("CheckWorkerVersion"))return[3,3];return[4,this.checkWorkerVersion()];case 2:af.sent(),af.label=3;case 3:return this.bindPageEvents(),[4,this.getFileData()];case 4:if(L=(K=j.pM.apply(void 0,[af.sent(),2]))[0],M=K[1],!this.mounted||!L||!M)return N=new s.c(s.b.PdfLoadCanceled,"PdfViewer unmounted before opening document.unmounted:".concat(!this.mounted,", filedata undefined:").concat(!L,", fileSize:").concat(M)),x.a.logError(N.toCaughtError()),null==(b=this.docLoadScenario)||b.stop(),[2];return w.a.mark("Downloaded"),this.exposeFnsToWorker(),[4,this.wasmDataProvider.getModuleInnerInit()];case 5:return O=af.sent(),[4,this.viewWorker.initialize(O)];case 6:return af.sent(),[4,this.viewWorker.getHandlerInstance(L,M,!!this.props.enableCopyByChunk,null==(c=this.progressiveLoadingService)?void 0:c.getChunkRequestSize())];case 7:return P=af.sent(),v.a.verbose(bt,"Created PdfViewHandler instance"),[4,this.viewWorker.getInputEvtHandler()];case 8:return Q=af.sent(),R=this,[4,X.getInstance(P,Q)];case 9:return R.viewContext=af.sent(),this.docOpener.viewHandler=P,this.docOpener.reset(),[4,this.initProgressiveLoadingService(P)];case 10:return af.sent(),S={featureConfigInMspdfkit:{enableFormFilling:!!(null==(d=V.a.features)?void 0:d.enableFormFilling),enableOpenMip:!!this.props.enableOpenMip,enableProgressiveLoading:!!(null==(e=this.progressiveLoadingService)?void 0:e.enabled),enableICUConverterKS:!u.a.isActivated("EnableICUConverter"),enableMipSdkTelemetry:!!(null==(f=V.a.features)?void 0:f.enableMipSdkTelemetry),enableOwnerPassword:!!(null==(g=V.a.features)?void 0:g.enableEncrypt),enableWatermark:!!(null==(h=V.a.features)?void 0:h.enableWatermark),enableDataCopyOptimizationKS:!u.a.isActivated("EnableDataCopyOptimization"),enableMipTokenPrefetch:!!(null==(i=V.a.features)?void 0:i.enableMipTokenPrefetch),enableLoadFontOnDemand:!!(null==(k=V.a.features)?void 0:k.enableLoadFontOnDemand),enableLoopFontsOnDemand:!!(null==(l=V.a.features)?void 0:l.enableLoopFontsOnDemand),enablePageTextRunInfoForAcc:!!(null==(m=V.a.features)?void 0:m.enablePageTextRunInfoForAcc)},featureConfigInPdfControl:{enableFreeText:!!(null==(n=V.a.features)?void 0:n.enableFreeText),enableEnhancedInk:!!(null==(o=V.a.features)?void 0:o.enableEnhancedInk),enableProgressiveDocumentHandler:!!(null==(p=this.progressiveLoadingService)?void 0:p.enabled)&&!u.a.isActivated("EnableProgressiveDocumentHandler"),enableWatermark:!!(null==(q=V.a.features)?void 0:q.enableWatermark),enableOnlyBGRFormat:!!(null==(r=V.a.features)?void 0:r.enableOnlyBGRFormat),enableUndoRedo:!!(null==(t=V.a.features)?void 0:t.enableUndoRedo),disableLinearization:!u.a.isActivated("DisableLinearizationKS"),enableShowStickyNote:!!(null==(z=V.a.features)?void 0:z.enableShowStickyNote)}},[4,P.setFeatureConfig(S)];case 11:return af.sent(),P.setEditEnabled(!!this.props.enableEdit),T=this,[4,this.viewWorker.getAnnotationHandlerInstance()];case 12:if(T.annotHandler=af.sent(),!(null==(A=V.a.features)?void 0:A.enableFreeText))return[3,14];return U=this,[4,this.viewWorker.getFreeTextHandler()];case 13:U.freeTextHandler=af.sent(),af.label=14;case 14:if(!(null==(B=V.a.features)?void 0:B.enableFormFilling))return[3,16];return W=this,[4,this.viewWorker.getFormHandler()];case 15:W.formHandler=af.sent(),af.label=16;case 16:if(!(null==(C=V.a.features)?void 0:C.enableWatermark))return[3,18];return Y=this,[4,this.viewWorker.getWatermarkHandler()];case 17:Y.watermarkHandler=af.sent(),af.label=18;case 18:if(!(null==(D=V.a.features)?void 0:D.enableUndoRedo))return[3,20];return Z=this,[4,null==(F=(E=this.viewWorker).getUndoRedoHandler)?void 0:F.call(E)];case 19:Z.undoRedoHandler=af.sent(),af.label=20;case 20:return[4,this.tryOpenDocument()];case 21:return af.sent(),[3,23];case 22:return(null==($=af.sent())?void 0:$.message)&&(_=V.a.wasmModuleInit.length>0?V.a.wasmModuleInit[0]:void 0)&&(aa=_.wasmUrl,ab=_.dataUrl,ac=_.wasmJsUrlOrBlob,$.message+=". Additional: wasmUrl=".concat(encodeURIComponent(aa).replace("https",""),", wasmJsUrl=").concat("string"==typeof ac&&encodeURIComponent(ac).replace("https",""),", dataUrl=").concat(encodeURIComponent(ab||"").replace("https",""))),ad=$ instanceof s.c?$.toQosError():{isExpected:$.isExpected||$.name===s.b.InvalidPDF,error:$,code:$.name},this.pageLoaded&&this.mounted||(ad.isExpected=!0),ad.extraData=(0,j.q5)((0,j.q5)((0,j.q5)({},ad.extraData),this.tempAuthLogFields),{unmounted:!this.mounted,unloaded:!this.pageLoaded}),(null==(G=V.a.features)?void 0:G.enableAsyncQosEvent)?window.setTimeout(function(){var a,b,c;null==(a=ae.docLoadScenario)||a.fail(ad),null==(c=(b=ae.props).onInitError)||c.call(b,ad)}):(null==(H=this.docLoadScenario)||H.fail(ad),null==(J=(I=this.props).onInitError)||J.call(I,ad)),[2];case 23:return[2]}})})},b.prototype.tryOpenDocument=function(a,b){var c,d;return(0,j.yv)(this,void 0,void 0,function(){var e,f,g,h;return(0,j.SO)(this,function(i){switch(i.label){case 0:e=!1,f=void 0,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,this.docOpener.tryOpen(a,b)];case 2:return e=i.sent(),[3,4];case 3:if(g=i.sent(),this.props.enableOpenMip&&g.name&&g.name.startsWith("Mip"))e=!0,f=s.e.getParsedErrorData(g);else throw g;return[3,4];case 4:if(!e)return h={mip:!1},null==(c=this.docLoadScenario)||c.stop({extraData:h}),[2];if(null==(d=this.progressiveLoadingService)?void 0:d.enabled)return[3,6];return[4,this.initDocument(f)];case 5:i.sent(),i.label=6;case 6:return[2]}})})},b.prototype.initDocument=function(a){var b,c,d,e,f,h,i,k,l,m,n,o,p;return(0,j.yv)(this,void 0,void 0,function(){var q,r,t,u,v,y=this;return(0,j.SO)(this,function(z){switch(z.label){case 0:if(w.a.mark("Opened"),!this.viewContext)throw new s.c(s.b.ViewContextNotInitialized,"PdfViewer viewContext empty");return[4,this.viewContext.initMetadata()];case 1:if(z.sent(),this.viewContext.metadata.needPassword=this.docOpener.needPassword,null==(c=(b=this.props).onMetadataUpdated)||c.call(b,this.viewContext.metadata),this.viewContext.metadata&&this.setState({metadata:this.viewContext.metadata}),q=this.layoutManager.metadata=this.viewContext.metadata,r=(0,j.q5)({pageCount:q.pageCount,averagePageSize:0===q.pageCount?0:this.docLoader.fileSize/q.pageCount,mip:q.mip,hasOutline:q.hasOutline},this.tempAuthLogFields),a?(a.extraData=r,a.code===g.MipNoPermissions&&(null==(e=(d=this.props).onMipAuthFailed)||e.call(d)),null==(f=this.docLoadScenario)||f.fail(a),x.a.logError(a)):null==(h=this.docLoadScenario)||h.stop({extraData:r}),this.loadFontPromise=V.a.fontConfigs&&this.loadFonts(),this.initServices(),!((null==(i=V.a.features)?void 0:i.enableUndoRedo)&&this.viewContext))return[3,3];return[4,(0,Y.h)()];case 2:t=z.sent(),this.undoRedoService=new t(this.viewContext,this.eventBus.dispatch.bind(this.eventBus),this.undoRedoHandler),z.label=3;case 3:return[4,(0,Y.j)()];case 4:if(u=z.sent(),this.pinchable=new u(function(){return y.scale},this.zoomService.blurZoom,function(){var a,b;null==(a=y.renderService)||a.clear(),null==(b=y.zoomService)||b.render()},this.eventBus),!(null==(k=V.a.features)?void 0:k.enableShowStickyNote))return[3,6];return[4,(0,Y.c)()];case 5:v=z.sent(),this.noteService=new v(this.viewContext,this.eventBus.dispatch.bind(this.eventBus)),z.label=6;case 6:var A,B;if(this.displayHelper||(this.displayHelper=new a2(this.layoutManager,this.props.uniqueId,this.props.enableCacheDisplayInfo,this.props.defaultPageNumber,this.props.defaultScale)),!(null==(l=V.a.features)?void 0:l.enableProhibitScreenshotForMip))return[3,8];return[4,(A=q,B=this.props.prohibitScreenshot,(0,j.yv)(void 0,void 0,void 0,function(){var a,b;return(0,j.SO)(this,function(c){switch(c.label){case 0:if(!(A.isMipDecrypted&&!A.isCopyAllowed&&!A.isCopyAccessibleAllowed))return[3,4];c.label=1;case 1:return c.trys.push([1,3,,4]),[4,null==B?void 0:B()];case 2:return a=c.sent(),x.a.logEngagement({name:"MipProhibitScreenshot",extraData:{isSuccess:a}}),[3,4];case 3:return b=c.sent(),x.a.logEngagement({name:"MipProhibitScreenshot",extraData:{isSuccess:!1,errorInfo:b instanceof Error?b.message:String(b)}}),[3,4];case 4:return[2]}})}))];case 7:z.sent(),z.label=8;case 8:return this.bindEvents(),null==(m=this.displayHelper)||m.applyInfoInLocalStorage(),[4,this.initContent()];case 9:return z.sent(),(null==(n=this.progressiveLoadingService)?void 0:n.enabled)||null==(p=(o=this.props).onDocumentLoaded)||p.call(o,q),[2]}})})},b.prototype.loadFonts=function(){var a;return(0,j.yv)(this,void 0,void 0,function(){var b,c,d;return(0,j.SO)(this,function(e){switch(e.label){case 0:return[4,this.viewWorker.getFontHandler()];case 1:if(b=e.sent(),!V.a.fontConfigs)return[2];if(!(null==(a=V.a.features)?void 0:a.enableLoadFontOnDemand))return[3,4];return[4,(0,Y.a)()];case 2:return c=e.sent(),this.fontProvider=new c(b,this.props.onFontLoading),[4,this.fontProvider.loadRequiredFonts(V.a.fontConfigs)];case 3:return e.sent(),[2];case 4:if(u.a.isActivated("CacheFontFile"))return[3,7];return[4,(0,Y.a)()];case 5:return c=e.sent(),this.fontProvider=new c(b),[4,this.fontProvider.loadFonts(V.a.fontConfigs)];case 6:return e.sent(),[3,9];case 7:return d=V.a.fontConfigs.map(function(a){return a.fontUrl}),[4,b.loadFonts(d)];case 8:e.sent(),e.label=9;case 9:return[2]}})})},b.prototype.exposeFnsToWorker=function(){var a=this;H({getMIPToken:function(b){return(0,j.yv)(a,void 0,void 0,function(){var a,c;return(0,j.SO)(this,function(d){return this.props.enableOpenMip?[2,null==(c=(a=this.props).getMIPToken)?void 0:c.call(a,b)]:[2]})})},logQosStart:function(a){x.a.handler.logQosStart(a)},logQosEnd:function(a){x.a.handler.logQosEnd(a)},logEngagement:function(a){x.a.handler.logEngagement(a)},logError:function(a){x.a.handler.logError(a)},logVerbose:function(a){var b,c;null==(c=(b=x.a.handler).logVerbose)||c.call(b,a)}},this.worker)},b.prototype.initServices=function(){var a,b,c,d,e,f=this;this.viewContext&&(this.renderService=new aC(this.viewContext,this.updateRenderResult,this.props.onRenderError,function(){f.eventBus.dispatch(S.e.InitialDisplayInfoApplied)}),this.zoomService=new aH(this.viewContext,this.layoutManager,this.renderViewport,this.updateBlurRenderResult,this.eventBus.dispatch.bind(this.eventBus),function(){f.preventScrollRender=!0},function(a,b){var c,d,e;null==(c=f.viewerRendererRef)||c.toggleGripper(!1),null==(e=(d=f.props).onScaleChanged)||e.call(d,a,b),f.eventBus.dispatch(S.e.ScaleChanged)}),this.contentService=new ad(this.viewContext,this.layoutManager,this.l10n,this.updateRenderResult,this.goToPage,this.scrollBy,this.onTextSelected,this.onTextDeselected,null==(a=this.progressiveLoadingService)?void 0:a.refreshViewPortForProgressiveLoading),this.linkService=new ay(this.viewContext,this.layoutManager,this.goToPage,this.eventBus.dispatch.bind(this.eventBus)),this.searchService=new aD(this.viewContext),this.inputEvtService=new ax(this.viewContext,this.layoutManager,this.l10n,this.contentService,function(a){var b;null==(b=f.viewerRendererRef)||b.toggleGripper(a)},function(a){var b;null==(b=f.viewerRendererRef)||b.updateGripperPosition(a)},this.goToPage,this.scrollBy,this.scrollTo,function(a){var b;null==(b=f.viewerRendererRef)||b.focusOnVirtualForwardForm(a)},function(a){var b;null==(b=f.viewerRendererRef)||b.focusOnVirtualBackwardForm(a)},this.updateCursorType,this.onFormFocus,function(){return f.context.isFormFillingEnabled},this.rootRef.current||void 0),(null==(b=V.a.features)?void 0:b.enableFreeText)&&(this.freeTextService=new al(this.viewContext,(null==(c=this.pageManager)?void 0:c.getOriginalPageRects())||[],this.eventBus.dispatch.bind(this.eventBus))),(null==(d=V.a.features)?void 0:d.enableFormFilling)&&(this.formService=new aj(this.eventBus.dispatch.bind(this.eventBus))),null==(e=this.loadFontPromise)||e.then(function(){f.renderViewport("Init")}))},b.prototype.initContent=function(){var a,b,c;return(0,j.yv)(this,void 0,void 0,function(){var d,e=this;return(0,j.SO)(this,function(f){switch(f.label){case 0:if(d=null==(a=this.displayHelper)?void 0:a.initialRenderOptions,null==(b=this.zoomService)||b.initScale(null==d?void 0:d.scale),!(null==d?void 0:d.rotation))return[3,2];return[4,this.rotate(d.rotation)];case 1:f.sent(),f.label=2;case 2:return this.layoutManager.resetContentSize(),this.goToPage(0,null==(c=this.displayHelper)?void 0:c.initialPos),this.initRenderRequestId=requestAnimationFrame(function(){e.layoutManager.resetContentSize(),requestAnimationFrame(function(){v.a.verbose(bt,"Root size: ".concat(e.layoutManager.rootRect.getClientWidth(),", ").concat(e.layoutManager.rootRect.getClientHeight())),e.renderViewport("Init")})}),[2]}})})},b.prototype.initManipulator=function(){return(0,j.yv)(this,void 0,void 0,function(){var a;return(0,j.SO)(this,function(b){switch(b.label){case 0:return[4,this.wasmDataProvider.getModuleInnerInit("Manipulator")];case 1:return a=b.sent(),[4,this.viewWorker.initialize(a)];case 2:return b.sent(),[2,this.viewWorker.getManipulatorHandlerInstance()]}})})},b.prototype.getManipulatorHandler=function(){return this.manipulatorInitPromise||(this.manipulatorInitPromise=this.initManipulator()),this.manipulatorInitPromise},b.prototype.reset=function(){var a;null==(a=this.renderService)||a.clear(),this.dispose(),this.layoutManager.metadata=void 0,this.setState(bs),this.layoutManager.contentRect.reset(),this.layoutManager.rootRect.clear(),this.docLoader=new ah(this.props.url,this.props.filename,this.props.fileSize,this.props.enableDownloadByRange,this.props.token,this.props.getAuthHeaders),v.a.verbose(bt,"Reset")},b.prototype.disposeForReload=function(){var a,b,c,d,e;az.a.getInstance().clear(),w.a.clearMarks(),this.storeDisplayInfo(),this.removeEvents(),null==(a=this.renderService)||a.clear(),null==(b=this.printService)||b.dispose(),null==(c=this.inputEvtService)||c.dispose(),this.docLoader.dispose(),null==(d=this.thumbnailService)||d.dispose(),null==(e=this.progressiveLoadingService)||e.dispose(),this.renderService=void 0,this.zoomService=void 0,this.contentService=void 0,this.inputEvtService=void 0,this.rotateService=void 0},b.prototype.dispose=function(){var a,b,c;null==(b=null==(a=this.pinchable)?void 0:a.dispose)||b.call(a),null==(c=this.viewContext)||c.dispose(),this.eventBus.dispose(),this.disposeForReload()},b.prototype.bindWorkerMessage=function(){this.worker.addEventListener("message",this.onWorkerMessage)},b.prototype.bindPageEvents=function(){window.addEventListener("beforeunload",this.onBeforePageUnload),window.addEventListener("unload",this.onPageUnload)},b.prototype.bindEvents=function(){u.a.isActivated("UseSizeObserver")?window.addEventListener("resize",this.onResize):this.observeOuterSizeChange(),window.addEventListener("mousemove",this.onGlobalMouseMove),window.addEventListener("mouseup",this.onGlobalMouseUp);var a,b=this.rootRef.current;null==b||b.addEventListener("touchmove",this.onTouchMove),null==b||b.addEventListener("scroll",this.onScroll),null==b||b.addEventListener("wheel",this.onWheel,{passive:!1}),(null==(a=this.progressiveLoadingService)?void 0:a.enabled)||this.bindWorkerMessage()},b.prototype.removeEvents=function(){u.a.isActivated("UseSizeObserver")?window.removeEventListener("resize",this.onResize):null==(a=this.outerSizeObserver)||a.disconnect(),window.removeEventListener("mousemove",this.onGlobalMouseMove),window.removeEventListener("mouseup",this.onGlobalMouseUp),window.removeEventListener("beforeunload",this.onBeforePageUnload),window.removeEventListener("unload",this.onPageUnload);var a,b=this.rootRef.current;null==b||b.removeEventListener("touchmove",this.onTouchMove),null==b||b.removeEventListener("scroll",this.onScroll),null==b||b.removeEventListener("wheel",this.onWheel),this.worker.removeEventListener("message",this.onWorkerMessage)},b.prototype.observeOuterSizeChange=function(){var a=this,b=!0;this.outerSizeObserver=new ResizeObserver(function(c){var d,e;try{for(var f=(0,j.BW)(c),g=f.next();!g.done;g=f.next())if(g.value.target.className===a4){b?b=!1:a.onResize();break}}catch(a){d={error:a}}finally{try{g&&!g.done&&(e=f.return)&&e.call(f)}finally{if(d)throw d.error}}}),this.outerRef.current&&this.outerSizeObserver.observe(this.outerRef.current)},b.prototype.resizeViewer=function(){var a,b,c=this,d=(0,r.a)();d!==this.state.dpr&&(this.setState({dpr:d}),this.clearViewport()),(null==(a=this.zoomService)?void 0:a.isResponsiveZoomValid())&&this.eventBus.dispatch(S.e.ResponsiveResize),(null==(b=this.zoomService)?void 0:b.responsiveZoom())||(this.layoutManager.resetContentSize(),requestAnimationFrame(function(){c.renderViewport()}))},b.prototype.updateOuterHeight=function(){this.props.height&&this.outerRect.setHeight(this.props.height)},b.prototype.clearViewport=function(){var a;null==(a=this.renderService)||a.clear(),this.setState({viewportRenderResult:void 0,viewportBlurRenderResult:void 0})},b.prototype.isEvtInsideViewer=function(a){var b,c,d=new o.a(a.clientX,a.clientY),e=a.target,f=null==(b=this.rootRef.current)?void 0:b.getBoundingClientRect();return e instanceof Node&&(null==(c=this.rootRef.current)?void 0:c.contains(e))||!!f&&d.x>=f.x&&d.x<=f.x+f.width&&d.y>=f.y&&d.y<=f.y+f.height},b.prototype.getNativeEvt=function(a){return a.nativeEvent||a},b.prototype.checkWorkerVersion=function(){var a,b;return(0,j.yv)(this,void 0,void 0,function(){var c;return(0,j.SO)(this,function(d){switch(d.label){case 0:return[4,this.viewWorker.getExtWorkerVersion()];case 1:if(c=d.sent(),null==(b=(a=this.props).isWorkerVersionMismatch)?void 0:b.call(a,c))throw new s.f("Fail to initialize viewer due to mismatching between web worker and the main app, workerVersion=".concat(c,", workerSrc=").concat(encodeURIComponent(V.a.workerSrc)));return[2]}})})},Object.defineProperty(b.prototype,"pageManager",{get:function(){return this.layoutManager.pageManager},enumerable:!1,configurable:!0}),Object.defineProperty(b.prototype,"tempAuthLogFields",{get:function(){return z.a.getTempAuthLogFields(this.props.url,this.props.token)},enumerable:!1,configurable:!0}),b.prototype.getHighlightCanvasRect=function(){var a,b,c,d,e,f,g,h;return new o.b(null!=(b=null==(a=this.layoutManager.rootRect)?void 0:a.getScrollLeft())?b:0,null!=(d=null==(c=this.layoutManager.rootRect)?void 0:c.getScrollTop())?d:0,null!=(f=null==(e=this.layoutManager.rootRect)?void 0:e.getClientWidth())?f:0,null!=(h=null==(g=this.layoutManager.rootRect)?void 0:g.getClientHeight())?h:0)},b.defaultProps={isRootFocusable:!0,enableCacheDisplayInfo:!0,prohibitScreenshot:aO},b.contextType=aR.b,b}(Q.Component)}
,a=>{"use strict";var b=Object.getOwnPropertySymbols,c=Object.prototype.hasOwnProperty,d=Object.prototype.propertyIsEnumerable;a.exports=!function(){try{if(!Object.assign)return!1;var a=new String("abc");if(a[5]="de","5"===Object.getOwnPropertyNames(a)[0])return!1;for(var b={},c=0;c<10;c++)b["_"+String.fromCharCode(c)]=c;var d=Object.getOwnPropertyNames(b).map(function(a){return b[a]});if("0123456789"!==d.join(""))return!1;var e={};if("abcdefghijklmnopqrst".split("").forEach(function(a){e[a]=a}),"abcdefghijklmnopqrst"!==Object.keys(Object.assign({},e)).join(""))return!1;return!0}catch(a){return!1}}()?function(a,e){for(var f,g,h=function(a){if(null==a)throw TypeError("Object.assign cannot be called with null or undefined");return Object(a)}(a),i=1;i<arguments.length;i++){for(var j in f=Object(arguments[i]))c.call(f,j)&&(h[j]=f[j]);if(b){g=b(f);for(var k=0;k<g.length;k++)d.call(f,g[k])&&(h[g[k]]=f[g[k]])}}return h}:Object.assign}
,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>k,b:()=>i});var d=c(201),e=c(0),f=c("odsp.util_126");let g=!1,h=[];function i(a,b,c){f.Ov.isActivated("54E9C1A9-2920-4652-8B8B-78037EA1ADAD")?!g&&a&&(g=!0,d.a.logData({name:"ChatODSP.EntryPointRendered"})):a&&0>h.indexOf(b)&&(h.push(b),d.a.logData({name:"ChatODSP.EntryPointRendered",extraData:{scenario:b,userLicenseType:c()}}))}let j=!1;function k(a){j||(j=!0,new e.a({name:"ChatODSP.CopilotAvailability"}).end({resultType:!a.isFoRFlightEnabled&&a.isUserInMochaSegmentation?e.b.Failure:a.isFoRFlightEnabled&&(!a.customCopilotEAPCheckEnabled||a.isUserInEAP)?e.b.Success:e.b.ExpectedFailure,extraData:{...a}}))}}
,,(a,b,c)=>{"use strict";c.d(b,{a:()=>e});var d=c("odsp.util_126");let e=new d.v7({name:"isCopilotLiteEnabled",factory:new d.Uo(()=>!1)})}
,,,,(a,b,c)=>{"use strict";c.r(b),c.d(b,{legacyGraphDataSourceKey:()=>n});var d=c(9),e=c("odsp.util_126"),f=c(42),g=c(15),h=c(46),i=c(76),j=c(2),k=c(156);let l={ODB:620};class m{getItemCurrentVersion(a,b){return d.c.resolve((async()=>{let c=this.getItemUrl(a,b),d=`${c}/versions?$select=id`,{value:e}=await this._sendVroomRequest(c,d,a,b||{},"versions",{});return e.length>0?e[0].id:""})())}getDownloadUrl(a,b={}){let c=this._urlCache;if(!b.forceRefresh){let{url:b,time:f}=c.get(a.key)||{};if(!e.Ov.isActivated("BCD7B9B4-8CA3-4350-87D0-90643D190FE6","11/01/2023","Enable download url cache")&&b&&f>Date.now()-27e5)return d.c.wrap(b)}if(b.excludeTempAuth&&a.downloadUrlNoAuth)return d.c.resolve(a.downloadUrlNoAuth);if(a.downloadUrl&&""!==a.downloadUrl&&a.itemGeneratedTimeStamp&&Date.now()-a.itemGeneratedTimeStamp<27e5)return d.c.resolve(a.downloadUrl);let f=b.excludeTempAuth?{Prefer:"pactoken=N"}:void 0,g=this.getItemUrl(a,b),h=`${g}?select=id,@content.downloadUrl`;return this._sendVroomRequest(g,h,a,b,"itemDownloadUrl",f).then(b=>{let d=b["@content.downloadUrl"].replace(/[?&]ApiVersion=[^&]+/,"");return c.set(a.key,{url:d,time:Date.now()}),d})}getDownloadToken(a){let{item:b}=a,c=this._itemUrlHelper.getItemUrlParts(b.key);return c.isCrossDomain?this._identityDataSource.getSharePointToken({webAbsoluteUrl:new f.a(c.fullItemUrl).authority,apiQosName:"LegacyGraphDataSource"}).then(a=>{let{accessToken:b,isBadger:c}=a;return`${c?"badger":"bearer"} ${b}`}):d.c.resolve(void 0)}getAuthenticationParams(a,b){let{apiVersion:c=e.lU.isFeatureEnabled(l)?"v2.1":"v2.0"}=b||{};return this.refreshAccessToken(a,{...b,apiVersion:c}).then(()=>this._getAuthenticationParamsSync(a,b))}getItemUrl(a,b={}){let{useDirectEndpoint:c=!this._pageContext.isSPO,isPath:d=!1,apiVersion:e="v2.0",allowCookies:f=!1}=b,g=this._getGraphBaseUrl(a,{useDirectEndpoint:c,apiVersion:e,allowCookies:f}),{graph:h}=a;if(h&&h.driveId&&"root"!==h.itemId){let{driveId:a="me",itemId:b="root"}=h;return`${g}/drives/${encodeURIComponent(a)}${"root"===b?"/root":`/items/${encodeURIComponent(b)}`}${d?":":""}`}{let b,c=a.graph,e=c&&c.driveId;if(e&&(b=`${g}/drives/${encodeURIComponent(e)}`),!b)return"";let f=this._itemUrlHelper.getItemUrlParts(a.key),{listRelativeItemUrl:h}=this._itemUrlHelper.getUrlParts({path:f.serverRelativeItemUrl,listUrl:f.serverRelativeListUrl});return`${b}/root${h?`:/${encodeURI(h)}${d?"":":"}`:`${d?":":""}`}`}}getAccessToken(a,b={}){let{apiVersion:c}=b;return"v2.1"===c?a&&a.graph.sessionTokenV21:a&&a.graph.sessionToken}refreshAccessToken(a,b={}){return d.c.resolve(this.getAccessToken(a,b))}getMetaPac(a,b={}){return d.c.resolve(this.getAccessToken(a,b))}getDownloadUrlSync(a,b){}getDriveUrl(a,b){return""}_getAuthenticationParamsSync(a,b){let c=this.getAccessToken(a,b);if(c){let{accessToken:a,proofToken:b}=c,d={};return a&&(d.access_token=a),b&&(d.prooftoken=b),d}return{}}_getGraphBaseUrl(a,b){let{useDirectEndpoint:c,apiVersion:d}=b,e=this._itemUrlHelper.getItemUrlParts(a.key),g=e.fullListUrl;if(!c)return"https://graph.microsoft.com/v1.0";if(g)return`${new f.a(g).authority}/_api/${d}`;if(!e.isCrossDomain&&!e.isCrossList)return this._urlDataSource.getApiBaseUrl({apiVersion:d});{let b=this._itemUrlHelper.getItemUrlParts(a.key).fullItemUrl;return`${new f.a(b).authority}/_api/${d}`}}_sendVroomRequest(a,b,c,e={},g,h){let{isCrossDomain:i}=this._itemUrlHelper.getItemUrlParts(c.key);e.apiName&&(g=`${e.apiName}.${g}`);let j=!i;return(j?d.c.resolve(void 0):this._identityDataSource.getSharePointToken({webAbsoluteUrl:new f.a(a).authority,apiQosName:"LegacyGraphDataSource"})).then(a=>this._vroomDataRequestor.send({apiName:g,path:`${b}`,accessToken:j?void 0:a,qosExtraData:e.qosExtraData,allowCookies:j,headers:h}))}constructor(a,b){this._urlDataSource=b.urlDataSource,this._itemUrlHelper=b.itemUrlHelper,this._pageContext=b.pageContext,this._urlCache=new Map,this._vroomDataRequestor=b.vroomDataRequestor,this._identityDataSource=b.identityDataSource}}m.dependencies={urlDataSource:k.b,itemUrlHelper:g.c,pageContext:j.a,vroomDataRequestor:i.a,identityDataSource:h.resourceKey};let n=(0,e.hl)("LegacyGraphDataSource",m)}
,(a,b,c)=>{var d="Expected a function",e=0/0,f=/^\s+|\s+$/g,g=/^[-+]0x[0-9a-f]+$/i,h=/^0b[01]+$/i,i=/^0o[0-7]+$/i,j=parseInt,k="object"==typeof c.g&&c.g&&c.g.Object===Object&&c.g,l="object"==typeof self&&self&&self.Object===Object&&self,m=k||l||Function("return this")(),n=Object.prototype.toString,o=Math.max,p=Math.min,q=function(){return m.Date.now()};function r(a){var b=typeof a;return!!a&&("object"==b||"function"==b)}function s(a){if("number"==typeof a)return a;if("symbol"==typeof(b=a)||b&&"object"==typeof b&&"[object Symbol]"==n.call(b))return e;if(r(a)){var b,c="function"==typeof a.valueOf?a.valueOf():a;a=r(c)?c+"":c}if("string"!=typeof a)return 0===a?a:+a;a=a.replace(f,"");var d=h.test(a);return d||i.test(a)?j(a.slice(2),d?2:8):g.test(a)?e:+a}a.exports=function(a,b,c){var e=!0,f=!0;if("function"!=typeof a)throw TypeError(d);return r(c)&&(e="leading"in c?!!c.leading:e,f="trailing"in c?!!c.trailing:f),function(a,b,c){var e,f,g,h,i,j,k=0,l=!1,m=!1,n=!0;if("function"!=typeof a)throw TypeError(d);function t(b){var c=e,d=f;return e=f=void 0,k=b,h=a.apply(d,c)}function u(a){var c=a-j,d=a-k;return void 0===j||c>=b||c<0||m&&d>=g}function v(){var a,c,d,e=q();if(u(e))return w(e);i=setTimeout(v,(a=e-j,c=e-k,d=b-a,m?p(d,g-c):d))}function w(a){return(i=void 0,n&&e)?t(a):(e=f=void 0,h)}function x(){var a,c=q(),d=u(c);if(e=arguments,f=this,j=c,d){if(void 0===i)return k=a=j,i=setTimeout(v,b),l?t(a):h;if(m)return i=setTimeout(v,b),t(j)}return void 0===i&&(i=setTimeout(v,b)),h}return b=s(b)||0,r(c)&&(l=!!c.leading,g=(m="maxWait"in c)?o(s(c.maxWait)||0,b):g,n="trailing"in c?!!c.trailing:n),x.cancel=function(){void 0!==i&&clearTimeout(i),k=0,e=j=f=i=void 0},x.flush=function(){return void 0===i?h:w(q())},x}(a,b,{leading:e,maxWait:b,trailing:f})}}
,,,,,,,,,,,,,,,,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>V});var d=c(155),e=c(265),f=c(272),g=c(532),h=c(159),i=c(273),j=c(274),k=c(108),l=c(275),m=c(150),n=c(102),o=c("odsp.util_126"),p=c(881),q=c(206),r=c(161),s=c(536),t=c(539);let u=[".docm",".dotm",".dotx",".docx",".bmp",".jpg",".jpeg",".tiff",".tif",".png",".gif",".emf",".wmf",".psd",".svg",".ai",".pdf",".pptm",".pptx",".potm",".potx",".ppsm",".ppsx",".xlsm",".xlsx",".aspx"];function v(a){return!!a&&u.indexOf(a.toLowerCase())>=0}var w=c(276),x=c(81),y=c(6),z=c(540),A=c(62),B=c(277),C=c(15),D=c(98),E=c(20),F=c(22),G=c(2),H=c(32),I=c(541),J=c(4),K=c(49),L=c(162);let M=!o.Ov.isActivated("b8f99452-1739-40bb-a1bb-dd8b65e27ec6","07/13/2024","Fix image preview of remote item in Gallatin"),N=[".dcm",".dcm30",".dic",".dicm",".dicom"];function O(a){let{endpoint:b,driveId:c,itemId:d="root"}=(0,f.a)(a);if(b)return{endpoint:b,driveId:c,itemId:d}}function P(a){let b,c,{pageContext:d,spItemIdentity:e,itemFromServer:f,oneUpUrlDataSource:g,navigation:h,itemUrlHelper:i,rootItemSet:j}=a;if(j)b=function(a){let{rootItemSet:b,oneUpUrlDataSource:c}=a;return c.getKey({[F.a.queryTypeParamKey]:b.queryType})}({oneUpUrlDataSource:g,rootItemSet:j});else{let a;f&&(a=f.FileRef||f.ServerRelativeUrl),e&&({key:b,id:c}=function(a){let{spItemIdentity:b,folderPath:c,newTargetListViewUrl:d,itemUrlHelper:e,supportsOnePageNavigation:f,itemQueryParams:g,searchParams:h,oneUpUrlDataSource:i,...j}=a,k=e.getUrlParts({webUrl:b.webAbsoluteUrl,listUrl:b.listFullUrl,path:c||b.rootFolder});if(b.itemId&&!c)return{key:void 0,id:void 0};let l=!0;return f&&d&&!j.listUrl&&k.normalizedListUrl&&d.indexOf(k.normalizedListUrl)>-1&&(l=!1),{key:i.getKey({[F.a.idParamKey]:k.serverRelativeItemUrl||"",...l&&k.normalizedListUrl?{[F.a.listUrlKey]:k.normalizedListUrl}:{},...g||{},...h||{}}),id:k.serverRelativeItemUrl||""}}({spItemIdentity:e,oneUpUrlDataSource:g,folderPath:a,itemUrlHelper:i,listUrl:d.listUrl,viewParams:h.viewParams}))}return{key:b,viewParams:h.viewParams,id:c}}function Q(a){let b,{itemFromServer:c,extension:d,mediaServiceFastMetadata:e,blockDownload:f,microServiceDataSource:g,pdfConversionOptions:h}=a,j={fileExtension:a.extension,item:c,mediaServiceMetadata:e};if(b=f&&(0,i.b)(d)?g.getPassthroughUrl(j,h):g.getPdfConversionUrl(j,void 0,h))return{url:b}}function R(a){if(a&&"{}"!==a)try{return JSON.parse(a)}catch(a){return}}function S({siteId:a,webId:b,docId:c,webUrl:d,layoutsUrl:e}){let f,g=f=>d+"/"+e+"/getpreview.ashx?clientType=docLibGrid&guidFile="+c+"&guidSite="+a+"&guidWeb="+b+(f?"":"&resolution=Width1024");return c&&(f={url:g(!1),width:0,height:0,getAligned:(a,b)=>({url:g(b.name===p.a.name),width:0,height:0})}),f}function T(a){return void 0!==a?a/1e4:NaN}function U(a){let b,c,d;if(!a)return{};let{".driveAccessTokenV21":e,".driveAccessToken":f,".driveUrl":g,".driveUrlV21":i,".driveAccessCode":j,".driveAccessCodeV21":k}=a;if(f){let a=(0,q.a)(f);if(b={accessToken:a.access_token,proofToken:a.prooftoken,tokenUrl:g},g){let a=O(g);a&&(d=a.driveId)}}if(e){let a=(0,q.a)(e);if(c={accessToken:a.access_token,proofToken:a.prooftoken,tokenUrl:i},i&&!d){let a=O(i);a&&(d=a.driveId)}}return!o.Ov.isActivated("30d02c53-cd92-4e96-a4c6-f129734b443f","03/18/2025","Add MeTA PAC tokens (driveAccessCode and driveAccessCodeV21) to sessionToken")&&(j&&(b={...b||{},metaPac:j}),k&&(c={...c||{},metaPac:k})),b&&(0,h.a)({authToken:b.accessToken,proofToken:b.proofToken})&&(b=void 0),c&&(0,h.a)({authToken:c.accessToken,proofToken:c.proofToken})&&(c=void 0),{driveId:d,sessionToken:b,sessionTokenV21:c}}let V=new o.v7({name:"ProcessOneUpItem",factory:{dependencies:{pageContext:G.a,oneUpUrlDataSource:e.a,microServiceDataSource:D.a,navigation:E.a,itemUrlHelper:C.c,isMeTATempAuthDeprecationEnabled:L.a},create:({pageContext:a,oneUpUrlDataSource:b,microServiceDataSource:c,navigation:e,itemUrlHelper:f,isMeTATempAuthDeprecationEnabled:h})=>({instance:{processOneUpItem:function(i){return i.microServiceDataSource||delete i.microServiceDataSource,function(a){let{pageContext:b,itemFromServer:c,mediaTransformListSchema:e,microServiceDataSource:f,itemUrlHelper:h,oneUpUrlDataSource:i,spItemIdentity:p,spParentItemIdentity:q,navigation:u,listContext:C,currentPageContext:D,mainLinkInfo:E,isMeTATempAuthDeprecationEnabled:G}=a,L=b.listBaseTemplate,{key:V,id:W}=P({pageContext:b,spItemIdentity:p,itemFromServer:c,oneUpUrlDataSource:i,navigation:u,itemUrlHelper:h}),X={key:V||"",id:W};if(q){let{key:a}=P({pageContext:b,spItemIdentity:q,itemFromServer:c,oneUpUrlDataSource:i,navigation:u,itemUrlHelper:h});a&&(X.parentKey=a)}let{sessionToken:Y,sessionTokenV21:Z}=U(e);if(X.graph={itemId:"",driveId:"",sessionToken:Y,sessionTokenV21:Z},(0,K.a)()&&E&&(X.mainLinkInfo=E),c){let a,e,p,q,u,E,P,U,W=c[".spItemUrl"],Y=W?O(W):void 0;if(Y){let{itemId:a,driveId:b}=Y;X.itemId=a,X.graph={...X.graph,itemId:a||"",driveId:b||""}}let Z=c.PermMask?(0,l.a)(c.PermMask):void 0;Z&&(X.permissions=Z),X.displayName=function({itemFromServer:a,listTemplateType:b=m.a.documentLibrary}){let c=b&&(0,n.d)(b)||b===m.a.promotedLinks||(0,n.c)(b)?a.Title:a.FileLeafRef;return b===m.a.links&&(c=a["URL.desc"]||a.URL||c),c}({itemFromServer:c,listTemplateType:L});let{name:$,extension:_}=function(a){let{File_x0020_Type:b,FileLeafRef:c,FileRef:d,RemoteItem:e}=a,f=b&&!e?"."+b:"",g=c||d&&new y.a(d).segments.slice(-1)[0]||"",h=f&&g?g.toLowerCase().lastIndexOf(f.toLowerCase()):-1;return{name:h>-1?g.substring(0,h):g,extension:f}}(c);X.name=$,X.extension=_;let aa=Number(c.File_x0020_Size)||Number(c.FileSizeDisplay)||void 0;if(void 0!==aa&&(X.size=aa),X.totalSize=Number(c.SMTotalSize)||void 0,(0,J.lb)()){let a="Created_x0020_Date"in c,b=c.Created_x0020_Date?.split(";#").pop();if(a&&b){let a=new Date(b).getTime();if(!isNaN(a)){X.dateCreatedTime=new Date(a);let b=A.a.language||window.navigator.language;X.dateCreated=(0,s.c)(X.dateCreatedTime,b)}}}let ab="Modified."in c,ac=c["Modified."];if(ab&&ac){let a=new Date(ac).getTime();if(!isNaN(a)){X.dateModifiedTime=new Date(a);let b=A.a.language||window.navigator.language;X.dateModified=(0,s.c)(X.dateModifiedTime,b)}}X.contentTypeId=c.ContentTypeId;let ad=R(c.MediaServiceFastMetadata),ae=R(c.MediaServiceMetadata),af=G?{isMeTATempAuthDeprecationEnabled:!0}:void 0,ag=function({itemFromServer:a,extension:b,microServiceDataSource:c,pageContext:d,isMeTATempAuthDeprecationEnabled:e}){if(!d.isSPO)return;let f=c.getFbxConversionUrl({fileExtension:b,item:a},{isMeTATempAuthDeprecationEnabled:e}),g=(0,j.b)(b)||!1;if(f||g)return{canConvert:!0,canRenderNative:g,conversionUrl:f&&f.replace("/bxf?","/glb?")}}({pageContext:b,itemFromServer:c,extension:_,microServiceDataSource:f,isMeTATempAuthDeprecationEnabled:G});ag&&(X.model3d=ag);let ah=Z&&H.a.hasPermission(Z,H.a.openItems),ai=b.blockDownloadsExperienceEnabled||b.viewOnlyExperienceEnabled,aj=(0,J._c)()&&G?{isMeTATempAuthDeprecationEnabled:!0}:void 0,ak=Q({itemFromServer:c,extension:_,mediaServiceFastMetadata:ad,blockDownload:ai||!ah,microServiceDataSource:f,pdfConversionOptions:aj});ak&&(X.pdfConversion=ak);let al=function(a){let{itemFromServer:b,listTemplateType:c,mediaServiceFastMetadata:e,hasPdfConversion:f,has3d:g}=a,h=d.a.Unknown;if(b.folder)h=d.a.Folder;else if("1"===b.FSObjType||b.RemoteItem){let a=b["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"],c=b["File_x0020_Type.mapapp"];h=c&&"onenote"===c.substring(0,7)||a&&-1!==a.indexOf("onenote")?d.a.OneNote:d.a.Folder}if(h===d.a.Unknown){let a=b.File_x0020_Type,i=a?`.${a}`:"";if(a&&z.a.isShortcutFileType(a))return d.a.Shortcut;if("pdf"===a||f||g||"audio"===(0,r.b)(i)||e)return d.a.Media;if((h=(0,r.d)(i))===d.a.Unknown)return void 0!==c&&(0,n.d)(c)?d.a.File:c===m.a.promotedLinks?d.a.Media:h}return h||d.a.File}({itemFromServer:c,mediaServiceFastMetadata:ad,listTemplateType:L,hasPdfConversion:!!Q({itemFromServer:c,extension:_,mediaServiceFastMetadata:ad,blockDownload:!0,microServiceDataSource:f,pdfConversionOptions:aj}),has3d:!!ag});if((((0,J.Cc)()?v(_):(0,t.a)(_))||".ai"===_||".eps"===_||".psd"===_)&&f.getThumbnail({fileExtension:_,item:c,itemKey:V||"",mediaServiceMetadata:ad},af)&&(al=d.a.Media),g.b(_))X.htmlConversion={};else if(g.a(_)){let a=f.getHtmlConversionUrl({fileExtension:_,item:c,mediaServiceMetadata:ad},af);a&&(al=d.a.Media,X.htmlConversion={url:`${a}&inlineImages=true`})}if(".zip"===_||".rar"===_){let a=f.getZipMetaDataUrl({fileExtension:_,item:c,mediaServiceMetadata:ad},af),b=f.getDownloadZipContentsUrl(c);a&&b&&(al=d.a.Media,X.zip={zipMetaDataUrl:a,downloadZipContentsUrl:b})}let am=ad&&ad.video,an=".ts"===_&&void 0!==aa&&aa<524288&&!am;an&&(al=d.a.File);let ao={},ap=f.getDownloadAsZipUrl(c),aq=f.getImmersiveReaderUrl({fileExtension:_,item:c}),ar=i.getKeyParams(V),as=h.getUrlParts({path:c.id||c.FileRef||c.ServerRelativeUrl,listUrl:ar[F.a.listUrlKey]}),at=as.fullItemUrl,au=at?x.a(at):void 0;ap&&(ao[k.b.downloadAsZip]=ap),aq&&(ao[k.b.immersiveReaderUrl]=aq),W&&(ao[k.b.itemUrl]=W);let av=c["serverurl.progid"];(av=av?av.substring(1):L===m.a.links?c.URL:au)&&(ao[k.b.original]=av),z.a.isShortcutItem({key:V||"",extension:_})&&(al=d.a.Shortcut,X.shortcutInfo={shortcutLinkRewritten:!0},c._ShortcutUrl&&(ao[k.b.shortcutTarget]=c._ShortcutUrl),c._ShortcutUniqueId&&(a=S({siteId:c._ShortcutSiteId,webId:c._ShortcutWebId,docId:c._ShortcutUniqueId,webUrl:b.webAbsoluteUrl,layoutsUrl:b.layoutsUrl}))),av&&(ao[k.b.open]=av);let aw=c["File_x0020_Type.mapapp"];!aw&&(aw=c["HTML_x0020_File_x0020_Type.File_x0020_Type.mapall"])&&(aw=aw.split("|").slice(-1).join()),X.appMap=aw,a||(a=function(a){if(a.type===d.a.Folder)return;let{itemFromServer:b}=a;if(void 0!==a.listTemplateType&&(0,n.e)(a.listTemplateType))return{url:b.BackgroundImageLocation||"",width:0,height:0};let c=a.microServiceDataSource.getThumbnail({fileExtension:a.extension,allowCookieAuth:a.listTemplateType===m.a.mySiteDocumentLibrary,itemKey:a.key,item:b,mediaServiceMetadata:a.mediaServiceFastMetadata},{isMeTATempAuthDeprecationEnabled:a.isMeTATempAuthDeprecationEnabled});if(c)return c;let{pageContext:e,currentPageContext:f}=a;if(((0,J.Cc)()?v(a.extension):(0,t.a)(a.extension))&&e){let{siteId:a,webId:c,webAbsoluteUrl:d,layoutsUrl:g}=e;return S({siteId:M&&f?.siteId||a,webId:M&&f?.webId||c,docId:b.UniqueId,webUrl:d,layoutsUrl:g})}}({itemFromServer:c,listTemplateType:L,extension:_,key:V||"",type:al,mediaServiceFastMetadata:ad,microServiceDataSource:f,pageContext:b,currentPageContext:D,isMeTATempAuthDeprecationEnabled:G})),X.openUrl=av,X.downloadUrl=c[".downloadUrl"]||void 0,X.downloadUrlNoAuth=c[".downloadUrlNoAuth"]||void 0,X.itemGeneratedTimeStamp=Date.now();let ax=c["IconOverlay.mapoly"];if(ax&&(X.overlayUrl="/"+b.layoutsUrl+"/images/"+ax),a&&(X.thumbnail=a),al===d.a.Folder){X.childCount=function(a){let{FolderChildCount:b,ItemChildCount:c,RemoteItem:d}=a;if(d)return JSON.parse(d).FolderChildCount;let e=c?parseInt(c,10):NaN,f=b?parseInt(b,10):NaN;if(!(isNaN(e)&&isNaN(f)))return isNaN(e)?f:isNaN(f)?e:e+f}(c);let a=Number(c.SMTotalFileCount);X.folder={totalCount:a>0?a:X.childCount,childCount:X.childCount}}let ay=c.ServerRedirectedEmbedUrl;ay&&!h.getUrlParts({path:ay}).isCrossDomain&&(X.previewIFrameUrl=ay),X.type=al;let{ID:az,UniqueId:aA}=c,aB={};for(let a in aB.uniqueId=(0,o.YR)(aA),aB.ID=az,(0,J.ub)()&&(aB.siteId=(0,o.YR)(D?.siteId),aB.webId=(0,o.YR)(D?.webId),aB.listId=(0,o.YR)(D?.listId)),c)c.hasOwnProperty(a)&&(aB[a]=c[a]);X.properties=aB;let aC="ms-excel"===aw,aD="ms-powerpoint"===aw,aE="ms-visio"===aw,aF="ms-word"===aw,aG=!0;if((0,J.Pc)()&&_){let a=B.b[_.replace(/^\./,"")];aG=!!a&&(a===B.f||a===B.c||a===B.d||a===B.e)}if(av&&(aF||aC||aD||aE)&&aG){let a=function(a){let b,c,d,{isWord:e,extension:f,itemUrlParts:g,isPowerPoint:h,itemFromServer:i,microServiceDataSource:j,mediaServiceFastMetadata:k}=a;if(g.isCrossDomain)return;let l=(e||h?j.getOfficeBundleGenerateUrl({fileExtension:f,item:i,mediaServiceMetadata:k}):"")||"",m=j.getOfficeBundleGetFragmentUrl({fileExtension:f,item:i,mediaServiceMetadata:k})||"",n=!1,o="",p=i[".ctag"],q=k&&k.officeBundle;return q&&(b=q.ctag,d=q.version,n=q.fatalError||!1,q.generationTime&&(c=new Date(q.generationTime)),o=q.errorInfo||""),{officeBundleGenerateUrl:l,officeBundleGetFragmentUrl:m,bundleCTag:b||"",bundleVersion:d||"",hasBundleGenerationFailed:n,bundleErrorInfo:o,generationTime:c,cTag:p||"",enableDefaultClick:e||h}}({isWord:aF,extension:_,itemUrlParts:as,isPowerPoint:aD,itemFromServer:c,microServiceDataSource:f,mediaServiceFastMetadata:ad});if(a&&!aE&&(X.officeBundle=a),a&&(aF||aD)){let a=f.getPdfConversionUrl({fileExtension:_,item:c,mediaServiceMetadata:ad},!0,aj);a&&(ao[k.b.viewInBrowser]=a)}X.wopiFrameUrl=av}let aH=f.getVideoUrl({fileExtension:_,item:c,mediaServiceMetadata:ad});aH&&(ao[k.b.video]=aH);let aI=f.getMediaBaseUrl({fileExtension:_,item:c,mediaServiceMetadata:ad});aI&&(ao[k.b.mediaBaseUrl]=aI);let aJ=f.getThumbnailSpriteBaseUrl({fileExtension:_,item:c});aJ&&(ao[k.b.thumbnailSpriteBaseUrl]=aJ),X.urls=ao;let aK=N.indexOf(_)>=0;if(al===d.a.Folder)X.isDocSet=e=!!c.ProgId&&"sharepoint.documentset"===c.ProgId.toLowerCase();else if((al===d.a.Media||ad)&&!(void 0!==L&&(0,n.e)(L))){let a=r.b(_),b=ad&&ad.photo||(aK||"photo"===a?{}:void 0),d=am||("video"===a?{}:void 0),e=ad&&ad.audio||("audio"===a?{}:void 0);b&&(p={originalUrl:"photo"===a?au:void 0,width:b.width||0,height:b.height||0},Y&&Y.itemId&&(q=function({itemFromServer:a,mediaServiceFastMetadata:b,photoMetadata:c,fullMediaServiceMetadata:d}){let e,f=b&&b.panorama,g=!1;if(f&&"equirectangular"===f.projectionType?(e={projectionType:f.projectionType},g=!0):a.FileLeafRef&&-1!==a.FileLeafRef.indexOf(".360")?e={projectionType:"equirectangular"}:void 0!==c.width&&c.width>0&&void 0!==c.height&&c.height>0&&c.width/c.height==2&&(g=!0),g&&d){let a=d.panorama;if(a)e={projectionType:f&&f.projectionType||void 0,croppedAreaImageHeightPixels:a.croppedAreaImageHeightPixels||void 0,croppedAreaImageWidthPixels:a.croppedAreaImageWidthPixels||void 0,croppedAreaLeftPixels:a.croppedAreaLeftPixels||void 0,croppedAreaTopPixels:a.croppedAreaTopPixels||void 0,fullPanoHeightPixels:a.fullPanoHeightPixels||void 0,fullPanoWidthPixels:a.fullPanoWidthPixels||void 0,initialHorizontalFOVDegrees:a.initialHorizontalFOVDegrees||void 0,initialVerticalFOVDegrees:a.initialVerticalFOVDegrees||void 0,initialViewHeadingDegrees:a.initialViewHeadingDegrees||void 0,initialViewPitchDegrees:a.initialViewPitchDegrees||void 0,initialViewRollDegrees:a.initialViewRollDegrees||void 0,poseHeadingDegrees:a.poseHeadingDegrees||void 0,posePitchDegrees:a.posePitchDegrees||void 0,poseRollDegrees:a.poseRollDegrees||void 0};else{let a=d.photo;a&&a.cameraModel&&["gopro fusion 360","kodak pixpro - 360","ricoh theta","ricoh theta s","ricoh theta sc","ricoh theta v"].indexOf(a.cameraModel.toLowerCase())>=0&&(e={projectionType:"equirectangular"})}}return e}({itemFromServer:c,mediaServiceFastMetadata:ad,photoMetadata:b,fullMediaServiceMetadata:ae}))),X.media={mediaEdits:c.Edits?JSON.parse(c.Edits):void 0,previewThumbnailsQualitySets:!o.Ov.isActivated("96f75f66-17fb-4071-9322-86e0db732994","07/04/2024","Get preview thumbnails information from RLDAS infromation for Seek bar thumbnails.")&&c.PreviewThumbnailsQualitySets?JSON.parse(c.PreviewThumbnailsQualitySets):void 0};let f=ad&&ad.media;if(d){let a=o.Ov.isActivated("f0fc3265-1fce-4d4a-b67a-3b3dfa291a6f","09/27/2023","Get PremiumProcessingStatus from RLDAS for Premium Video in 1P 1.0")?void 0:d.premiumProcessingStatus;u={fourCC:d.fourCC||(".mp4"===_.toLowerCase()?"H264":void 0),bitrate:d.encodingBitrate,width:d.frameWidth||0,height:d.frameHeight||0,duration:T(f&&f.duration),audioFormat:e&&e.format,manifestMetadata:d.manifestMetadata,altManifestMetadata:d.altManifestMetadata,premiumProcessingStatus:a}}e&&(E={duration:T(f&&f.duration)})}else al===d.a.File&&C&&void 0!==C.isDocLib&&!C.isDocLib&&(P={});X.photo=p,X.image360=q,X.video=u,X.audio=E;let aL=!b||"21"===b.webTemplate&&700===b.listBaseTemplate;X.sharingType=U=Number(c.PrincipalCount)>0?w.a.Shared:void 0===c.PrincipalCount?aL?void 0:w.a.Unknown:w.a.Private,X.iconName=r.c({extension:_,isDocSet:e,listItem:P,sharingType:U,type:al,textEditorMimeType:an?"text/typescript":void 0,panorama:q,isMountPoint:!!c.RemoteItem}),X.isPlaceholder=!X.displayName&&!X.permissions,(0,J.Uc)()&&(X.iconColor=c._ColorHex);let aM={isMalwareDetected:(0,I.a)(c),isNew:(0,I.b)(c)};if(aM&&(X.lifeCycleStatus=aM),(0,K.a)()&&c[".mainLinkInfo"])try{X.mainLinkInfo=JSON.parse(c[".mainLinkInfo"])}catch(a){}}return X}({pageContext:a,oneUpUrlDataSource:b,microServiceDataSource:c,navigation:e,itemUrlHelper:f,isMeTATempAuthDeprecationEnabled:h,...i})},processOneUpListRootItem:function(g){return function(a){let{pageContext:b,oneUpListInfo:c,itemUrlHelper:e,oneUpUrlDataSource:f,spItemIdentity:g,navigation:h}=a,{key:i,id:j}=P({pageContext:b,spItemIdentity:g,oneUpUrlDataSource:f,navigation:h,itemUrlHelper:e}),k={key:i||"",id:j},{mediaTransform:l,list:m,permissions:n}=c,{sessionToken:o,sessionTokenV21:p,driveId:q}=U(l);return k.itemId=k.itemId||"root",k.graph={itemId:"root",driveId:q||"",sessionToken:o,sessionTokenV21:p},k.name=k.name||m.title,k.displayName=k.displayName||m.title,k.type=d.a.Folder,k.isRootFolder=!0,k.folder={},k.list=m,k.permissions=n,k}({pageContext:a,oneUpUrlDataSource:b,microServiceDataSource:c,navigation:e,itemUrlHelper:f,isMeTATempAuthDeprecationEnabled:h,...g})}}})}})}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>f});var d=c("odsp.util_126"),e=c(156);let f=new d.v7({name:"oneUpUrlDataSource",factory:new d.FF(e.a)})}
,,(a,b,c)=>{"use strict";c.d(b,{a:()=>d});let d="remoteItem"}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>d});let d="parent"}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>d,b:()=>e});let d="parentview",e="view"}
,,,,,,,,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>j});var d=c("odsp.util_126"),e=c(229),f=c(4),g=c(2);let h={ODB:61356},i={isFavoritesEnabled:e.a,pageContext:g.a},j=new d.v7({name:"isFavoritesEnabledInOneUp",factory:{dependencies:i,create:a=>({instance:a.isFavoritesEnabled()&&(0,f.$b)(h)})}})}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>e});var d=c("odsp.util_126");let e=new d.v7({name:"UniversalPrintDataSourceAsync.key",loader:new d.dE(()=>c.e(84).then(c.bind(c,793)).then(a=>a.universalPrintDataSourceKey))})}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>r});var d,e,f,g,h=c("odsp.util_126"),i=c(82),j=c(2),k=c(283),l=c(40),m=c(20),n=c(22),o=c(57),p=c(4);(d=f||(f={})).legacy="legacy",d.phase1="react",d.phase2="newDesign",(e=g||(g={})).carousel="carousel",e.fast="fast",e.embed="embed";let q={isFastOneUp:i.j.optional,pageContext:j.a,navigation:m.a,platformDetection:o.a.optional},r=new h.v7({name:"OneUpEngagementContextKey",factory:{dependencies:q,create:a=>{let{pageContext:b,isFastOneUp:c}=a;return{instance:{previewContext:c?"fast":"carousel",webTemplate:b?(0,l.c)(Number(b.webTemplate)):"unknown",clientId:b?(0,k.a)(b):void 0,isSyntexEnabled:b?b.isSyntexEnabled:"unknown",oneUpPhase:"newDesign",isSyncAutoAction:(0,p.vb)()?a.navigation.viewParams[n.b.openedFrom]?.toLowerCase()==="sync":!!a.navigation.viewParams[n.b.action],isMobile:!!a.platformDetection?.isMobile}}}}})}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>g});var d=c(40),e=c("odsp.util_126"),f=c(61);function g(a){let b,c=a?.authToken||"",g=(0,f.b)(c);if(g&&g.app_displayname)b=g.app_displayname;else{let c,f,g,h;c=window,f=(0,e.pW)((c.location.search||"").slice(1)),g=(0,e.pW)((c.location.hash||"").slice(1)),h=c.PageContext?.scenarioContext.embed||{},b=({...f,...g,...h}).client_id||(Number(a.webTemplate)===d.b.mySite?"ODB":"SPList")}return b}}
,,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>d});let d=c("odsp.util_126").Ov.isActivated("fb3bead2-a0ae-4f8b-a7f4-c777ae0a7a93")}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>e});var d=c("odsp.util_126");let e=new d.v7({name:"OneUpAuthTokenHelperAsync.key",loader:new d.dE(()=>c.e(50).then(c.bind(c,794)).then(a=>a.authTokenHelperResourceKey))})}
,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>e,b:()=>v});var d,e,f=c(0),g=c("odsp.util_126"),h=c(35),i=c(107),j=c(168),k=c(82),l=c(2),m=c(165),n=c(169),o=c(15),p=c(300),q=c(118),r=c(4),s=c(301);let t=g.Ov.isActivated("4991B354-419D-471B-9ABD-2B20890E4E0C");(d=e||(e={})).next="next",d.previous="previous",d.close="close";let u={getValidViewerTypes:j.c,isFastOneUp:k.j.optional,pageContext:l.a,itemUrlHelper:o.c},v=new g.v7({name:"OneUpLoadingCustomerPromiseFunctionsKey",factory:{dependencies:u,create:a=>{let b,c,d=a.pageContext,e=(0,m.b)(d)?.toLowerCase()||"unknown",k="View";return{instance:{newLoadingCustomerPromise:function(d,f){let g=f;!t&&f&&(g={...f},delete g.item),void 0===c&&(b=d,c=new n.a({scenario:"OneUpLightSpeed.load",perfGoalInMs:i.c,pillar:k,extraData:{oneUpRenderingMode:a.isFastOneUp?i.e.fastOneUp:i.e.inlineOneUpFirstPage,viewerName:a.getValidViewerTypes.getValidViewerTypes(d),fileExtension:d.extension,fileSize:d.size,fileSizeRange:(0,i.g)(d.size),Ring:e,isCrossList:a.itemUrlHelper.getItemUrlParts(b.key).isCrossList,...g}}))},reportLoadingCXPSuccess:function(d){c?.end({resultType:f.b.Success,extraData:{...d.extraData,navigationOption:d.navExtraData?.navigationOption,isCrossList:a.itemUrlHelper.getItemUrlParts(b.key).isCrossList}}),c=void 0,d.navExtraData&&d.navExtraData.newItem&&("previous"===d.navExtraData.navigationOption||"next"===d.navExtraData.navigationOption)&&(b=d.navExtraData.newItem,c=new n.a({scenario:"OneUpLightSpeed.load",perfGoalInMs:i.c,pillar:k,extraData:{oneUpRenderingMode:i.e.inlineOneUpSlide,viewerName:a.getValidViewerTypes.getValidViewerTypes(d.navExtraData.newItem),fileExtension:d.navExtraData.newItem.extension,fileSize:d.navExtraData.newItem.size,fileSizeRange:(0,i.g)(d.navExtraData.newItem.size),Ring:e,isNavigating:!0,navigationOptions:d.navExtraData.navigationOption,navNewItemUniqueId:d.navExtraData.newItem?.properties?.uniqueId,isCrossList:a.itemUrlHelper.getItemUrlParts(b.key).isCrossList}}))},reportLoadingCXPFailure:function(e){let i,k,l,m,n,o,{errorType:t,error:u,item:v,meTAEvent:w}=e.rawError;if(u instanceof g.lM||u instanceof g.lM){var x;k="string"==typeof(x=(i=(0,h.a)(u)).resultCode||"Unknown")?x.split(",").join("_"):JSON.stringify(x),l=i.resultType,m=u.correlationId,n={...e.rawError.extraData,...u.extraData}}else k=u.message,l=f.b.Failure,n={...e.rawError.extraData};let y=d.cloudType?.toLowerCase()==="spdf",z={viewerName:v&&a.getValidViewerTypes.getValidViewerTypes(v)||j.a.Unknown,extension:v&&v.extension||"Unknown",errorType:t,rawError:u,isPPE:y,...i?.extraData,CorrelationId:m||d?.CorrelationId,isCrossList:a.itemUrlHelper.getItemUrlParts(b.key).isCrossList,...(0,q.a)(e.rawError.extraData?.url),noTempAuth:e.rawError.extraData?.noTempAuth,...n};if((0,r.Lb)()){let a=(0,s.a)(z);o={...z,diagnosticInfo:a}}else o=z;c?.end({resultType:l,errorCode:k,extraData:o}),c=void 0,w&&(0,p.b)(w,{resultType:l,errorCode:k,extraData:o})}}}}}})}
,(a,b,c)=>{"use strict";let d;function e(){return"boolean"!=typeof d&&(d="srcdoc"in document.createElement("iframe")),d}c.d(b,{a:()=>e})}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>d,b:()=>e});let d=a=>{if(!a)return!1;let b=window.Flight?.ecsConfig&&JSON.parse(window.Flight?.ecsConfig),c=b?.RolloutContext?.settings?.ODSPMicroservices_ODWeb;return c&&!0===c[a]},e=a=>d(a)}
,(a,b,c)=>{"use strict";function d(a){let b=a=>{try{let c=new URL(a.toLowerCase()).searchParams,d=c.get("tempauth"),e=c.get("access_token"),f=c.get("docid");if(d&&"false"!==d||e&&"false"!==e)return!0;if(f)return b(decodeURI(f));return!1}catch(a){return}};return b(a)}c.d(b,{a:()=>d})}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>o});var d=c("odsp.util_126"),e=c(10),f=c(15),g=c(113),h=c(2),i=c(556),j=c(76);let k=(0,d.hl)("PreAuthServiceKey",i.a,{dataRequestor:j.a});var l=c(46),m=c(4);let n={oneUpStateStore:e.f,graphDataSource:g.a,itemUrlHelper:f.c,preAuthService:k,identityDataSource:l.resourceKey,pageContext:h.a},o=new d.v7({name:"FileHandlerHelper",factory:{dependencies:n,create:a=>({instance:{hasFileHandler:function(b){let c=a.oneUpStateStore.getFileHandlerOptions();if(c){let a=c?.data.actions.preview,d=b.extension;for(let b=0;b<a.length;b++){let c=a[b].availableOn.file,e=c&&c.extensions||void 0;if(c&&d){let a="."!==d.charAt(0)?"."+d:d;if(!(0,m.Xb)())return!e||-1!==e.indexOf(a.toLowerCase())||-1!==e.indexOf("*");if(e&&e.indexOf(a.toLowerCase())>-1)return!0}}}return!1},getCorrespondingPreviewFileHandlerPostData:async function(b){let c=a.oneUpStateStore.getFileHandlerOptions();if(c){let a=c?.data.actions.preview,d=b.extension;for(let c=0;c<a.length;c++){let e=a[c].availableOn.file,f=e&&e.extensions||void 0;if(e&&d){let e="."!==d.charAt(0)?"."+d:d;if(!f||-1!==f.indexOf(e.toLowerCase())||-1!==f.indexOf("*")||-1!==f.indexOf(".*"))try{let d=await this.getFileHandlerItemUrl(b,a[c],!!a[c].handler.isPromoted);if(d&&d.length>0)return{...a[c],itemUrls:d};throw Error("failed to get fileHandler item url")}catch(a){throw Error(a)}}}}return Promise.resolve(void 0)},getFileHandlerItemUrl:async function(b,c,d){if(d)return Promise.resolve([a.graphDataSource.getItemUrl(b,{useDirectEndpoint:!1})]);{let d=a.itemUrlHelper.getItemUrlParts(b.key).fullItemUrl,e=a.itemUrlHelper.getItemUrlParts(b.key).fullWebUrl;if(d&&e){let f=await a.identityDataSource.getSharePointToken({webAbsoluteUrl:e,apiQosName:"FileHandlerHelper.getFileHandlerItemUrl"});return await a.preAuthService.getPreAuthUrls({driveUrl:(0,m.ec)()?b.graph?.sessionToken?.tokenUrl:void 0,appId:c.handler.appId,items:[d],accessToken:f})}throw Error("no item full url / item webAbsolute Url")}}}})}})}
,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>e});var d=c(30);function e(){return window.ONEUPTELEMETRY_MANAGER=window.ONEUPTELEMETRY_MANAGER||(0,d.b)({sourceName:"OneUp"})}}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>f,b:()=>h,c:()=>g});var d=c(75),e=c(169);function f(a,b){return new e.a({scenario:"OneUpLightSpeed.MeTA",extraData:{viewerName:a,...b}})}function g(a,b){a?.end({resultType:d.c.Success,extraData:b})}function h(a,b,c){if(b)a?.end(b);else if(c){let b;"code"in c&&(b=c);let e=b?.isExpected?d.c.ExpectedFailure:d.c.Failure,f=b?.code||c.name||c.message,g=b?.extraData||{rawError:c};a?.end({resultType:e,errorCode:f,extraData:g})}}}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>function a(b){if("object"==typeof b&&b){for(let c of Object.keys(b))b[c]=a(b[c]);return b}return"string"==typeof b&&b.match(/https?:\/\//)?"DATA_Sanitized":b}})}
,,(a,b,c)=>{"use strict";c.d(b,{a:()=>i});var d=c("odsp.util_126"),e=c(113),f=c(17),g=c(162);let h={resources:d.m3,oneUpStore:f.b,graphDataSource:e.a,isMeTATempAuthDeprecationEnabled:g.a},i=new d.v7({name:"GetMeTAHeader.key",factory:{dependencies:h,create:({resources:a,oneUpStore:b,graphDataSource:c,isMeTATempAuthDeprecationEnabled:d})=>({instance:async function(e){if(d){let d=b.getOneUpProperties();if(d?.focusItem){let b,f=await c.getMetaPac(a,d.focusItem,e);return f.metaPac&&(b={"X-SPOPacToken":f.metaPac}),b}}}})}})}
,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>p});var d=c(111),e=c(562),f=c(31),g=c("odsp.util_126"),h=c(76),i=c(2),j=c(4);let k="universalannotations",l="$batch",m="multipart/mixed;boundary=",n="application/json";class o{update(a,b,c){this._getSharePointToken=a,this._basePath=`/drives/${c}/items/${b}`,this._layerPath=`${this._basePath}/annotationlayers`}createLayer({title:a,mainFileVersion:b="1.0",layerId:c}){let d=this._layerPath;return this._sendRequest({path:d,requestType:"POST",data:{title:a,mainFileVersion:b,id:c}})}deleteLayer({layerId:a}){let b=`${this._layerPath}/${a}`;return this._sendRequest({path:b,requestType:"DELETE"})}getLayers(){let a=this._layerPath;return this._sendRequest({path:a,requestType:"GET"})}createAnnotation({annotationId:a,layerId:b,content:c,partitionId:d,anchor:e,contentType:f}){let g=this._getAnnotationUrl(b);return this._sendRequest({path:g,requestType:"POST",data:{id:a,content:c,partitionId:d,anchor:e,contentType:f}})}getAnnotations({layerId:a,partitionId:b}){let c=this._getAnnotationUrl(a);return b&&(c+=`?partitionId=${b}`),this._sendRequest({path:c,requestType:"GET"})}deleteAnnotation({layerId:a,partitionId:b,annotationId:c}){let d=`${this._getAnnotationUrl(a)}/${c}?partitionId=${b}`;return this._sendRequest({path:d,requestType:"DELETE"})}async batchCreateAnnotations({payload:a}){let b="batch_"+f.a.generate(),c=this._createBatchBody(b,a.map(({id:a,layerId:b,annotationId:c,...d})=>({path:`${this._basePath}/AnnotationLayers('${b}')/${k}`,requestType:"POST",id:a,data:{id:c,...d}})));return this._sendRequest({path:`/${l}`,requestType:"POST",headers:{"Content-Type":m+b},data:c})}async batchDeleteAnnotations({payload:a}){let b="batch_"+f.a.generate(),c=this._createBatchBody(b,a.map(({id:a,annotationId:b,layerId:c,partitionId:d})=>({path:`${this._getAnnotationUrl(c)}/${b}?partitionId=${d}`,requestType:"DELETE",id:a})));return this._sendRequest({path:`/${l}`,requestType:"POST",headers:{"Content-Type":m+b},data:c})}get hasLicense(){return(0,j.$b)(j.ab)?!!this._pageContext.canUserUseSyntex||!!this._pageContext.isUserSyntexV2Licensed:!!this._pageContext.canUserUseSyntex}get isUniversalAnnotationDisabled(){return this._pageContext.isUniversalAnnotationDisabled??!1}get _server(){return(0,d.b)(this._pageContext)}_needRefreshToken(){return!this._token||!this._token.tokenExpiry||Date.now()>=this._token.tokenExpiry}async _getToken(){if(this._needRefreshToken()&&this._getSharePointToken){let a=await this._getSharePointToken(this._server);this._token=a}return this._token||void 0}_getAnnotationUrl(a){return`${this._layerPath}/${a}/${k}`}_createBatchBody(a,b){let c=`changeset_${f.a.generate()}`;return new Blob([(0,e.b)(a,`${m}"${c}"`,"binary")+b.map(a=>{let b;return b="--"+c+"\r\nContent-Type: application/http\r\nContent-Transfer-Encoding: binary\r\nContent-ID: "+a.id+"\r\n\r\n"+(0,e.a)(n,`${n};odata=verbose`,a.requestType,a.path)+"\r\n",a.data&&(b+=JSON.stringify(a.data)+"\r\n\r\n"),b}).join("")+"--"+c+"--\r\n\r\n--"+a+"--\r\n"])}async _sendRequest(a){let b=await this._getToken(),{data:c,path:d,requestType:e,headers:f}=a,g=c?c instanceof Blob?c:JSON.stringify(c):void 0;return this._dataRequestor.send({path:d,endpoint:`${this._server}/_api/v2.1`,headers:{Scenario:"Syntex_UniversalAnnotaion",...f},requestType:e,accessToken:b,apiName:"UniversalAnnotationAPI",apiVersion:"v2.1",postData:g,expectedErrorCodes:{resourceModified:!0}})}constructor(a,b){this._token=null,this._layerPath="";const{vroomDataRequestor:c,pageContext:d}=b;this._dataRequestor=c,this._pageContext=d}}o.dependencies={vroomDataRequestor:h.a,pageContext:i.a};let p=(0,g.hl)("UniversalAnnotationDataSource",o)}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>e,b:()=>q,c:()=>f,d:()=>r,e:()=>t,f:()=>s,g:()=>v,h:()=>u});var d,e,f,g=c(435),h=c(59),i=c(22),j=c(155),k=c(171),l=c("odsp.util_126"),m=c(412),n=c(50),o=c(115);class p extends Error{constructor(a,b){super(b),this.name="NetworkError",this.status=a}}(d=e||(e={}))[d.UnableFurtherCompression=13]="UnableFurtherCompression";class q extends Error{constructor(a,b){super(a),this.name="ManipulationError",this.code=b}}(f||(f={})).ExceedsMaximumLength="ExceedsMaximumLength";class r extends Error{constructor(a,b,c){super(b),Object.setPrototypeOf(this,r.prototype),this.name="UploadError",this.type=a,this.url=c||""}}async function s(a,b){if(!b)throw Error("Invalid url");let c=await fetch(b,a);if(!c.ok)throw new p(c.status,`Fail to fetch file, url=${b}`);return c.arrayBuffer()}async function t(a,b){return Promise.all(a.map(a=>s(b,a)))}function u(a,b){let c=`${b.webUrl}/${a}.pdf`;if(c.length>=400)throw new r("ExceedsMaximumLength",l.rz(k.w,c.length),c)}async function v(a,b,d,e){if(!e?.webUrl)return Promise.reject("");let{SharePointUploader:f}=await c.e(74).then(c.bind(c,766)),k={name:a.name,size:a.size,slice:(b,c)=>a},l=decodeURI(new URL(e.webUrl).pathname),p=decodeURI(e["@sharePoint.listUrl"]||""),q=d.getKey({[i.b.idParamKey]:l,[i.b.listUrlKey]:p}),r=new n.a({},{pageContext:b}),s=new o.a({},{pageContext:b,itemUrlHelper:r}),t=r.getItemUrlParts(q),u=new f({webApiUrl:s.build().webByItemUrl(t),fileUpload:k,throttler:new g.a({maxParallelUploads:1}),canStream:!0,dataRequestor:new h.b({},{pageContext:b,noRedirect:!0}),destinationUrl:t.serverRelativeItemUrl||"",nameConflictBehavior:m.a.rename,appName:"ODB OneUp viewer",onStart:()=>{},onAbort:()=>{},onProgress:a=>{}}),v=await u.upload(),w=d.getKey({[i.b.idParamKey]:v.ServerRelativeUrl}),x=p&&t.isCrossList,y=d.getKey({[i.b.idParamKey]:l,...x?{[i.b.listUrlKey]:p}:{}}),z={key:w||"",id:v.ServerRelativeUrl,type:j.a.File},A={key:y||"",id:t.serverRelativeItemUrl,type:j.a.Folder};return Promise.resolve(d.getDefaultClickUrlForOneUp(z,{parentItem:A,urlType:"focus"}))}}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>j,b:()=>i,c:()=>h,d:()=>g,e:()=>k});var d=c("tslib_533"),e=c(463),f=c(64),g=function(a){this.type="Qos",this.payload=(0,d.q5)((0,d.q5)({privacyClassification:"RequiredService"},a),{id:(0,e.a)(),status:f.b.Start,startTime:performance.now()})},h=function(a,b,c,e){this.type="Qos",this.payload=(0,d.q5)((0,d.q5)({privacyClassification:"RequiredService"},e),{id:a,name:b,status:c,endTime:performance.now()})},i=function(a){this.type="Engagement",this.payload=(0,d.q5)({privacyClassification:"OptionalDiagnostic"},a)},j=function(a){this.type="CaughtError",this.payload=(0,d.q5)({privacyClassification:"RequiredService"},a)},k=function(a){this.type="Verbose",this.payload=(0,d.q5)({privacyClassification:"OptionalDiagnostic"},a)}}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>d});var d=function(){return"rtl"===(document.body&&document.body.getAttribute("dir")||document.documentElement.getAttribute("dir"))}}
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>e,b:()=>f});var d=c(65);function e(a){try{var b=new URL(a).toString().match(/\/([^\/?#]+)[^\/]*$/);return b&&b.length>1?b[1]:""}catch(b){return d.a.warn("UrlHelper",'Given url "'.concat(a,'" is invalid')),""}}function f(a){a.startsWith("www.")&&(a="https://".concat(a));try{switch(new URL(a).protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}catch(a){return!1}}}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>e});var d=c("tslib_533");(0,c("fui.util_178").ZW)([{rawString:".screenReader_6d70c630{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0, 0, 0, 0);border:0}"}]);var e=function(){function a(){}return a.read=function(a,b){if(""!==a)for(var c=[a],d=this._getLiveNodes(c.length,b||0),e=function(a){window.setTimeout(function(){d[a].textContent=c[a]},500*(a+1))},f=0;f<c.length;f++)e(f)},a.clear=function(){var a,b;try{for(var c=(0,d.BW)(this._liveNodes),e=c.next();!e.done;e=c.next()){var f=e.value;document.body.removeChild(f)}}catch(b){a={error:b}}finally{try{e&&!e.done&&(b=c.return)&&b.call(c)}finally{if(a)throw a.error}}this._liveNodes=[]},a._getLiveNodes=function(a,b){this.clear();for(var c=[],d=0;d<a;d++){var e=document.createElement("div");switch(c.push(e),document.body.appendChild(e),e.classList.add("screenReader_6d70c630"),e.setAttribute("data-tabster-never-hide",""),b){case 0:e.setAttribute("aria-live","polite");break;case 1:e.setAttribute("role","alert"),e.setAttribute("aria-live","assertive")}}return this._liveNodes=c,c},a._liveNodes=[],a}()}
,(a,b,c)=>{"use strict";function d(){if(window.devicePixelRatio)return Math.ceil(window.devicePixelRatio);if(window.matchMedia){for(var a=4;a>1;a=Math.round((a-.1)*10)/10)if(window.matchMedia("(-webkit-min-device-pixel-ratio: ".concat(a,")")).matches||window.matchMedia("(min-resolution: ".concat(a,"dppx)")).matches)return a}return 1}function e(a){return Math.floor(a*d())}c.d(b,{a:()=>d,b:()=>e})}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>f});var d=c(66),e=c(85),f=function(){function a(){this._eventMap={}}return a.prototype.on=function(a,b){this._eventMap[a]||(this._eventMap[a]=[]),this._eventMap[a].push(b)},a.prototype.off=function(a,b){var c,d=this._eventMap[a];!d||(c=d.indexOf(b))<0||d.splice(c,1)},a.prototype.dispatch=function(a){for(var b=[],c=1;c<arguments.length;c++)b[c-1]=arguments[c];this._eventMap[a]&&this._eventMap[a].forEach(function(c){try{c.apply(null,b)}catch(b){var f=new d.c(d.b.EventHandleFailed,"Fail to handle event ".concat(a,", error: ").concat(b));e.a.logError(f.toCaughtError())}})},a.prototype.dispose=function(){var a=this;Object.keys(this._eventMap).forEach(function(b){for(var c=a._eventMap[b],d=c.length;d>=0;d--)a.off(b,c[d])})},a}()}
,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>n});var d=c("odsp.util_126"),e=c(17),f=c(142),g=c(4),h=c(604),i=c(605),j=c(607),k=c(2),l=c(529),m=c(10);let n=new d.v7({name:"canOpenCopilot",factory:{dependencies:{isCopilotEnabled:f.a,appPageContext:k.a,oneUpStore:e.b,oneUpStateStore:m.f},create:a=>({instance:{isCopilotSupportedForItem:function(b){let c=(0,g.$b)(g.h)&&a.isCopilotEnabled(),d=(0,l.a)({oneUpProps:a.oneUpStore.getOneUpProperties(),appPageContext:a.appPageContext,item:b}),e=(0,j.a)({item:b,currentPageContext:d,appPageContext:a.appPageContext});return!!(b.extension&&function(b,c,d,e){let f=d,g=(0,h.c)(h.a),j=(0,i.b)(g,"Media.Meeting"===e),k=a.oneUpStateStore.currentAppState.deletedKeys?.has(b.key);if(j){let a=c.replace(".","");f=f&&!!j.map.get(a)&&!k}else f=!1;return f}(b,b.extension,c,b.properties?.ProgId)&&e)}}})}})}
,,,,,,,,,,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>d,b:()=>e});let d=!c("odsp.util_126").Ov.isActivated("5B8CD4DE-74E3-46DF-9A3E-B28C31F8BA71");function e(a){let{focusItem:b,navigation:c,saveAction:e}=a;return!!d&&!!c.beforeUnload.isHashNavDialogHandlerRegistered?.()&&!!b&&e.evaluateAction({item:b}).isAvailable&&c.beforeUnload.hasActiveBlock()}}
,,,,,,,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>l,b:()=>m,c:()=>j,d:()=>n,e:()=>e,f:()=>k,g:()=>o,h:()=>p});var d,e,f=c("react-lib"),g=c(21),h=c(72),i=c(282);let j="CollabOneUp",k="Viewer",l="Command",m="Component";(d=e||(e={})).success="Success",d.unexpectedFailure="UnexpectedFailure",d.expectedFailure="ExpectedFailure";let n=f.createContext({});function o(a,b){let c=0===a.indexOf(j)?a:`${j}.${a}`,d=b?.engagementContext;b&&b.engagementContext&&(b.engagementContext=void 0);let e={name:c,extraData:{...b,...d}};g.a.logData(e)}function p(){return(0,h.c)().consume(i.a)}}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>e});var d=c("odsp.util_126");let e=new d.v7({name:"showCopilotPaneAsync.key",loader:new d.dE(()=>c.e(9).then(c.bind(c,841)).then(a=>a.showCopilotPaneKey))})}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>e});var d=c(186);let e=a=>{let{palette:b,semanticColors:c}=d.b,e=`${c.buttonBackground} !important`,f=`${c.buttonBackgroundHovered} !important`,g=`${c.buttonBackgroundPressed} !important`;return{root:{...a},rootHovered:{cursor:"pointer",...a,background:f},rootPressed:{background:g},rootExpanded:{backgroundColor:e,...a},rootCheckedHovered:{cursor:"pointer",...a,background:f},rootCheckedPressed:{...a,background:g},rootExpandedHovered:{background:f,cursor:"pointer"},flexContainer:{color:b.black,width:"auto"},icon:{color:b.black}}}}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>f,b:()=>m});var d=c(32),e=c(95);let f=c("odsp.util_126").Ov.isActivated("5EB3A0F2-70A9-4420-BC71-4E623B94CF83"),g=(a,b,c)=>{let e=!0;return b.map(b=>{if(!d.a.hasPermission(a,b)){e=!1;return}}),e},h=[d.a.insertListItems,d.a.editListItems],i=[d.a.reviewListItems],j=[d.a.openItems],k=[d.a.viewListItems],l=[d.a.fullMaskWithoutACP],m=a=>a?!f&&g(a,l,"fullMask")?e.a.owner:g(a,h,"edit")?e.a.edit:g(a,i,"review")?e.a.review:g(a,j,"view")?e.a.view:g(a,k,"restricted")?e.a.restrictedview:e.a.none:e.a.none}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>e});var d=c("odsp.util_126");let e=new d.v7({name:"CommentsPaneActionAsync.key",loader:new d.dE(()=>c.e(5).then(c.bind(c,845)).then(a=>a.commentsPaneActionKey))})}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>h,b:()=>g});var d=c("react-lib"),e=c(17),f=c(72);function g(a,b){let c=(0,f.c)(),g=[];(0,d.useEffect)(function(){let d=c.consume(e.b);for(let c in a)if(a.hasOwnProperty(c)){let e=a[c];e&&g.push(d.subscribe(c,e,b))}return function(){let a;for(;a=g.pop();)a()}},[])}function h(a){let[b,c]=(0,d.useState)();return g({updateOneUpStatus:function(b){if("update"in b.detail&&b.detail.update&&"publisher"in b.detail){let d=b.detail.update;c(a?a(d):d)}}},e.a.oneUpItemCacheUpdate||e.a.oneUpSpartanUpdate),b}}
,,(a,b,c)=>{"use strict";let d;c.d(b,{a:()=>h,b:()=>j,c:()=>k,d:()=>i});var e=c(39),f=c(4),g=c("odsp.util_126");function h(a){let b={aadUserId:a.aadUserId,experimentData:a.experimentData,experimentDataLookup:a.experimentDataLookup,serverTime:a.serverTime,siteId:a.siteId};d=(0,e.b)(90304,b),d?.logExposure()}function i(){return!g.Ov.isActivated("38e570f6-99f2-4061-8d53-4bbfa2e7c692","09/03/2024","RMA dialog KS")&&(!!(0,f.gc)()||!!d&&1===d.variantToDisplay)}function j(a){return 1===(0,e.c)(90278,a)}function k(a){return 1===(0,e.c)(90346,a)}}
,,(a,b,c)=>{"use strict";c.d(b,{a:()=>A,b:()=>B});var d=c("react-lib"),e=c.n(d),f=c(72),g=c("odsp.util_126"),h=c(375),i=c(0),j=c(35),k=c(380),l=c(391),m=c(377),n=c(22),o=c(212),p=c(2),q=c(393),r=c(4),s=c(10),t=c(192),u=c(370),v=c(168),w=c(57);let x=!g.Ov.isActivated("470B097E-0BC7-4D40-9A82-2F57E410A2B6"),y=!g.Ov.isActivated("F49447A1-A51A-4846-A1A7-17C779BF5529"),z=!1;function A(){z=!1}function B(){let a=(0,f.c)(),b=(0,h.a)(a=>a?.focusItem),c=a.consume(p.a),d=a.consume(q.a),A=a.consume(s.f),B=e().useContext(u.d),C=a.consume(w.a);e().useEffect(()=>{let e,f,h,p,q=window.location.search.substring(1),w=(0,g.pW)(q),D="true"===w.openShare,E="true"===w.openRMA,F=w[n.a.action],G=a.consume(t.a);F&&b&&(0,u.g)("CollabOneUp.SyncClientAutoOpen",{commandName:F,extension:b?.extension||"",viewer:v.a.Unknown,engagementContext:B});let H=function(){if(A.rightPaneType!==s.e.none)return!1;if(y?F===o.i||F===o.e||F===o.a||F===o.b||F===o.d||F===o.c||F===o.h||F===o.f||F===o.g:F===o.a||F===o.i||F===o.e)return!0;if((0,r._b)()){let a=b&&G.evaluateAction({item:b}).isAvailable,e=C.isMobile;if(a&&d&&!e){let a=(0,m.b)(c);return A.updateAutoOpenCopilotExperimentEnabled(a),a}}return!1}();if(D&&b?(e=(p=a.consume(k.d).evaluateAction({item:b})).isAvailable,f=p.onExecute,h=Error(`no available action for ${k.d.name}`)):(0,m.d)()&&E&&b?(e=(p=a.consume(l.a).evaluateAction()).isAvailable,f=p.onExecute,h=Error(`no available action for ${l.a.name}`)):b&&H&&(p=G.evaluateAction({item:b}),F?(e=p.isAvailable&&(!z||!x),f=x?a=>{if(!z&&p&&p.onExecute)return z=!0,p.onExecute?.(a)}:p.onExecute):(e=p.isAvailable,f=p.onExecute)),b&&p&&(D||(0,m.d)()&&E||H)){let a=new i.a({name:`OneUpLightSpeed.autoActionExecutorInvoked.${p.id||"unknownAction"}`}),b="Unhandled exception executing an auto action";try{if(e&&f){let c=f({qosEvent:a});c&&c.then(b=>{let c=b||{resultType:i.b.Success};a.end(c)}).catch(c=>{let d=c||Error(b);a.end((0,j.a)(d))})}else a.end((0,j.a)(h))}catch(d){let c=d||Error(b);a.end((0,j.a)(c))}}},[b])}}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>$,b:()=>Z,c:()=>X,d:()=>Y});var d=c("odsp.util_126"),e=c("react-lib"),f=c(681),g=c(120),h=c(62),i=c(50),j=c(46),k=c(42),l=c(381),m=c(31),n=c(669),o=c(672),p=c(678),q=c(4),r=c(74),s=c(61),t=c(0),u=c(17),v=c(388),w=c(143),x=c(679),y=c(680),z=c(2),A=c(6),B=c(468);let C={spHttpDataSourceAsync:new d.v7({name:"sharingSpHttpDataSourceModuleAsyncKey",loader:new d.dE(()=>Promise.all([c.e("ondemand.resx"),c.e(75)]).then(c.bind(c,857)).then(a=>a.resourceKey))}).lazy.async,appPageContext:z.a},D=new d.v7({name:"sharingHostTokenProviderKey",factory:{dependencies:C,create:a=>{let{spHttpDataSourceAsync:b,appPageContext:c}=a;return{instance:{onGetAuthToken(a){let{tokenName:c,getTokenParams:d}=a;return b().then(a=>{if(Object.values(v.a).includes(c)){let b=`SharingHost.onGetAuthToken-${c}`,e=new t.a({name:b});return a.fetchToken({resource:d?.resource||"",apiQosName:b}).then(a=>a?(e.end({resultType:t.b.Success}),a):void e.end({resultType:t.b.Failure})).catch(()=>{e.end({resultType:t.b.Failure})})}return Promise.resolve(void 0)})},onRefreshCookies:a=>(0,B.a)()?b().then(b=>{let d="SharingHost.onRefreshCookies",e=new t.a({name:d});return b.fetchToken({resource:new A.a(a.webAbsoluteUrl||c.webAbsoluteUrl).authority,apiQosName:d}).then(b=>b?a.sharingHostMessenger.sendReloadWithAuthToken(b).then(()=>(e.end({resultType:t.b.Success}),Promise.resolve(!0))):(e.end({resultType:t.b.Failure}),Promise.resolve(!1))).catch(()=>(e.end({resultType:t.b.Failure}),Promise.resolve(!1)))}):Promise.resolve(!1)}}}}});var E=c(209);let F=!d.Ov.isActivated("B0220AEF-CCEA-4D78-8DDA-5A135FA2B266"),G=!d.Ov.isActivated("98CFE6BF-ABFD-4293-A939-2917DF2B9BB9"),H=d.Ov.isActivated("3A6F37FF-6C59-4A8C-A454-D8C73E8F8634"),I=y.a(),J=d.Ov.isActivated("8603512d-f82c-40b8-8005-d2c99e472f05","9/11/2025","ahackett: Check user copilot licensed for share dialog in oneup"),K=(0,g.a)(async()=>(await Promise.all([c.e("ondemand.resx"),c.e(73)]).then(c.bind(c,855))).ShareDialog);function L(a){let b=new d.G7;return a.onRender&&a.onRender(e.createElement(N,{...a,signal:b})),b.promise}function M(a){let b=new i.a({},{pageContext:a.pageContext}).getItemUrlParts(a.item.key),{fullListUrl:c,fullWebUrl:e,serverRelativeItemUrl:f}=b,{isCrossList:g,isCrossDomain:h}=b;g=g||!H&&(0,w.a)(a.pageContext),h=h||!H&&(0,w.a)(a.pageContext);let j=H?e||"":(0,x.a)(e||""),{listurl:k,id:l}=F?{listurl:c,id:f}:(0,d.pW)((0,d.zY)(window.location.href));return{listurl:k,serverRelativeItemUrl:l,webAbsoluteUrl:j,isCrossList:g,isCrossDomain:h,listItemId:a.listItemId,listId:a.listId,uniqueId:a.uniqueId}}function N(a){let b,c=Date.now(),{signal:d}=a,g=e.useMemo(function(){return function(a){let{mode:b,itemName:c,resources:d}=a,{listurl:e,serverRelativeItemUrl:f,webAbsoluteUrl:g,isCrossList:h,isCrossDomain:i,uniqueId:l,listItemId:m,listId:n}=M(a);return()=>{if((0,q.Jb)()?h:i){let a=Date.now(),b=d.consume(j.resourceKey),h=(0,r.k)(r.i);return b.getSharePointToken({webAbsoluteUrl:new k.a(g).authority,apiQosName:"Sharing.getAuthToken",disallowSelfIssuedToken:h}).then(b=>{let d=H?g:(0,x.a)(g),i=b.accessToken,j={authToken:i,webAbsoluteUrl:g,isODB:!0,itemName:c,listUrl:e,serverRelativeItemUrl:f,cookieAuthIframeUrlForCrossDomain:`${d}/_layouts/15/sharedialog.aspx?crossdomain=true&clickTime=${a}`},k=(0,s.b)(i).appid||"",l="08e18876-6177-487e-b8b5-cf950c1e598c"!==k&&"c58637bb-e2e1-4312-8a00-04b5ffcd3403"===k?t.b.Failure:t.b.Success;return new t.a({name:"oneUp_shareAuthToken"}).end({resultType:l,resultCode:k,extraData:{disallowSelfIssuedToken:h}}),Promise.resolve({...j})})}{let a,c=H?g:(0,x.a)(g||""),d=`${c}/_layouts/15/sharedialog.aspx?listId=${n}&clientId=oneup&mode=${b}&fullScreenMode=true`;return m&&(d+=`&listItemId=${m}`),G&&l&&(d+=`&uniqueId=${l}`),I?a={hasTokenProvider:!0}:(0,q.pb)()&&(a={hasAdditionalTokenProvider:[v.a.Augloop]}),Promise.resolve({cookieAuthIframeUrl:d,sharingContext:a})}}}(a)},[a]),i=e.useMemo(function(){return function(a){let{resources:b,mode:c,item:d,pageContext:e}=a,{listurl:f,serverRelativeItemUrl:g,webAbsoluteUrl:i,isCrossList:k,isCrossDomain:r,listId:s,listItemId:t}=M(a),v=b.consume(D);return w=>{let{sharingInformation:x,clickTime:y}=w,[z,A]=(0,p.a)("OneUpSharingModalContainer");if(((0,q.Jb)()?k:r)&&z){let k;z.style.position="relative",z.style.zIndex="10000000000000";let p=x.authToken,r=b.consume(j.resourceKey);if((0,q.Rb)()){let a=b.consume(u.b)?.list;k=a?.list?.id??s}let w=(0,q.mb)()&&r?.getAugloopToken?async a=>(await r.getAugloopToken({resource:a,apiQosName:"ShowShareDialog"})).accessToken:void 0,B=J?void 0:b.consume(E.a)?.(),C={authToken:p||"",clientId:"oneup",mode:Number(c),listItemId:d.itemId||t,itemName:d.name||"",correlationId:e?.CorrelationId??m.a.generate(),scenarioId:"OneUp-CrossList",hostOptions:{showCloseButton:!0,hideShareDialogOverflowButton:!0},hostMethod:l.a.sharepoint,serverRelativeItemUrl:g,listId:k,listUrl:f,uniqueId:H?"":a.uniqueId,webAbsoluteUrl:i||"",locale:h.a.language||"en-US",fullScreenIframe:!0,...!J?{isUserCopilotLicensed:B}:{}},D={onError:a=>{},onReady:()=>{console.log("sharePrefetch ready")},onTimeout:()=>{},onDismiss:()=>{a.onClose&&a.onClose(),A()},...(0,q.mb)()&&!I?{spRestTokenProvider:{getAugloopToken:w}}:void 0};I&&(D.sharingHostTokenProvider=v),new o.a({element:z,locale:C.locale,environment:e.env2??n.a.prod,disableIframeDomainCheck:!0,isConsumer:!1,context:C,styles:{minWidth:"480px"},clickTime:y,options:D}).initializeUI()}}}(a)},[a]),w=e.useMemo(function(){let b;return b=a.resources.consume(j.resourceKey),(a,c)=>a===v.a.Augloop&&b?.getAugloopToken?b.getAugloopToken({resource:c?.resource,apiQosName:"ShowShareDialog"}).then(a=>a.accessToken):Promise.resolve(void 0)},[a]),y=a.resources.consume(D),z={...I?{onGetAuthToken:y.onGetAuthToken,onRefreshCookies:y.onRefreshCookies}:{},...!I?{onGetAdditionalToken:w}:{}};return e.createElement(K,{getSharingInformation:g,getTargetDocId:()=>a.targetDocId,getClientId:()=>"oneup",initializeShareFrame:i,mode:f.a.share,resolve:()=>{},reject:a=>{d.reject(a)},locale:h.a.language||"en-US",itemName:a.itemName||"",onShareReady:()=>{b&&b.focus()},onShareLoaded:a=>{let{resultType:b,...c}=a;d.resolve({resultType:b,extraData:c})},onModalClose:()=>{a.onClose&&a.onClose()},clickTime:c,...z})}let O=new d.v7({name:"ShowShareDialog",factory:{dependencies:{},create:a=>({instance:{showShareDialog:L}})}});var P=c(10),Q=c(297),R=c(682);let S=!d.Ov.isActivated("98CFE6BF-ABFD-4293-A939-2917DF2B9BB9"),T="ShareAction",U="AddAgentToTeamsAction",V=(a,b,c)=>d=>{var e;let f=a.oneUpStateStore.currentAppState.deletedKeys?.has(d.item.key),g=(e=d.item,!e.lifeCycleStatus?.isMalwareDetected&&!f);return b===U&&d.item.extension!==Q.d&&d.item.extension!==Q.e&&(g=!1),{isAvailable:g,id:b,onExecute:async()=>{let b=a.oneUpStore.getOneUpProperties(),e=R.a&&d.item?d.item:a.oneUpStore.getOneUpProperties()?.focusItem;if(b&&e){let f={listId:(0,q.Tb)()&&b?.list?.list?.id||a.pageContext.listId,webAbsoluteUrl:a.pageContext.webAbsoluteUrl,listItemId:e.properties?.ID,uniqueId:S?e.properties?.uniqueId:void 0,mode:c,targetDocId:d.targetDocId,fullScreenMode:!0,itemName:e.name,item:e,pageContext:a.pageContext,resources:a.resources,onClose:()=>{a.oneUpStateStore.updateModalState("shareCommand",{showModal:!1,content:void 0})},onRender:b=>{a.oneUpStateStore.updateModalState("shareCommand",{showModal:!0,content:b})}},g=await a.getExecutor();return await g.showShareDialog(f)}}}},W={getExecutor:O.async.lazy,pageContext:z.a,oneUpStore:u.b,resources:d.m3,oneUpStateStore:P.f},X=new d.v7({name:"ShareAction",factory:{dependencies:W,create:a=>({instance:{evaluateAction:V(a,T,f.a.manageAccess)}})}}),Y=new d.v7({name:"ShareAction",factory:{dependencies:W,create:a=>({instance:{evaluateAction:V(a,T,f.a.share)}})}}),Z=new d.v7({name:"ShareAction",factory:{dependencies:W,create:a=>({instance:{evaluateAction:V(a,"CopyAction",f.a.copyLink)}})}}),$=new d.v7({name:"ShareAction",factory:{dependencies:W,create:a=>({instance:{evaluateAction:V(a,U,f.a.copyLink)}})}})}
,,,,,,,,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>l});var d=c("odsp.util_126"),e=c(95),f=c(10),g=c(2),h=c(17),i=c(373),j=c(392);let k={oneUpStore:h.b,oneUpStateStore:f.f,pageContext:g.a,resources:d.m3,getExecutor:j.a.async.lazy},l=new d.v7({name:"EditRequestAction",factory:{dependencies:k,create:a=>({instance:{evaluateAction:(({oneUpStore:a,oneUpStateStore:b,pageContext:c,resources:d,getExecutor:f})=>()=>{let g=(0,i.b)(a.focusItem?.permissions);return{isAvailable:!c.isAnonymousGuestUser&&(a=>{switch(a){case e.a.review:case e.a.restrictedview:case e.a.view:return!0;default:return!1}})(g),id:"EditRequestAction",onExecute:async()=>{let h=a.getOneUpProperties();if(h&&g){let a=await f();await a.showRequestMoreAccessDialog({item:h.focusItem,pageContext:c,itemRole:g,requestRole:e.a.edit,resources:d,onClose:()=>{b.updateModalState("editRequestCommand",{showModal:!1,content:void 0})},onRender:a=>{b.updateModalState("editRequestCommand",{showModal:!0,content:a})}})}}}})(a)}})}})}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>e});var d=c("odsp.util_126");let e=new d.v7({name:"ShowRequestMoreAccessDialog.key",loader:new d.dE(()=>c.e(72).then(c.bind(c,858)).then(a=>a.showRequestMoreAccessDialogKey))})}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>d});let d=new(c("odsp.util_126")).v7({name:"isAutoOpenCopilotPaneEnabled",factory:{dependencies:{},create:()=>({instance:!1})}})}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>n,b:()=>q});var d=c("odsp.util_126"),e=c(0),f=c(306),g=c(135),h=c(10),i=c(51),j=c(374),k=c(15),l=c(4),m=c(79);let n="AnnotateAction",o={oneUpStateStore:h.f,uaDataSource:f.a,pdfHelper:i.b,itemUrlHelper:k.c,openCommentsPaneActionAsyncKey:j.a.async};async function p(a,b){if(b.oneUpStateStore.state.currentState.annotationViewerState?.viewerVisiblity===h.a.On){let c=await b.openCommentsPaneActionAsyncKey();await c.evaluateAction({item:a.item,isAnnotateAction:!0})}}let q=new d.v7({name:"AnnotateAction",factory:{dependencies:o,create:a=>({instance:{evaluateAction:b=>({id:n,isAvailable:function(a,b){if(!(0,l.$b)(l.ib))return!1;let c=b.uaDataSource.isUniversalAnnotationDisabled;if((0,l.$b)(l._)&&c||b.oneUpStateStore.currentAppState.viewerStates?.get(a.key)?.pdfViewerStates?.isPdfMip||!b.pdfHelper.isSupportedFileType(a)||b.itemUrlHelper.getItemUrlParts(a.key).geoRelation!==k.a.sameGeo||!(b.pdfHelper.isMsPdfViewerAvailable(a)&&b.pdfHelper.isMsPdfViewerSupported()))return!1;let d=b.oneUpStateStore.getESignData().isCreateSidePanelActive;return(!!g.l||!d)&&!!b.uaDataSource.hasLicense&&!!b.pdfHelper.isNotEmbed()}(b.item,a),isDisabled:g.l&&a.oneUpStateStore.getESignData().isCreateSidePanelActive,onExecute:async()=>{let{oneUpStateStore:c}=a,d=c.currentAppState.annotationViewerState,f=c.currentAppState.viewerStates?.get(b.item.key)?.pdfViewerStates?.outlineVisibility;return c.toggleAnnotationViewerVisiblity(n),f!==m.b.Focus&&f!==m.b.Visible||d.isActive||c.updateViewerState("annotateActionHideOutline",{key:b.item.key,options:{pdfViewerStates:{outlineVisibility:m.b.Hidden}}}),(0,l.$b)(l.z)&&await p(b,a),{resultType:e.b.Success}}})}})}})}
,,,,,,,,,,,,,(a,b,c)=>{"use strict";function d(){return!0}c.d(b,{a:()=>d})}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>h,b:()=>j,c:()=>i});var d=c("tslib_533"),e=c(172),f=c("react-lib"),g=f.createContext(void 0),h=function(a){var b=a.children,c=(0,d.dc)(a,["children"]),h=f.useMemo(function(){return new e.a(c.strings)},[c.strings]);return f.createElement(g.Provider,{value:h},b)},i=function(){return f.useContext(g)},j=function(){return(0,d.yv)(void 0,void 0,void 0,function(){var a,b,c;return(0,d.SO)(this,function(e){switch(e.label){case 0:return[4,Promise.all([Promise.resolve().then(function(){var a=Error("Cannot find module '../l10n/Strings.resx'");throw a.code="MODULE_NOT_FOUND",a}),Promise.resolve().then(function(){var a=Error("Cannot find module '@ms/file-annotation-bar/lib/l10n/Strings.resx'");throw a.code="MODULE_NOT_FOUND",a})])];case 1:return b=(a=d.pM.apply(void 0,[e.sent(),2]))[0],c=a[1],[2,(0,d.q5)((0,d.q5)({},b.default),c.default)]}})})}}
,,(a,b,c)=>{"use strict";var d,e,f,g,h,i;c.d(b,{a:()=>e,b:()=>d,c:()=>f}),(g=d||(d={})).FreeText="FreeText",g.Pen="Pen",g.Highlighter="Highlighter",g.Eraser="Eraser",g.PointEraser="PointEraser",g.Display="Display",g.Watermark="Watermark",(h=e||(e={})).DarkYellow="#FED430",h.LightOrange="#FBAE17",h.Orange="#F36323",h.Red="#E3182D",h.DarkPurple="#5B318D",h.Purple="#914BB8",h.Magenta="#CF1278",h.DarkRed="#C10051",h.LightBlue="#3ECCFD",h.Blue="#0078D7",h.DarkBlue="#0051BA",h.LightGreen="#7EC400",h.Green="#00B44B",h.LightGrey="#EBEBEB",h.Grey="#B6B6B6",h.Black="#1F1F1F",(i=f||(f={})).Unknown="Unknown",i.Create="Create",i.Update="Update",i.Delete="Delete",i.UpdateOrDelete="UpdateOrDelete"}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>h,b:()=>j,c:()=>i});var d=c("tslib_533"),e=c(172),f=c("react-lib"),g=f.createContext(void 0),h=function(a){var b=a.children,c=(0,d.dc)(a,["children"]),h=f.useMemo(function(){return new e.a(c.strings)},[c.strings]);return f.createElement(g.Provider,{value:h},b)},i=function(){return f.useContext(g)},j=function(){return(0,d.yv)(void 0,void 0,void 0,function(){return(0,d.SO)(this,function(a){switch(a.label){case 0:return[4,Promise.resolve().then(function(){var a=Error("Cannot find module '../../l10n/Strings.resx'");throw a.code="MODULE_NOT_FOUND",a})];case 1:return[2,a.sent().default]}})})}}
,,(a,b,c)=>{"use strict";c.d(b,{A:()=>f,B:()=>s,C:()=>h,D:()=>i,E:()=>e,F:()=>n,G:()=>o,H:()=>m,I:()=>g,J:()=>q,K:()=>z,L:()=>y,M:()=>P,a:()=>A,b:()=>r,c:()=>x,d:()=>w,e:()=>v,f:()=>l,g:()=>k,h:()=>B,i:()=>p,j:()=>j,k:()=>t,l:()=>u,m:()=>I,n:()=>F,o:()=>G,p:()=>H,q:()=>E,r:()=>D,s:()=>d,t:()=>C,u:()=>O,v:()=>M,w:()=>L,x:()=>K,y:()=>N,z:()=>J}),(0,c("fui.util_178").ZW)([{rawString:".OneUpModal_a508321b .OneUpRoot_a508321b{display:flex;flex-direction:row;position:absolute;top:45px;left:0;right:0;bottom:0}.OneUpModal_a508321b .OneUpRoot_a508321b .OneUpRightPane_a508321b{min-width:320px}.OneUpModal_a508321b .OneUpRoot_a508321b .OneUpVersionHistoryRightPane_a508321b{min-width:320px;overflow-y:auto!important}.OneUpModal_a508321b .OneUpRootLightBackground_a508321b{border-top:1px solid "},{theme:"neutralLight",defaultValue:"#edebe9"},{rawString:";background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.OneUpModal_a508321b .OneUpRootDarkBackground_a508321b{background-color:rgba(0,0,0,0)}.OneUpModal_a508321b [data-automation-id=CopilotPaneCommand]{min-width:32px!important;width:32px!important;margin:4px 2px!important}.OneUpModal_a508321b [data-automation-id=commentCommand]{margin:4px 2px!important;width:32px!important}.OneUpModal_a508321b .OneUpRootNoCommandBar_a508321b{display:flex;flex-direction:column;position:absolute;top:0;left:0;right:0;bottom:0}.OneUpModal_a508321b .OneUpDetailsPane_a508321b{position:relative;width:380px;height:100%}@media (width <= 380px){.OneUpModal_a508321b .OneUpDetailsPane_a508321b{width:100%}}.OneUpModal_a508321b .OneUpCopilotPane_a508321b{position:relative;width:400px;height:100%}@media (width <= 400px){.OneUpModal_a508321b .OneUpCopilotPane_a508321b{width:100%}}.OneUpModal_a508321b .OneUpCommentsPane_a508321b{padding:10px 10px 10px 20px;width:340px;height:calc(100% - 60px)}.OneUpModal_a508321b .OneUpCommentsPane_a508321b .OneUpCommentsPaneTitle_a508321b{display:flex;align-items:center;font-family:sans-serif;font-size:"},{theme:"xLargeFontSize",defaultValue:"20px"},{rawString:";font-weight:"},{theme:"xLargeFontWeight",defaultValue:"600"},{rawString:"}.OneUpModal_a508321b .OneUpVersionHistoryPane_a508321b{padding:10px;width:630px}.OneUpModal_a508321b .OneUpVersionHistoryPane_a508321b .OneUpVersionHistoryPaneHeader_a508321b{display:flex;justify-content:space-between;align-items:center;padding:10px}.OneUpModal_a508321b .OneUpVersionHistoryPane_a508321b .OneUpVersionHistoryPaneHeader_a508321b .OneUpVersionHistoryPaneTitle_a508321b{font-size:20px;font-weight:600;font-family:sans-serif;margin:0}.OneUpModal_a508321b .OneUpDetailsPaneSpinner_a508321b{height:100%;display:flex;justify-content:center;align-items:center}.OneUpModal_a508321b .OneUpViewer_a508321b{position:relative;flex:1 1 auto}.OneUpModal_a508321b .OneUpAccessibleLoadAnnouncement_a508321b{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);border:0}.OneUpModal_a508321b .OneUpCommandBar_a508321b{display:flex;justify-content:space-between}.OneUpModal_a508321b div.OneUpRootAnimation_a508321b{opacity:0;transition:opacity 367ms linear,visibility 367ms linear,transform 367ms linear}.OneUpModal_a508321b div.OneUpRootAnimation_a508321b.OneUpEntrance_a508321b{transition-delay:0s,0s,0s;opacity:1;visibility:visible}.OneUpModal_a508321b div.OneUpRootAnimation_a508321b.OneUpExit_a508321b{opacity:0;visibility:hidden}.OneUpModal_a508321b div.OneUpRootAnimation_a508321b.OneUpEntranceV2_a508321b{transition-delay:0s,0s,0s;opacity:1;visibility:visible}.OneUpModal_a508321b div.OneUpRootAnimation_a508321b.OneUpExitV2_a508321b{opacity:0;visibility:hidden}@media (prefers-reduced-motion){.OneUpModal_a508321b div.OneUpRootAnimation_a508321b{transition:unset;opacity:1;visibility:inherit}}.OneUpCommandButtonPrimary_a508321b{margin-left:5px;margin-right:5px}.OneUpCommandButtonPrimaryWhite_a508321b{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:";border:1px solid "},{theme:"white",defaultValue:"#fff"},{rawString:";color:"},{theme:"black",defaultValue:"#000"},{rawString:"}.OneUpCommandButtonPrimaryWhiteV2_a508321b{background-color:"},{theme:"white",defaultValue:"#fff"},{rawString:"!important;border:1px solid "},{theme:"white",defaultValue:"#fff"},{rawString:";color:"},{theme:"black",defaultValue:"#000"},{rawString:"!important}.PreviousButton_a508321b{position:absolute;top:50%;left:32px;z-index:9999}.PrevBtnNextToPdfOutline_a508321b{left:344px}.NextButton_a508321b{position:absolute;top:50%;right:32px}.OneUpContextMenuCommandIcon_a508321b{display:flex}.OneUpNewBadge_a508321b{margin-left:10px;align-self:center;color:"},{theme:"white",defaultValue:"#fff"},{rawString:";background-color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:";display:inline-flex;align-items:center;justify-content:center;position:relative;font-size:.625rem;height:8px;padding:3px 6px;border-radius:20px}.OneUpHelpMenuOption_a508321b{border:transparent;margin:5px}.OneUpHelpButton_a508321b{width:32px;height:32px;position:absolute;bottom:12px;right:24px;z-index:99999;display:flex;flex-direction:column;align-items:center}.OneUpHelpButton_a508321b i{font-size:16px}.OneUpHelpButtonPerfBtnOpen_a508321b{right:249px}.OneUpHelpButtonRightPaneOpen_a508321b{right:364px}.OneUpHelpButtonVersionHistoryPaneOpen_a508321b{right:694px}.OneUpHelpButtonDetailsPaneOpen_a508321b{right:424px}.OneUpPerfButton_a508321b{position:absolute;bottom:0;right:0;z-index:9999;display:flex;flex-direction:column;align-items:flex-end;box-shadow:0 0 5px "},{theme:"black",defaultValue:"#000"},{rawString:";border-top-left-radius:10px;border-top-right-radius:10px}.OneUpPerfButton_a508321b .OneUpPerfButtonHeader_a508321b{display:flex;flex-direction:row;justify-content:space-between;width:100%;border-radius:inherit}.OneUpPerfButton_a508321b .OneUpPerfButtonHeaderText_a508321b{margin-top:5px;margin-left:10px}.OneUpPerfButton_a508321b .OneUpPerfButtonDivider_a508321b{margin-left:10px;margin-right:10px}.OneUpPerfButton_a508321b .OneUpPerfButtonLink_a508321b{color:"},{theme:"themePrimary",defaultValue:"#0078d4"},{rawString:"}.OneUpPerfButton_a508321b .OneUpPerfButtonContent_a508321b{margin:10px;display:flex;flex-direction:row;align-items:flex-end}.versionHistoryNumber_a508321b:hover{color:"},{theme:"themeDarker",defaultValue:"#004578"},{rawString:"}::-webkit-scrollbar{width:14px;height:14px;scrollbar-width:thin;scrollbar-color:#605e5c transparent}::-webkit-scrollbar-thumb{-webkit-background-clip:content-box;background-clip:content-box;border-radius:8px;border:4px solid transparent;background-color:#605e5c}::-webkit-scrollbar-thumb:hover{background-color:#3b3a39}::-webkit-scrollbar-button{display:none}::-webkit-scrollbar-corner{background:0 0}@media (forced-colors:active){::-webkit-scrollbar{scrollbar-color:CanvasText transparent}::-webkit-scrollbar-thumb{background-color:CanvasText;border:4px solid Window}}"}]);let d="OneUpModal_a508321b",e="OneUpRoot_a508321b",f="OneUpRightPane_a508321b",g="OneUpVersionHistoryRightPane_a508321b",h="OneUpRootDarkBackground_a508321b",i="OneUpRootNoCommandBar_a508321b",j="OneUpDetailsPane_a508321b",k="OneUpCommentsPane_a508321b",l="OneUpCommentsPaneTitle_a508321b",m="OneUpVersionHistoryPane_a508321b",n="OneUpVersionHistoryPaneHeader_a508321b",o="OneUpVersionHistoryPaneTitle_a508321b",p="OneUpDetailsPaneSpinner_a508321b",q="OneUpViewer_a508321b",r="OneUpAccessibleLoadAnnouncement_a508321b",s="OneUpRootAnimation_a508321b",t="OneUpEntranceV2_a508321b",u="OneUpExitV2_a508321b",v="OneUpCommandButtonPrimary_a508321b",w="OneUpCommandButtonPrimaryWhite_a508321b",x="OneUpCommandButtonPrimaryWhiteV2_a508321b",y="PreviousButton_a508321b",z="PrevBtnNextToPdfOutline_a508321b",A="NextButton_a508321b",B="OneUpContextMenuCommandIcon_a508321b",C="OneUpNewBadge_a508321b",D="OneUpHelpMenuOption_a508321b",E="OneUpHelpButton_a508321b",F="OneUpHelpButtonPerfBtnOpen_a508321b",G="OneUpHelpButtonRightPaneOpen_a508321b",H="OneUpHelpButtonVersionHistoryPaneOpen_a508321b",I="OneUpHelpButtonDetailsPaneOpen_a508321b",J="OneUpPerfButton_a508321b",K="OneUpPerfButtonHeader_a508321b",L="OneUpPerfButtonHeaderText_a508321b",M="OneUpPerfButtonDivider_a508321b",N="OneUpPerfButtonLink_a508321b",O="OneUpPerfButtonContent_a508321b",P="versionHistoryNumber_a508321b"}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>d});var d=function(a){this.viewHandler=a.viewHandler,this.inputEvtHandler=a.inputEvtHandler,this.metadata=a.metadata}}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>g,b:()=>h});var d=c("tslib_533"),e=c("react-lib"),f=e.createContext(void 0),g=function(a){var b=a.children,c=(0,d.dc)(a,["children"]);return e.createElement(f.Provider,{value:c},b)},h=function(){return e.useContext(f)}}
,,(a,b,c)=>{"use strict";c.d(b,{a:()=>g,b:()=>h});var d=c("tslib_533"),e=c("react-lib"),f=e.createContext(void 0),g=function(a){var b=a.children,c=(0,d.dc)(a,["children"]);return e.createElement(f.Provider,{value:c},b)},h=function(){return e.useContext(f)}}
,,(a,b,c)=>{"use strict";c.d(b,{a:()=>g,b:()=>j,c:()=>h,d:()=>k});var d=c("tslib_533"),e=c("react-lib"),f=e.createContext(void 0),g=function(a){var b=a.children,c=(0,d.dc)(a,["children"]);return e.createElement(f.Provider,{value:c},b)},h=function(){return e.useContext(f)},i=e.createContext(void 0),j=function(a){var b=a.children,c=(0,d.dc)(a,["children"]);return e.createElement(i.Provider,{value:c},b)},k=function(){var a=e.useContext(i);if(!a)throw Error("usePageTabIndexContext must be used within a PageTabIndexProvider");return a}}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>d});let d=new(c("odsp.util_126")).v7("clientName")}
,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>i});var d=c(2),e=c(15),f=c(115),g=c("odsp.util_126");let h=new g.v7({name:"ApiUrlHelper.encodeWebAbsoluteUrl",factory:new g.Uo(!0)}),i=(0,g.hl)("ApiUrlHelper",f.a,{itemUrlHelper:e.c,pageContext:d.a,encodeWebAbsoluteUrl:h})}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>i,b:()=>j,c:()=>h,d:()=>g});var d=c("tslib_533"),e=c(84),f=c(73),g=function(a,b,c,g){var h,i,j,k,l,m=(0,d.pM)([a.x,a.y],2),n=m[0],o=m[1],p=(0,d.pM)([a.width,a.height],2),q=p[0],r=p[1];switch(g){case f.f.Degree90:n=(h=(0,d.pM)([b.height-o-r,n],2))[0],o=h[1],q=(i=(0,d.pM)([r,q],2))[0],r=i[1];break;case f.f.Degree180:n=(j=(0,d.pM)([b.width-n-q,b.height-o-r],2))[0],o=j[1];break;case f.f.Degree270:n=(k=(0,d.pM)([o,b.width-n-q],2))[0],o=k[1],q=(l=(0,d.pM)([r,q],2))[0],r=l[1]}return new e.b(n,o,q,r).scale(c||1)},h=function(a,b,c,d,f){var h=a.x,i=a.y,j=void 0===f?{width:0,height:0}:f,k=j.width,l=j.height;return g(new e.b(h,i,k,l),b,c,d)},i=function(a,b,c,g){var h,i,j,k=(0,d.pM)([a.x/c,a.y/c],2),l=k[0],m=k[1];switch(g){case f.f.Degree90:l=(h=(0,d.pM)([m,b.height-l],2))[0],m=h[1];break;case f.f.Degree180:l=(i=(0,d.pM)([b.width-l,b.height-m],2))[0],m=i[1];break;case f.f.Degree270:l=(j=(0,d.pM)([b.width-m,l],2))[0],m=j[1]}return new e.a(l,m)},j=function(a,b,c,d,g){var h=a.left,i=a.top,j=a.bottom,k=a.right,l=function(a,b){return new e.a(a*d+c,b*d)};switch(g){case f.f.Degree0:return l(h,j);case f.f.Degree90:return l(h,i);case f.f.Degree180:return l(b?k:h,i);case f.f.Degree270:return l(k,b?j:i);default:return new e.a(0,0)}}}
,,(a,b,c)=>{"use strict";c.d(b,{a:()=>i,b:()=>g,c:()=>k,d:()=>j});var d=c("tslib_533"),e=c(172),f=c("react-lib"),g=function(a){return new e.a(a)},h=f.createContext(void 0),i=function(a){var b=a.children,c=(0,d.dc)(a,["children"]),g=f.useMemo(function(){return new e.a(c.strings)},[c.strings]);return f.createElement(h.Provider,{value:g},b)},j=function(){return f.useContext(h)},k=function(){return(0,d.yv)(void 0,void 0,void 0,function(){return(0,d.SO)(this,function(a){switch(a.label){case 0:return[4,Promise.resolve().then(function(){var a=Error("Cannot find module '../../l10n/Strings.resx'");throw a.code="MODULE_NOT_FOUND",a})];case 1:return[2,a.sent().default]}})})}}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>j.a,b:()=>k.p,c:()=>k.s,d:()=>l.f,f:()=>d.c,e:()=>d.b});var d=c(205),e=c(218);c(234);var f=c("tslib_533"),g=c("react-lib"),h=c("react-dom-lib");function i(a,b){this.container=a,this.render(b)}i.prototype.render=function(a){var b=this;h.render(g.createElement(e.a,(0,f.q5)({},(0,f.q5)((0,f.q5)({},a),{componentRef:function(a){b._innerRef=a}}))),this.container)},i.prototype.dispose=function(){h.unmountComponentAtNode(this.container)},Object.defineProperty(i.prototype,"innerRef",{get:function(){return this._innerRef},enumerable:!1,configurable:!0});var j=c(37),k=c(58),l=c(73);c(148),c(569)}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>i,b:()=>k,c:()=>g,e:()=>h,d:()=>f.a,f:()=>j});var d=c("odsp.util_126");c(470),c(217);var e=c(137);new d.v7("list"),new d.v7("oAuthTokenDataSource"),new d.v7("siteScripts"),c(885);var f=c(97);new d.v7("recentList"),new d.v7("prefetchCache"),new d.v7("folder"),new d.v7("appsItem"),new d.v7("externallySharedItem"),new d.v7("popularItem"),new d.v7("subsiteItem"),new d.v7("mostViewsItem"),new d.v7("mostViewersItem"),new d.v7("settings"),new d.v7("getItem"),new d.v7("items"),new d.v7("versionControl"),new d.v7("versionHistory"),new d.v7("vault");let g=e.a;new d.v7("peopleCardFactory"),new d.v7("peopleCard"),new d.v7("language"),new d.v7("languagePicker"),new d.v7("leftNav"),new d.v7("search"),new d.v7("sharing"),new d.v7("sharingLightSpeed"),new d.v7("sharingData"),new d.v7("groups"),new d.v7("suiteNav"),new d.v7("iosMobileAppPath");let h=new d.v7("url");new d.v7("universalAnnotation");let i=new d.v7("download");new d.v7("docFormat"),new d.v7("footer"),new d.v7("manifests"),new d.v7("itemActivityFeed"),new d.v7("itemActivityFeedHelper"),new d.v7("itemActivityFeedSharingHelper"),new d.v7("userInfo"),new d.v7("storageInfo"),new d.v7("storageOptions"),new d.v7("album"),new d.v7("tag"),new d.v7("shareByLink"),new d.v7("folderItemCount"),new d.v7("photo"),new d.v7("subscriptions"),new d.v7("analytics"),new d.v7("sendFeedback"),new d.v7("embed"),new d.v7("application"),new d.v7("policyTip"),new d.v7("policyTipLightSpeed"),new d.v7("customAction"),new d.v7("taxonomy"),new d.v7("web"),new d.v7("floodgate"),new d.v7("shortcutsDS"),new d.v7("encoding"),new d.v7("rating"),new d.v7("publish");let j=new d.v7("videoItem");new d.v7("sites"),new d.v7("copy"),new d.v7("upsell"),new d.v7("notifications"),new d.v7("command"),new d.v7("processFilters"),new d.v7("quota"),new d.v7("itemColumn"),new d.v7("bundle"),new d.v7("itemPicker"),new d.v7("site"),new d.v7("pushChannel"),new d.v7("itemAutoRefresh"),new d.v7("loginApp"),new d.v7("mruRecent"),new d.v7("pdf"),new d.v7("zip"),new d.v7("url2"),new d.v7("attachments"),new d.v7("spotlight"),new d.v7("error"),new d.v7("promotedPhotos"),new d.v7("fileHandler"),new d.v7("fileHandlerFromCache"),new d.v7("recycleBin"),new d.v7("deleteRestore"),new d.v7("instrumentation"),new d.v7("shadowCall");let k=new d.v7("graph");new d.v7("formula"),new d.v7("appUrl"),new d.v7("graphUrl"),new d.v7("batchUploaderType"),new d.v7("vroomItemIdentityProcessor"),new d.v7("preAuth"),new d.v7("peopleService"),new d.v7("schema"),new d.v7("restore"),new d.v7("restore"),new d.v7("restoreActivities"),new d.v7("inAppMessaging"),new d.v7("notificationSettings"),new d.v7("itemInvalidator"),new d.v7("itemUpdator"),new d.v7("wopiFrame"),new d.v7("wrs"),new d.v7("excel"),new d.v7("worker"),new d.v7("checkUserAccessDataSource"),new d.v7("userExpiration"),new d.v7("itemMuteNotificationDataSource"),new d.v7("ticketRedeemer"),new d.v7("recommendList"),new d.v7("reportAbuse"),new d.v7("legacyReportAbuse"),new d.v7("requestReview"),new d.v7("removeFromShareWithMeList"),new d.v7("siteUserPermissions")}
,,(a,b,c)=>{"use strict";c.d(b,{a:()=>l,b:()=>k,c:()=>j});var d=c("tslib_533"),e=c("react-lib"),f=c.n(e),g={setMode:function(){},resetPageSelection:function(){},subscribe:function(){},unsubscribe:function(){},toggle:function(){}},h=(0,e.createContext)(g),i=(0,e.createContext)(function(){}),j=function(){return f().useContext(h)},k=function(){var a=f().useContext(i);return(0,e.useCallback)(function(b){a(function(a){return(0,d.q5)((0,d.q5)({},a),b)})},[a])},l=function(a){var b=a.children,c=(0,d.pM)((0,e.useState)(g),2),j=c[0],k=c[1];return f().createElement(i.Provider,{value:k},f().createElement(h.Provider,{value:j},b))}}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>g,b:()=>h});var d=c("tslib_533"),e=c("react-lib"),f=e.createContext(void 0),g=function(a){var b=a.children,c=(0,d.dc)(a,["children"]);return e.createElement(f.Provider,{value:c},b)},h=function(){return e.useContext(f)}}
,,(a,b,c)=>{"use strict";var d,e;c.d(b,{a:()=>f}),(e=d||(d={}))[e.File=0]="File",e[e.Folder=1]="Folder",e[e.Media=2]="Media",e[e.OneNote=3]="OneNote",e[e.Unknown=4]="Unknown",e[e.Error=5]="Error",e[e.App=6]="App",e[e.Subsite=7]="Subsite",e[e.Shortcut=8]="Shortcut",e[e.Album=9]="Album",e[e.MultiShare=10]="MultiShare";let f=d}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>T});var d=c("odsp.util_126"),e=c(2),f=c(545),g=c(28),h=c(74),i=c(479);let j=!d.Ov.isActivated("DB0DA5A6-F7AD-46D8-8419-EA01B02D5B6E");var k=c(141),l=c(230),m=c(6);let n=d.Ov.isActivated("6BC7F79B-F64E-45FD-8C10-8A0B11E1A1AE"),o=d.Ov.isActivated("b34b53db-eebd-41ab-a952-cea4ecae7061"),p=d.Ov.isActivated("FCE15EEB-B33F-48C7-B6B0-01C53F4E3F22"),q=d.Ov.isActivated("CE33C02E-50E4-42DC-A90F-21222CB273FF"),r=d.Ov.isActivated("A3C20F37-C7C2-4AC6-ADB4-8C6958661CE0"),s=d.Ov.isActivated("18041F7A-7BDD-4D29-86F1-1C56AC02CABB"),t=d.Ov.isActivated("E33B9D9A-36D5-4622-942E-D752961FB9C5"),u=d.Ov.isActivated("ED251D77-47F5-4235-A7E7-5B016DCF530C"),v=d.Ov.isActivated("770CD907-DCBF-4F19-9F41-B0CE57497A99"),w=d.Ov.isActivated("ff106db9-b7de-4cb7-b28a-41fd6264cb74"),x={"az-nb":d.Ov.isActivated("11E94882-32E7-41F9-97E5-517D8392AD64"),"az-rms":d.Ov.isActivated("4326281B-C894-4584-A679-2A8F906F9186"),"ms-augloop":d.Ov.isActivated("FECC1297-0280-4181-AC7D-C7619C8317C7"),"ms-designer":d.Ov.isActivated("08A57D58-3B4E-4D6F-8069-4923A16D1410"),"ms-forms":d.Ov.isActivated("DE809C5A-1684-42BD-8234-8CD758135C88"),"ms-graph":d.Ov.isActivated("9DAED3DC-9C1F-4868-94C9-559F38847D35"),"ms-loki":d.Ov.isActivated("82D3735E-7873-4DFB-9C17-05D2621E7ED9"),"ms-mcu":d.Ov.isActivated("6961FBF5-64D1-49FC-B005-A913747B8ACA"),"ms-officeapps":d.Ov.isActivated("87A9B0FD-843A-48E5-A8CE-4D8DB62A436A"),"ms-substrate":d.Ov.isActivated("D48E094B-A6B2-4A5A-B21A-3027E03520C5"),"ms-substrate-search":d.Ov.isActivated("FED1D456-746E-49F6-9B01-3A55C05B67E5"),"ms-substrate-sti":d.Ov.isActivated("2E7FC3E3-8CB0-48F3-99D2-96C57E6791B6"),"ms-substrate-taiger-service":d.Ov.isActivated("C0C4A112-23C5-47BC-B4DA-1DF407EC0525"),"ms-substrate-tenant-feedback":d.Ov.isActivated("BB31A897-FBA6-45DB-ABAE-F80ED5C76178"),"oAuth-SA":d.Ov.isActivated("371D965D-71B0-457C-9859-A4DAE8D93331"),"office-home":d.Ov.isActivated("7904032D-82A6-4E91-9B0F-19FC78818E0E"),"power-bi":d.Ov.isActivated("2988E6EE-0506-4DAD-95B1-AD4457FC47D2"),"power-platform":d.Ov.isActivated("0A68AF2D-350A-46AC-825C-97D4C5F1E3B1"),"SharePoint-embedded":d.Ov.isActivated("819646EE-A230-4E40-AE1F-8706BCAC044D"),"SharePoint-graph":d.Ov.isActivated("6F52630A-DAEC-4706-A27F-C3F9C78FA0B2"),"SharePoint-media":d.Ov.isActivated("DB3A7BE9-BC20-448A-B625-077BEBEC6008"),"SharePoint-mediaGPT":d.Ov.isActivated("D2B7A193-D1A2-46B1-AC7B-D7BB6D55E34C"),"teams-cmd":d.Ov.isActivated("60A336BB-9983-4209-8AA2-D363834C1949"),"your-phone":d.Ov.isActivated("5E52A975-66D9-4250-AC01-58D481529EBA"),oAuth:d.Ov.isActivated("C9B5BE64-2CEF-4898-A844-CACAD3B22692"),ocps:d.Ov.isActivated("7083D304-F054-4320-9699-7630F7983EB7"),pushchannel:d.Ov.isActivated("2C50BE8C-2E41-4E97-B00A-411397F2D382"),SharePoint:d.Ov.isActivated("EF16A944-DBA4-46F1-BE52-E010C4FDE981"),SharePoint_MSAL:d.Ov.isActivated("846C4E85-895E-478B-B0BF-CD8F8A911C81"),SharePoint_SelfIssued:d.Ov.isActivated("CA3D4808-E720-411F-8A0E-D4D8DCBF7E5F"),SPHome:d.Ov.isActivated("595982BE-C488-4ADF-9E0C-7FCEDAAD2621"),yammer:d.Ov.isActivated("6D22340C-BED0-4910-A341-0AD4C7EB165A")},y=["onedrive_implicit.access"],z=["https://my.microsoftpersonalcontent.com/v2/.default"],A=new Set;for(let a of["https://esign.svc.cloud.dev.microsoft","https://esign.svc.cloud.microsoft","9471276c-aa67-4dd2-bde2-291a033f3c3c","396ef0b6-ae1c-4404-86ce-0a869d4d2987",k.c])A.add(a);var B=c(60),C=c(59),D=c(36),E=c(13),F=c(278),G=c(546);let H=d.Ov.isActivated("14B745EB-1E25-4510-8F86-1E531232E670");var I=c(445),J=c(216);let K=(0,d.hl)("acquireTokenFetcher",class{getToken(a){let{name:b,resource:c,tokenType:e,apiQosName:f}=a;if(!d.Ov.isActivated("3985CFAD-51BE-4D3E-A7F9-F1C2ADFD85E4","09/18/2023","Validate that self-signed resource is in tenant")){let a=new E.b({context:this._pageContext}).getUrlParts({webUrl:c});if("SPO"===e&&a.geoRelation===E.a.unknown)throw new d.lM({code:"InvalidTenantForSelfSignedToken"})}let g=this._apiUrlHelper.build().segment("SP.OAuth.Token").method("Acquire").toString();return(0,G.b)(`AcquireTokenFetcher.GetToken.${b} (${f})`,void 0,!0),this._dataRequestor.getData({url:g,webAbsoluteUrl:this._pageContext.webAbsoluteUrl,method:"POST",qosName:`AcquireToken.getToken.${b}`,qosObjectType:f,additionalHeaders:{Accept:"application/json;odata.metadata=minimal","Odata-Version":"4.0"},allowOAuth:!1,noRedirect:H?void 0:this._noRedirect,parseResponse:(a,b)=>{let c=JSON.parse(a),d=b.getCorrelationId();return{...c,correlationId:d}},additionalPostData:JSON.stringify({resource:c,tokenType:e}),telemetryHandler:a=>{let{errorData:b,eventData:c}=a,e=c;if(b){let{code:a}=b;if(a&&(a.indexOf("0x80070005")>-1||a.indexOf("10012")>-1))if(d.Ov.isActivated("CA0F7D1A-8CFF-448C-9522-D43AFF8278E2"))return{eventData:{...c,resultType:D.a.ExpectedFailure}};else e=(0,F.c)(e,{resultType:D.a.ExpectedFailure})}return f&&(e=(0,F.c)(e,{objectType:f})),{eventData:e}}}).then(a=>((0,G.a)(`AcquireTokenFetcher.GetToken.${b} (${f})`,"Succeeded",void 0,!0),a)).catch(a=>{throw(0,G.a)(`AcquireTokenFetcher.GetToken.${b} (${f})`,"Failed",void 0,!0),a})}constructor(a,b){const{cookieRefresher:c,pageContext:e,noRedirect:f=!d.Ov.isActivated("22A14184-8C68-4EA3-8CA6-09C8A9009A71")||void 0}=b;this._pageContext=e,this._noRedirect=f;const g=c?{getFormDigest:async a=>{await c.refreshCookies({resource:a.url,url:a.url,expiration:a.expiration,claimsChallenge:a.claimsChallenge,apiQosName:a.apiQosName})}}:void 0;this._dataRequestor=new C.a({qosName:"IdentityDataSource",normalizeErrors:!0},{pageContext:e,tokenProvider:g,noRedirect:f}),this._apiUrlHelper=new B.a({webAbsoluteUrl:e.webAbsoluteUrl})}},{pageContext:e.a,cookieRefresher:I.a.optional,noRedirect:J.a}),L=!d.Ov.isActivated("3CA3181A-AA3E-4895-BF73-D6089D92C8F5"),M=!d.Ov.isActivated("DDD0B6F7-6461-4DFD-A821-98C1FB34AA32");var N=c(145);let O=(0,d.hl)("spHttpTokenFetcher",class{async getToken(a){let{name:b,resource:c,claimsChallenge:d,expiration:e,apiQosName:f,scopes:g}=a,h=await this._getSpHttpDataSource(),{accessToken:i,expiresOn:k}=await h.fetchTokenData({resource:c,claims:d?.claims,forceRefresh:!!e||"ms-substrate"===b,tokenName:M?b:void 0,apiQosName:L?f:"",...j?{scopes:g}:{}});return{access_token:i,expires_on:k?.toISOString()}}constructor(a,b){this._getSpHttpDataSource=b.getSpHttpDataSource}},{getSpHttpDataSource:N.a.async.lazy.bypass}),P=new d.v7({name:"isMsalSupported",factory:new d.Uo(()=>!0)}),Q=new d.v7({name:"isSubstrateAcquireDisabled",factory:{dependencies:{},create:()=>({instance:()=>(0,h.k)(h.f)})}}),R=new d.v7("enableOdcOnSpoToken"),S=(0,d.hl)("spHttpTokenFetcherWithAcquireFallback",class{async getToken(a){let{scopes:b,tokenType:c}=a;o||p||"oAuth-SA"===a.name||({scopes:b,...a}=a),q||"SPO"!==c||({tokenType:c,...a}=a);let{resource:d}=a;if((0,l.a)(d,{appPageContext:this._appPageContext})){if(this._isMsalSupported()){if(((0,g.a)(h.e)||this._enableOdcOnSpoToken)&&("SPO"===c||"SharePoint"===a.name||"SharePoint_SelfIssued"===a.name||"SharePoint_MSAL"===a.name))return this._enableOdcOnSpoToken?await this._spHttpTokenFetcher.getToken({...a,scopes:this._getOdcScopes(d)}):await this._spHttpTokenFetcher.getToken(a);if("SharePoint_MSAL"===a.name||"oAuth-SA"===a.name)return await this._spHttpTokenFetcher.getToken(a)}return await this._acquireTokenFetcher.getToken(!q?{...a,tokenType:c}:a)}if(this._isMsalSupported()){if(d===this._appPageContext.msGraphEndpointUrl||"ms-graph"===a.name){if(t&&(0,g.a)(h.c)||!n&&b&&(b.indexOf("InformationProtection.Read.All")>-1||b.indexOf("InformationProtectionPolicy.Read")>-1||b.indexOf("Calendars.Read")>-1||!r&&b.indexOf("Sites.Read.All")>-1))return await this._spHttpTokenFetcher.getToken(a);if(!t)if((0,g.a)(h.c))return await this._spHttpTokenFetcher.getToken(a);else return await this._acquireTokenFetcher.getToken(a)}if("SharePoint-mediaGPT"===a.name)return await this._spHttpTokenFetcher.getToken(a);if(t){if(this._isSubstrateAcquireDisabled()&&(d===this._appPageContext.substrateEndpointUrl||"ms-substrate"===a.name||"ms-substrate-search"===a.name||"ms-substrate-sti"===a.name||"ms-substrate-tenant-feedback"===a.name||"ms-substrate-taiger-service"===a.name||"STI"===a.tokenType))return await this._spHttpTokenFetcher.getToken(a)}else if(d===this._appPageContext.substrateEndpointUrl||"ms-substrate"===a.name||"ms-substrate-search"===a.name||"ms-substrate-sti"===a.name||"STI"===a.tokenType)if(this._isSubstrateAcquireDisabled())return await this._spHttpTokenFetcher.getToken(a);else return await this._acquireTokenFetcher.getToken(a);if(t){if(!n&&("az-nb"===a.name||"office-home"===a.name))return await this._spHttpTokenFetcher.getToken(a)}else if("az-nb"===a.name||"office-home"===a.name)if(!n)return await this._spHttpTokenFetcher.getToken(a);else return await this._acquireTokenFetcher.getToken(a);if("ms-designer"===a.name||"ms-mcu"===a.name||"ms-forms"===a.name||"pushchannel"===a.name||"teams-cmd"===a.name||"oAuth-SA"===a.name||"ocps"===a.name||"ms-augloop"===a.name||"ms-substrate-tenant-feedback"===a.name||"ms-substrate-taiger-service"===a.name||"az-rms"===a.name||"power-platform"===a.name||"your-phone"===a.name||"oAuth"===a.name&&A.has(d))return await this._spHttpTokenFetcher.getToken(a);if(t){if((0,g.a)(h.d)&&"SharePoint-media"===a.name)return await this._spHttpTokenFetcher.getToken(a)}else if("SharePoint-media"===a.name)if((0,g.a)(h.d))return await this._spHttpTokenFetcher.getToken(a);else return await this._acquireTokenFetcher.getToken(a);if(t){if(!s&&a.resource===f.a)return await this._spHttpTokenFetcher.getToken(a)}else if(a.resource===f.a)if(!s)return await this._spHttpTokenFetcher.getToken(a);else return await this._acquireTokenFetcher.getToken(a);if(!u){let b=this._appPageContext.farmSettings?.ExternalService_flowservicehostname?`https://${this._appPageContext.farmSettings.ExternalService_flowservicehostname}`:"https://service.flow.microsoft.com";if(new m.a(d).authority===b)if(!v&&!(0,g.a)(h.h))return await this._acquireTokenFetcher.getToken(a);else return await this._spHttpTokenFetcher.getToken(a)}if((0,g.a)(h.b)&&!x[a.name])return await this._spHttpTokenFetcher.getToken({...a,scopes:j&&(0,i.a)(d)?this._getOdcScopes(d):a.scopes})}return j&&(0,i.a)(d)?await this._spHttpTokenFetcher.getToken({...a,scopes:this._getOdcScopes(d)}):await this._acquireTokenFetcher.getToken(a)}_getOdcScopes(a){return(0,g.a)(h.j)&&!(0,i.b)(a)?z:y}constructor(a,b){this._acquireTokenFetcher=b.acquireTokenFetcher,this._spHttpTokenFetcher=b.spHttpTokenFetcher,this._appPageContext=b.appPageContext,this._isMsalSupported=b.isMsalSupported,this._isSubstrateAcquireDisabled=b.isSubstrateAcquireDisabled,this._enableOdcOnSpoToken=b.enableOdcOnSpoToken,!w&&this._appPageContext.farmSettings?.ExternalService_powerappsappshostname&&A.add(`https://${this._appPageContext.farmSettings.ExternalService_powerappsappshostname}`)}},{acquireTokenFetcher:K,spHttpTokenFetcher:O,appPageContext:e.a,isMsalSupported:P,isSubstrateAcquireDisabled:Q,enableOdcOnSpoToken:R.optional}),T=new d.v7({name:"TokenFetcher.key",factory:new d.zO(S)})}
,,(a,b,c)=>{"use strict";c.d(b,{a:()=>i});var d=c("tslib_533"),e=c(92),f=c(65),g=function(a){var b;a&&(null==(b=a.oncancel)||b.call(a),a.isCancelled=!0,a=void 0)},h=function(a,b){var c=a.indexOf(b);return!(c<0)&&(a.splice(c,1),!0)},i=function(){function a(){var a=this;this.internalRun=function(){return(0,d.yv)(a,void 0,void 0,function(){var a,b,c,g,h,i=this;return(0,d.SO)(this,function(j){switch(j.label){case 0:var k;if(this.running=!0,!(a=this.pickTask()))return this.running=!1,[2];return b=a.type,[4,(k=c=a.task,(0,d.yv)(void 0,void 0,void 0,function(){var a,b,c,e;return(0,d.SO)(this,function(d){switch(d.label){case 0:return d.trys.push([0,2,,3]),[4,k.target.apply(null,k.args)];case 1:if(a=d.sent(),k.isCancelled)return[2,!1];return null==(c=k.onsuccess)||c.call(k,a),[2,!0];case 2:return b=d.sent(),null==(e=k.onerror)||e.call(k,b),[2,!1];case 3:return[2]}})}))];case 1:switch(!(g=j.sent())&&f.a.error("AsyncTaskQueue",Error("Failed to execute task of type ".concat(b))),b){case"Micro":h=this.microQueue.findIndex(function(a){return a===c}),this.microQueue.splice(0,h+1);break;case"Normal":this.queue.shift();break;case"PreRender":(!e.a.isActivated("FixPreRenderFailAtNativeRender")||g)&&(this.preRenderTask=void 0);break;case"NonRender":this.nonRenderQueue.shift()}return"PreRender"!==b||e.a.isActivated("ScheduleAsMicroWhenAfterPreRender")?this.internalRun():Promise.resolve().then(function(){i.internalRun()}),[2]}})})},this.microQueue=[],this.queue=[],this.nonRenderQueue=[],this.running=!1}return a.getInstance=function(){return a.instance||(a.instance=new a),a.instance},a.prototype.add=function(a,b,c){c?this.nonRenderQueue.push(a):b?this.microQueue.push(a):this.queue.push(a),this.running||this.run()},a.prototype.poll=function(a,b){return b?this.nonRenderQueue.shift():a?this.microQueue.shift():this.queue.shift()},a.prototype.cancel=function(a){(h(this.nonRenderQueue,a)||h(this.queue,a)||h(this.microQueue,a))&&g(a)},a.prototype.setPreRenderTask=function(a){this.preRenderTask=a,this.running||this.run()},a.prototype.cancelPreRenderTask=function(){g(this.preRenderTask)},a.prototype.run=function(){this.internalRun()},a.prototype.clear=function(){this.cancelPreRenderTask(),a.instance=void 0},a.prototype.pickTask=function(){if(this.preRenderTask&&this.preRenderTask.isPageVisible())return{type:"PreRender",task:this.preRenderTask};if(this.microQueue.length>=1){var a=this.microQueue.length;return{type:"Micro",task:this.microQueue[a-1]}}return this.queue.length>=1?{type:"Normal",task:this.queue[0]}:this.preRenderTask?{type:"PreRender",task:this.preRenderTask}:this.nonRenderQueue.length>=1?{type:"NonRender",task:this.nonRenderQueue[0]}:void 0},a}()}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>e});var d=c(58),e=function(){function a(){}return a.normalizeScale=function(a,b){void 0===b&&(b=1);var c=Math.pow(10,b);return Math.round(a*c)/c},a.normalizeScaleWithMinMaxScale=function(a,b,c){void 0===c&&(c=1);var d=Math.pow(10,c),e=Math.round(b*d)/d;return b/a>=1?Math.min(this._maxScale,e):Math.max(this._minScale,e)},a.setMinMaxScale=function(a,b){this._minScale=a,this._maxScale=b},a._minScale=d.z,a._maxScale=d.y,a}()}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>g,b:()=>f});var d=c("react-lib"),e=d.createContext(void 0),f=function(){return d.useContext(e)},g=function(a){var b=a.children,c=a.enableFormFilling,f=a.formHandler;return d.createElement(e.Provider,{value:{enableFormFilling:c,formHandler:f}},b)}}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>g,b:()=>h});var d=c("tslib_533"),e=c("react-lib"),f=e.createContext(void 0),g=function(a){var b=a.children,c=(0,d.dc)(a,["children"]);return e.createElement(f.Provider,{value:c},b)},h=function(){return e.useContext(f)}}
,,(a,b,c)=>{"use strict";c.d(b,{a:()=>h});var d=c("odsp.util_126"),e=c(2);let f=!d.Ov.isActivated("D3C0DFEB-12A9-4202-B5C5-CC6F8108222A"),g={pageContext:e.a},h=new d.v7({name:"chatODSPPageUrl",factory:{dependencies:g,create:a=>{let b;if(f){let c=new URL(a.pageContext.webAbsoluteUrl);c.pathname=`${a.pageContext.layoutsUrl}/chat.aspx`,b=c.toString()}else b=`${a.pageContext.webAbsoluteUrl}/${a.pageContext.layoutsUrl}/chat.aspx`;return{instance:b}}}})}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>g});var d=c("fui.util_178"),e=c(496);let f={AcceptMedium:"",Accounts:"",Add:"",AddFriend:"",AlertSolid:"",AlignLeft:"",AlignRight:"",AppIconDefault:"",Archive:"",Ascending:"",Attach:"",AutomateFlow:"",Back:"",BackToWindow:"",Blocked12:"",Blocked2:"",BlockedSite:"",BlockedSiteSolid12:"",BooleanData:"",CalculatorAddition:"",CalculatorMultiply:"",Calendar:"",CalendarDay:"",CalendarWeek:"",CalendarWorkWeek:"",Cancel:"",CC:"",CCSolid:"",Chat:"",CheckboxComposite:"",CheckedOutByOther12:"",CheckedOutByYou12:"",CheckMark:"",ChevronDown:"",ChevronDownSmall:"",ChevronLeft:"",ChevronLeftMed:"",ChevronLeftSmall:"",ChevronRight:"",ChevronRightMed:"",ChevronRightSmall:"",ChevronUp:"",ChoiceColumn:"",ChromeClose:"",CircleAdditionSolid:"",CirclePlus:"",CircleRing:"",Clear:"",ClearFilter:"",ClosePaneMirrored:"",CloudPrinter:"",Color:"",Comment:"",CommentAdd:"",CompassNW:"",Completed:"",CompletedSolid:"",Contact:"",Copy:"",CriticalErrorSolid:"",Currency:"",DateTime2:"",Delete:"",Descending:"",Diamond:"",Document:"",DocumentApproval:"",Down:"",Download:"",DynamicList:"",Edit:"",EditListPencil:"",EditNote:"",Embed:"",EntityExtraction:"",Error:"",ErrorBadge:"",ExcelDocument:"",ExcelLogo:"",FabricFolder:"",FabricFolderLink:"",FabricMovetoFolder:"",FabricOpenFolderHorizontal:"",Favicon:"",FavoriteStar:"",FavoriteStarFill:"",Feedback:"",FileRequest:"",Filter:"",Flag:"",Flow:"",Folder:"",FullScreen:"",FullView:"",GenericScan:"",Giftbox:"",Glimmer:"",GlobalNavButton:"",Globe:"",Go:"",GridViewMedium:"",GripperBarVertical:"",GripperDotsVertical:"",GroupedList:"",GroupList:"",Handwriting:"",Heart:"",HeartFill:"",History:"",Home:"",HomeGroup:"",Info:"",InfoSolid:"",LargeGrid:"",Library:"",Lightbulb:"",Link:"",Link12:"",List:"",Lock:"",Mail:"",MailAttached:"",Market:"",Megaphone:"",MicrosoftTranslatorLogo:"",More:"",MoreVertical:"",Number:"",ODLink:"",OneDriveAdd:"",OpenFile:"",OpenFolderHorizontal:"",OpenPane:"",OpenPaneMirrored:"",OutlookLogo:"",Page:"",PDF:"",People:"",PeopleAdd:"",Photo2:"",Pin:"",Pinned:"",PinnedSolid:"",PinSolid12:"",PinSolidOff12:"",PinToTab:"",Play:"",PlayerSettings:"",PlaylistMusic:"",POI:"",PopExpand:"",PowerApps2Logo:"",PowerAutomateLogo:"",PowerPointDocument:"",ReadingMode:"",ReadOutLoud:"",RecycleBin:"",ReminderPerson:"",RemoveFilter:"",Rename:"",Reply:"",Ringer:"",SavedOffline:"",Search:"",SecurityGroup:"",Send:"",Settings:"",Share:"",ShareiOS:"",Signin:"",SingleBookmark:"",SingleBookmarkSolid:"",SingleColumnEdit:"",SkypeCheck:"",SkypeClock:"",SkypeMinus:"",Snooze:"",Sort:"",SortDown:"",SortLines:"",SortUp:"",Speech:"",SpeechOff:"",StackIndicator:"",StatusCircleCheckmark:"",StatusErrorFull:"",Stop:"",Switch:"",SyncStatusSolid:"",SyncToPC:"",Tag:"",TagUnknown12:"",TagUnknown12Mirror:"",Taskboard:"",TeamsLogo:"",TextDocument:"",TextDocumentShared:"",TextField:"",Tiles:"",Trending12:"",UnavailableOffline:"",Undo:"",Uneditable2:"",Unknown:"",Unpin:"",Up:"",Upload:"",View:"",ViewAll:"",ViewList:"",VisioLogo:"",Warning12:"",WarningSolid:"",WordDocument:"",Work:""};function g(a){let b={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons"',src:`url('${e.a}') format('woff')`},icons:f};(0,d.fU)(b,a)}}
,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>d});let d=new(c("odsp.util_126")).v7("CookieRefresher")}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>f,b:()=>j,c:()=>h,d:()=>i});var d=c("tslib_533"),e="ODSPPDF",f="WASM_CACHE",g=[f];function h(a,b,c){return(0,d.yv)(this,void 0,void 0,function(){var e,f;return(0,d.SO)(this,function(d){switch(d.label){case 0:return[4,k()];case 1:return f=(e=d.sent()).transaction([a],"readonly").objectStore(a).get(b),[2,new Promise(function(a,d){f.onerror=function(){e.close(),d("Fail to retreive store by ".concat(b))},f.onsuccess=function(b){var d=b.target.result;d&&d.version===c?(e.close(),a(d.value)):(e.close(),a(void 0))}})]}})})}function i(a,b){return(0,d.yv)(this,void 0,void 0,function(){var c,e;return(0,d.SO)(this,function(d){switch(d.label){case 0:return[4,k()];case 1:return e=(c=d.sent()).transaction([a],"readwrite").objectStore(a).put(b,b.key),[2,new Promise(function(a,d){e.onerror=function(){c.close(),d("Fail to update store by ".concat(b.key))},e.onsuccess=function(){c.close(),a()}})]}})})}function j(a,b){return(0,d.yv)(this,void 0,void 0,function(){var c,e,f;return(0,d.SO)(this,function(d){switch(d.label){case 0:return[4,k()];case 1:return f=(e=(c=d.sent()).transaction([a],"readwrite").objectStore(a)).getAllKeys(),[2,new Promise(function(a,d){f.onsuccess=function(c){var d=c.target.result;null==d||d.forEach(function(a){a.startsWith(b)&&e.delete(a)}),a()},f.onerror=function(){c.close(),d("Fail to get all keys")}})]}})})}function k(){return(0,d.yv)(this,void 0,void 0,function(){var a;return(0,d.SO)(this,function(b){if(!self.indexedDB)throw Error("This browser doesn't support IndexedDB");return a=indexedDB.open(e,1),[2,new Promise(function(b,c){a.onupgradeneeded=function(){var b=a.result;g.forEach(function(a){b.objectStoreNames.contains(a)&&b.deleteObjectStore(a),b.createObjectStore(a)})},a.onerror=function(){c("Fail to open indexeddb ".concat(e))},a.onsuccess=function(){b(a.result)}})]})})}}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>l,b:()=>k,c:()=>j});var d=c("tslib_533"),e=c("react-lib"),f=c.n(e),g={isVisible:!1},h=(0,e.createContext)(g),i=(0,e.createContext)(function(){}),j=function(){return f().useContext(h)},k=function(){var a=f().useContext(i);return(0,e.useCallback)(function(b){a(function(a){return(0,d.q5)((0,d.q5)({},a),b)})},[a])},l=function(a){var b=a.children,c=(0,d.pM)((0,e.useState)(g),2),j=c[0],k=c[1];return f().createElement(i.Provider,{value:k},f().createElement(h.Provider,{value:j},b))}}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>f,b:()=>g});var d=c(92),e=c(449),f="textField",g=function(){var a,b=null==(a=document.activeElement)?void 0:a.className;return d.a.isActivated("EnableCJKInFormTextField")?b===e.b:b===e.a||b===f}}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>f,b:()=>e,c:()=>d}),(0,c("fui.util_178").ZW)([{rawString:".page_363c865a{position:absolute;left:50%;-webkit-transform:translate(-50%, 0);transform:translate(-50%, 0);background-color:rgba(0,0,0,0)}.pageText_363c865a{position:absolute;width:100%;height:100%}.formOverlay_363c865a{position:absolute;width:100%;height:100%}"}]);let d="page_363c865a",e="pageText_363c865a",f="formOverlay_363c865a"}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>g});var d=c("tslib_533"),e=c(86),f=c("react-lib");(0,c("fui.util_178").ZW)([{rawString:'.inputWrapper_e17f0b58{display:inline-block;height:100%}input{height:24px;border:1px solid;border-radius:2px;background-color:"#ffffff";color:"#323130"}input:focus{outline:none}'}]);var g=function(a){var b=a.visible,c=a.autoFocusOnInput,g=a.onEnterWhenFocused,h=a.onShiftEnterWhenFocused,i=a.inputProps,j=a.rootProps,k=a.outerRef,l=a.children,m=(0,d.pM)(f.useState(!1),2),n=m[0],o=m[1],p=f.useRef(null),q=f.useRef(null),r=(0,e.a)();f.useEffect(function(){var a,d;b&&c&&(null==(a=p.current)||a.focus(),o(!0),null==(d=q.current)||d.focus())},[c,b]);var s=f.useCallback(function(a){var b,c;switch(a.key){case"Enter":q.current===document.activeElement?a.shiftKey?null==h||h():null==g||g():(o(!0),null==(b=q.current)||b.focus());break;case"Escape":o(!1),null==(c=p.current)||c.focus(),a.stopPropagation(),a.preventDefault()}},[g,h]),t=f.useCallback(function(a){var b;null==(b=i.onBlur)||b.call(i,a),o(!1)},[i]);return f.createElement("div",{ref:k,className:"inputWrapper_e17f0b58"},f.createElement("div",(0,d.q5)({},j,{ref:p,"data-is-focusable":!0,onKeyDown:s}),f.createElement("input",(0,d.q5)({},i,{ref:q,style:{borderColor:r.semanticColors.inputBorder,backgroundColor:r.semanticColors.inputBackground,color:r.semanticColors.inputText},"data-is-focusable":n,onBlur:t})),f.createElement("style",null,"::placeholder {color: ".concat(r.semanticColors.inputPlaceholderText,"; }")),l))};g.defaultProps={visible:!0,autoFocusOnInput:!1}}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>f});var d=c(65),e="LocalStorageHelper",f=function(){function a(){}return a.setItem=function(a,b){try{return localStorage.setItem(a,b),!0}catch(a){return d.a.error(e,a),!1}},a.getItem=function(a){try{return localStorage.getItem(a)}catch(a){return d.a.error(e,a),null}},a.setBooleanItem=function(a,b){return this.setItem(a,b.toString())},a.getBooleanItem=function(a){return"true"===this.getItem(a)},a}()}
,(a,b,c)=>{"use strict";c.r(b),c.d(b,{oneDriveDataSourceKey:()=>g});var d=c("odsp.util_126"),e=c(487),f=c(2);let g=new d.v7({name:"OneDriveDataSource.key",factory:{dependencies:{pageContext:f.a},create:({pageContext:a})=>{let b=new e.a({},{pageContext:a});return{instance:b,disposable:b}}}})}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>e});var d=c("odsp.util_126");let e=new d.v7({name:"isBizChatEnabled",factory:new d.Uo(()=>!1)})}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>d});let d=new(c("odsp.util_126")).v7("VroomDataRequestor")}
,,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>h});var d=c("odsp.util_126"),e=c(99),f=c(460),g=c(461);let h=new d.v7({name:"isOfflineStateObservable.key.isOfflineStateObservable",factory:{dependencies:{offlineDetection:e.a},create:a=>{let b=new f.a,c=new g.a(a.offlineDetection.offline);return b.attach(a.offlineDetection.onChange(a=>{c.set(a)})),{instance:c,disposable:b}}}})}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>e});var d=c(164);d.a.prototype.trackPromise=function(a){let b=!1,c=this.attach({dispose:()=>{!b&&a.cancel&&a.cancel()}}),d=()=>{b=!0,c.dispose()};return a.done(d,d),a},d.a.prototype.trackSignal=function(a){return this.attach({dispose:()=>{a.cancel()}}),a};let e=d.a}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>f});var d=c("odsp.util_126"),e=c(548);let f=d.Ov.isActivated("544e04a1-a11f-4d23-aedf-80ecb02d2818")?class{get(){return this._value}set(a){this._value=a,this._observers.forEach(a=>{a()})}subscribe(a){return this._observers.add(a),()=>{this._observers.delete(a)}}constructor(a){this._value=a,this._observers=new Set}}:class{get(){return this._observableValue.value}set(a){this._observableValue.value=a}subscribe(a){return this._observableValue.subscribe(a,"set"),()=>{this._observableValue.unsubscribe(a,"set")}}constructor(a){this._observableValue=new e.a(a)}}}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>e});var d=c("odsp.util_126");let e=new d.v7({name:"cookieOrigin",factory:new d.Uo(window.location.origin)})}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>f});var d=c(568),e=c(464);let f=function(a,b,c){var f=(a=a||{}).random||(a.rng||d.a)();if(f[6]=15&f[6]|64,f[8]=63&f[8]|128,b){c=c||0;for(var g=0;g<16;++g)b[c+g]=f[g];return b}return(0,e.a)(f)}}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>g});for(var d=c(465),e=[],f=0;f<256;++f)e.push((f+256).toString(16).substr(1));let g=function(a){var b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,c=(e[a[b+0]]+e[a[b+1]]+e[a[b+2]]+e[a[b+3]]+"-"+e[a[b+4]]+e[a[b+5]]+"-"+e[a[b+6]]+e[a[b+7]]+"-"+e[a[b+8]]+e[a[b+9]]+"-"+e[a[b+10]]+e[a[b+11]]+e[a[b+12]]+e[a[b+13]]+e[a[b+14]]+e[a[b+15]]).toLowerCase();if(!(0,d.a)(c))throw TypeError("Stringified UUID is invalid");return c}}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>e});let d=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,e=function(a){return"string"==typeof a&&d.test(a)}}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>g,b:()=>f});var d=c("react-lib"),e=d.createContext(void 0),f=function(){return d.useContext(e)},g=function(a){var b=a.children,c=a.undoRedoService;return d.createElement(e.Provider,{value:{undoRedoService:c}},b)}}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>j,b:()=>k});var d=c("tslib_533"),e=c("react-lib"),f=c(220),g=e.createContext(void 0),h={dirty:!1},i=function(a,b){var c;return b.type===f.a.Reset?h:{dirty:!0,annotTypeOfLatestEdit:null==(c=b.payload)?void 0:c.annotType}},j=function(a){var b=a.children,c=(0,d.pM)(e.useReducer(i,h),2),f=c[0],j=c[1],k=e.useMemo(function(){return{editState:f,dispatchEditAction:j}},[f]);return e.createElement(g.Provider,{value:k},b)};g.Consumer;var k=function(){return e.useContext(g)}}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>f});var d=c("odsp.util_126"),e=c(28);function f(){return!d.Ov.isActivated("702E9983-B7E6-47C0-A412-6E557D0A20C9")&&(0,e.a)({ODB:60342})}d.Ov.isActivated("96723D41-0476-4E60-A02D-199517143E81","11/10/2020","Allow ADAL as fallback for OAuth token requests")}
,(a,b,c)=>{"use strict";a.exports=c(204)}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>d});let d=new(c("odsp.util_126")).v7("engagementHandlers")}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>d});let d=new(c("odsp.util_126")).v7("getOneUpOnePlayerResources")}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>h,b:()=>i});var d=c(47);let e=c(41).a.local,f="copilotLicenseStore",g=new d.a(f,e);function h(){try{return g.getValue(f)??!1}catch(a){return!1}}function i(a){try{g.setValue(f,a)}catch(a){}}}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>e});var d=c("odsp.util_126");let e=new d.v7({name:"swapCobOnSpoDomainWithMpc",factory:new d.Uo(!1)})}
,,(a,b,c)=>{"use strict";let d,e,f,g,h,i,j,k,l,m,n;var o,p,q,r,s,t,u,v,w,x,y,z,A,B,C=c(493),D=c(494),E=c(9),F=c(250);C.a.initializeTheme({webThemeProvider:a=>new D.a({pageContext:a,getThemeDataSource:()=>new E.c((b,d)=>{window.require.specified("@msinternal/odsp-datasources/lib/dataSources/theming/spList/WebThemeDataSource"),c.e(88).then(c.bind(c,786)).then(F.a).then(c=>{b(new c(a))})})})});var G=c(442),H=c("fui.util_178"),I=c(497),J=c(498),K=c("odsp.util_126");(0,G.a)();let L={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"FabricMDL2Icons"',src:`url(${I.a}) format('woff')`},icons:{PinOff:"",PinNavMenu:"",PinOffSolid:"",PinSolid:""}};(0,H.fU)(L);let M={style:{MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",fontStyle:"normal",fontWeight:"normal",speak:"none"},fontFace:{fontFamily:'"App Icons"',src:`url('${J.a}') format('woff')`},icons:{SharePointLogo:"",SharePointLogoInverse:"",TeamsLogo:"",TeamsLogoInverse:"",OutlookLogo:"",OutlookLogoInverse:"",OneDriveLogo:"",WordLogo:"",WordLogoInverse:"",ExcelLogo:"",ExcelLogoInverse:"",PowerPointLogo:"",PowerPointLogoInverse:"",OneNoteLogo:"",OneNoteLogoInverse:"",DefenderApp:""}};if(K.Ov.isActivated("b79a8b93-9904-471d-af54-d53545352fbd"))(0,H.mi)(Object.keys(M.icons));else{let a=H.RZ.getValue("icons"),b=Object.keys(M.icons).map(a=>a.toLowerCase()).filter(b=>a?.[b]);(0,H.mi)(b)}(0,H.fU)(M,{disableWarnings:!0});var N=c("react-lib"),O=c.n(N),P=c(515),Q=c(516),R=c(499),S=c(500),T=c(501),U=c(502),V=c(503),W=c(504),X=c(505),Y=c(506),Z=c(507),$=c(508),_=c(509),aa=c(510),ab=c(511),ac=c(421);let ad=`${H.fG}/`,ae=(0,ac.b)(`${ad}`),af=`${ad}office-ui-fabric-react-assets/foldericons`,ag=`${ad}assets/brand-icons/product/`,ah=Y.a,ai=Z.a;var aj=c(513),ak=c(514);(0,P.a)(ae,{disableWarnings:!0}),(0,Q.a)(af,{disableWarnings:!0}),(0,R.a)(ag,{disableWarnings:!0}),o={disableWarnings:!0},(0,H.fU)({fontFace:{},style:{width:12,height:12,overflow:"hidden"},icons:{shortcutBadge12:N.createElement("img",{alt:"",src:S.a})}},o),(0,H.fU)({fontFace:{},style:{width:16,height:16,overflow:"hidden"},icons:{shortcutBadge16:N.createElement("img",{alt:"",src:T.a})}},o),(0,H.fU)({fontFace:{},style:{width:20,height:20,overflow:"hidden"},icons:{shortcutBadge20:N.createElement("img",{alt:"",src:U.a})}},o),(0,H.fU)({fontFace:{},style:{width:12,height:12,overflow:"hidden"},icons:{shortcutBadge12_dark:N.createElement("img",{alt:"",src:V.a})}},o),(0,H.fU)({fontFace:{},style:{width:16,height:16,overflow:"hidden"},icons:{shortcutBadge16_dark:N.createElement("img",{alt:"",src:W.a})}},o),(0,H.fU)({fontFace:{},style:{width:20,height:20,overflow:"hidden"},icons:{shortcutBadge20_dark:N.createElement("img",{alt:"",src:X.a})}},o),(0,Y.b)(ah,{disableWarnings:!0}),(0,Z.b)(ai,{disableWarnings:!0}),(0,$.a)({disableWarnings:!0}),(0,_.a)({disableWarnings:!0}),(0,aa.a)({disableWarnings:!0}),(0,ab.a)({disableWarnings:!0}),(0,H.fU)({icons:{errorExclamation:N.createElement("img",{src:aj.a,alt:""}),errorExclamationDark:N.createElement("img",{src:ak.a,alt:""})}}),c.e(23).then(c.bind(c,787)).then(({initializeIcons:a})=>{a({disableWarnings:!0},!0)}).catch(a=>{console.error("Icons error",a)}),c("react-dom-lib");var al=c(765),am=c(517),an=c(2),ao=c(231),ap=c(20),aq=c(153),ar=c(72),as=c(550),at=c(98),au=c(97),av=c(551),aw=c(423),ax=c(15),ay=c(552);let az={crossDomainImageHelper:(0,K.hl)("ThumbnailHelper.crossDomainImageHelper",ay.a,{apiUrlHelper:aw.a}),itemUrlHelper:ax.c},aA=new K.v7({name:"ThumbnailHelper",factory:{dependencies:az,create:a=>{let b=new ay.b(a);return{instance:b,disposable:b}}}});var aB=c(290),aC=c(57);let aD=(0,K.hl)("MetaDataProcessor",aB.a,{pageContext:an.a,platformDetection:aC.a});var aE=c(553),aF=c(17),aG=c(233);let aH=new K.v7({name:"updateThumbnailUrlCallback",factory:{dependencies:{},create:a=>({instance:function(a,b){a.itemsWaitingForCookies.map(c=>{let{itemKey:d}=c,e=(0,ar.c)().consume(aF.b),f=e?.getOneUpProperties();if(f&&d===f.focusItem.key){let g=b.authTokenV21,h=b.proofTokenV21,i=c.thumbnailUrl+`&access_token=${g}&prooftoken=${h}`,j=a.thumbnailHelper.getThumbnail({baseUrl:i,itemKey:d,fileExtension:c.fileExtension,mediaServiceMetadata:c.mediaServiceMetadata});if(j){let a={...f.focusItem};a.thumbnail=aG.replace(j),e.update({focusItem:a},"AuthCookieHelperUpdateThumbnail")}}})}})}}),aI=(0,K.hl)("AuthCookieHelper",aE.a,{thumbnailHelper:aA,platformDetection:aC.a,updateThumbnailUrlCallback:aH});var aJ=c(554);let aK=(0,K.hl)("AuthTokenStore",aJ.a,{}),aL=new K.FF(av.a,{pageContext:an.a,thumbnailHelper:aA,metaDataProcessor:aD,authCookieHelper:aI,authTokenStore:aK}),aM=new K.v7({name:"MicroServiceDataSource",factory:aL});var aN=c(217);let aO=new K.v7({name:"ItemCommentsDataSource.key",loader:new K.dE(()=>c.e(47).then(c.bind(c,795)).then(a=>a.resourceKey))});var aP=c(885);let aQ=new K.v7({name:"PeoplePickerDataSource.async.key",loader:new K.dE(()=>c.e(81).then(c.bind(c,796)).then(a=>a.resourceKey))});(0,H.ZW)([{rawString:"div[class*=OneUpModalSizing]>div.ms-Dialog-main{height:100vh!important;height:100dvh!important;width:100vw!important;max-width:unset!important;max-height:unset!important;min-height:unset!important;border-radius:0!important}div[class*=OneUpSafariMobile]>div.ms-Dialog-main{height:100%!important}"}]);var aR=c(735),aS=c(555),aT=c(83),aU=c(292),aV=c(107),aW=c(413),aX=c(168),aY=c(23),aZ=c(114),a$=c(113);(0,H.ZW)([{rawString:".OneUpHtml_54b8a18c{position:absolute;top:0;left:0;right:0;bottom:0;margin:20px 20px;-webkit-overflow-scrolling:touch}.OneUpHtmlIOS_54b8a18c{overflow:auto;position:absolute;top:0;left:0;right:0;bottom:0;margin:20px 20px;-webkit-overflow-scrolling:touch}.OneUpHtmlIFrame_54b8a18c{width:100%;height:100%;background-color:#fff;border:0;box-shadow:0 0 7px 2px rgba(0,0,0,.15);overflow:auto;-webkit-overflow-scrolling:touch}.OneUpHtmlNewDesign_54b8a18c{position:absolute;top:0;width:75%;bottom:0;left:0;right:0;margin:auto;text-align:center;-webkit-overflow-scrolling:touch}"}]);var a_=c(293),a0=c(480),a1=c(558),a2=c(10);function a3(a,b){if(a)try{return a.getResponseHeader(b)||void 0}catch(a){}}var a4=c(4),a5=c(303),a6=c(118),a7=c(300),a8=c(295),a9=c(162);function ba(a){let{item:b}=a,c=(0,ar.c)(),d=N.useRef();if(!b)return N.createElement(N.Fragment,null);let e=c.consume(a2.f),f=c.consume(aC.a).isIOS,g=c.consume(a0.downloadDataSourceKey),[h,i]=N.useState(!1),[j,k]=N.useState(),[l,m]=N.useState(),[n,o]=N.useState(!1),p=N.createRef(),q=N.useRef(),r=c.consume(a9.a);N.useEffect(()=>()=>{l&&window.URL.revokeObjectURL(l)},[]),N.useEffect(()=>{if(f&&p&&p.current){let{clientWidth:a,clientHeight:b}=p.current;p.current.style.width=`${a}px`,p.current.style.height=`${b}px`}},[p]);let s=b=>{let{extension:c}=b||a.item,d=c&&c.toLowerCase();return!!d&&(".htm"===d||".html"===d||".svg"===d)},t=b=>{if((0,a4.oc)())return!1;if(a.item.htmlConversion&&!s()){let a=b.extraData.status;if(b.code.indexOf("406")>=0||a&&a.toString().indexOf("406")>=0)return!0}return!1},u=(c,f,g)=>{let h=f?(0,aV.o)(f):"",i=new K.lM({code:c.name,message:c.message,extraData:{...g,rawError:JSON.stringify(c).concat(`, ${h}`)}});if(f)try{let a,b="",d="";if(f){b=c.name.concat("."+f.code),d=c.message.concat("."+f.message);let e="error";if(f.data&&f.data[e])try{let c=f.data[e];b=b.concat("."+c?.code).concat("."+f?.status),d=d.concat("."+c?.message?.value).concat("."+f?.statusText),a=c.stack}catch(a){}}i=new K.lM({code:b,message:d,isExpected:t(i),correlationId:f?.correlationId,extraData:{...i.extraData,status:f?.status,statusText:f?.statusText,stack:a}})}catch(a){try{i=new K.lM({code:c.name.concat("."+f.name),message:c.message.concat("."+f.message),isExpected:t(i),extraData:{...i.extraData}})}catch(a){}}e.updateErrorState("oneupHtmlViewer",{errorType:aV.d.viewerInitLoadingError,error:i,item:b,meTAEvent:d.current,extraData:{noTempAuth:q.current}}),a.fallbackToOtherViewer&&a.fallbackToOtherViewer(i,"HTMLViewer")},v=(a,d)=>{let e=c.consume(a$.a);return a?.url&&!d?.forceRefresh?Promise.resolve({shouldRetryForceToken:!1,url:a?.url}):e.getAuthenticationParams(b,d).then(a=>({shouldRetryForceToken:!1,url:`${e.getItemUrl(b,{useDirectEndpoint:!0})}/content?format=html&${(0,aY.a)(a)}`})).catch(a=>{if(a&&a instanceof Error&&"AccessExpired"===a.name)return{shouldRetryForceToken:!0};try{let b;if(a&&a instanceof XMLHttpRequest){b=a?(0,a6.d)(a):void 0;let c=JSON.parse(a.responseText);if(c.error?.code==="unauthenticated"&&c.error?.innererror?.code==="AccessExpired")return{shouldRetryForceToken:!0}}let c=(0,aV.i)("error getting auth params for graph html conversion","HTMLGraphAuthParamError");return u(c,a,{...b}),{shouldRetryForceToken:!1}}catch{return u((0,aV.i)("error getting auth params parsed error for graph html conversion","HTMLGraphAuthParamParseError"),a),{shouldRetryForceToken:!1}}})},w=(a,b)=>(q.current=!(0,a8.a)(a),aZ.a.startAndPostProcess({url:a,headers:b},(a,b)=>a.responseText)),x=async a=>{let{extension:e,htmlConversion:f}=a,h=!1;if((0,a4.oc)()){let a=e&&e.toLowerCase();h=".htm"===a||".html"===a||".svg"===a}else h=s(a);if(!f||h)return d.current=void 0,g.getItemContents(b).then(a=>a1.c(a,"text/html").then(a=>a.text).catch(a=>{throw u((0,aV.i)("error parsing content from blob","HTMLParseContentBlobError"),a),Error()})).catch(a=>{throw u((0,aV.i)("error getting item content from download datasource","HTMLGetItemContentsError"),a),Error()});if((0,a4.nc)()){let a,b=!1;if(f.url){let d=c.consume(a5.a);if(a=await d(),!r)try{let a=f.url?.split("access_token=")[1].split("&")[0];if(a){let c,d,e=(c=a.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),d=decodeURIComponent(window.atob(c).split("").map(function(a){return"%"+("00"+a.charCodeAt(0).toString(16)).slice(-2)}).join("")),JSON.parse(d)),f=Date.now();e.exp&&f-1e3*parseInt(e.exp,10)>=198e5&&(b=!0)}}catch(a){u((0,aV.i)("error parsing JWT token from htmlConversion url param","HtmlTokenHtmlConversionUrlError"),a)}}(0,a6.b)(f.url)&&(d.current=(0,a7.a)(aX.a.Html));let e=v(f,{forceRefresh:!!b});return Promise.resolve(e).then(b=>b.url?w(b.url,a):Promise.resolve(void 0)).catch(a=>{if(a){let b={};try{if(a&&a instanceof XMLHttpRequest&&f){b=a?(0,a6.d)(a):{};let d=JSON.parse(a.responseText);if(d.error?.code==="unauthenticated"&&d.error?.innererror?.code==="AccessExpired"){let a=!!f.url,d=a&&r?e:v(void 0,{forceRefresh:!0});return Promise.resolve(d).then(async b=>{let d;if(a){let a=c.consume(a5.a);d=await a({forceRefresh:!0})}return b.url?w(b.url,d):Promise.resolve(void 0)}).catch(a=>{let c=(0,aV.i)("error reattempting to get item conversion content url with token retry without htmlConversion prop","HTMLUrlPromiseTokenRetryWithoutHtmlConvError");return u(c,a,{...b}),Promise.resolve(void 0)})}}let d=(0,aV.i)("error getting graph html conversion","HtmlConversionError");return u(d,a,{...b}),Promise.resolve(void 0)}catch{return u((0,aV.i)("error getting parsed error for graph html conversion","HTMLGraphHtmlConversionParseError"),a,{...b}),Promise.resolve(void 0)}}u((0,aV.i)("error calling to get item html content conversion ","HTMLConversionGeneralError"))})}{let a=c.consume(a$.a);return Promise.resolve(f.url||a.getAuthenticationParams(b).then(c=>`${a.getItemUrl(b,{useDirectEndpoint:!0})}/content?format=html&${(0,aY.a)(c)}`)).then(a=>aZ.a.startAndPostProcess({url:a},(a,b)=>a.responseText))}};N.useEffect(()=>{h||x(b).then(a=>{if(a)if((0,a_.a)())k(a),i(!0);else{let b,c=new Blob([a],{type:"text/html"});try{b=window.URL.createObjectURL(c),m(b),i(!0)}catch(a){u((0,aV.i)("error creating object url from blob","HTMLCreateObjectUrlError"),a)}}else u((0,aV.i)("empty html file content","HTMLEmptyContentError"))},c=>{let f=aV.d.genericViewerLoadingError;if(c instanceof XMLHttpRequest){var g;let a,h,i,j=(g=[406],a=c&&c.status,h=c&&g&&-1!==g.indexOf(a),i=a3(c,"x-errorcode")||a3(c,"x-clienterrorcode"),new K.lM({isExpected:h,code:i||a.toString(),message:JSON.stringify(c.response)}));f="HTMLErrorProcessingContent",e.updateErrorState("oneupHtmlViewer",{errorType:aV.d.viewerInitLoadingError,error:j,item:b,meTAEvent:d.current,extraData:{noTempAuth:q.current}})}else f="HTMLErrorRetrievingContent",e.updateErrorState("oneupHtmlViewer",{errorType:aV.d.viewerInitLoadingError,error:c,item:b,meTAEvent:d.current,extraData:{noTempAuth:q.current}});a.fallbackToOtherViewer&&a.fallbackToOtherViewer(Error(f),"HTMLViewer")})},[h,b]);let y=(0,aT.a)(()=>{n||(a.onViewerLoaded&&a.onViewerLoaded({meTAEvent:d.current,extraData:{noTempAuth:q.current}}),o(!0))}),z=(0,aT.a)(b=>{0===a.offset&&u((0,aV.i)(`${b.type} - Error loading HTML viewer`,`${b.type} - HTMLIframeLoadError`))});return h&&b?N.createElement("div",{className:f?"OneUpHtmlIOS_54b8a18c":"OneUpHtmlNewDesign_54b8a18c"},N.createElement("iframe",{ref:p,className:"OneUpHtmlIFrame_54b8a18c",sandbox:"",title:b.name,frameBorder:"0",src:l,srcDoc:j,onLoad:y,onError:z})):N.createElement(N.Fragment,null)}var bb=c(22),bc=c(42),bd=c(100);let be=K.Ov.isActivated("441dc3a7-bbe8-456c-91fd-59e0e22bb611","08/26/2024","Add subpath for mpc in swproxy url to make it be processed in the farm where the user mysite is"),bf=(0,K.hl)("WorkerDataSource",class{getWorkerUrl(a,b){let c=this._window,d=`${c.location.protocol}//${c.location.host}`,e=new bc.a(a);if(b||e.authority!==d){let e=new bc.a(this._webAbsoluteUrl);if(d===e.authority&&this._isEmbed){if(b){let a=be||"https://my.microsoftpersonalcontent.com"!==d?"":e.path;return`${d}${a}/_layouts/15/odspserviceworkerproxy.aspx?swManifestName=${encodeURIComponent(b)}&debug=false&bypass=false`}return`${d}/_layouts/15/serviceworkerproxy.aspx?serviceWorkerUrl=${encodeURIComponent(a)}`}{let b=this._urlCache;if(b[a])return b[a];let d=c.URL.createObjectURL(new Blob([`importScripts(${JSON.stringify(a)});`],{type:"text/javascript"}));return b[a]=d,d}}return a}dispose(){let a=this._urlCache;for(let b in a)a.hasOwnProperty(b)&&this._window.URL.revokeObjectURL(a[b])}constructor(a,b){this._urlCache={};const{window:c=window,urlDataSource:d,navigation:e}=b;this._window=c,this._webAbsoluteUrl=b.pageContext.webAbsoluteUrl;const f=d.getPageType(e.viewParams);this._isEmbed=f===bd.a.Embed}},{pageContext:an.a,urlDataSource:au.a,navigation:ap.a});var bg=c(182),bh=c(79),bi=c(92),bj=c(85),bk=c(482),bl=c(570),bm=c(161),bn=c(62),bo=c(559),bp=c(0),bq=c(32),br=c(116);let bs="OpenPdfInBrowserAction",bt={pageContext:an.a,oneUpStore:aF.b,navigation:ap.a,platform:aC.a,oneUpStateStore:a2.f},bu=new K.v7({name:"OpenPdfInBrowserAction",factory:{dependencies:bt,create:a=>({instance:{evaluateAction:b=>{var c,d;return{isAvailable:(c=b.item,d=a.oneUpStateStore.currentAppState.isTeamsFileScenario,(0,a4.Db)()?!!c&&bv(c)&&c.extension?.toLowerCase()===".pdf":!!c&&bv(c)&&c.extension?.toLowerCase()===".pdf"&&!d),id:bs,onExecute:async()=>{let{item:c}=b,d=c.openUrl;if(d)return a.navigation.navigateTo({url:d,frameId:"_blank"}),{resultType:bp.b.Success};{let b=(0,aV.i)("no url");throw a.oneUpStateStore.updateErrorState(bs,{errorType:aV.d.actionError,error:b,item:c}),b}}}}}})}});function bv(a){return!!(a&&a.extension&&a.openUrl&&a.itemStatus!==br.b.ConditionalAccessViewOnly&&a.itemStatus!==br.b.ConditionalAccessBlocked&&bq.a.hasItemPermission(a,bq.a.openItems))}var bw=c(43),bx=c(110),by=c(31),bz=c(108),bA=c(120);let bB=(0,bA.a)(async()=>(await c.e(26).then(c.bind(c,801))).MalwareDetectedDialog),bC={oneUpStateStore:a2.f},bD=new K.v7({name:"ShowMalwareDetectedAction",factory:{dependencies:bC,create:a=>({instance:function(b){try{let c=N.createElement(bB,b);a.oneUpStateStore.updateModalState("showMalwareDetectedDialog",{showModal:!0,content:c})}catch(b){throw a.oneUpStateStore.updateErrorState("showMalwareDetectedDialog",{errorType:aV.d.actionError,error:b,item:void 0}),b}}})}});var bE=c(288),bF=c(119),bG=c(170),bH=c(561);let bI="DownloadAction",bJ={pageContext:an.a,oneUpStore:aF.b,downloadDataSource:a0.downloadDataSourceKey,graphDataSource:a$.a,oneUpStateStore:a2.f,showMalwareDetectedDialog:bD,navigation:ap.a,itemUrlHelper:ax.c},bK=new K.v7({name:"DownloadAction",factory:{dependencies:bJ,create:a=>({instance:{evaluateAction:b=>({isAvailable:bL({item:b.item,appLevelPagecontext:a.pageContext,itemUrlHelper:a.itemUrlHelper,remoteWebPageContexts:a.oneUpStore.pageContexts,oneUpStateStore:a.oneUpStateStore}),id:bI,onExecute:async()=>{let b=a.oneUpStore.getOneUpProperties(),c=b?.focusItem;if(c?.lifeCycleStatus?.isMalwareDetected===!0){let b={item:c,allowInfectedFileDownload:!!a.pageContext?.allowInfectedDownload,onDismiss:()=>{a.oneUpStateStore.updateModalState("showMalwareDetectedDialog",{showModal:!1,content:void 0})},onDownload:async()=>{let b=a.downloadDataSource.getItemClassicDownloadLink(c);a.navigation.navigateTo({url:b,frameId:"_blank"})}};a.showMalwareDetectedDialog(b)}else if(c&&c.type===bx.a.Folder&&c.urls){let b,d=c.urls[bz.a.itemUrl],e=bE.a?a.graphDataSource.getAccessToken(c):await a.graphDataSource.getAccessToken(c),f=[{name:c.name,size:c.size,docId:`${d}${-1!==d.indexOf("?")?"&":"?"}access_token=${e.accessToken}`,isFolder:!0}],g="";f&&1===f.length&&(g=f[0].name+".zip");let h=c.urls[bz.a.downloadAsZip],i=((b=document.createElement("iframe")).id="zip-download-iframe",b.name=b.id,b.hidden=!0,b);document.body.appendChild(i);let j=document.createElement("form");j.target=i.id,j.method="POST",j.action=h,j.style.display="none";let k=document.createElement("input");k.type="hidden",k.name="files",k.value=JSON.stringify({items:f}),j.appendChild(k);let l=document.createElement("input");l.type="hidden",l.name="guid",l.value=by.a.generate(),j.appendChild(l);let m=document.createElement("input");m.type="hidden",m.name="accessToken",m.value=e.accessToken,j.appendChild(m);let n=document.createElement("input");n.type="hidden",n.name="zipFileName",n.value=g,j.appendChild(n);let o=document.createElement("input");o.type="hidden",o.name="provider",o.value="spo",j.appendChild(o);let p=document.createElement("input");p.type="submit",j.appendChild(p),i.contentWindow?.document.body.appendChild(j),j.submit()}else if(c&&c.type!==bx.a.Folder)await a.downloadDataSource.downloadItems({items:[c]}).then(()=>({resultType:bp.b.Success})).catch(b=>{throw a.oneUpStateStore.updateErrorState("download action",{errorType:aV.d.actionError,error:b,item:c}),b});else{let b=(0,aV.i)("no parent view/item");throw a.oneUpStateStore.updateErrorState(bI,{errorType:aV.d.actionError,error:b,item:c}),b}return{resultType:bp.b.Success}}})}})}});function bL(a){let{item:b,appLevelPagecontext:c,itemUrlHelper:d,remoteWebPageContexts:e,oneUpStateStore:f}=a;if(!b||!b.key||!b.urls||!bG.a&&(0,bF.c)(b.extension)||f&&f.currentAppState&&f.currentAppState.renamedKeyInFastOneUp&&f.currentAppState.renamedKeyInFastOneUp===b.key||b.itemStatus===br.b.ConditionalAccessBlocked||b.itemStatus===br.b.ConditionalAccessViewOnly||b.type===bx.a.OneNote||!bq.a.hasItemPermission(b,bq.a.openItems))return!1;let g=c,h=d.getItemUrlParts(b.key);if(h.fullWebUrl&&h.serverRelativeListUrl){let a={webAbsoluteUrl:h.fullWebUrl,listUrl:h.serverRelativeListUrl};e&&e.get(a)&&(g=e.get(a))}if(g){if((0,a4.jb)()){let a={blockDownloadsExperienceEnabled:!!g.blockDownloadsExperienceEnabled,viewOnlyExperienceEnabled:!!g.viewOnlyExperienceEnabled,itemIsFolder:b.type===bx.a.Folder,itemHasOpenUrl:!!b.openUrl,itemHasAppMap:!!b.appMap},c=(0,bH.a)(a);if(c===br.b.ConditionalAccessBlocked||c===br.b.ConditionalAccessViewOnly)return!1}else if(g.blockDownloadFileTypePolicyEnabled||g.blockDownloadsExperienceEnabled||g.viewOnlyExperienceEnabled)return!1}return!!b.urls[bz.a.downloadAsZip]&&!!b.urls[bz.a.itemUrl]&&0!==b.childCount&&b.type===bx.a.Folder||!b.isRootFolder&&(b.type===bx.a.File||b.type===bx.a.Media||b.type===bx.a.Unknown)}let bM="downloadCommand",bN=new K.v7({name:"DownloadCommand",factory:{dependencies:{downloadActionProvider:bK},create:({downloadActionProvider:a})=>({instance:{id:bM,name:bw.w,title:bw.x,automationId:bM,iconProps:{iconName:"Download"},evaluateAction:a.evaluateAction}})}});var bO=c(306),bP=c(82),bQ=c(252),bR=c(253),bS=c(255),bT=c(225),bU=c(299),bV=c(48),bW=c(80);let bX="OneUpViewer";function bY(a="unknownViwer"){return(0,aq.e)(`oneUp-${a}.start`)}function bZ(a){if(!("number"==typeof a&&isNaN(a)))return{data:a,needFlatten:!0}}class b${initRumoneLogger(){if(this._initialized)return;this._initialized=!0;let a=this._pageContext&&this._pageContext.ariaCollectorUrl?new bc.a(this._pageContext.ariaCollectorUrl).domain:"/Collector/3.0/";this._rumone.startAPIMeasurement({ignore:b=>b.indexOf(a)>=0,getAPIName:a=>a.toLowerCase().indexOf("/RenderListDataAsStream")?"RenderListDataAsStream":""})}logRumonePerformance(a,b){let{viewerName:c,clientId:d,extension:e,fileSizeRange:f,embedStartLoadingTime:g=NaN,viewerStartTime:h=NaN,userClickTime:i=NaN,endTime:j,pageTransType:k,breakDownData:l,oneupScenario:m,isLightSpeed:n,isFullPageLogging:o,isServerSideTransfer:p,isFluentV9:q,isPdfNoTempAuth:r,isPdfUseToken:s,pdfSource:t,mip:u,isAutoOpenCopilotExperimentEnabled:v,isFromSyncClientAutoOpen:w}=a;g=this._regulateTime(g),i=this._regulateTime(i),j=this._regulateTime(j),h=this._regulateTime(h);let x=this._regulateTime(performance.timing.navigationStart),y=this._regulateTime(this._getResponseEnd()),z=this._regulateTime(this._rumone.getMarkerTime("EUPL.AppStart")),A=i;isNaN(A)&&(A=g),isNaN(A)&&(A=x);let B=new bV.b;if(this._rumone&&this._rumone.isRunning()){let C=o?"FullPageLoad":"Load",D=n?0===m?`ODSPEmbedLightSpeed.${C}`:`ODSPOneUpLightSpeed.${C}`:0===m?`ODSPEmbed.${C}`:`ODSPOneUp.${C}`;this._rumone.writeScenarioId(D),this._rumone.addExpectedControl(bX),this._rumone.writePageTransitionType(void 0!==k?k:bR.a.fullPageLoad),this._rumone.collectW3CPerfTimings(),this._rumone.collectW3cResourceTimings();let E=location.href.toLowerCase().indexOf("embed.aspx")>=0;E&&this._pageContext&&this._rumone.collectSPClientFlights(this._pageContext),(0,a4.Cb)()&&a.isFastOneUp&&this._pageContext&&this._rumone.collectSPClientFlights(this._pageContext);let F=new bW.a("OneUpRumOneHelper");if(F.on(this._rumone,"measureTTI",()=>{let c=this._rumone.getPerformanceData();b&&b({EUPL:c.EUPL,TTI:c.TTI}),B.complete({FCI:c.TTI,FMP:c.EUPL,startTiming:this._regulateAbsoluteTime(A),AbsoluteFCI:this._regulateAbsoluteTime(c.TTI+A),AbsoluteFMP:a.endTime}),F.dispose()}),this._rumone.setSettings({TTISettings:{enabled:!0},getStartTime:()=>A}),bS.b){let a=new bS.a({controlId:bX,startTime:A,endTime:j,renderTimeCalculator:this._computeRenderTime,renderTimeRequiredDataChecker:this._checkRenderTimeRequiredDataAvailable});this._rumone.writeControlPerformanceData(a)}else this._rumone.components.reportComponent({id:bX,startTime:A,endTime:j});l={...l,waitForDomReady:Math.round(this._rumone.getMarkerTime("EUPL.AfterWaitForDomReady")-this._rumone.getMarkerTime("EUPL.BeforeWaitForDomReady")),isEmbedASPXHosted:bZ(E),w3cResponseEnd:bZ(y-x),appStart:bZ(z-y),render:bZ(j-z),viewerRenderTime:bZ(j-h),oneUpViewer:bZ(c),oneUpClientId:bZ(d),oneUpFileExtension:bZ(e),oneUpFileSizeRange:bZ(f),beforeOneUpLoading:bZ(x-i),beforeOneUpLoadingIframeCost:bZ(x-g),beforeOneUpLoadingHostCost:bZ(g-i),userClickTime:bZ(i),embedStartLoadingTime:bZ(g),isLightSpeed:bZ(!!n),isServerSideTransfer:bZ(!!p),isFluentV9:bZ(!!q),isPdfNoTempAuth:void 0!==r?bZ(r):void 0,isPdfUseToken:void 0!==s?bZ(s):void 0,pdfSource:t&&bZ(t),mip:void 0!==u?bZ(u):void 0,isAutoOpenCopilotExperimentEnabled:void 0!==v?bZ(v):void 0,isFromSyncClientAutoOpen:bZ(!!w)},this._rumone.writeEUPLBreakdown(JSON.stringify(l))}return B.promise}resetRumOne(){return!this._rumone.isRunning()&&(this._rumone.resetLogger(),!0)}_isDateTime(a){let b=new Date;return a>new Date(b.setDate(b.getDate()-1)).getTime()}_regulateTime(a){return this._isDateTime(a)&&aq.a?a-performance.timing.navigationStart:a}_regulateAbsoluteTime(a){return!this._isDateTime(a)&&aq.a?a+performance.timing.navigationStart:a}_getResponseEnd(){return performance&&performance.timing?window.g_responseEnd&&(performance.timing.responseEnd&&Number(window.g_responseEnd)<performance.timing.responseEnd||!performance.timing.responseEnd)?Number(window.g_responseEnd):performance.timing.responseEnd:NaN}constructor(a,b){this.resetRumOneApiMeasurement=()=>{this._rumone.undoAPIInstrument()},this._computeRenderTime=a=>{if(a){let{startTime:b,endTime:c}=a;if(!isNaN(b)&&null!==b&&!isNaN(c)&&null!==c&&c>b)return c-b}return 0},this._checkRenderTimeRequiredDataAvailable=a=>{if(a){let{startTime:b,endTime:c}=a;return!isNaN(b)&&null!==b&&!isNaN(c)&&null!==c&&c>b}return!1};const{pageContext:c}=b,{loggerName:d="oneup"}=a;this._pageContext=c,this._initialized=!1;const e=(0,bU.a)();this._rumone=bQ.a.getRUMOneLogger({name:d,onLog:(a,b)=>{bT.a.withManager(e).logData({streamName:a,dictionary:b})}}),window.getRumOneForTAB=()=>this._rumone}}(0,K.hl)("OneUpRumoneHelper",b$,{pageContext:an.a.optional});let b_=new K.v7({name:"OneUpRumoneHelper",factory:{dependencies:{pageContext:an.a.optional},create:({pageContext:a})=>({instance:{getOneUpRumoneLogger:b=>new b$(b,{pageContext:a})}})}});var b0=c(51),b1=c(563);let b2=new K.v7({name:"PdfSaveHelper.key",loader:new K.dE(()=>c.e(67).then(c.bind(c,803)).then(a=>a.resourceKey))});(0,H.ZW)([{rawString:".pdfWrapper_d49e1686{position:absolute;width:100%;height:100%}"}]);var b3=c(46),b4=c(304),b5=c(564),b6=c(84),b7=c(565);let b8={scale:1,rotation:0,currentScrollPosition:new b6.a(0,0),originalLayoutSize:{width:0,height:0},originalPageRects:[]},b9=(0,bA.a)(async()=>(await Promise.all([c.e("ondemand.resx"),c.e(18)]).then(c.bind(c,804))).ESignWrapper,{useChildrenAsPlaceholder:!(0,a4.pc)()});var ca=c(64),cb=c(307),cc=c(171),cd=c(566),ce=c(265),cf=c(50);let cg=(0,bA.a)(async()=>(await Promise.all([c.e("ondemand.resx"),c.e(65)]).then(c.bind(c,805))).PdfFilePicker);(p=v||(v={}))[p.Extract=0]="Extract",p[p.Merge=1]="Merge",p[p.Encrypt=2]="Encrypt",p[p.Select=3]="Select",p[p.Compress=4]="Compress";let ch=O().forwardRef(({filePickerProps:a,telemetryHandler:b,...c},d)=>{let{filename:e="PDF"}=c,[f,g]=O().useState(""),h=O().useRef(0),i=O().useRef(),j=O().useRef(),k=O().useRef(),l=O().useRef(),m=O().useRef(),n=O().useRef([]),o=(0,cd.d)(d),p=(0,ar.c)();O().useEffect(()=>{a?.config?.mode==="merge"&&(h.current=1)},[a?.config?.mode]);let q=O().useCallback(async(a,b)=>{let c=p.consume(an.a),d=p.consume(ce.a);return(0,cb.g)(a,c,d,b)},[p]),r=(0,cd.c)(q),s=O().useMemo(()=>e.endsWith(".pdf")?e.slice(0,-4):e,[e]),t=O().useCallback(async(b,c)=>{g(`Extracted from ${s}`),a?.setConfig?.({mode:"save"}),i.current=b,j.current=c,h.current=0},[s,a]),u=O().useCallback(async b=>{g(`Encrypted from ${s}`),a?.setConfig?.({mode:"save"}),k.current=b,h.current=2},[s,a]),v=O().useCallback(async(b,c)=>{a?.setConfig?.({mode:"select",focusZoneProps:c}),l.current=b,h.current=3},[a]),w=O().useCallback(async b=>{g(`Compressed from ${s}`),a?.setConfig?.({mode:"save"}),m.current=b,h.current=4},[s,a]),x=O().useCallback(()=>{a?.setConfig?.({mode:"close"}),n.current=[]},[a]),y=O().useCallback(async c=>{a?.setConfig?.({mode:"close"}),await o({successText:cc.j,runningText:cc.i,failedText:cc.h,telemetryHandler:b,scenarioName:ca.a.DocumentExtract,before:()=>{j.current?.()},runner:()=>r(c,async()=>i.current?.())})},[a,r,o,b]),z=O().useCallback(c=>{a?.setConfig?.({mode:"close"}),o({successText:cc.f,runningText:cc.e,failedText:cc.d,disableAutoHide:!0,telemetryHandler:b,scenarioName:ca.a.DocumentEncrypt,runner:()=>r(c,async()=>k.current?.())})},[a,r,o,b]),A=O().useCallback(async b=>{a?.setConfig?.({mode:"close"});let c=await Promise.all(b.map(async a=>({buffer:await (0,cb.f)({credentials:"same-origin"},a.webDavUrl),name:a.name||""}))),d=c.map(({buffer:a})=>new Uint8Array(a)),e=c.map(({name:a})=>a);l.current?.(d,e)},[a]),B=O().useCallback(c=>{a?.setConfig?.({mode:"close"}),o({successText:cc.c,runningText:cc.b,failedText:cc.a,disableAutoHide:!0,telemetryHandler:b,scenarioName:ca.a.DocumentCompress,runner:()=>r(c,async()=>m.current?.())})},[a,r,o,b]),C=O().useCallback(async c=>{Array.isArray(c)?(n.current=[...c],g(`Merged from ${s}`),a?.setConfig?.({mode:"save"})):(a?.setConfig?.({mode:"close"}),await o({successText:cc.m,runningText:cc.l,failedText:cc.k,telemetryHandler:b,scenarioName:ca.a.DocumentMerge,runner:async()=>r(c,async()=>{let a=(await (0,cb.e)([...n.current].map(a=>a.webDavUrl),{credentials:"same-origin"})).map(a=>new Uint8Array(a,0,a.byteLength));return d.current?.merge(a)}),after:()=>{n.current=[]}}))},[s,a,r,d,o,b]),D=O().useCallback(async a=>{switch(h.current){case 0:await y(a);break;case 2:z(a);break;case 3:A(a);break;case 4:B(a);break;default:await C(a)}},[z,y,C,A,B]),E=O().useMemo(()=>{let b;if(!a)return;let c=p.consume(an.a),d=c.listId;d&&"{"===d[0]&&"}"===d[d.length-1]&&(d=d.substring(1,d.length-1));let e=a.item.parentKey;if(e){let a=new cf.a({},{pageContext:c}).getItemUrlParts(e);b={entry:{sharePoint:{byPath:{web:a.serverRelativeWebUrl,list:a.fullListUrl,folder:a.listRelativeItemUrl}}},telemetry:{sessionId:c?.CorrelationId}}}return{...a,item:{listId:d,siteUrl:c.siteAbsoluteUrl,listItemId:a.item.listItemId},pickerPageUrl:`${c.webAbsoluteUrl}/${c.layoutsUrl}/FilePicker.aspx`,defaultNewFileName:f,options:b,onClose:x,onConfirm:D}},[a,p,f,x,D]),F=O().useMemo(()=>O().createElement(bl.a,{ref:d,...c,execExtract:t,encryptDialogProps:c.encryptDialogProps&&{...c.encryptDialogProps,execEncrypt:u},compressDialogProps:c.compressDialogProps&&{...c.compressDialogProps,execCompress:w},execSelect:v}),[d,c,t,u,v,w]);return O().createElement(O().Fragment,null,F,E&&O().createElement(cg,E))}),ci=O().memo(ch),cj=(0,bA.a)(async()=>(await c.e(82).then(c.bind(c,834))).UniversalAnnotationWrapper,{useChildrenAsPlaceholder:!(0,a4.pc)()}),ck=N.memo(a=>{let b,c,[d,e]=N.useState(!1),[f,g]=N.useState(!1),h=N.useRef(null),i=N.useRef(null),j=N.useRef(null),k=N.useRef(null),{universalAnnotationProps:l,eSignProps:m,...n}=a,{itemId:o,onDocumentLoaded:p,height:q,addOnsEnabled:r,filename:s,fileSize:t,pdfItemViewer:u=ci}=n,v=(0,b4.a)(()=>n,n),w=m?.isEsignSidePanelActive||m?.isEsignRecipient,x=N.useCallback(({pageCount:a,mip:b,isMipDecrypted:c,isAnnotAllowed:d,isFormFieldAllowed:e,isPrintAllowed:f,isFileEncrypted:h,isSigned:i,hasOutline:j,isOutlineDefaultOff:k})=>{p?.({pageCount:a,mip:b,isMipDecrypted:c,isAnnotAllowed:d,isFormFieldAllowed:e,isPrintAllowed:f,isFileEncrypted:h,isSigned:i,hasOutline:j,isOutlineDefaultOff:k}),g(!0)},[p]),y=N.useCallback(()=>{e(!0)},[]),{documentMetadataLoaded:z,documentMetadata:A}=((a,b,c)=>{let[d,e]=N.useState(b5.d),[f,g]=N.useState(!1),h=N.useCallback(()=>{let a;e({scale:(a=c.current?.getPdfMetadata()??b8).scale,rotation:a.rotation/b5.k%4,currentScrollPosition:{x:a.currentScrollPosition.x,y:a.currentScrollPosition.y},originalLayoutSize:{height:a.originalLayoutSize.height,width:a.originalLayoutSize.width},originalPageRects:a.originalPageRects.map(a=>({top:a.origin.y,left:a.origin.x,height:a.height,width:a.width}))})},[c,c.current]);return(0,b7.a)(h),N.useEffect(()=>{if(a&&b){h(),g(!0);return}a||g(!1)},[a,b]),{documentMetadataLoaded:f,documentMetadata:d}})(w||a.universalAnnotationProps?.isUniversalAnnotationActive,(0,a4.pc)()?d&&f:f,h),B=(0,ar.c)(),C=B.consume(b3.resourceKey),D=N.useCallback((a,b)=>{r?.universalAnnotation&&i.current?.updateScrollPosition(a,b),r?.eSign&&j.current?.updateScrollPosition(a,b)},[]),E=(0,aT.a)(a=>{r?.universalAnnotation&&i.current?.zoom(a),r?.eSign&&j.current?.zoom(a)}),F=(0,aT.a)(a=>{r?.universalAnnotation&&i.current?.updateCursorType(a)}),G=(0,aT.a)(()=>{r?.universalAnnotation&&i.current?.rotateClockwise(),r?.eSign&&j.current?.rotateClockwise()}),H=N.useMemo(()=>N.createElement("div",{ref:k,className:"pdfWrapper_d49e1686"},N.createElement(u,{...v,height:m?.isEsignRecipient?void 0:v.height,ref:h,onDocumentLoaded:x,onRenderViewport:(0,a4.pc)()?y:void 0,enableToolbar:!(r?.eSign&&w),shouldPlaceToolbarOnTop:!0,onScrollPositionUpdated:D,onRotationChanged:G,onScaleChanged:E,onCursorUpdate:F})),[u,v,m?.isEsignRecipient,x,y,r?.eSign,w,D,G,E,F]);if(r?.universalAnnotation&&l){let{driveId:a,progressRegister:c,onPreloadFailure:d,onPreloadSuccess:e,isUniversalAnnotationActive:f}=l,g=B.consume(bO.a);b=N.createElement(cj,{pdfItemViewerRef:h,pdfAppRef:k,universalAnnotationRef:i,isUniversalAnnotationActive:f,progressRegister:c,dataSource:g,driveId:a,itemId:o,onPreloadFailure:d,onPreloadSuccess:e,viewerHeight:q,documentMetadataLoaded:z,documentMetadata:A},H)}if(r?.eSign){let{uniqueId:a,isEsignSidePanelActive:d=!1,setIsEsignSidePanelActive:e,parentItemPermission:f,parentItemUri:g,isEsignRecipient:i,documentUrl:l,canSendToExternalRecipients:n,canAddNewExternalUser:o,hasParentItemPermissionsLoaded:p,onUpdateToast:r}=m||{},u=!!(a&&s&&l&&t&&e&&h.current?.getEventHandlers),{rotate:v,scrollTo:w,getEventHandlers:x,hasSignature:y}=h.current||{};((0,a4.Yb)()||u)&&(c=N.createElement(b9,{item:{itemId:a||"",name:s||"",size:t||0,openUrl:l||"",parent:{permissions:f,openUrl:g||"",hasLoaded:p}},esignWrapperRef:j,showCreatePanel:d,isRecipient:i,documentMetadataLoaded:z,documentMetadata:A,onCancelClick:()=>e?.(!1),getSessionToken:async a=>C.getOAuthSessionToken({endPoint:a,apiQosName:"ESignWrapper"}),documentRotate:v,documentScrollTo:w,height:q??k.current?.clientHeight??0,getEventHandlers:x,hasSignature:y,isNewDesign:m?.isNewOneup,creatorPermissions:{canAddExistingExternalRecipient:n,canAddNewExternalRecipient:o},onUpdateToast:a=>r?.("eSign",{...a,actionButtons:void 0})},b||H))}return c||b||H});var cl=c(99),cm=c(66),cn=c(600),co=c(75),cp=c(63),cq=c(21),cr=c(146),cs=c(301),ct=c(169),cu=c(117),cv=c(294);let cw={"PDF Save Failed":["GetPdfStreamFailed","UploadFileDataFailed"],"PDF Load Failed: Init":["GetDocument","GetDownloadUrl","GetWasmAsset","WasmCacheFailed","WasmModuleInitFailed","WasmModuleNotFound"],"PDF Load Failed: Previewer":["PreviewerFailToFetchFile","PreviewerFailToLoadPage","PreviewerFailToLoadTask","PreviewerUnmounted"],"PDF Load Failed: WasmRuntime":["RuntimeError","WasmRuntimeError"],"PDF Load Failed: Others":["AnnotationAddFailed","EventHandleFailed","FileDownloadFailed","FontLoadFailed","InvalidPDF","PrintFailed","RangeDownloadSizeMismatch","RangeError","ShowThumbnailFailed","TypeError","PDFWorkerMismatch","ViewContextNotInitialized"]};class cx{constructor(a,b){this._qosEventMap={},this.logQosStart=a=>{let b=a.payload.name,c=(a=>{switch(a){case ca.a.DocumentSave:return"PDF.Edit";case ca.a.DocumentLoad:return"PDF.Load";default:return}})(b),d={scenario:c||"PDF."+b,pillar:(a=>{switch(a){case"PDF.Edit":return"Edit";case"PDF.Load":return"View";default:return"None"}})(c),perfGoalInMs:18e5,extraData:{viewerName:"MSPdf",...this._initExtraData,...a.payload.extraData}};this._qosEventMap[b]=new ct.a(d)},this.logQosEnd=a=>{let b,{name:c,status:d,extraData:e}=a.payload,f=this._qosEventMap[c];if(f){if(d===ca.b.Succeed)b={resultType:co.c.Success,extraData:{...this._initExtraData,...e}};else{let c,d,e=this._resource.consume(cl.a.optional);cy(a.payload,!!e?.offline);let{code:f,error:g,isExpected:h}=a.payload,i={...this._initExtraData,...a.payload.extraData,error:g.message};b={resultType:h?co.c.ExpectedFailure:co.c.Failure,errorCode:f,veto:(d=(c=f||"None").endsWith("GetDocument")?"GetDocument":c.endsWith("GetDownloadUrl")?"GetDownloadUrl":c.endsWith("GetWasmAsset")?"GetWasmAsset":c,Object.keys(cw).find(a=>cw[a]?.indexOf(d)!==-1)||"None"),extraData:{...i,pdfDiagnosticInfo:(0,cs.a)(i)}}}f.end(b),this._qosEventMap[c]=void 0}},this.logError=a=>{let{error:b,extraData:c}=a.payload,d={};for(let a in c)if(c.hasOwnProperty(a)){let b=c[a];d[a]=JSON.stringify(b)}cp.a.logError(b,d)},this.logEngagement=a=>{let{name:b,extraData:c,actionScenario:d}=a.payload,e={location:"MsPdfViewer",usageType:cn.a[cn.a.Click],isIntentional:!0};cq.a.logData({...e,name:b,extraData:{...c,actionScenario:d}})},this.logVerbose=a=>{if((0,cu.j)()||(0,cv.b)(a4.c.ECS))return;let{name:b,message:c}=a.payload;cr.a.logData({name:b,message:c})},this._resource=a,this._initExtraData=b}}function cy(a,b){if(a.error.name!==cm.d.NetworkError)return;let{extraData:c}=a,d=c?.status,e=c?.responseHeaders;a.isExpected=!!d&&(406===d||412===d)||b||a.isExpected,a.extraData={...c,correlationId:e?.get("SPRequestGuid")||e?.get("X-Correlationid")||void 0,requestId:e?.get("request-id")||void 0}}(0,H.ZW)([{rawString:".root_25e3a853{position:absolute;top:0;left:0;right:0;bottom:0;display:flex;justify-content:center;align-items:center}"}]);let cz="root_25e3a853";var cA=c(35),cB=c(601);function cC(a){let{item:b,onViewerLoaded:c,isMainViewer:d,offset:e}=a,[f,g]=N.useState(b?.thumbnail?.url||""),[h,i]=N.useState(!0),j=(0,ar.c)(),k=j.consume(a2.f),l=!!j.consume(bP.j.optional),m=N.useRef(),n=N.useRef(),[o,p]=N.useState(!0),q=N.useRef(),r=N.useRef(),s=!!j.consume(a9.a);N.useEffect(()=>{d||m.current||(m.current=new ct.a({scenario:"OneUpLightSpeed.thumbnailViewer",perfGoalInMs:aV.c,extraData:{oneUpRenderingMode:l?aV.e.fastOneUp:aV.e.inlineOneUpFirstPage}}))},[d,m,l]);let t=(0,aT.a)(c=>{let{resultType:e,resultCode:f,extraData:g}=(0,cA.a)(c);d?(k.updateErrorState("oneupThumbnailViewer",{errorType:aV.d.viewerInitLoadingError,error:c,item:b,extraData:{viewer:aX.a.Thumbnail,extension:b&&b.extension||"",url:b?.thumbnail?.url,...g,noTempAuth:r.current},meTAEvent:n.current}),a.fallbackToOtherViewer&&a.fallbackToOtherViewer(c,"ThumbnailViewer")):m.current&&(m.current.end({resultType:e,errorCode:f,extraData:{viewer:aX.a.Thumbnail,extension:b&&b.extension||"",...g}}),m.current=void 0)}),u=(0,aT.a)(async a=>{try{if((0,a4.kc)()&&b&&(n.current||(0,a4.cb)()&&!b.thumbnail?.url)){let{width:c,height:d}=b.thumbnail||{},e=j.consume(a$.a),{blobUrl:f,error:h}=await e.getThumbnailUrl(b,{useDirectEndpoint:!0,size:c&&d?{width:c,height:d}:void 0})||{};if(f)g(f),i(!1);else if(h)throw(0,cB.a)(a,h);else throw a}else throw a}catch(a){t(a),i(!1)}});N.useEffect(()=>{if(0!==e)return;let a=b?.thumbnail?.url;r.current=!a||!(0,a8.a)(a);let c=(0,a6.b)(a);c&&(n.current=(0,a7.a)(aX.a.Thumbnail)),(0,cB.b)({resources:j,thumbnailUrl:a,isMeTA:c,isMeTATempAuthDeprecationEnabled:s}).then(a=>{let{blobUrl:c,error:d}=a;if(c)g(c),m.current?.end({resultType:bp.b.Success,extraData:{viewer:aX.a.Thumbnail,extension:b&&b.extension||""}});else if(d)throw d;i(!1)}).catch(a=>{u(a).catch(()=>{})})},[j,e,u,b,c,d,s]);let v=(0,aT.a)(()=>{if(o&&c){let a=q.current;if(a&&"code"in a&&(a.code=`${a.code}-VroomLoadSuccess`),d){let d=n.current;n.current&&a&&((0,a7.b)(n.current,void 0,a),d=void 0),c({extraData:{url:b.thumbnail?.url,noTempAuth:r.current},meTAEvent:d})}p(!1)}}),w=(0,aT.a)(a=>{let b=q.current;b?("code"in b&&(b.code=`${b.code}-VroomLoadFail`),t(b)):t(Error(a.type))}),x=(0,aT.a)(a=>{(0,a4.Sb)()&&a.preventDefault()});return 0===a.offset&&!h&&f?N.createElement("div",{className:cz},N.createElement("img",{alt:"",src:f,onLoad:v,onError:w,onContextMenu:x})):N.createElement(N.Fragment,null)}var cD=c(40),cE=c(150),cF=c(425),cG=c(135);let cH="SPeSign",cI=()=>{let a,b,c=(b=btoa(by.a.generate().match(/\w{2}/g).map(function(a){return String.fromCharCode(parseInt(a,16))}).join("")),`${b.replace(/=/g,"").replace(/[+]/g,"-").replace(/\//g,"_")}`),d={};return a=d[c]||0===d[c]?d[c]+1:0,d[c]=a,`${c}.${a}`};function cJ(a){let{isSyntexESignatureEnabled:b,isSyntexPAYGEnabled:c,userEmail:d}=a;return!!((0,a4.$b)(a4.E)||b&&c&&(!cG.h||d))}function cK(a){let{webTemplate:b,listBaseTemplate:c}=a;return b!==cD.b.mySite.toString()&&c!==cE.a.mySiteDocumentLibrary}function cL(){return(0,cG.d)()?bw.Q:bw.P}function cM(){return(0,cG.d)()?bw.S:bw.R}var cN=c(186);let cO=new K.v7({name:"C5A93D50-ADC6-4945-8E89-AB95B3B4CC7C",loader:new K.dE(()=>Promise.resolve().then(c.bind(c,46)).then(a=>a.resourceKey))});var cP=c(141),cQ=c(603);let cR=new K.v7({name:"UniversalActionExecutor.key",loader:new K.dE(()=>Promise.all([c.e("ondemand.resx"),c.e(83)]).then(c.bind(c,835)).then(a=>a.universalPrintActionExecutorKey))});var cS=c(281);let cT="UniversalPrintAction",cU={pageContext:an.a,oneUpStore:aF.b,resources:K.m3,platform:aC.a,oneUpStateStore:a2.f,getExecutor:cR.async.lazy,pdfViewerHelper:b0.b,navigation:ap.a,oneUpUrlDataSource:ce.a},cV=new K.v7({name:"UniversalPrintAction",factory:{dependencies:cU,create:a=>({instance:{evaluateAction:b=>{let d=function(a,b,c,d){let e=c.currentAppState.isTeamsFileScenario,f=a&&a.graph&&"personal"===a.graph.driveType;if(a&&a.extension&&a.openUrl&&a.itemStatus!==br.b.ConditionalAccessViewOnly&&a.itemStatus!==br.b.ConditionalAccessBlocked&&bq.a.hasItemPermission(a,bq.a.openItems)&&!c.currentAppState.viewerStates?.get(a.key)?.pdfViewerStates?.isPdfMip&&(c.currentAppState.viewerStates?.get(a.key)?.pdfViewerStates?.isPrintAllowed??!0))if((0,a4.Tc)()){if(!(0,a4.Db)()&&e||f)return!1;let c=(0,cQ.a)(a.extension);if(c&&"ms-word"===c||b.isSupportedFileType(a))return!0}else{let d=c.currentAppState.isUniversalPrintLicenseValid,f=(0,cQ.a)(a.extension);if(f&&"ms-word"===f){if(d)return!0}else if(b.isSupportedFileType(a))return!!(0,a4.Db)()||!e||!!d}return!1}(b.item,a.pdfViewerHelper,a.oneUpStateStore,a.pageContext),e=a.oneUpStore.getOneUpProperties();return{isAvailable:d,id:cT,onExecute:async()=>{let{focusItem:d,parentItem:f,focusItemSet:g}=e;if(e&&g&&g.length&&d&&f)if((0,a4.Tc)()){let e=await a.resources.consumeAsync(cS.a);if(await e.hasValidLicenseCached())try{let b=await a.getExecutor();return await b.executeUniversalPrint({item:d,resources:a.resources,oneUpStateStore:a.oneUpStateStore}),{resultType:bp.b.Success}}catch(f){let e=(await Promise.resolve().then(c.bind(c,488))).ToastActionStatus;if(a.oneUpStateStore.updateToastState("updateToast",{visible:!1,actionStatus:e.none,displayText:bw.Bb,actionButtons:void 0}),a.pdfViewerHelper.isSupportedFileType(d))cW(a.navigation,d);else{let c=a.oneUpStore.list?.id;if(c){let d=a.oneUpUrlDataSource.getOpenInOfficeOnlineUrl(b.item,c);a.navigation.navigateTo({url:d,frameId:"_blank"})}}throw a.oneUpStateStore.updateErrorState(cT,{errorType:aV.d.actionError,error:f,item:d}),f}if(a.pdfViewerHelper.isSupportedFileType(d))return cW(a.navigation,d),{resultType:bp.b.Success};{let c=a.oneUpStore.list?.id;if(!c)return{resultType:bp.b.Failure};{let d=a.oneUpUrlDataSource.getOpenInOfficeOnlineUrl(b.item,c);return a.navigation.navigateTo({url:d,frameId:"_blank"}),{resultType:bp.b.Success}}}}else if(!a.oneUpStateStore.currentAppState.isUniversalPrintLicenseValid)return cW(a.navigation,d),{resultType:bp.b.Success};else try{let b=await a.getExecutor();return await b.executeUniversalPrint({item:d,resources:a.resources,oneUpStateStore:a.oneUpStateStore}),{resultType:bp.b.Success}}catch(b){throw a.pdfViewerHelper.isSupportedFileType(d)&&cW(a.navigation,d),a.oneUpStateStore.updateErrorState(cT,{errorType:aV.d.actionError,error:b,item:d}),b}{let b=(0,aV.i)("no parent view/item");throw a.oneUpStateStore.updateErrorState(cT,{errorType:aV.d.actionError,error:b,item:d}),b}}}}}})}});function cW(a,b){let c=b.openUrl;c&&a.navigateTo({url:c,frameId:"_blank"})}var cX=c(347);let cY=new K.v7({name:"getIsPdfPaidFeaturesEnabled",factory:{dependencies:{},create:()=>({instance:()=>Promise.resolve(!1)})}}),cZ=()=>({pdfDownloadTime:bZ(bg.a.getDurationBetweenMarks("Start","Downloaded")),pdfOpenTime:bZ(bg.a.getDurationBetweenMarks("Downloaded","Opened")),pdfFirstRenderTime:bZ(bg.a.getDurationBetweenMarks("Opened","FirstRenderCompleted")),pdfGetTokenTime:bZ(bg.a.getDurationBetweenMarks("GetTokenStart","GetTokenEnd"))}),c$=a=>bn.a.language.toLowerCase()===a||bn.a.cultureLCID.toLowerCase()===a||window.navigator.language.toLowerCase()===a,c_=["NoConnection","expiredToken"];function c0(a){!function(a="unknownViwer"){(0,aq.f)(`oneUp-${a}.start`)}("MSPdf");let{item:b,offset:c,parentItem:d,onViewerLoaded:e,onLogFullPageRumone:f,fallbackToOtherViewer:g}=a,[h]=(0,a2.g)("currentState",a=>a.pdfAppMode??bh.a.View),[i]=(0,a2.g)("currentState",b=>a.item?b.viewerStates?.get(a.item.key)?.pdfViewerStates?.filePickerConfig:{mode:"close"}),[j]=(0,a2.g)("currentState",b=>!!a.item&&b.viewerStates?.get(a.item.key)?.pdfViewerStates?.isPdfMip),[k]=(0,a2.g)("currentState",b=>{if(a.item)return b.viewerStates?.get(a.item.key)?.pdfViewerStates?.outlineVisibility}),l=(0,ar.c)(),m=l.consume(b0.b),n=l.consume(bO.a),o=l.consume(a$.a),p=l.consume(a2.f),q=l.consume(an.a),r=l.consumeAsync(b2),s=l.consume(bN),t=l.consume(bu),u=l.consume(ap.a),v=l.consume(cl.a.optional),w=l.consume(cX.a),x=l.consume(cV),y="ZXNpZ24"===u.viewParams[bb.b.navParamKey],[z]=(0,a2.g)("currentState",b=>!!a.item&&b.viewerStates?.get(a.item.key)?.pdfViewerStates?.pdfEncryptDialogVisible),[A]=(0,a2.g)("currentState",b=>!!a.item&&b.viewerStates?.get(a.item.key)?.pdfViewerStates?.pdfCompressDialogVisible),[B]=(0,a2.g)("currentState",a=>a.eSignData),[C]=(0,a2.g)("currentState",a=>a.annotationViewerState),[D]=(0,a2.g)("currentState",a=>a.isPdfPaidFeaturesEnabled??!1),[E]=(0,a2.g)("currentState",a=>a.rightPane),[F,G]=N.useState(!1),[H,I]=N.useState(!1),[J,L]=N.useState(!1),[M,O]=N.useState(void 0),[P,Q]=N.useState({}),R=N.useRef(!1),S=N.useRef(c$("zh-cn")),T=N.useMemo(()=>0===c,[c]),U=F&&T?"OneUp-pdf OneUp-pdf--loaded":"OneUp-pdf",V=N.useMemo(()=>b?s.evaluateAction({item:b}):void 0,[s,b]),W=N.useMemo(()=>b?t.evaluateAction({item:b}):void 0,[t,b]),X=N.useRef();void 0===X.current&&(X.current=!m.isNotEmbed());let Y=N.useRef();void 0===Y.current&&(Y.current=!X.current&&(!(0,a4.pc)()||cK(q)&&cJ(q)));let Z=N.useRef();void 0===Z.current&&(Z.current=(0,a4.$b)(a4.ib)&&n.hasLicense&&!X.current);let $=N.useRef();N.useEffect(()=>{let a=new cx(l,{pdfSource:m.getPdfSource(b?.pdfConversion)});$.current=a,(0,bi.b)(K.Ov.isActivated),(0,bj.b)(a)},[l,b?.key]);let _=(0,aT.a)(async a=>{let b;try{b=await l.consumeAsync(cO)}catch{return}try{if(b.getAzRMSToken)return b.getAzRMSToken({resource:a?.resource||cP.a,apiQosName:"OneUpMSPDFViewer"}).then(a=>a.accessToken);throw Error("Identity datasource not found for AzRMS token")}catch(a){if("handleError"===a.code)return;throw m.handleMipTokenError(a)}}),aa=(0,aT.a)(async a=>!!m?.isODSPCopilotEnabled(b)&&(p.updatePdfCopilotAction("updatePdfCopilotAction",a,!1),Promise.resolve(!0))),ab=N.useRef(),ac=N.useRef(),ad=(0,aT.a)(a=>{(a.url!==P.url||a.token!==P.token)&&(Q({...a}),(0,a6.b)(a.url)&&(ac.current=(0,a7.a)(aX.a.MSPdf)))}),af=(0,aT.a)((a,d)=>{if(0===c){let{code:c,isExpected:e}=a,f=!!e||!!v?.offline||-1!==c_.indexOf(c||""),h=`${c||a.name||"UnknownError"}.${d}`,i=new K.lM(a instanceof K.lM?{...a,code:h,isExpected:f}:{code:h,isExpected:f,message:a.details||a.message||JSON.stringify(a)});p.updateErrorState("oneupPDFViewer",{errorType:aV.d.viewerInitLoadingError,error:i,item:b}),g&&g(i,"MSPDFViewer")}}),ag=(0,aT.a)(()=>{H&&I(!1),F||G(!0)}),ah=(0,aT.a)(b=>{ag(),a.item&&p.updateViewerState("updatePdfViewerLoaded",{key:a.item.key,options:{pdfViewerStates:{isOpened:!0,isPdfMip:b?.mip,isAnnotAllowed:b?.isAnnotAllowed,isPrintAllowed:(0,cu.e)()||(b?.isPrintAllowed??!0),isFileEncrypted:b?.isFileEncrypted,isSigned:b?.isSigned,outlineVisibility:m.isPdfOutlineAvailable(a.item)&&b?.hasOutline||m.isPdfOutlineNextAvailable(a.item)?C?.isActive||b?.isOutlineDefaultOff?bh.b.Hidden:bh.b.Visible:void 0}}})}),ai=(0,aT.a)(()=>{ag(),a.item&&p.updateViewerState("updatePasswordProtectedPdf",{key:a.item.key,options:{pdfViewerStates:{isPdfPasswordProtected:!0}}})}),aj=(0,aT.a)(a=>{if(0===c){cy(a,!!v?.offline);let{code:c,isExpected:d,extraData:e,error:f}=a,h=new K.lM({code:c,correlationId:e?.correlationId,isExpected:d,message:f.message,innerError:f,extraData:e});p.updateErrorState("oneupPDFViewer",{errorType:aV.d.viewerInitLoadingError,error:h,item:b,meTAEvent:ac.current,extraData:{url:P.url}}),g&&g(h,"MSPDFViewer")}}),ak=(0,aT.a)(b=>{b===bh.a.Edit&&(C?.isActive?p.toggleAnnotationViewerVisiblity("OneUpMSPDFViewer"):!(0,cu.a)()&&E&&E.type!==a2.e.none&&p.updateRightPaneState("closeRightPaneForPdfEdit",{type:a2.e.none,content:void 0})),a.item&&p.updatePdfState("updatePdfAppMode",b)}),al=(0,aT.a)(b=>{a.item&&p.updateViewerState("updatePdfFilePickerMode",{key:a.item.key,options:{pdfViewerStates:{filePickerConfig:b}}})}),ao=N.useCallback(async a=>{let b=await l.consumeAsync(b1.b.optional);switch(a){case b1.a.Modified:b?.notifyModified();break;case b1.a.ExitEdit:b?.notifyExitEdit()}},[l]),as=(0,aT.a)(({dirty:a})=>{a&&ao(b1.a.Modified)}),at=(0,aT.a)(()=>{ao(b1.a.Modified)}),au=(0,aT.a)(()=>p.setAnnotationViewerPreloadSucceeded("OneUpMSPDFViewer",!1)),av=(0,aT.a)(()=>p.setAnnotationViewerPreloadSucceeded("OneUpMSPDFViewer",!0)),aw=(0,bo.a)({register:()=>{},start:()=>{},setMaximum:a=>{},setCurrent:a=>{},succeed:()=>{av()},fail:()=>{au()}},[av,au]),ax=(0,aT.a)(async()=>{if(!b||!(0,cu.f)()&&(!m.isPdfEditAvailable(b)||!m.isPdfEditable(b)))return Promise.resolve("");if(!(0,cu.u)())return o.getItemCurrentVersion(b,{useDirectEndpoint:!0});{let a=await r;return a?.getItemCurrentVersion(b,q)||Promise.resolve("")}}),ay=N.useCallback(async()=>{let a=await ab.current||Promise.resolve(""),b=await ax();return!!a&&!!b&&b!==a},[ax]),az=(0,aT.a)(async c=>{if(!b||!c)return Promise.reject(Error("Invalid document"));if(X.current){let a=await l.consumeAsync(b1.b.optional);return a?.execSave(c)}let d=await r,e=await d.execSave({item:b,parentItem:a.parentItem,oneUpStateStore:p,pageContext:q,fileData:c});if(e?.extraData?.schema){let{resultType:a,resultCode:b,extraData:c}=e.extraData.schema;if(a!==bp.b.Success)return Promise.reject(Error(`errorCode:${b}, extraData:${JSON.stringify(c)}`))}ab.current=ax()}),aA=(0,aT.a)(()=>{V?.isAvailable&&V.onExecute?.({})}),aB=(0,aT.a)(()=>{W?.isAvailable&&W.onExecute?.({})}),aC=(0,aT.a)(()=>{b&&m.isProgressiveLoadingEnabled(b)&&(H&&I(!1),L(!0)),e&&e({perfData:{euplBreakDownData:bg.a.getMarkerTime("Previewed")?{pdfTTI:bZ(bg.a.getDurationBetweenMarks("Start","Previewed"))}:{...cZ(),pdfTTI:bZ(bg.a.getDurationBetweenMarks("Start","FirstRenderCompleted"))},extraPerfData:{...m.getTempAuthLogData(P),pdfSource:m.getPdfSource(b?.pdfConversion),mip:j??!1}},meTAEvent:ac.current,extraData:{url:P.url}})}),aD=(0,aT.a)(()=>{(0,cu.l)()||f?.({perfData:{euplBreakDownData:cZ(),extraPerfData:{...m.getTempAuthLogData(P),pdfSource:m.getPdfSource(b?.pdfConversion),mip:j??!1}}})}),aE=(0,aT.a)(()=>{F||J||I(!0)}),aF=(0,aT.a)(a=>{if(!(0,cu.y)()&&(a.ctrlKey||a.metaKey)&&"P"===a.key.toUpperCase()){if(!b)return;a.preventDefault();let c=x.evaluateAction({item:b}),d=c.isAvailable,e=c.onExecute,f=new bp.a({name:`OneUpLightSpeed.commandInvoked.${c.id}`});d&&e&&e({qosEvent:f})?.then(a=>{let b=a||{resultType:bp.b.Success};f.end(b)}).catch(a=>{let b=a||Error("Unhandled exception");f.end((0,cA.a)(b))})}});N.useEffect(()=>{let a=setTimeout(()=>{aE()},1e4);return()=>clearTimeout(a)},[aE]),N.useEffect(()=>{(0,cu.m)()?p.updateIsPdfPaidFeaturesEnabled("initIsPdfPaidFeaturesEnabled",!!l.consume(bP.l.optional)):l.consume(cY)().then(a=>{p.updateIsPdfPaidFeaturesEnabled("initIsPdfPaidFeaturesEnabled",a)})},[l,p]),N.useEffect(()=>{if(!(0,cu.x)()&&R.current)return;let a=b0.a.GetDownloadUrl,c=async()=>{if(b.pdfConversion?.url){let a=await o.getMetaPac(l,b);if(a.metaPac)return[{name:"X-SPOPacToken",value:a.metaPac}]}return[]};(async()=>{if(!b)return{};R.current=!0;let d=b.pdfConversion;if(d){let a=d.url;if(a)return{url:a,getAuthHeaders:!(0,cu.n)()&&(0,a6.b)(a)&&!(0,a8.a)(a)?c:void 0};let e=await o.getAuthenticationParams(b);return{url:`${o.getItemUrl(b,{useDirectEndpoint:!0})}/content?format=pdf&${(0,aY.a)(e)}`}}if(m.isNoTempAuthEnabled()){let c,d=await o.getDownloadUrl(b,{useDirectEndpoint:!0,excludeTempAuth:m.isTempAuthDeprecated(b)});return m.isSameDomainEmbed(d)?{url:d}:((0,a8.a)(d)||(a=b0.a.GetDownloadToken,bg.a.mark("GetTokenStart"),c=await o.getDownloadToken({url:d,item:b}),bg.a.mark("GetTokenEnd")),{url:d,token:c})}return o.getDownloadUrl(b,{useDirectEndpoint:!0}).then(a=>({url:a}))})().then(ad,b=>af(b,a))},[o,b,m,af,ad,l]),N.useEffect(()=>{ab.current=ax()},[b,ax]),N.useEffect(()=>{Y.current&&y&&ak(bh.a.Esign)},[ak,y]);let aG=N.useMemo(()=>m.isPdfOutlineAvailable(b)?{visibility:k,onOutlineClose:()=>{p.updateViewerState("PDFViewerUpdateIsOutlineVisible",{key:b.key,options:{pdfViewerStates:{outlineVisibility:bh.b.Hidden}}})}}:void 0,[b,k,m,p]);N.useEffect(()=>{let a={...cN.b,semanticColors:{...cN.b.semanticColors,bodyBackground:"transparent"}},c=b?m.getEmbedOptions()?.allowEdit:void 0,e=b?m.isPdfEditAvailable(b)&&m.isPdfEditable(b)&&(!X.current||c):void 0,f={enableDownload:V?.isAvailable,enableOpenInBrowser:W?.isAvailable,onDownload:aA,onOpenInBrowser:aB},g=(0,a4.$b)(a4.l)?{enableOpenMip:!0,getMIPToken:_,mipDialogProps:f}:{enableOpenMip:!1,mipDialogProps:f},k=m.isPdfEncryptAvailable(b)?{closeEncryptDialog:()=>{p.updateViewerState("updatePdfEncryptDialogVisibleState",{key:b.key,options:{pdfViewerStates:{pdfEncryptDialogVisible:!1}}})},encryptVisible:z}:void 0,l=m.isPdfCompressAvailable(b)?{closeCompressDialog:()=>{p.updateViewerState("updatePdfCompressDialogVisibleState",{key:b.key,options:{pdfViewerStates:{pdfCompressDialogVisible:!1}}})},compressVisible:A}:void 0,n=m.isODSPCopilotEnabled(b)&&w?.isCopilotSupportedForItem(b)&&h===bh.a.View,o=b?{url:"",filename:b?.displayName,fileSize:b.size,mode:h,encryptDialogProps:k,outlineProps:aG,compressDialogProps:l,enableThumbnailView:h===bh.a.Extract,telemetryHandler:$.current,enableEdit:e&&!j,enablePreRender:(0,a4.$b)(a4.s),enableProgressiveLoading:m.isProgressiveLoadingEnabled(b),enablePrint:(0,cu.e)()||m.isPdfPrintable(b),isPaidFeaturesEnabled:D,darkMode:!0,theme:a,shouldAutoFocus:!1,showOpenInNewWindow:!1,openUrl:"",toolbarAttributes:{"data-handle-special-keys":"Left Right Esc"},enableCopyByChunk:!(0,cu.o)(),enableDebugString:(0,a4.$b)(a4.n)&&!X.current,formAttributes:"data-suppresskeyboardbinding",...g,shouldExitEditModeAfterSave:!X.current,allowUnloadPageWithEdits:X.current,enableCacheDisplayInfo:(0,a4.$b)(a4.m),uniqueId:b.properties?.uniqueId,onDocumentLoaded:ah,enableCopilot:n,onRequestCopilot:aa,onNeedPassword:ai,onCurrentPageChanged:()=>{},onInitError:aj,onEditStateChanged:X.current?as:void 0,onExitEditMode:X.current?at:void 0,updateMode:ak,execSave:az,isFileVersionChanged:ay,itemId:b.graph?.itemId,onFirstRenderVisible:aC,onDocumentFullyLoaded:aD,filePickerProps:{app:"OneDrive",config:i??{mode:"close"},setConfig:al,getIconUrl:a=>`${ae}${a}/${(0,bm.b)("pdf")}.png`,item:{listItemId:b.properties?.ID||"",parentKey:d.key||""}}}:void 0;o&&(o={...o,addOnsEnabled:{eSign:Y.current,universalAnnotation:Z.current}}),O(o)},[h,V?.isAvailable,az,i,_,ah,aA,as,at,aj,aD,aC,aB,w,aa,al,ak,ay,b,ai,W?.isAvailable,d.key,m,$,p,z,j,aG,A,D]);let aH=window.require,aI=aH.toUrl?aH.toUrl("item-viewer-pdf/"):void 0;N.useEffect(()=>{let a,c,d=l.consume(bf),e=(0,a4.$b)(a4.l)?{mipWasmUrl:`${aI}mspdf2.wasm`,mipWasmJsUrl:`${aI}mspdf2.min.js`}:{},f={workerUrl:d.getWorkerUrl(`${aI}index.worker.js`,m.getWorkerManifestName()),wasmUrl:`${aI}mspdfkit.wasm`,wasmJsUrl:`${aI}mspdfkit.min.js`,dataUrl:`${aI}mspdfkit.data`,...e,parserWasmUrl:b&&(m.isPdfExtractAvailable(b)||m.isPdfEncryptAvailable(b)||m.isPdfCompressAvailable(b))?`${aI}mspdfparser.wasm`:void 0,parserWasmJsUrl:b&&(m.isPdfExtractAvailable(b)||m.isPdfEncryptAvailable(b)||m.isPdfCompressAvailable(b))?`${aI}mspdfparser.min.js`:void 0},g=`${aI}media/fonts/`,h="arial.ttf",i="noto_sans_sc.ttf",j="noto_sans_jp.otf",k="noto_sans_ko.ttf",n="noto_sans_tc.ttf",o=[{fontUrl:`${g}${h}`,fontName:h,type:bk.b.ANSI,ondemand:!1},{fontUrl:`${g}${i}`,fontName:i,type:bk.b.ChineseSimplified,ondemand:!S.current},{fontUrl:`${g}${j}`,fontName:j,type:bk.b.Japanese,ondemand:!(c$("ja")||c$("ja-jp"))},{fontUrl:`${g}${k}`,fontName:k,type:bk.b.Korean,ondemand:!(c$("ko")||c$("ko-kr"))}];(0,cu.i)()||o.push({fontUrl:`${g}${n}`,fontName:n,type:bk.b.ChineseTraditional,ondemand:!(c$("zh-tw")||c$("zh-hk")||c$("zh-mo"))});let p=!(0,cu.k)(),r=p?{resource:cP.a,authority:(a=q?.aadInstanceUrl,c=q?.aadTenantId,a&&c?`${a}/${c}`:"")}:void 0,s={enableFreeText:(0,a4.$b)(a4.q)&&!S.current,enableFormFilling:(0,a4.$b)(a4.p)&&!S.current,enableEnhancedInk:(0,a4.$b)(a4.o),enableOptimizedPinch:(0,a4.$b)(a4.s)&&(0,a4.$b)(a4.r),enableEncrypt:m.isPdfEncryptAvailable(b),enableCompress:m.isPdfCompressAvailable(b),enableMipSdkTelemetry:(0,a4.$b)(a4.g),enableWatermark:m.isWatermarkAvailable(b),enableOutline:m.isPdfOutlineAvailable(b),enableOutlineNext:m.isPdfOutlineNextAvailable(b),enableOnlyBGRFormat:(0,a4.$b)(a4.k),enableLoadFontOnDemand:(0,a4.$b)(a4.f),enableLoopFontsOnDemand:(0,a4.$b)(a4.C),enableMipTokenPrefetch:p,enableUndoRedo:(0,a4.$b)(a4.v),enableShowStickyNote:m.isPdfShowStickyNoteEnabled(),enableProhibitScreenshotForMip:(0,a4.$b)(a4.U),enablePageTextRunInfoForAcc:(0,a4.$b)(a4.P)};(0,bl.b)(f,o,s,r)},[aI,b,m,l,q,w]);let aJ=N.useMemo(()=>({isUniversalAnnotationActive:0===c&&!!C?.isActive,driveId:b?.graph?.driveId,onPreloadFailure:au,onPreloadSuccess:av,progressRegister:()=>aw}),[C?.isActive,aw,b?.graph?.driveId,au,av,c]);N.useEffect(()=>{let{permissions:a,openUrl:b}=d;!B?.isCreateSidePanelActive||a&&b||(0,am.a)(l)},[l,d.permissions,d.openUrl,B?.isCreateSidePanelActive,d]),N.useEffect(()=>(document.addEventListener("keydown",aF),()=>{document.removeEventListener("keydown",aF)}),[aF]);let aK=N.useMemo(()=>{if(Y.current&&b&&b.openUrl&&b.properties?.uniqueId&&0===c)return{uniqueId:b.properties.uniqueId,documentUrl:b.openUrl,isEsignRecipient:h===bh.a.Esign,isEsignSidePanelActive:B?.isCreateSidePanelActive,setIsEsignSidePanelActive:a=>{p.updateESignDataState("SetIsEsignSidePanelActive",{isCreateSidePanelActive:a})},parentItemPermission:d.permissions,parentItemUri:d.openUrl,isNewOneup:!(0,cu.c)(),hasParentItemPermissionsLoaded:p.state.currentState.hasValidPermissionToParent,canSendToExternalRecipients:B?.canAddExistingExternalUser,canAddNewExternalUser:B?.canAddNewExternalUser,onUpdateToast:(a,b)=>p.updateToastState(a,{...b,actionButtons:void 0})}},[b,c,h,B?.isCreateSidePanelActive,B?.canAddExistingExternalUser,B?.canAddNewExternalUser,d.permissions,d.openUrl,p]),aL=N.useMemo(()=>T&&M&&P.url&&""!==P.url?N.createElement(ck,{...M,token:P.token,getAuthHeaders:P.getAuthHeaders,url:P.url,eSignProps:aK,universalAnnotationProps:aJ}):N.createElement(N.Fragment,null),[T,M,P,aK,aJ]),aM=N.useRef();return aM.current||(aM.current={viewer:aX.a.MSPdf,extension:b&&b.extension||"unknown"}),N.createElement("div",{className:U},N.createElement("div",{className:"newOneUpPdfContainer",role:"document"},aL),H&&N.createElement(cC,{mainViewerEngagementData:aM.current,isMainViewer:!1,...a}))}var c1=c(315),c2=c(131),c3=c(348);function c4(a){function b(b){let c=new bp.a({name:`OneUpLightSpeed.commandInvoked.${b.id}`}),d="Unhandled exception executing an action";try{if(a.onClickCallback&&a.onClickCallback(),b.action.onExecute)b.action.onExecute({qosEvent:c})?.then(a=>{let b=a||{resultType:bp.b.Success};c.end(b)}).catch(b=>{a.updateErrorStateCallBack(`Unhandled exception executing an action: ${a.text}`);let e=b||Error(d);c.end((0,cA.a)(e))});else{a.updateErrorStateCallBack(`no available action for ${b.name}`);let d=Error(`no available action for ${b.name}`);c.end((0,cA.a)(d))}}catch(e){a.updateErrorStateCallBack(`Unhandled exception executing an action: ${a.text}`);let b=e||Error(d);c.end((0,cA.a)(b))}}let c=cN.b;if(a.command.action.isDisabled)return N.createElement(N.Fragment,null);let d=N.createElement(N.Fragment,null);if(0===a.buttonType)d=N.createElement(c1.a,{className:aW.e,onClick:()=>b(a.command),disabled:!!a.command.action.isDisabled,title:a.command.title,ariaLabel:a.toolTipText||a.command.title},a.text);else if(1===a.buttonType){let{palette:e,semanticColors:f}=c,g=`${f.buttonBackground} !important`,h=`${f.buttonBackgroundHovered} !important`,i=`${f.buttonBackgroundPressed} !important`,j=`${f.buttonBorder} !important`,k={height:"40px",width:"40px",borderRadius:"25px",fontSize:"30px",zIndex:9999,color:e.black,border:`1px solid ${j}`},l={root:{...k,backgroundColor:a.isActive?h:g,"&::before":{content:"''",width:"72px",height:"72px",position:"absolute",transform:"translate(-50%, calc(-50% + 20px))"}},rootHovered:{...k,backgroundColor:h,cursor:"pointer"},rootPressed:{...k,backgroundColor:i}};d=N.createElement(c2.a,{iconProps:{iconName:a.text},styles:l,disabled:!!a.command.action.isDisabled,onClick:()=>b(a.command),ariaLabel:a.toolTipText||a.command.title})}else d=N.createElement(c1.a,{className:`${aW.d} ${!K.Ov.isActivated("9038af9c-9d8f-4288-bff3-2b0ef5c72aa3","11/08/2023","Fix Download Button shim incorrect color (should be white)")?aW.c:""}`,disabled:!!a.command.action.isDisabled,onClick:()=>b(a.command),title:a.command.title,ariaLabel:a.toolTipText||a.command.title},a.text);return N.createElement(c3.a,{content:a.toolTipText?a.toolTipText:a.text},d)}(q=w||(w={}))[q.primary=0]="primary",q[q.iconButton=1]="iconButton",q[q.default=2]="default",(0,H.ZW)([{rawString:".OneUpOther_04a3e9e8{position:absolute;width:100%;height:100%;left:50%;top:50%;transform:translate(-50%,-50%);display:flex;justify-content:center;align-items:center}.OneUpOther_04a3e9e8 .OneUpOtherContent_04a3e9e8{text-align:center}.OneUpOther_04a3e9e8 .OneUpOtherContent_04a3e9e8 .OneUpOtherFileName_04a3e9e8{font-size:21px}.OneUpOther_04a3e9e8 .OneUpOtherContent_04a3e9e8 .OneUpOtherDownload_04a3e9e8{color:"},{theme:"white",defaultValue:"#fff"},{rawString:"}.OneUpOther_04a3e9e8 .OneUpOtherContent_04a3e9e8 .OneUpOtherMessage_04a3e9e8{margin:15px}.OneUpOther_04a3e9e8 .OneUpOtherContent_04a3e9e8 .OneUpOtherMessageNewDesign_04a3e9e8{margin-top:15px;margin-bottom:15px}.OneUpOther_04a3e9e8 .OneUpOtherContent_04a3e9e8 .OneUpOtherActions_04a3e9e8{font-size:14px;font-weight:400;box-sizing:border-box;box-shadow:none;margin:0;padding:0;display:inline-block;box-sizing:border-box;border:1px solid transparent;padding:4px 20px 6px 20px;height:30px}html[dir=rtl] .OneUpOther_04a3e9e8 .OneUpOtherContent_04a3e9e8 .OneUpOtherActions_04a3e9e8{padding:4px 20px 6px 20px}.OneUpOther_04a3e9e8 .OneUpOtherContent_04a3e9e8 .OneUpOtherActions_04a3e9e8 .odButtonBarMain_04a3e9e8{float:none}.OneUpOther_04a3e9e8 .OneUpOtherContent_04a3e9e8 .OneUpOtherFileIcon_04a3e9e8 .FileTypeIcon_04a3e9e8{outline:0}.OneUpOtherMalwareDetectedIcon_04a3e9e8{height:208px;width:208px}.OneUpOtherMalwareDetectedIconExperiment_04a3e9e8{height:256px;width:256px}"}]);var c5=c(618);let c6={pageContext:an.a,oneUpStore:aF.b,navigation:ap.a,resources:K.m3,platform:aC.a},c7=new K.v7({name:"OpenInOfficeOnlineAction",factory:{dependencies:c6,create:a=>({instance:{evaluateAction:b=>{var c;return{isAvailable:!!((c=b.item)&&c.appMap)&&c.itemStatus!==br.b.ConditionalAccessBlocked&&c.itemStatus!==br.b.ConditionalAccessViewOnly,id:"OpenInOfficeOnlineAction",onExecute:async()=>a.resources.consumeAsync(ce.a).then(c=>{let d=a.oneUpStore.list?.id;if(!d)return{resultType:bp.b.Failure};{let e=c.getOpenInOfficeOnlineUrl(b.item,d);return a.navigation.navigateTo({url:e,frameId:"_blank"}),{resultType:bp.b.Success}}})}}}})}}),c8={navigation:ap.a,oneUpUrlDataSource:ce.a},c9=new K.v7({name:"OpenInOtherViewerAction",factory:{dependencies:c8,create:a=>({instance:{evaluateAction:b=>({isAvailable:!0,id:"OpenInOtherViewerAction",onExecute:async()=>{if(b.item.folder){let c=a.oneUpUrlDataSource.getDefaultClickUrlForOneUp(b.item,{urlType:"default"});"#"===c.charAt(0)&&(c="?"+c.substring(1)),await a.navigation.navigateTo({url:c,frameId:"_blank"})}else{let c=a.oneUpUrlDataSource.getDefaultClickUrlForOneUp(b.item,{urlType:"default"});await a.navigation.navigateTo({url:c,frameId:"_blank"})}return{resultType:bp.b.Success}}})}})}});var da=c(619),db=c(86),dc=c(155),dd=c(623),de=c(624),df=c(625);let dg=["agent","copilot"],dh=K.Ov.isActivated("3a3977b1-d189-4347-85b1-d19bb3ad8141");function di(a){let{iconName:b,iconFieldAriaLabel:c,item:d}=a,e=a.desiredSize||16,f=!1;(0,a4.Uc)()&&d?.iconColor&&d.type===dc.a.Folder&&(f=!0);let g="";if(b){var h,i;let c=a.iconSize||e,d=(0,bF.b)(b,!0),f=!dh&&(-1!==dg.indexOf(b)||d),j=d?de.a:dd.a;g=f?j:(h=!!a.platformDetection?.isRetinaSupported,i=a.fileExtention,`${ae}${c}${h?"_2x":""}/${b}.${i||"png"}`)}let j=a.className||"FileTypeIcon-icon";return N.useMemo(()=>f?N.createElement("div",{className:j,style:{width:`${e}px`,height:`${e}px`,padding:"0px 4px"}},N.createElement(df.a,{className:j,color:d?.iconColor,fileIconType:H.Xx.folder,size:16})):N.createElement("img",{className:j,src:g,alt:c,style:{width:`${e}px`,height:`${e}px`}}),[j,g,c,e,f,d?.iconColor])}var dj=c(626),dk=c(627),dl=c(628),dm=c(228);let dn=K.Ov.isActivated("4F69420A-9950-45CF-8BD3-2E57ED1A714D"),dp=K.Ov.isActivated("875099EF-AA79-4289-8864-F787C33E6577"),dq=K.Ov.isActivated("96D5A045-AF6F-4674-9E1E-36BB29142BBA"),dr=K.Ov.isActivated("7bd0c6ec-1d72-4be0-8493-171a6a7043d5");function ds(a){let b,c,d,e=(0,ar.c)(),{item:f,viewerType:g,offset:h,onViewerLoaded:i}=a,j=e.consume(bK),k=f?j.evaluateAction({item:f}):void 0,l=e.consume(c7),m=f?l.evaluateAction({item:f}):void 0,n=e.consume(c9),o=f?n.evaluateAction({item:f}):void 0,p=e.consume(an.a),q=e.consume(aC.a),r=e.consume(ax.c),s=f?.extension,t=!!s&&(".fluid"===s||".loop"===s||".note"===s||".whiteboard"===s||".wbtx"===s),u=a.fallbackErrorCode,v=(0,db.a)(),x=v.palette;if(N.useEffect(()=>{0===h&&i&&i()},[h,i]),N.useEffect(()=>{a.fallbackCxpRef?.current?.end({resultType:co.c.Success,extraData:{viewer:aX.a.Other,extension:f&&f.extension||""}})},[]),f)if(k&&k.isAvailable&&(b={id:"downloadCommand",action:k}),(0,aX.b)(f).length>0&&(u=1),(0,a4.Oc)()){if(g===aX.a.WAC&&m&&m.isAvailable)c={id:"openCommand",action:m};else if(g===aX.a.Other&&(0,aX.b)(f).length>0&&(0,aX.b)(f)[0].originalViewer&&(0,aX.b)(f)[0].originalViewer===aX.a.WAC&&m&&m.isAvailable)c={id:"openCommand",action:m};else if(g===aX.a.Other&&!t&&(dq||!f.zip)&&o&&o.isAvailable)if(dr)c={id:"openCommand",action:o};else{let a=f.key?r.getItemUrlParts(f.key)?.fullItemUrl:void 0;(f.folder||!(0,dm.b)(f.openUrl,a))&&(c={id:"openCommand",action:o})}}else g===aX.a.Other&&!t&&(dq||!f.zip)&&o&&o.isAvailable?c={id:"openCommand",action:o}:g===aX.a.WAC&&m&&m.isAvailable&&(c={id:"openCommand",action:m});let y=e.consume(a2.f),z=a=>{let b=(0,aV.i)(a);y.updateErrorState(`otherViewerActionFailure: ${a}`,{errorType:aV.d.actionError,error:b,item:f})},A=f?.lifeCycleStatus?.isMalwareDetected??!1,B=!dp&&!dn,C=!!p?.allowInfectedDownload,D=!!p?.m365GroupsBlockDownloadsExperienceEnabled,E=c5.d,F=dj.a;return B&&(d=v&&v.isInverted?dl.a:dk.a),N.createElement("div",{className:"OneUpOther_04a3e9e8"},N.createElement("div",{className:"OneUpOtherContent_04a3e9e8"},B?N.createElement("img",{className:"OneUpOtherMalwareDetectedIconExperiment_04a3e9e8",src:d,alt:E}):A?N.createElement("img",{className:"OneUpOtherMalwareDetectedIcon_04a3e9e8",src:F,alt:E}):f?.iconName?N.createElement("div",{className:"OneUpOtherFileIcon_04a3e9e8"},N.createElement(di,{iconName:f.iconName,platformDetection:q,desiredSize:96})):null,N.createElement("div",{className:"OneUpOtherFileName_04a3e9e8",style:{color:x?.black}},f?.name),N.createElement("div",{className:"OneUpOtherMessageNewDesign_04a3e9e8",style:{color:x?.black}},A?N.createElement(da.a,{allowInfectedFileDownload:C}):f?.itemStatus!==br.b.ConditionalAccessBlocked?function(a,b){switch(b){case 0:return c5.i;case 1:return c5.h;default:return a?c5.e:c5.f}}(B,u):D?c5.a:c5.b),N.createElement("div",{className:"OneUpOtherActions_04a3e9e8"},c&&f&&N.createElement(c4,{command:c,text:c5.g,buttonType:w.primary,updateErrorStateCallBack:z,toolTipText:c5.g}),b&&f&&N.createElement(c4,{command:b,text:c5.c,buttonType:c?w.default:w.primary,updateErrorStateCallBack:z,toolTipText:c5.c}))))}(r=x||(x={}))[r.ZipTooLarge=0]="ZipTooLarge",r[r.UnsupportedFileType=1]="UnsupportedFileType";var dt=c(485),du=c(16),dv=c(631),dw=c(630);let dx=!K.Ov.isActivated("229b7061-d676-49af-a733-a9b269161b4b");function dy(a){return!!a&&a.width>0&&a.height>0}function dz(a){let b,{size:c,scale:d,item:e,isMeTA:f}=a,[g,h]=N.useState({localBlobImageUrl:"",scale:a.scale}),i=dx?{width:0,height:0}:{width:e?.photo?.width||0,height:e?.photo?.height||0},j=0===i.width||0===i.height,[k,l]=N.useState(j?void 0:i),[m,n]=N.useState(!0),o=(0,ar.c)(),[p,q]=N.useState(!0),r=N.useRef(),s=!!o.consume(a9.a),t=(0,aT.a)(()=>j?{width:k?.width||0,height:k?.height||0}:i),u=(0,aT.a)(async b=>{try{if((0,a4.kc)()&&e&&(f||(0,a4.cb)()&&!e.thumbnail?.url)){let a=o.consume(a$.a),f=(0,a4.qc)()?{useDirectEndpoint:!0,size:c,apiVersion:"v2.1",headers:{accept:"image/*"}}:{useDirectEndpoint:!0,size:c},{blobUrl:g,error:i}=await a.getThumbnailUrl(e,f)||{};if(r.current=b,g)h({localBlobImageUrl:g,scale:d}),q(!1);else if(i)throw(0,cB.a)(b,i);else throw b}else throw b}catch(b){a.onImageLoadFail(b),q(!1)}}),v=(0,aT.a)(b=>{if(r.current){let b=r.current;"code"in b&&(b.code=`${b.code}-VroomLoadFail`),a.onImageLoadFail(b)}else a.onImageLoadFail(Error("img load fail"))}),w=(0,aT.a)(a=>{(0,a4.Sb)()&&a.preventDefault()}),x=(0,aT.a)(async(a=g.scale,b={width:1024,height:1024},c)=>{if(g.localBlobImageUrl&&a<=g.scale)return;let d=c,i={width:Math.ceil(b.width*a*window.devicePixelRatio),height:Math.ceil(b.height*a*window.devicePixelRatio)},k=d?new du.b(d):void 0;if(k){let a=t();j&&i&&(a=i),k.setQueryParameter("width",(a.width||1024).toString()),k.setQueryParameter("height",(a.height||1024).toString()),d=k.toString()}try{let b,c;if((0,a4.fb)()&&e&&e.photoContent?b=e.photoContent.url:{blobUrl:b,error:c}=await (0,cB.b)({resources:o,thumbnailUrl:d,isMeTA:f,isMeTATempAuthDeprecationEnabled:s}),b)h({localBlobImageUrl:b,scale:a});else if(c)throw c;q(!1)}catch(a){await u(a)}}),y=g.localBlobImageUrl?g.localBlobImageUrl:a.item?.thumbnail?.url;if(N.useEffect(()=>{j||!g.localBlobImageUrl?x(d,c,e?.thumbnail?.url).catch(()=>{}):q(!1)},[]),!c)return N.createElement(N.Fragment,null);let z=t(),A={width:c.width*d,height:c.height*d};return dy(z)&&dy(A)&&(b=(0,dv.b)({boundsSize:A,contentSize:z,mode:"contain",maxScale:1/0})),b&&k&&b.width>k.width&&b.height>k.height&&(b=d<=1?k:{width:k.width*d,height:k.height*d}),N.createElement("div",{className:cz,"data-automation-id":"oneup-image-container"},!p&&N.createElement("img",{"data-automation-id":"oneup-image-frame","tab-index":0,alt:K.rz(dw.a,a.item?.displayName),src:y,style:k?{width:`${b?.width}px`,height:`${b?.height}px`,opacity:1}:{opacity:0},onLoad:b=>{if(m&&a.onViewerLoaded){let b=r.current;b&&"code"in b&&(b.code=`${b.code}-VroomLoadSuccess`),a.onViewerLoaded(b),n(!1)}y&&0===y.indexOf("blob:")&&1===d&&!k&&l({width:b.currentTarget.offsetWidth,height:b.currentTarget.offsetHeight})},onError:v,onContextMenu:w}))}let dA=(0,bA.a)(async()=>(await Promise.resolve().then(c.bind(c,485))).Projector);function dB(a){let{item:b,offset:d,fallbackToOtherViewer:e,onViewerLoaded:f,parentItem:g}=a,h=(0,ar.c)(),i=h.consume(a2.f),[j]=(0,a2.g)("currentState",a=>a.imageMode===a2.c.edit),k=!j&&(0,a6.b)(b?.thumbnail?.url),l=N.useRef(),m={url:b?.thumbnail?.url,noTempAuth:!b?.thumbnail?.url||!(0,a8.a)(b.thumbnail.url)};N.useEffect(()=>{k&&0===d&&(l.current=(0,a7.a)(aX.a.Photo))},[k,d]);let n=(0,aT.a)(async(a=!1)=>{i.updateImageState("openImageEditor",a2.c.view)}),o=(0,aT.a)(a=>{let b=l.current;l.current&&a&&((0,a7.b)(l.current,void 0,a),b=void 0),f({meTAEvent:b,extraData:m})}),p=(0,aT.a)(a=>{0===d&&(i.updateErrorState("oneupPhotoViewer",{errorType:aV.d.viewerInitLoadingError,error:a,item:b,meTAEvent:l.current,extraData:m}),e&&e(Error("photoViewerFailToLoad"),"PhotoViewer"))}),q=(0,aT.a)(a=>{if(0===d){let c=(0,aV.i)(a.message,a.id);i.updateErrorState("oneUpPhotoEditor",{errorType:aV.d.actionError,error:c,item:b}),e&&e(Error("photoEditorFailToLoad"),"PhotoViewer")}});if(!b||0!==d)return N.createElement(N.Fragment,null);let r=N.createElement(dA,{mode:dt.ProjectorMode.preview},({size:a,transformV:c})=>N.createElement(dz,{item:b,size:a,scale:c.scale,onImageLoadFail:p,onViewerLoaded:o,isMeTA:k})),s=(0,bA.a)(async()=>(await c.e(54).then(c.bind(c,837))).OneUpImageEditor);return N.createElement(N.Fragment,null,j&&b?N.createElement(s,{item:b,parentItem:g,resources:h,switchToView:n,onErrorCallBack:q}):r)}var dC=c(147),dD=c(271);(0,H.ZW)([{rawString:".OneUpTextFileContent_b125dea2{position:absolute;top:0;left:0;right:0;bottom:0;display:flex;flex-flow:column nowrap;align-items:stretch;justify-content:space-between;box-shadow:0 0 7px 2px rgba(0,0,0,.15);border-radius:5px}.OneUpTextFileContent_b125dea2 .OneUpTextFileTitle_b125dea2{flex:0 0 24px;font-size:14px;padding:6px 0 0 10px}html[dir=rtl] .OneUpTextFileContent_b125dea2 .OneUpTextFileTitle_b125dea2{padding:6px 10px 0 0}.OneUpTextFileContent_b125dea2 .OneUpTextFileEditor_b125dea2{position:relative;flex:1 1 auto;width:100%}.isFluentVNext_b125dea2 .OneUpTextFileContent_b125dea2{border-radius:"},{theme:"roundedCorner4",defaultValue:"4px"},{rawString:"}.isFluentVNext_b125dea2 .OneUpTextFileContent_b125dea2 .OneUpTextFileTitle_b125dea2{border-top-left-radius:"},{theme:"roundedCorner4",defaultValue:"4px"},{rawString:";border-top-right-radius:"},{theme:"roundedCorner4",defaultValue:"4px"},{rawString:"}.OneUpTextFileContentLight_b125dea2{background-color:#fff;color:"},{theme:"black",defaultValue:"#000"},{rawString:"}.OneUpTextFileContainer_b125dea2{position:relative;margin:auto;width:75%;height:100%}.oneUpTextEditor{height:100%}"}]);var dE=c(486),dF=c(236),dG=c(190),dH=c(360);(s=y||(y={})).Default="Default",s.OneUpTextFile="OneUpTextFile";let dI=!K.Ov.isActivated("c0448c19-5a5d-49a7-818a-33485f56176e"),dJ=!K.Ov.isActivated("a0d3c12d-224c-4052-a6a4-0ba003e4ec1d");function dK(a){let{closeCallback:b}=a,d=(0,ar.c)(),e=d.consume(a2.f),f=d.consume(aF.b),g=d.consume(ap.a),h=d.consume(bP.i),[i,j]=N.useState(!1),k=N.useRef(a.editorContent),[l,m]=N.useState(a.editorContent),[n,o]=N.useState(void 0),p=d.consume(dG.a),q=!!a.item&&p.evaluateAction({item:a.item}).isAvailable,r=N.useRef(!0);N.useEffect(()=>()=>{r.current=!1},[]),N.useEffect(()=>{if(dH.a){let a=a=>g.beforeUnload.isHashNavDialogHandlerRegistered?.()&&q?y.OneUpTextFile:"",c=()=>E.c.resolve(b?.(!0).then(()=>{f.clean(),e.clean(),e.navClean()}));return g.beforeUnload.registerHandler(a),g.beforeUnload.registerOnContinueHandler(c),()=>{g.beforeUnload.unRegisterHandler(a),g.beforeUnload.unRegisterOnContinueHandler(c)}}},[q,g.beforeUnload,f,e,b]),N.useEffect(()=>{let a=()=>{(!dJ||r.current)&&(window.innerWidth<1024&&!i?j(!0):window.innerWidth>=1024&&i&&j(!1))};return a(),window.addEventListener("resize",a),()=>{window.removeEventListener("resize",a)}},[i]),N.useEffect(()=>{(!dJ||r.current)&&(a.editorContent!==l&&(m(a.editorContent),k.current=a.editorContent),a.item&&e.updateViewerState("updateSaveStatus",{key:a.item.key,options:{saveData:{saveButtonVisible:!1}}}))},[l,e,a.editorContent,a.item,a.item?.key]);let s=(0,aT.a)(async()=>{let b=(await c.e(1).then(c.bind(c,774))).resourceKey,e=d.consumeAsync(b),f=null;if(a.item&&a.parentItem&&(f=(await e).evaluateAction({item:a.item,parentItem:a.parentItem})),f&&f.onExecute&&a.item){let a=new bp.a({name:"OneUpLightSpeed.saveInvokedInEditor"});f.onExecute({qosEvent:a})?.then(()=>{}).catch(a=>{})}}),t=(0,aT.a)(b=>{(!dJ||r.current)&&(a.setEditorLoaded(!0),b.addCommand(monaco.KeyMod.CtrlCmd|monaco.KeyCode.KeyS,()=>{s()},""),k.current=l,b.onDidChangeModelContent(()=>{if(dJ&&!r.current)return;let c=b.getValue();if(void 0!==k.current&&c!==k.current&&a.item){o(c);let b=new Blob([c],{type:a.item.textEditorMimeType});b.name=a.item.name;let d={extension:a.item.extension,iconName:"text",name:(a.item.name||"")+a.item.extension,size:c.length,_file:b,slice:(a,c)=>b},f=e.getViewerState(a.item.key);f&&f.saveData&&(f.saveData.fileUpload=d),f&&f.saveData&&f.saveData.saveButtonVisible||e.updateViewerState("updateSaveStatus",{key:a.item.key,options:{saveData:{saveButtonVisible:!0,fileUpload:d}}})}else a.item&&c===l&&(o(c),e.updateViewerState("updateSaveStatus",{key:a.item.key,options:{saveData:{saveButtonVisible:!1}}}))}))}),u={wordWrap:"on",automaticLayout:!0,scrollbar:{alwaysConsumeMouseWheel:!1},minimap:{enabled:!i},readOnly:!a.isEditable,theme:h?"vs-dark":"vs",...dI?{unicodeHighlight:{invisibleCharacters:!1,ambiguousCharacters:!1}}:{}},v="OneUpTextFileContent_b125dea2";return h||(v+=" OneUpTextFileContentLight_b125dea2"),N.createElement("div",{className:v,"data-automationid":"OneUpTextFile-Content"},N.createElement("div",{className:"OneUpTextFileTitle_b125dea2","data-automationid":"OneUpTextFile-Title"},a.editorTitle),N.createElement("div",{className:"OneUpTextFileEditor_b125dea2"},N.createElement(dE.a,{className:"oneUpTextEditor",editorDidMount:t,language:"plaintext",options:u,value:n||l,moduleType:dF.a.ESM,getWorkerUrl:()=>"",importESMModule:()=>E.c.resolve(c.e(48).then(c.bind(c,838)))})))}let dL=new K.v7({name:"EncodingProviderAsyncKey",loader:new K.dE(()=>c.e(17).then(c.bind(c,840)).then(a=>a.resourceKey))});var dM=c(361);let dN=!K.Ov.isActivated("5bbf5cba-aaed-483d-82d0-a2629a658259"),dO=!K.Ov.isActivated("960e7f41-3474-4923-a898-b4b542bd118e"),dP=!K.Ov.isActivated("3AB8014F-9C31-4C18-8258-37E7110BCE71"),dQ=!K.Ov.isActivated("A6C39EC2-C951-45F4-AF81-86FAABEC4E4E"),dR=!K.Ov.isActivated("9e2926a7-5e7c-437b-9772-9e27b881a0be"),dS=!K.Ov.isActivated("091d7a76-c2c5-44ae-bb54-a9267e0aba62");function dT(a){let b=(0,ar.c)(),[c,d]=N.useState(""),[e,f]=N.useState(""),[g,h]=N.useState(!1),[i,j]=N.useState(0),[k,l]=N.useState(!0),m=N.useRef(!0),[n,o]=N.useState(!1),[p,q]=N.useState(!1),r=b.consume(an.a),s=b.consume(a2.f),{item:t,offset:u,fallbackToOtherViewer:v,parentItem:w}=a,x=N.useRef(!0);N.useEffect(()=>()=>{x.current=!1},[]);let y=(0,aT.a)(a=>{0===u&&(s.updateErrorState("oneupTextViewer",{errorType:aV.d.viewerInitLoadingError,error:a,item:t}),v&&v(Error("textViewerFailToLoad"),"TextViewer"))}),z=(0,aT.a)(b=>{(!dP||x.current)&&(b?(2!==i&&j(2),dR?m.current&&a.onViewerLoaded&&g&&(a.onViewerLoaded(),m.current=!1):k&&a.onViewerLoaded&&g&&(a.onViewerLoaded(),l(!1))):y(Error("Error loading monaco editor")))}),A=(0,aT.a)(a=>{let c=a.extension?(0,dC.c)(a.extension):void 0;async function e(a){if(a&&c)if(!dN)return a1.c(a,c);else{let d=(await b.consumeAsync(dL)).getEncoding();return a1.a(a,c,d)}}function f(a){if(dP&&!x.current)return;let b=a;if(dO&&a?.status){let{status:c,code:d,correlationId:e,data:f,...g}=a;delete g.authenticate,delete g.targetUrl,delete g.redirectUrl,b=new K.lM({code:`${c}_${d}`,correlationId:e,isExpected:dS?403===c&&"917656"===d:void 0,extraData:{innerError:f,...g}})}y(b),o(!1)}function g(a){(!dP||x.current)&&(d(a?.text||""),h(!0),o(!1))}return E.c.resolve(b.consumeAsync(a0.downloadDataSourceKey)).then(b=>b.getItemContents(a)).then(async a=>e(a)).then(a=>{g(a)}).catch(async c=>{let d=dQ?await b.consumeAsync(bP.d.optional):void 0;if(d){let b=new bp.a({name:"OneUpTextViewerOpenFallbackOnVroom"});return d(a).then(async a=>e(a)).then(a=>{g(a);let d=c.data?.error?.code?.split(",")[0]===dM.a.fileNotFound.toString();b.end({resultType:bp.b.ExpectedFailure,extraData:{error:c,errorMessage:"SPO API failed, most likely due to cross farm content. Fallback on Vroom API."}}),d&&(!dP||x.current)&&q(!0)}).catch(a=>{b.end({resultType:bp.b.Failure,extraData:{error:a}}),f(a)})}f(c)})}),B=(0,aT.a)(a=>{dP&&!x.current||f(a.displayName||a.name||"")});N.useEffect(()=>{g&&2===i&&z(!0)},[z,i,g]),N.useEffect(()=>{!g&&t&&(A(t),B(t))},[g,t,A,B,i]),N.useEffect(()=>{if(!g&&t){let a=setTimeout(()=>{(!dP||x.current)&&o(!0)},5e3);return()=>{clearTimeout(a)}}},[g,t]);let C=(0,aT.a)(()=>{if(p||t&&t.extension&&".osts"===t.extension||!t)return!1;var b=a.list;if(!bq.a.hasItemPermission(t,bq.a.editListItems)||!r)return!1;let c=b?.list?.isForceCheckout;return!(0,dD.a)(t,r.userId)&&(!c||!!(0,dD.b)(t,r.userId))}),D=N.createElement("div",{className:"OneUpTextFileContainer_b125dea2"},N.createElement(dK,{editorTitle:e,editorContent:g?c:void 0,isEditable:C(),setEditorLoaded:z,item:t,parentItem:w,closeCallback:a.closeCallback})),F=N.useRef();return F.current||(F.current={viewer:aX.a.TextFile,extension:t&&t.extension||"unknown"}),n&&!g&&(D=N.createElement(cC,{mainViewerEngagementData:F.current,isMainViewer:!1,...a})),D}(t=z||(z={}))[t.shouldLoad=0]="shouldLoad",t[t.loading=1]="loading",t[t.loaded=2]="loaded",t[t.error=3]="error",(0,H.ZW)([{rawString:".OneUpWacFullScreen_bfffd0c2{width:100%;height:100%;border:0}.OneUpWacNinetyPercent_bfffd0c2{width:90%;height:100%;border:0;margin:auto}"}]);let dU="OneUpWacFullScreen_bfffd0c2",dV=(0,K.hl)("WopiFrameDataSource",class{getWopiFrameUrl(a,b){let c="ms-word"===a.appMap,d=a.wopiFrameUrl,e=c?this._wordAction:"embedview",f=d&&d.replace(/action=([^&]+)/,`action=${e}&wdnc=1&nobg=1&wdhostscenario=oneuplightspeed`);return(f&&!K.lU.isFeatureEnabled({ODB:60385})&&(f=f?.concat("&bypassowl=true")),c&&!K.Ov.isActivated("feaac491-2c3c-48e6-b23a-701bb912ce09")&&(f=f?.concat("&wdignorefpo=1")),!K.Ov.isActivated("53193300-5ac6-4cf5-a3a0-882ac3497e79","10/31/2024","Update wopiembedframe.aspx to doc.aspx for embedview action")&&K.lU.isFeatureEnabled({ODB:62222})&&b)?f?f.replace("Doc.aspx","doc2.aspx"):void 0:f?f.replace(/\/_layouts\/[^?]+/i,`/_layouts/15/${b?"WopiEmbedFrame":"doc"}.aspx`):void 0}constructor(a,b){const c=b.platformDetection;this._wordAction=c.isMobile&&!c.isIPad?"mobileview":"embedview"}},{platformDetection:aC.a}),dW=new K.v7("wopiToken");var dX=c(6),dY=c(283),dZ=c(47),d$=c(41),d_=c(246);function d0(a){let b=!K.Ov.isActivated("2c617684-fdeb-4e99-91af-9f322f25818d","7/18/2024","Killswitch to use channel message to communicate WAC page with parent frame"),c=a.item,d=(0,ar.c)(),e=d.consume(dV),f=d.consume(dW.optional),g=d.consume(a2.f),h=d.consume(an.a),[i,j]=N.useState(!1),[k,l]=N.useState(),[m,n]=N.useState(""),o=N.createRef(),p=N.useRef(!1),[q]=N.useState(Math.random().toFixed(16)),[r,s]=N.useState(),[t,u]=N.useState("");if(!(0,a4.mc)()){let a=d.consume(b3.resourceKey),b=new cf.a({},{pageContext:h}).getItemUrlParts(c.key),e=new dX.a(b.normalizedItemUrl);a.getSharePointToken({webAbsoluteUrl:e.authority,apiQosName:"OneUpWacViewer"}).then(a=>{u(a.accessToken)})}let v=(b,d,e)=>{g.updateErrorState("oneupWacViewer",{errorType:aV.d.viewerInitLoadingError,error:b,item:d,extraData:{...e,extension:c?.extension,appMap:c?.appMap}}),a.fallbackToOtherViewer&&a.fallbackToOtherViewer(b,"WacViewer")},w=a=>{if(o&&o.current?.contentDocument){let b=o&&o.current?.contentDocument;b.body||b.createElement("body");let c=b.createElement("form");c.action=a.url,c.method="POST",c.style.visibility="hidden",c.target="_self";let d=a.postdata;for(let a in d)if(a&&d[a]){let e=b.createElement("input");e.type="hidden",e.name=a,e.value=d[a],c.appendChild(e)}b.body.appendChild(c),c.submit(),j(!0)}else v((0,aV.i)("missing iframe reference for form post","WacIFrameReferenceError"),c)},x=(d,e,f,g,i,j)=>{let k=bp.b.Success,l=JSON.stringify(f);if(d)try{k=bp.b[d]}catch{k=bp.b.Failure,l="Additional Error: Failed to convert WAC Event Data resultType to known result type, using default of Failure. Original WAC errorInfo: "+l}let m={hostSessionId:g,loadResultSource:b?"wacChannelMessaging":"wacWindowPostMessage"};k!==bp.b.Success||d?.toLowerCase().indexOf("failure")!==-1?v(new K.lM({code:e||"oneupWacLoadGenericFailure",message:l,correlationId:i||h?.CorrelationId,isExpected:k===bp.b.ExpectedFailure,extraData:{...m,stack:f?JSON.stringify(f):"",rawError:JSON.stringify(j)}}),c,{...j}):a.onViewerLoaded&&a.onViewerLoaded({extraData:{...m,...j}})},y=a=>{let b;try{b=a.data}catch(b){v((0,aV.i)("Error loading Wac viewer iframe - cannot parse wac message","WacInitIframeError.ProcessWacMessage"),c,{...a,e:b}),p.current=!0;return}"WacHost_initialized"===b.messageId&&x(b.values?.resultType,b.values?.resultCode,b.values?.errorInfo,b.hostSessionId,b.correlationId||h?.CorrelationId,b),p.current=!0};N.useEffect(()=>{c&&(!i||t)&&(a=>{let d;if(f&&f.then(a=>{d=a}),!c||!a||""===d)return v((0,aV.i)("missing item or wopitokenval","WacItemOrTokenError"),c);let g=e.getWopiFrameUrl(c,d);if(!g||/^javascript:\/\//i.test(g.trim()))return v(g?(0,aV.i)("wopiframeurl is not acceptable format","WacUrlFormatError"):(0,aV.i)("wopiframeurl is empty","WacUrlEmptyError"),c);let i=dY.a(h);i&&(g+="&wdorigin="+encodeURIComponent(String(i)));let k="OfficeDocClickTime",o=new dZ.a("",d$.a.local),p=o.getValue(k,d$.a.session),r=p?new Date(p):void 0;o.setValue(k,"",d$.a.session),r&&(g+="&CT="+encodeURIComponent(String(r)));let s=new d_.b,u=s&&s.viewParams.uih;if(u&&(g+="&uih="+u),n(new URL(g).origin),b&&(g+=new URLSearchParams({wdskipfccheck:"true",appName:"OneUp",origin:window.location.origin,channelId:q,app:"OneUp",scenario:"OneUpWacViewer"})),d){let a=s&&s.viewParams.EmbeddingPageOrigin,b=s&&s.viewParams.EmbeddingPageSessionInfo;w({url:g,postdata:{access_token:d,EmbeddingPageOrigin:a||m,EmbeddingPageSessionInfo:b||""}})}else!(0,a4.mc)()&&t?w({url:g,postdata:{access_token:t}}):(l(g),j(!0))})(c)},[i,c,f,t]),N.useEffect(()=>{let a,c=o?.current?.contentWindow;function d(a){if(a.source&&c&&a.source===c){let b=a.data;if("initialize"===b.type&&b.channelId===q){let b=a.ports[0];b&&s(b)}}}if(b&&!r&&c)return a=window.setInterval(()=>{c.postMessage({type:"identify-parent",channelId:q},m)},1e3),window.addEventListener("message",d),()=>{a&&(clearInterval(a),a=void 0),window.removeEventListener("message",d)}},[r,o,k,q,b,m]),N.useEffect(()=>{function a(a){var b=a.data;if("notification"===b.type){let a=b.data;"page-loaded"===a.notification&&x(a.result?.resultType,a.result?.resultCode,a.result?.errorInfo,a.hostSessionId,a.correlationId||h?.CorrelationId,a)}p.current=!0}if(r&&b)return r.addEventListener("message",a),r.start(),r.postMessage({type:"activate"}),()=>{r.removeEventListener("message",a)}},[r,b]),N.useEffect(()=>{b||window.addEventListener("message",y,!1)},[]),N.useEffect(()=>()=>{b||window.removeEventListener("message",y,!1)},[]);let z=(0,aT.a)(()=>{setTimeout(function(){p.current||v((0,aV.i)("Error loading Wac viewer iframe - no response from wac in callbacktimeout 240000ms","WacInitIframeError.WacCallbackTimeout"),c)},24e4)}),A=(0,aT.a)(()=>{z()}),B=(0,aT.a)(()=>{0===a.offset&&v((0,aV.i)("Error loading Wac viewer iframe","WacInitIframeError.IFrameLoadError"),c)}),C=a.isFallback?"fallback":"",D=a.item?.appMap==="ms-excel",E=i&&c?N.createElement("div",{className:`oneup-wac-container ${D?"OneUpWacNinetyPercent_bfffd0c2":dU} ${C}`,"data-automation-id":"oneup-wac-container"},N.createElement("iframe",{"data-automation-id":"oneup-wac-frame",className:`oneup-wac-frame ${dU}`,ref:o,title:c.name,onLoad:A,onError:B,src:k})):N.createElement(N.Fragment,null);return(0,a4.Fc)()?0===a.offset?E:N.createElement(N.Fragment,null):E}function d1(a){return a.getResponseHeader("X-CorrelationId")||void 0}(A||(A={})).WacHostInitialized="WacHost_initialized";let d2=(0,K.hl)("OneUpZipDataSource",class{getContents(a,b){let c=new bp.a({name:"OneUpZipDataSourceGetContents"});return this._getMeTAHeader().then(a=>this._makeXHR({url:b,headers:a})).then(b=>{let d=b.status;if(d>=200&&d<300)try{let{delimiter:d,error:e,list:f=[]}=JSON.parse(b.responseText).metadata;return a.dateModified&&a.extension&&a.name&&c.end({resultType:bp.b.Success}),{delimiter:d,error:e,root:{children:f,date:a.dateModified||"",extension:a.extension||"",isFolder:!0,name:a.name||"",childCount:f.length,parentFolder:void 0,path:"",size:0}}}catch(a){return c.end({resultType:bp.b.ExpectedFailure,extraData:{e:a,code:`${d}.InvalidResponse`}}),E.c.reject(new K.lM({code:`${d}.InvalidResponse`,message:a&&a.message,correlationId:d1(b),isExpected:!0,extraData:{responseText:b.responseText}}))}{let a={code:`${d}.InvalidStatus`,message:"getContents xhr status unacceptable range",status:d,statusText:b.statusText,responseType:b.responseType,response:b.response,responseTxt:b.responseText};return c.end({resultType:bp.b.Failure,extraData:{...a}}),E.c.reject(b)}}).catch(a=>{let b;if(a instanceof K.lM)return c.end({resultType:bp.b.Failure,extraData:{error:a,code:`${a.code}.XhrExceptionApiErr`}}),E.c.reject(a);let d=!1,e=a&&a.message,f="GetZipContents";if(a instanceof XMLHttpRequest){let c=a&&a.status;d=!!c&&c>=400&&c<500,(!c||this._offlineDetection.offline)&&(d=!0),b=d1(a),f=a.getResponseHeader("X-ErrorCode")||"";try{let b=JSON.parse(a.responseText),c=b&&b.error;for(;c.innererror;)c=c.innererror;c&&(e=c.message,f=c.code)}catch(b){e=a.responseText?"Invalid JSON response":"Empty response",d=!0}f=`${c}.${f}`}return c.end({resultType:d?bp.b.ExpectedFailure:bp.b.Failure,extraData:{code:`${f}.XhrException`,error:a,resultCode:f,errorMessage:e,correlationId:b}}),E.c.reject(new K.lM({code:f,message:e,isExpected:d,correlationId:b,extraData:{responseText:a instanceof XMLHttpRequest?a.responseText:""}}))})}constructor(a,b){this._makeXHR=b.makeXHR||aZ.a.start,this._offlineDetection=b.offlineDetection,this._getMeTAHeader=b.getMeTAHeader}},{makeXHR:void 0,offlineDetection:cl.a,getMeTAHeader:a5.a});var d3=c(636);(0,H.ZW)([{rawString:".OneUpZipContainer_1e83ea04{margin:auto;margin-top:20px;box-shadow:0 0 7px 2px rgba(0,0,0,.15);display:flex;flex-direction:column;max-width:780px;min-width:70%;height:95%}.OneUpZipHeader_1e83ea04{height:130px;display:flex;min-height:130px;justify-content:center;position:relative}.OneUpZipImage_1e83ea04{height:130px;width:135px}.OneUpZipNumber_1e83ea04{position:absolute;top:83px;font-size:medium;width:113px}html[dir=ltr] .OneUpZipNumber_1e83ea04{text-align:right}html[dir=rtl] .OneUpZipNumber_1e83ea04{text-align:left}.OneUpZipNumber_1e83ea04.NumberV2_1e83ea04{padding-right:20px}.OneUpZipList_1e83ea04{padding:0 20px;overflow:auto}"}]);var d4=c(637);(0,H.ZW)([{rawString:".odZipContentListBreadcrumb_472c7f54{margin-bottom:20px}.odZipContentListLink_472c7f54{cursor:pointer;text-decoration:none;font-size:12px}.odZipContentListLink_472c7f54:hover{text-decoration:underline;color:"},{theme:"black",defaultValue:"#000"},{rawString:"}"}]);var d5=c(640),d6=c(641),d7=c(364),d8=c(94),d9=c(369),ea=c(331),eb=c(646),ec=c(639),ed=c(33),ee=c(339);class ef extends N.Component{render(){let a=!!this.props.allowSelection,b=this.state.ancestors,c=this.state.crumbs.reduce((a,b)=>a?K.rz(ec.a,b.text,a):b.text,""),d=b[b.length-1].childCount,e=K.sQ(ec.i,ec.h,d),f=e?K.rz(e,d):"";return N.createElement(ea.a,null,N.createElement(d5.a,{className:"odZipContentListBreadcrumb_472c7f54",ariaLabel:K.rz(ec.b,c),items:this.state.crumbs,maxDisplayedItems:5}),N.createElement(d6.a,{className:"od-ZipContent-DetailsList",items:b[b.length-1].children,columns:this._columns,checkboxVisibility:a?d7.a.onHover:d7.a.hidden,selectionMode:a?d8.c.multiple:d8.c.none,layoutMode:d7.e.fixedColumns,onItemInvoked:this._onItemInvoked,selection:this._selection,constrainMode:d7.d.horizontalConstrained,selectionPreservedOnEmptyClick:!0,ariaLabel:f,onDidUpdate:this._onDetailsListUpdated}))}UNSAFE_componentWillReceiveProps(a){this.props!==a&&a.root!==this.props.root&&this.setState((a,b)=>{let{root:c}=b;return this._selection.setItems(c.children,!0),{ancestors:[c],crumbs:this._appendBreadcrumb([],c.name)}})}_onDetailsListUpdated(){!this.state.initialLoadComplete&&(this.setState({initialLoadComplete:!0}),this.props.onLoad&&this.props.onLoad())}_onItemInvoked(a){a.isFolder&&this.setState(b=>{let c=b.crumbs,d=c.length;return this._selection.setItems(a.children,!0),this.props.onNavigate(a),{ancestors:b.ancestors.concat([a]),crumbs:this._appendBreadcrumb([...c.slice(0,-1),{...c[d-1],isCurrentItem:!1}],a.name)}})}_onBreadcrumbClick(a,b){if(b){let a=parseInt(b.key,10);this.setState(b=>{let c=b.ancestors[a];return this._selection.setItems(c.children,!0),this.props.onNavigate(c),{ancestors:b.ancestors.slice(0,a+1),crumbs:this._appendBreadcrumb(b.crumbs.slice(0,a),c.name)}})}else console.log("no item available for breadCrumbClick")}_appendBreadcrumb(a,b){let c=a.length;return[...a,{text:b,key:`${c}`,isCurrentItem:!0,onClick:this._onBreadcrumbClick}]}_getAllColumns(){return[{key:"zipIcon",fieldName:void 0,minWidth:20,maxWidth:20,name:"",onRender:eg.bind(this)},{key:"zipName",fieldName:void 0,isResizable:!0,minWidth:200,name:ec.d,onRender:eh.bind(this,"name")},{key:"zipDateModified",fieldName:void 0,isCollapsable:!0,isResizable:!0,minWidth:100,name:ec.c,onRender:eh.bind(this,"date")},{key:"zipFileSize",fieldName:void 0,isCollapsable:!0,isResizable:!0,minWidth:100,name:ec.e,onRender:(a,b,c)=>a?N.createElement("div",null,a.size?d4.a.getDisplayString(a.size,{language:bn.a.language,ignoreZero:!0}):""):N.createElement(N.Fragment,null)}]}constructor(a){super(a);const{root:b}=a;this._onItemInvoked=this._onItemInvoked.bind(this),this._onBreadcrumbClick=this._onBreadcrumbClick.bind(this),this._onDetailsListUpdated=this._onDetailsListUpdated.bind(this),this._columns=this._getAllColumns(),this.state={ancestors:[b],crumbs:this._appendBreadcrumb([],b.name),initialLoadComplete:!1};const c=this._selection=new d9.a({selectionMode:d8.c.single,onSelectionChanged:()=>{let a=this.state.ancestors;this.props.onSelect(c.getSelection(),a[a.length-1])}});c.setItems(b.children,!0)}}function eg(a,b,c){if(!a)return N.createElement(N.Fragment,null);let{extension:d}=a,e={extension:d,size:20,type:a.isFolder?H.Xx.folder:void 0},f=(0,ee.a)(e);return N.createElement(ed.a,{...f,style:{width:"20px",height:"20px"},title:a.isFolder?ec.f:K.rz(ec.g,d)})}function eh(a,b,c,d){return b?"name"===a&&!0===b.isFolder?N.createElement(eb.a,{className:"odZipContentListLink_472c7f54",onClick:()=>this._onItemInvoked(b)},b[a]):N.createElement("div",null,b[a]):N.createElement(N.Fragment,null)}var ei=c(370),ej=c(649),ek=c(650);function el(a){let b=a.item,c=(0,ar.c)(),d=c.consume(aC.a).isRetinaSupported,e=c.consume(a2.f),[f,g]=N.useState(!1),[h,i]=N.useState(),[j,k]=N.useState(),l=N.useContext(ei.d),m={extension:b?.extension||"unknown",viewer:aX.a.Zip,engagementContext:l},n=(a,b)=>{},o=a=>{i(a.childCount),(0,ei.g)(`${ei.c}.ZipNavigateNested`,m)};N.useEffect(()=>{!f&&b&&(f=>{let h=f.zip&&f.zip.zipMetaDataUrl,j=!h||!(0,a8.a)(h),l=c.consume(d2);if(!h){let c=(0,aV.i)("zip url is null","ZipEmptyMetadataUrl");e.updateErrorState("oneupZipViewer",{errorType:aV.d.viewerInitLoadingError,error:c,item:b,extraData:{noTempAuth:j}}),a.fallbackToOtherViewer&&a.fallbackToOtherViewer(c,"ZipViewer");return}let m=(0,a6.b)(h)?(0,a7.a)(aX.a.Zip):void 0,p={hasZipUrl:!!h,noTempAuth:j};return l.getContents(f,h).then(c=>{if(!c||c.error&&""!==c.error){let d=(0,aV.i)(c.error||"Missing zip contents","ZipErrorRetrievingContents");e.updateErrorState("oneupZipViewer",{errorType:aV.d.viewerInitLoadingError,error:d,item:b,meTAEvent:m,extraData:p}),a.fallbackToOtherViewer&&a.fallbackToOtherViewer(d,"ZipViewer");return}i(c.root.childCount),k({allowSelection:!1,root:c.root,onNavigate:o,onSelect:n,isRetinaEnabled:d,onLoad:()=>{a.onViewerLoaded&&a.onViewerLoaded({meTAEvent:m,extraData:p})}}),g(!0)}).catch(c=>{let d;if(d=c&&c instanceof K.lM?c:new K.lM(c&&c instanceof Error?{code:c.name||"ZipErrorRetrievingContents",message:c.message,extraData:{...p,rawError:JSON.stringify(c)}}:{code:"ZipErrorRetrievingContents",extraData:{...p,rawError:JSON.stringify(c)}}),e.updateErrorState("oneupZipViewer",{errorType:aV.d.viewerInitLoadingError,error:d,item:b,meTAEvent:m,extraData:p}),c)try{c.code?.indexOf("Sandbox_FileTooLarge")!==-1?a.fallbackToOtherViewer&&a.fallbackToOtherViewer(c,"ZipViewer",x.ZipTooLarge):c.isExpected&&c.extraData?.toString().indexOf("notSupported")!==-1&&a.fallbackToOtherViewer&&a.fallbackToOtherViewer(c,"ZipViewer",x.UnsupportedFileType)}catch(b){a.fallbackToOtherViewer&&a.fallbackToOtherViewer(c,"ZipViewer")}else a.fallbackToOtherViewer&&a.fallbackToOtherViewer(c,"ZipViewer")})})(b)},[f,b]);let p=(0,db.a)().palette,q=(0,a4.Gc)(),r=q?b.iconUrl||(0,ek.a)("/assets/item-types/64/zip.svg"):ej.a;return f&&b&&j?N.createElement("div",{className:"OneUpZipContainer_1e83ea04",style:{backgroundColor:p?.white}},N.createElement("div",{className:"OneUpZipHeader_1e83ea04",style:{backgroundColor:p?.neutralLight},role:"heading"},N.createElement("img",{className:"OneUpZipImage_1e83ea04",src:r,alt:d3.a}),N.createElement("span",{className:`OneUpZipNumber_1e83ea04 ${q?"NumberV2_1e83ea04":""}`,style:{color:p?.white}},h)),N.createElement("div",{className:"OneUpZipList_1e83ea04",style:{backgroundColor:p?.white},role:"presentation","data-is-scrollable":"true"},N.createElement(ef,j))):N.createElement(N.Fragment,null)}(0,H.ZW)([{rawString:".container{position:absolute;top:0;left:0;right:0;bottom:0;display:flex;justify-content:center;align-items:center}.od-Error{text-align:center;position:absolute}.od-Error-image{padding-top:52px;height:208px;width:auto;margin:0 auto}.od-Error-image .od-Error-imageTag{height:208px;width:auto}.od-Error-image .od-Error-vaultImage{height:88px;width:auto;padding-top:113px}.md .od-Error-image,.sm .od-Error-image{padding-top:20px;height:168px;width:auto}.md .od-Error-image .od-Error-imageTag,.sm .od-Error-image .od-Error-imageTag{height:168px;width:auto}.md .od-Error-image .od-Error-vaultImage,.sm .od-Error-image .od-Error-vaultImage{height:88px;width:auto;padding-top:80px}.od-Error-title{padding:16px 16px 0 16px;font-size:21px;font-weight:100;max-width:400px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";margin:0 auto}html[dir=rtl] .od-Error-title{padding:16px 16px 0 16px}.md .od-Error-title,.sm .od-Error-title{font-size:17px;font-weight:300}.od-Error-subText{padding:6px 16px 0 16px;font-size:14px;font-weight:400;max-width:400px;color:"},{theme:"neutralSecondary",defaultValue:"#605e5c"},{rawString:";margin:0 auto}html[dir=rtl] .od-Error-subText{padding:6px 16px 0 16px}.od-Error-subtext--accessremoved{max-width:410px}.od-Error-code{padding-top:8px;color:"},{theme:"neutralTertiary",defaultValue:"#a19f9d"},{rawString:";-webkit-touch-callout:text;-webkit-user-select:text;-ms-user-select:text;user-select:text;font-size:12px;font-weight:400}.od-Error-button{padding-top:16px;font-size:14px;font-weight:400}"}]);var em=c(651),en=c(173),eo=c(652),ep=c(653),eq=c(654);let er=[eo.a,ep.a,eq.a];function es(a){let b,c=(0,ar.c)().consume(a2.f),{errorTitle:d,errorDetailedText:e,correlationId:f,errorCode:g,actionUrl:h,actionText:i}=a,j=(b=Math.floor(Math.random()*er.length),er[b]),k=N.useCallback(()=>{window.open(h,"_blank")},[h,!0]);return N.useEffect(()=>{a.itemKey&&c.updateViewerState("errorViewerAfterDelete",{key:a.itemKey,options:{showMainCommands:!1,showTitle:!0}})},[c,a.itemKey]),N.createElement("div",{className:"container"},N.createElement("div",{className:"od-Error"},N.createElement("div",{className:"od-Error-image"},N.createElement("img",{className:"od-Error-imageTag",src:j,alt:d})),N.createElement("div",{role:"alert"},N.createElement("p",{className:"od-Error-title"},d),e&&N.createElement("p",{className:"od-Error-subText"},e),f&&N.createElement("p",{className:"od-Error-code"},K.rz(em.b,f)),g&&N.createElement("p",{className:"od-Error-code"},K.rz(em.a,g)),h&&N.createElement("p",{className:"od-Error-code"},N.createElement(en.a,{href:h,text:i,onClick:k})))))}var et=c(296);(0,H.ZW)([{rawString:".OneUpFileHandlerIFrame_c746f6bf{width:100%;height:100%;border:0}"}]);var eu=c(302);function ev(a){let[b]=(0,a2.g)("currentState",a=>a.fileHandlerOptions?a.fileHandlerOptions.data.actions.preview:void 0),[c,d]=N.useState(),e=(0,ar.c)(),f=e.consume(et.a),g=e.consume(a2.f),h=e.consume(an.a),i=N.createRef(),j=h.userLoginName,k=h.currentUICultureName||h.currentCultureName||"en-US",[l,m]=N.useState(!1),n=(0,aT.a)(()=>{l||(a.onViewerLoaded&&a.onViewerLoaded(),m(!0))}),o=(0,aT.a)(b=>{0===a.offset&&(a.fallbackToOtherViewer&&a.fallbackToOtherViewer(Error("FileHandlerIframeLoadError"),"FileHandlerViewer"),g.updateErrorState("oneupFileHandlerViewer",{errorType:aV.d.viewerInitLoadingError,error:b,item:a.item}))});return N.useEffect(()=>{b&&a.item&&f.getCorrespondingPreviewFileHandlerPostData(a.item).then(a=>{a&&(d(a),n())}).catch(a=>{o(a)})},[a.item?.key,b,f,n,o]),N.useEffect(()=>{if(i&&i.current?.contentDocument&&c)try{let a={cultureName:k,client:"OneUp",domainHint:"organizations",userId:j,appId:c.handler.appId,items:JSON.stringify(c.itemUrls)};(0,eu.a)({url:c.url,postdata:a,document:i.current.contentDocument})}catch(a){o(a)}},[i,c,j,k,o]),N.createElement("iframe",{className:"OneUpFileHandlerIFrame_c746f6bf",ref:i,allow:"clipboard-read; clipboard-write",sandbox:"allow-scripts allow-same-origin allow-forms allow-top-navigation allow-popups allow-popups-to-escape-sandbox"})}var ew=c(655),ex=c(657);let ey=new K.v7({name:"isCopilotAgentBillingAvailableAsyncKey",loader:new K.dE(()=>c.e(10).then(c.bind(c,844)).then(a=>a.copilotAgentBillingDataSourceKey))}),ez={pageContext:an.a,getCopilotAgentBillingDataSource:ey.async.lazy},eA=new K.v7({name:"isCopilotAgentBillingAvailable",factory:{dependencies:ez,create:({pageContext:a,getCopilotAgentBillingDataSource:b})=>{if(K.lU.isFeatureEnabled({ODB:62537})&&!K.Ov.isActivated("26e3d359-a853-4dad-9ea6-85b6855e7b25","04/09/2025","Enables the SharePointEmbeddedPayAsYouGoEnabled feature")&&a.isSPECopilotPayGEnabled)return{instance:()=>!0};let c=K.lU.isFeatureEnabled({ODB:62330})&&!K.Ov.isActivated("37051AB0-8881-4429-9EF0-2016312BCC4A")&&(0,ex.a)({pageContext:a,getCopilotAgentBillingDataSource:b});return{instance:()=>c}}}});var eB=c(209),eC=c(661);let eD={isUserCopilotLicensed:eB.a,isCopilotAgentBillingAvailable:eA},eE=!K.Ov.isActivated("0F710A94-5239-46C8-8DD0-E02D3B7E4BA6"),eF=new K.v7({name:"shouldBlockCopilotViewer",factory:{dependencies:eD,create:({isUserCopilotLicensed:a,isCopilotAgentBillingAvailable:b})=>({instance:function(){if(!(a()||K.lU.isFeatureEnabled({ODB:62330})&&!K.Ov.isActivated("8B678DCC-BB1A-423D-A06A-E217D891D8AE")&&b()))return{errorTitle:eC.d,actionText:eC.b,actionUrl:"https://techcommunity.microsoft.com/t5/microsoft-365-copilot/microsoft-365-copilot-wave-2-ai-innovations-in-sharepoint-and/ba-p/4245159"}}})}});var eG=c(373),eH=c(95),eI=c(374),eJ=c(201),eK=c(49),eL=c(109),eM=c(140);let eN=!K.Ov.isActivated("217c20ef-7cb2-4851-bb66-294b6e38535c"),eO=K.Ov.isActivated("e9226f55-b041-41b5-984e-b74c382a9888");function eP(a){if(!a)return"NA";if(a<0)return"Unknown";let b=Math.log(a)/Math.LN2|0;return`${1<<b%10}-${1<<b%10+1}${b<10?" B":` ${"KMGTPEZY"[b/10-1|0]}iB`}`}function eQ(a){let{item:b,setIsLoaded:d,offset:e,parentItem:f,list:g,setIsPanningEnabled:h,itemIndex:i,closeCallback:j}=a,k=(0,ar.c)(),l=N.useContext(ei.d),m=k.consume(bP.j.optional),n=N.useRef(k.consume(aX.c)),o=k.consume(ax.c),p=k.consume(ap.a),[q,r]=N.useState(!1),[s,t]=N.useState(),{getValidViewerTypes:u}=n.current,[v,w]=N.useState(u(b)),x=k.consume(ew.a),y=N.useRef(void 0),z=(0,aT.a)(async()=>{let a=await k.consumeAsync(eI.a);await a.evaluateAction({item:b,isAnnotateAction:!1})}),A=N.useRef({});N.useEffect(()=>{d(!0)},[d]);let[B]=(0,a2.g)("currentState",a=>a.viewerStates),[C]=(0,a2.g)("currentState",a=>a.deletedKeys),[D]=(0,a2.g)("currentState",a=>a.imageMode===a2.c.edit),[E]=(0,a2.g)("currentState",a=>a.fileHandlerOptions),[F]=(0,a2.g)("currentState",a=>a.isAutoOpenCopilotExperimentEnabled);N.useEffect(()=>{w(u(b))},[E,b,u]);let G=B?.get(b.key),H=N.useRef(),I=(0,aT.a)(a=>{let c=k.consume(bP.o.optional),d=b?x.evaluateAction({item:b}):void 0;l.isCopilotAvailable=d?.isAvailable;let{url:f,...g}=a?.extraData||{},h=(0,a6.a)(f),i="unknown";if(!eG.a){let a=(0,eG.b)(b.permissions);void 0!==a&&(i=eH.a[a])}if((0===e||!e)&&c){let d=k.consume(aF.b),e=d.focusItemSet?.map(a=>a?.properties?.uniqueId),f=b.extension,j=o.getItemUrlParts(b.key).isCrossList;if(c({viewer:v,extension:f,isCrossList:j,fileSizeRange:eP(b.size),euplBreakDownData:a?.perfData?.euplBreakDownData,extraPerfData:a?.perfData?.extraPerfData,extraData:{...g,...h,isAutoOpenCopilotExperimentEnabled:F},itemSetIds:e,focusItemUniqueId:b?.properties?.uniqueId,index:d.currentIndex}),a?.meTAEvent&&(0,a7.c)(a.meTAEvent,{...h,viewerName:v,extension:f,isCrossList:j}),eN&&(0,eK.a)()){let a,c=!!p.viewParams[eL.b],d=o.getItemUrlParts(b.key),e=d.geoRelation!==ax.a.sameGeo;if(e&&d.fullWebUrl)try{a=new URL(d.fullWebUrl).hostname}catch{}let f={isFastOneUp:m,isCrossList:j,isCrossGeo:e,queryType:(0,eM.g)(p.viewParams),domain:a,mainLinkScenario:"OneUp"};!function({hasMainLinkShareToken:a,isCrossGeo:b,extraData:c}){let d=a?eJ.d.Success:b?eJ.d.ExpectedFailure:eJ.d.Failure;new eJ.c({name:"S3.MainLink"}).end({resultType:d,extraData:c})}({hasMainLinkShareToken:c,isCrossGeo:e,extraData:f})}(0,ei.g)(`${ei.c}.${ei.f}`,{extension:b.extension||"unknown",viewer:v,isInitalLoad:!0,engagementContext:l,userRole:i})}else c&&(0,ei.g)(`${ei.c}.${ei.f}`,{extension:b.extension||"unknown",viewer:v,isInitalLoad:!1,engagementContext:l,userRole:i});if(v===aX.a.MSPdf&&(0,a4.$b)(a4.y)){let a=p.viewParams;a&&a.commentId&&""!==a.commentId&&z()}}),J=(0,aT.a)(a=>{let c=k.consume(bP.n.optional);(0===e||!e)&&c&&c({viewer:v,extension:b.extension,isCrossList:o.getItemUrlParts(b.key).isCrossList,fileSizeRange:eP(b.size),euplBreakDownData:a?.perfData?.euplBreakDownData,extraPerfData:a?.perfData?.extraPerfData})}),L=(0,aT.a)((a,c,d)=>{0!==e||q||(y.current=new ct.a({scenario:"OneUpLightSpeed.fallBackToOtherViewer",perfGoalInMs:aV.c,extraData:{errorMessage:a.message,from:c,extension:b.extension,isFastOneUp:m}}),r(!0),t(d))});N.useEffect(()=>{(m||D)&&h?h(!1):0===e&&h&&(v===aX.a.Thumbnail||v===aX.a.Photo||v===aX.a.Other?h(!0):h(!1))},[m,D,h,e,v]);let M={item:b,offset:e,parentItem:f,list:g,setIsLoaded:d,setIsPanningEnabled:h,itemIndex:i,closeCallback:j,viewerType:v,onViewerLoaded:I,onLogFullPageRumone:J,fallbackToOtherViewer:L},O=a=>{let{viewerType:d,key:e,offset:f,mode:g,parentItem:h,list:i,isFallBackToOtherViewer:j,deletedKeysMap:l,errorViewerDisplayName:m,fallbackErrorCode:n}=a,o=N.createElement(N.Fragment,null);if(H.current||(H.current={viewer:v,extension:b.extension||"unknown"}),l&&l.get(e))o=N.createElement(es,{errorTitle:bw.Yb,itemKey:e,fileName:m});else if(j)o=N.createElement(ds,{...M,isErrorFallBack:!0,fallbackCxpRef:y,fallbackErrorCode:n});else if(0!==f&&(d===aX.a.MSPdf||d===aX.a.ThreeD||d===aX.a.TextFile))o=N.createElement(cC,{isMainViewer:!1,mainViewerEngagementData:H.current,...M});else switch(d){case aX.a.FileHandler:o=N.createElement(ev,M);break;case aX.a.Html:o=g&&g===a2.b.edit?N.createElement(dT,M):N.createElement(ba,M);break;case aX.a.Image360:{let a=(0,bA.a)(async()=>(await Promise.all([c.e("ondemand.resx"),c.e(53)]).then(c.bind(c,797))).OneUpImage360Viewer);o=N.createElement(a,M);break}case aX.a.MSPdf:i&&h&&(o=N.createElement(c0,M));break;case aX.a.Photo:o=N.createElement(dB,M);break;case aX.a.TextFile:o=N.createElement(dT,M);break;case aX.a.ThreeD:{let a=(0,bA.a)(async()=>(await c.e(49).then(c.bind(c,798))).OneUp3DViewer);o=N.createElement(a,M);break}case aX.a.WAC:o=N.createElement(d0,M);break;case aX.a.Zip:o=N.createElement(el,M);break;case aX.a.Copilot:{if(eO&&eE){let a=k.consume(eF)();if(a){o=N.createElement(es,a);break}}let a=(0,bA.a)(async()=>(await Promise.all([c.e("ondemand.resx"),c.e(51)]).then(c.bind(c,799))).OneUpCopilotViewer);o=N.createElement(a,M);break}case aX.a.OnePlayerVideo:case aX.a.OnePlayerAudio:if(0===f){let a=A.current.oneUpVideoViewer??(0,bA.a)(async()=>(await c.e(60).then(c.bind(c,800))).OneUpVideoViewer);K.Ov.isActivated("1a137a84-ced6-11f0-b958-8e94e1120c8f","12/02/2025","changjin - Fix duplicate requests in stream scenario")||(A.current.oneUpVideoViewer=a),o=N.createElement(a,M);break}o=N.createElement(ds,{...M,isErrorFallBack:!1,fallbackCxpRef:y});break;case aX.a.Error:{let a={...b.error};o=N.createElement(es,a);break}case aX.a.Thumbnail:o=N.createElement(cC,{isMainViewer:!0,mainViewerEngagementData:H.current,...M});break;default:o=N.createElement(ds,{...M,isErrorFallBack:!1,fallbackCxpRef:y})}return o},P={viewerType:v,key:b.key,offset:e,mode:G?.htmlMode,parentItem:f,list:g,isFallBackToOtherViewer:q,deletedKeysMap:C,errorViewerDisplayName:b.displayName,fallbackErrorCode:s},Q=N.useMemo(()=>O(P),[v,b.key,e,G?.htmlMode,f,g,q,C,b.displayName,b.thumbnail?.url,s]);return(0,a4.sc)()?Q:O(P)}var eR=c(662),eS=c(663),eT=c(375);let eU={navigation:ap.a,inlineOneUpUrlDataSource:bP.h.optional,oneUpUrlDataSource:ce.a.async.lazy,oneUpStateStore:a2.f},eV=new K.v7({name:"oneup-lightspeed/src/utilities/NavigateToItemKey.navigateToItem",factory:{dependencies:eU,create:({navigation:a,inlineOneUpUrlDataSource:b,oneUpUrlDataSource:c,oneUpStateStore:d})=>({instance:async function({item:e,options:f}){if(b){let c=b.getDefaultClickUrl(e,f);return a.navigateTo({url:c,ignoreHistory:!0}),{resultType:bp.b.Success}}try{f?.hasNavigationBlock||d.navClean();let b=(await c()).getDefaultClickUrlForOneUp(e,f);return a.navigateTo({url:b,ignoreHistory:!0}),{resultType:bp.b.Success}}catch{return{resultType:bp.b.Failure}}}})}}),eW=!K.Ov.isActivated("7A994F85-F671-4044-8C7A-B2031B413F75"),eX="PreviousAction",eY={oneUpStore:aF.b,navigation:ap.a,oneUpStateStore:a2.f,oneUpLoadingCustomerPromiseFunctions:aU.b,navigateToItem:eV},eZ=new K.v7({name:"PreviousAction",factory:{dependencies:eY,create:a=>({instance:{evaluateAction:b=>{let c=a.oneUpStore.getOneUpProperties();return{isDisabled:!c||!c.currentIndex||!c.focusItemSet||!c.focusItemSet.length||0===c.currentIndex,isAvailable:!!c&&(!(0,a4.cc)()||a.oneUpStateStore.getOneUpNavMode()!==a2.d.single),id:eX,onExecute:async()=>{if(c&&c.currentIndex&&c.focusItemSet&&c.focusItemSet.length){let b=c.focusItemSet[c.currentIndex-1];a.oneUpLoadingCustomerPromiseFunctions.reportLoadingCXPSuccess({navExtraData:{navigationOption:aU.a.previous,newItem:b}});let d={parentItem:c.parentStoreKey?.key?{key:c.parentStoreKey?.key}:c.parentItem,urlType:"focus",parentViewParams:eW?c.parentStoreKey?.viewParams:void 0};return await a.navigateToItem({item:b,options:d}),{resultType:bp.b.Success}}{let b=(0,aV.i)("no focusItemSet");throw a.oneUpStateStore.updateErrorState(eX,{errorType:aV.d.actionError,error:b,item:void 0}),b}}}}}})}}),e$=!K.Ov.isActivated("7A994F85-F671-4044-8C7A-B2031B413F75"),e_="NextAction",e0={oneUpStore:aF.b,navigation:ap.a,oneUpStateStore:a2.f,oneUpLoadingCustomerPromiseFunctions:aU.b,navigateToItem:eV},e1=new K.v7({name:"NextAction",factory:{dependencies:e0,create:a=>({instance:{evaluateAction:b=>{let c=a.oneUpStore.getOneUpProperties();return{isDisabled:!c||void 0===c.currentIndex||!c.focusItemSet||!c.focusItemSet.length||c.currentIndex+1>=c.focusItemSet.length,isAvailable:!!c&&(!(0,a4.cc)()||a.oneUpStateStore.getOneUpNavMode()!==a2.d.single),id:e_,onExecute:async()=>{if(c&&void 0!==c.currentIndex&&c.focusItemSet&&c.focusItemSet.length){let b=c.focusItemSet[c.currentIndex+1];if(!b)return{resultType:bp.b.Failure,extraData:{errorType:"noNextItem"}};{a.oneUpLoadingCustomerPromiseFunctions.reportLoadingCXPSuccess({navExtraData:{navigationOption:aU.a.next,newItem:b}});let d={parentItem:c.parentStoreKey?.key?{key:c.parentStoreKey?.key}:c.parentItem,urlType:"focus",parentViewParams:e$?c.parentStoreKey?.viewParams:void 0};return await a.navigateToItem({item:b,options:d}),{resultType:bp.b.Success}}}{let b=(0,aV.i)("no focusItemSet");throw a.oneUpStateStore.updateErrorState(e_,{errorType:aV.d.actionError,error:b,item:void 0}),b}}}}}})}});var e2=c("fui.core_517");let e3=new K.v7({name:"UpdateItemWithMainAccessAsyncKey",loader:new K.dE(()=>c.e(85).then(c.bind(c,846)).then(a=>a.updateItemWithMainAccessKey))});var e4=c(664),e5=c(377);let e6=N.lazy(()=>Promise.all([c.e("ondemand.resx"),c.e(45)]).then(c.bind(c,775))),e7=N.lazy(()=>Promise.all([c.e("ondemand.resx"),c.e(46)]).then(c.bind(c,847))),e8=(0,a4.wb)()?e7:e6,e9=()=>N.createElement(N.Suspense,{fallback:null},N.createElement(e8,null)),fa=!K.Ov.isActivated("2beb39f3-1076-486e-b9a7-e673102fc285"),fb=(0,e2.N3o)(),fc="oneUpCarousel";function fd(a){var b,c,d;let e,f=(0,ar.c)(),g=(0,eT.a)(),h=N.useContext(ei.d),i=f.consume(an.a),[j,k]=N.useState(!1),[l,m]=N.useState(!0),[n,o]=N.useState(),p=N.useRef(""),q=f.consume(eV),r=f.consume(cX.a),[s,t]=N.useState(!1),u=N.useRef(f.consume(aX.c)),[v]=(0,a2.g)("currentState",a=>a?.rightPane.type),[x]=(0,a2.g)("currentState",a=>a?.imageMode===a2.c.edit),[y]=(0,a2.g)("currentState",a=>a?.pdfAppMode),z=(0,eT.a)(a=>a?.focusItem),[A]=(0,a2.g)("currentState",a=>a?.deletedKeys),[B,C]=N.useState(!1),{getValidViewerTypes:D}=u.current,E=f.consume(eZ),F=g?.focusItem?E.evaluateAction({item:g?.focusItem}):void 0,G=f.consume(e1),H=g?.focusItem?G.evaluateAction({item:g?.focusItem}):void 0,I=F?{id:"previousCommandNewDesign",action:F}:void 0,J=H?{id:"nextCommandNewDesign",action:H}:void 0;l&&((0,ei.g)(`${ei.c}.Load`,{isInitalLoad:!0,viewer:aX.a.Unknown,extension:"unknown",engagementContext:h}),m(!1));let[L]=(0,a2.g)("currentState",a=>a.imageMode!==a2.c.edit&&[bh.a.Edit,bh.a.Esign].every(b=>b!==a.pdfAppMode)&&!a.eSignData.isCreateSidePanelActive),[M]=(0,a2.g)("currentState",a=>a.viewerStates),[O,P]=N.useState((0,eK.a)());N.useEffect(()=>{A&&z&&A.has(z.key)&&C(!0)},[z,A]),N.useEffect(()=>{let{mainLinkInfo:a,permissions:b}=g?.focusItem||{};(0,eK.a)()&&g?.focusItem.key&&a&&b&&(0,e4.a)({mainLinkInfo:a,permissions:b,pageContext:i})?(P(!0),f.consumeAsync(e3).then(a=>a(g.focusItem,window.location.href,()=>{P(!1)})).catch(()=>{P(!1)})):O&&P(!1)},[g?.focusItem.key]),N.useEffect(()=>{g?.focusItem&&r.isCopilotSupportedForItem(g.focusItem)&&(0,e5.c)(i)&&v!==a2.e.copilotPane&&!x&&y!==bh.a.Extract&&y!==bh.a.Edit&&!B?t(!0):t(!1)},[g?.focusItem,v,r,x,y,B,i]);let Q=N.useCallback(a=>{k(a)},[]),R=N.useCallback(b=>b&&b?.item&&b.item.parentItem&&b.item.listItem?N.createElement(eQ,{item:b.item.currentItem,parentItem:b.item.parentItem,list:b.item.listItem,offset:b.offset,itemIndex:b.itemIndex,setIsLoaded:b.setIsLoaded,setIsPanningEnabled:Q,closeCallback:a.closeCallback}):null,[]),S=g?{key:g.focusItem.key,currentItem:g.focusItem,parentItem:g.parentItem,listItem:g.list}:void 0,T={extension:S?.currentItem.extension||"",viewer:S?.currentItem?D(S?.currentItem):aX.a.Unknown,...h},U=N.useRef(),[V,W]=N.useState(),X=N.useCallback(a=>{fa&&(W(a),U.current&&clearTimeout(U.current),U.current=setTimeout(()=>{W(void 0),U.current=void 0},500))},[]),Y=(0,aT.a)(async(a,b,c)=>{let d={parentItem:a?.parentItem,urlType:"focus"};T.commandName="UnknownItemInvoked",c&&c.key===(fb?"ArrowLeft":"ArrowRight")?(X("next"),T.commandName=J?.id):c&&c.key===(fb?"ArrowRight":"ArrowLeft")&&(X("previous"),T.commandName=I?.id),(0,ei.g)(`${ei.c}.${ei.a}`,T),a&&await q({item:a.currentItem,options:d})});return N.useEffect(()=>{S&&(p.current=K.rz(eS.m,S?.currentItem.displayName),n||o(S))},[S,n]),N.createElement("div",{className:aW.J},N.createElement("div",{"aria-live":"polite","tab-index":"-1",role:"alert",className:aW.b},p.current),L&&I&&I.action.isAvailable&&(b="previous"===V,c=(e=S?M?.get(S?.key)?.pdfViewerStates?.outlineVisibility:void 0)&&e!==bh.b.Hidden?aW.K:"",N.createElement("div",{className:[aW.L,c].join(" ")},N.createElement(c4,{command:I,onClickCallback:()=>fe(I.id,T),text:"ChevronLeft",buttonType:w.iconButton,updateErrorStateCallBack:()=>{},toolTipText:eS.h,isActive:b}))),!O&&N.createElement(eR.a,{rootProps:{id:fc,role:"main"},items:function(a){let b=[];if(a&&a.focusItemSet&&a.focusItemSet.length>0)for(let c=0;c<a.focusItemSet.length;c++)b.push({key:a.focusItemSet[c].key,currentItem:a.focusItemSet[c],parentItem:a.parentItem,listItem:a.list});return b}(g),item:S,onRenderSlide:R,onItemInvoked:Y,isEnabled:j,slideAllocationCount:5}),L&&J&&J.action.isAvailable&&(d="next"===V,N.createElement("div",{className:aW.a},N.createElement(c4,{command:J,onClickCallback:()=>fe(J.id,T),text:"ChevronRight",buttonType:w.iconButton,updateErrorStateCallBack:()=>{},toolTipText:eS.f,isActive:d}))),s&&N.createElement(e9,null))}function fe(a,b){b.commandName=a||"UnknownClicked",(0,ei.g)(`${ei.c}.${ei.a}`,b)}let ff=new K.v7({name:"OpenInfoPaneActionAsync.key",loader:new K.dE(()=>c.e(64).then(c.bind(c,851)).then(a=>a.openInfoPaneActionKey))}),fg=new K.v7({name:"OpenAboutThisCopilotPaneActionAsync.key",loader:new K.dE(()=>Promise.all([c.e("odsp.react.lib"),c.e("ondemand.resx"),c.e(62)]).then(c.bind(c,852)).then(a=>a.openAboutThisCopilotPaneActionKey))}),fh=new K.v7({name:"VersionHistoryActionExecutorAsync.key",loader:new K.dE(()=>Promise.all([c.e("ondemand.resx"),c.e(86)]).then(c.bind(c,853)).then(a=>a.versionHistoryActionExecutorKey))});var fi=c(192);let fj=(0,bA.a)(async()=>(await c.e(57).then(c.bind(c,850))).OneUpRightPaneWithError);function fk(){let a=(0,ar.c)(),[b]=(0,a2.g)("currentState",a=>a.rightPane),c=a.consume(a2.f),d=(0,eT.a)(a=>a?.focusItem),e=(0,aT.a)(async b=>{let c=(await a.consumeAsync(ff)).evaluateAction({item:b});c.isAvailable&&c.onExecute&&await c.onExecute({qosEvent:new bp.a({name:"openInfoPane"})})}),f=(0,aT.a)(async b=>{let c=(await a.consumeAsync(fg)).evaluateAction({item:b});c.isAvailable&&c.onExecute&&await c.onExecute({qosEvent:new bp.a({name:"openAboutThisCopilotPane"})})}),g=(0,aT.a)(async b=>{let c=await a.consumeAsync(fh);await c.executeOpenVersionHistory({item:b})}),h=(0,aT.a)(async b=>{let c=await a.consumeAsync(eI.a);await c.evaluateAction({item:b,isAnnotateAction:!0})}),i=(0,aT.a)(()=>{c.updateRightPaneState("closeRightPane",{type:a2.e.none,content:void 0})}),j=(0,aT.a)(async c=>{switch(b?.type){case a2.e.detailPane:await e(c);break;case a2.e.copilotDetailPane:await f(c);break;case a2.e.versionHistory:await g(c);break;case a2.e.commentsPane:await h(c);break;case a2.e.copilotPane:c&&c.extension&&a.consume(fi.a).evaluateAction({item:c}).isAvailable||i();break;case a2.e.none:default:i()}});N.useEffect(()=>{let a=new bp.a({name:"retriggerRightPane"});d&&j(d).then(()=>a.end({resultType:bp.b.Success})).catch(b=>{a.end({resultType:bp.b.Failure,extraData:{error:b}})})},[d?.key,j]),N.useEffect(()=>{if(b?.firstFocusableTarget&&(0,a4.Ec)()){let a=null;"string"==typeof b.firstFocusableTarget?a=document.querySelector(b.firstFocusableTarget):b.firstFocusableTarget&&(a=b.firstFocusableTarget()),a?.focus()}},[b]);let k=N.useMemo(()=>b?.type!==void 0&&b.type!==a2.e.none?N.createElement(fj,{errorType:b.type,onClose:i}):N.createElement(N.Fragment,null),[b?.type,i]),l={borderRadius:5,overflow:"hidden",margin:8,backgroundColor:cN.a};return N.createElement(N.Fragment,null,(b?.content||b?.hasError)&&N.createElement("div",{className:function(){if(!b)return"";switch(b.type){case a2.e.detailPane:case a2.e.copilotDetailPane:case a2.e.commentsPane:case a2.e.copilotPane:return aW.A;case a2.e.versionHistory:return aW.I;default:return""}}(),style:l},function(){if(b)switch(b.type){case a2.e.detailPane:case a2.e.copilotDetailPane:case a2.e.commentsPane:case a2.e.copilotPane:case a2.e.versionHistory:if((0,a4.vc)()&&b.hasError)return k;return b.content||void 0;default:return}}()))}var fl=c(665);let fm=(0,c(8).a)(fl.a,a=>{let{className:b,theme:c}=a;return{root:[c.fonts.medium,"ms-CommandBar",{display:"flex",backgroundColor:"transparent",padding:"0 8px 0 8px",height:44},b],primarySet:["ms-CommandBar-primaryCommand",{flexGrow:(0,a4.Nc)()?"1":"unset",display:"flex",alignItems:"stretch",flexBasis:(0,a4.Nc)()?"25%":"unset",zIndex:1,color:c.palette.themePrimary}],middleSet:["ms-CommandBar-middleCommand",{display:"flex",justifyContent:"center",alignItems:"stretch",flexGrow:(0,a4.Nc)()?"2":"1",flexBasis:(0,a4.Nc)()?"50%":"unset",[`@media (max-width: ${e2.jyi}px)`]:{display:"none"},color:c.palette.themePrimary}],secondarySet:["ms-CommandBar-secondaryCommand",{display:"flex",alignItems:"stretch",justifyContent:"flex-end",flexGrow:(0,a4.Nc)()?"1":"unset",flexBasis:(0,a4.Nc)()?"25%":"unset",color:c.palette.themePrimary,marginRight:"-6px"}]}},void 0,{scope:"CommandBar"}),fn="mainDividerCommand";function fo(a){return{id:fn,isAvailable:!0,isDisabled:!0}}let fp=new K.v7({name:"DividerNonInteractiveCommand",factory:{dependencies:{},create:()=>({instance:{id:fn,automationId:fn,iconProps:{iconName:"Separator",iconStyle:"color: white !important"},ariaLabel:bw.v,buttonStyles:{root:{width:"20px !important",color:"white",background:"transparent",minWidth:"20px"}},evaluateAction:fo}})}});var fq=c(667),fr=c(101);function fs(a){let{definitions:b,item:c,parentItem:d}=a,e=[],f=!0;for(let a=0;a<b.length;a++){let g,h,i=b[a],{evaluateAction:j,evaluateSubCommands:k,subCommands:l,getSubCommands:m,...n}=i,o=j({item:c,parentItem:d});if(o.isAvailable){if(l?.length&&(g=fs({definitions:l,item:c})),k){let a=k(c);a?.length&&(g=fs({definitions:a,item:c}))}m&&(h=async()=>fs({definitions:await m(),item:c})),(!g||g.length||h||i.isSplit)&&(i.isDivider&&(f||a===b.length-1)||(f=!!i.isDivider,e.push({...n,name:i.evaluateCommandName?i.evaluateCommandName(c):i.name,title:i.evaluateTitle?i.evaluateTitle(c):i.title,iconProps:i.evaluateIconProps?i.evaluateIconProps(c):i.iconProps,buttonStyles:i.evaluateButtonStyles?i.evaluateButtonStyles(c):i.buttonStyles,action:o,...g?{subCommands:g}:{},...h?{getSubCommands:h}:{}})))}}return e}let ft={main:[],far:[],overflow:[]};class fu{get workingSet(){return this._workingSet}get displaySet(){return this._showCommands?this._displaySet:ft}updateWorkingSetOverride(a){let b=(0,fq.a)({suspensibles:Array.from(this._workingSetOverrides.values()),onRetry:()=>this.updateWorkingSetOverride(a)});b&&(this._workingSetOverride=this._generateWorkingSet(b),this.updateDisplaySet(a))}updateDisplaySet(a){let b=(0,fq.a)({suspensibles:Array.from(this._displaySetOverrides.values()),onRetry:()=>this.updateDisplaySet(a)});if(!b)return;let{publisher:c,item:d}=a;d&&(this._item=d),this._displaySet=this._generateDisplaySet(b),this._setShowCommands(!0),this._eventMC.publish("displaySetChange",{publisher:c,displaySet:this.displaySet})}calcDisplaySet(a,b){this._item=a,this._parentItem=b,this._displaySet=this._generateDisplaySet([])}addWorkingSetOverride(a){return this._workingSetOverrides.add(a),()=>this._workingSetOverrides.delete(a)}addDisplaySetOverride(a){return this._displaySetOverrides.add(a),()=>this._displaySetOverrides.delete(a)}dispose(){this._eventMC.dispose(),this._displaySetOverrides.clear(),this._workingSetOverrides.clear()}_generateWorkingSet(a){let b=this._workingSet;for(let c of a)b=c(b);return b}_generateDisplaySet(a){let b=this._item,c=this._parentItem,d=function(a){let{commandDefinitionSet:b,item:c,parentItem:d}=a;return{main:fs({definitions:b.main,item:c,parentItem:d}),far:fs({definitions:b.far,item:c,parentItem:d}),overflow:fs({definitions:b.overflow,item:c,parentItem:d})}}({commandDefinitionSet:this._workingSetOverride,item:b,parentItem:c});for(let c of a)d=c({displaySet:d,item:b});return d}_setShowCommands(a){this._showCommands=a}constructor(a){this.isContextual=()=>!1,this.onDisplaySetChange=a=>this._eventMC.subscribe("displaySetChange",b=>{a(b.detail.displaySet)}),this.getDisplaySetCommand=a=>{for(let b of[this._displaySet.main,this._displaySet.far,this._displaySet.overflow])for(let c of b)if(c.id===a)return c},this.getWorkingSetCommand=a=>{for(let b of[this._workingSetOverride.main,this._workingSetOverride.far,this._workingSetOverride.overflow])for(let c of b)if(c.id===a)return c};const{item:b,workingSet:c,showCommands:d=!0}=a;this._item=b,this._parentItem=void 0,this._workingSet=c,this._showCommands=d,this._workingSetOverride=c,this._workingSetOverrides=new Set,this._displaySetOverrides=new Set,this._eventMC=new fr.a,this._displaySet=this._generateDisplaySet([]),this.updateWorkingSetOverride({publisher:"commandBarInitialLoad"})}}var fv=c(668);let fw={actionProvider:fv.a},fx="closeCommand",fy=new K.v7({name:"CloseCommand",factory:{dependencies:fw,create:({actionProvider:a})=>({instance:{id:fx,buttonStyles:{root:{margin:"auto 6px"}},automationId:fx,title:bw.i,iconProps:{iconName:"Cancel"},evaluateAction:a.evaluateAction}})}});var fz=c(229),fA=c(683),fB=c(280),fC=c(136),fD=c(684),fE=c(206),fF=c(13),fG=c(685),fH=c(452),fI=c(488);let fJ=!K.Ov.isActivated("477a83b0-a601-4574-a95c-87b89e0949a7");(u=B||(B={}))[u.Favorite=0]="Favorite",u[u.Unfavorite=1]="Unfavorite";let fK={pageContext:an.a,oneUpStore:aF.b,resources:K.m3,urlDataSource:ce.a,oneUpStateStore:a2.f,isFavoritesEnabled:fz.a,offlineDetection:cl.a,navigation:ap.a,identityDataSource:b3.resourceKey,oneDriveDataSource:fH.oneDriveDataSourceKey,onClickFavoriteSpartan:bP.m.optional,isFavoritesEnabledInOneUp:fB.a};async function fL(a){if(fJ){let b=await a.oneDriveDataSource.getPersonalUrl();return"/"!==b.charAt(b.length-1)&&(b=b.concat("/")),b.concat("_layouts/15/onedrive.aspx?view=",`${fC.a.Favorites}`)}{let b=a.urlDataSource.getPageType(a.navigation.viewParams),c={};b!==bd.a.Files&&(c[bb.b.pageParamKey]=b),c[bb.b.queryTypeParamKey]=`${fC.a.Favorites||""}`;let d="#"+(0,fE.b)(c,void 0,!0);return Promise.resolve(`${window.location.protocol}//${window.location.host}/${d}`)}}function fM(a,b,d,e,f,g){let h,i="",j=(0,bA.a)(async()=>(await c.e(80).then(c.bind(c,777))).ToastActionButton);b?0===d?(i=N.createElement(N.Fragment,null,fD.a,N.createElement("span",{style:{fontWeight:"bold"}},e||fD.e),fD.h),h=g?N.createElement(N.Fragment,null,N.createElement(j,{theme:f,key:"openFavorites",text:fD.f,onClick:()=>{window.open(g,"_blank")}})):void 0):i=N.createElement(N.Fragment,null,fD.g,N.createElement("span",{style:{fontWeight:"bold"}},e||fD.e),fD.d):i=0===d?N.createElement(N.Fragment,null,fD.c,N.createElement("span",{style:{fontWeight:"bold"}},e||fD.e),fD.b):N.createElement(N.Fragment,null,fD.j,N.createElement("span",{style:{fontWeight:"bold"}},e||fD.e),fD.i),a.oneUpStateStore.updateToastState("favoriteAction",{visible:!0,actionStatus:b?fI.ToastActionStatus.succeed:fI.ToastActionStatus.error,displayText:i,actionButtons:h})}let fN={actionProvider:new K.v7({name:"FavoriteAction",factory:{dependencies:fK,create:a=>({instance:{evaluateAction:b=>{var d;let e=a.offlineDetection,f=a.oneUpStore.getOneUpProperties(),g=void 0!==a.oneUpStateStore.currentAppState.isFocusItemFavorited,h=a.oneUpStateStore.currentAppState.isFocusItemFavorited||!1,i=(d=b.item,(0,fA.a)({extension:d.extension,isMountPoint:!!d.mountPoint})&&!h),j=async()=>await c.e(59).then(c.bind(c,776)),k={isAvailable:a.isFavoritesEnabledInOneUp&&!e.offline&&(a.oneUpStateStore.currentAppState.isFocusItemFavorited?h:i),id:"FavoriteAction",isDisabled:!g};return j().then(d=>{k.onExecute=async()=>{let d=await c.e(21).then(c.bind(c,859)),e=await a.resources.consumeAsync(d.resourceKey),g=new fF.b({context:a.pageContext}),{id:i,listurl:j}=(0,K.pW)(b.item.key),k=g.getUrlParts({listUrl:j,path:i}),l=k.fullWebUrl,m=await (l?a.identityDataSource.getSharePointToken({webAbsoluteUrl:l,apiQosName:"FavoriteAction"}).then(a=>a):new Promise(()=>{})),n={webAbsoluteUrl:l,listUrl:k.serverRelativeListUrl},o=f?.pageContexts?.get(n),p=(0,fG.a)(),q={items:[{siteId:o?.siteId||a.pageContext.siteId,webId:o?.webId||a.pageContext.webId,listId:o?.listId||a.pageContext.listId,listItemUniqueId:b.item.properties?.uniqueId}],accessToken:m};fL(a).then(c=>{if(!q.items[0].siteId||!q.items[0].webId||!q.items[0].listId||!q.items[0].listItemUniqueId)return a.oneUpStateStore.updateErrorState("favoriteAction.Favorite",{errorType:aV.d.actionError,error:{name:"favoriteAction.MissingItemProperties",message:"Missing required item properties for favorite-unfavorite call"},item:b.item}),{resultType:bp.b.Failure};if(h?e.unfavoriteItems(q).then(()=>(fM(a,!0,1,b.item.name,p,c),a.oneUpStateStore.setIsFocusItemFavorited("favoriteAction",!1),{resultType:bp.b.Success})).catch(d=>(fM(a,!1,1,b.item.name,p,c),a.oneUpStateStore.updateErrorState("favoriteAction.Unfavorite",{errorType:aV.d.actionError,error:d,item:b.item}),{resultType:bp.b.Failure})):e.favoriteItems(q).then(()=>(fM(a,!0,0,b.item.name,p,c),a.oneUpStateStore.setIsFocusItemFavorited("favoriteAction",!0),{resultType:bp.b.Success})).catch(d=>(fM(a,!1,0,b.item.name,p,c),a.oneUpStateStore.updateErrorState("favoriteAction.Favorite",{errorType:aV.d.actionError,error:d,item:b.item}),{resultType:bp.b.Failure})),!(0,a4.Sc)())if(!(a.onClickFavoriteSpartan&&b.item.properties?.ID))return{resultType:bp.b.Failure,extraData:{error:`onClickFavoriteSpartan or item id not available, item id is ${b.item.properties?.ID}`}};else{let c={isFavorited:h,listItemId:b.item.properties?.ID};a.onClickFavoriteSpartan(c)}}).catch(c=>{a.oneUpStateStore.updateErrorState("favoriteAction.GetFavoritesEndpoint",{errorType:aV.d.actionError,error:c,item:b.item,extraData:{isCurrentOneDrive:a.oneDriveDataSource.isCurrentOneDrive}});let d={resultType:bp.b.Failure,error:c.name,extraData:{error:c,item:b.item,isCurrentOneDrive:a.oneDriveDataSource.isCurrentOneDrive}};return fM(a,!1,+!!h,b.item.name,p),d})}}).catch(a=>{k.isAvailable=!1}),k}}})}}),oneUpStateStore:a2.f},fO="favoriteCommand",fP=new K.v7({name:"FavoriteCommand",factory:{dependencies:fN,create:({actionProvider:a,oneUpStateStore:b})=>({instance:{id:fO,name:bw.F,automationId:fO,evaluateTitle:a=>b.currentAppState.isFocusItemFavorited?bw.Nb:bw.G,evaluateIconProps:a=>b.currentAppState.isFocusItemFavorited?{iconName:"FavoriteStarFill"}:{iconName:"FavoriteStar"},evaluateAction:a.evaluateAction}})}});function fQ(a){if(a)switch((0,cQ.a)(a)){case"ms-word":return"Word";case"ms-excel":return"Excel";case"ms-powerpoint":return"PowerPoint";case"ms-visio":return"Visio";case"ms-project":return"Project";case"ms-publisher":return"Publisher";case"ms-access":return"Access";case"onenote|UsePlain":return"OneNote"}}let fR={pageContext:an.a,oneUpStore:aF.b,navigation:ap.a,resources:K.m3,platform:aC.a},fS=new K.v7({name:"OpenInOfficeClientAction",factory:{dependencies:fR,create:a=>({instance:{evaluateAction:b=>{var c,d;return{isAvailable:(c=b.item,!!((d=a.platform).isMac||d.isWindows||d.isIOS||d.isWinPhone||d.isAndroid)&&!!c&&!!bq.a.hasItemPermission(c,bq.a.openItems)&&!!(c.openUrl&&c.appMap)&&c.itemStatus!==br.b.ConditionalAccessBlocked&&c.itemStatus!==br.b.ConditionalAccessViewOnly),id:"OpenInOfficeClientAction",onExecute:async()=>a.resources.consumeAsync(ce.a).then(c=>{let d=c.getOpenInOfficeClientUrl(b.item,a.navigation.viewParams);return a.navigation.navigateTo({url:d,frameId:"_blank"}),{resultType:bp.b.Success}})}}}})}});var fT=c(688),fU=c(689),fV=c(690),fW=c(691);let fX=K.Ov.isActivated("4517af36-b494-4137-bed5-a607bcad4a39");function fY(a){if(a)switch((0,cQ.a)(a)){case"ms-word":return fX?{iconName:"svg/word_16x1.svg",className:aW.h}:{className:aW.h,imageProps:{src:fT.a,width:16,height:16}};case"ms-excel":return fX?{iconName:"svg/excel_16x1.svg",styles:{root:{width:16,height:16}}}:{className:aW.h,imageProps:{src:fU.a,width:16,height:16}};case"ms-powerpoint":return fX?{iconName:"svg/powerpoint_16x1.svg",className:aW.h}:{className:aW.h,imageProps:{src:fV.a,width:16,height:16}};case"ms-visio":return{iconName:"svg/visio_16x1.svg",className:aW.h};case"ms-project":return{iconName:"ProjectDocument",className:aW.h};case"ms-publisher":return{iconName:"PublisherLogo",className:aW.h};case"ms-access":return{iconName:"AccessLogo",className:aW.h};case"onenote|UsePlain":return fX?{iconName:"svg/onenote_16x1.svg",className:aW.h}:{className:aW.h,imageProps:{src:fW.a,width:16,height:16}}}}let fZ={actionProvider:fS,oneUpStore:aF.b},f$="openInOfficeClientCommand";function f_(a){return fQ(a.extension)?K.rz(bw.ob,fQ(a.extension)):bw.rb}let f0=new K.v7({name:"OpenInOfficeClientCommand",factory:{dependencies:fZ,create:a=>({instance:{id:f$,automationId:f$,evaluateAction:a.actionProvider.evaluateAction,evaluateIconProps:a=>fY(a.extension),evaluateCommandName:a=>f_(a),evaluateTitle:a=>f_(a)}})}}),f1={actionProvider:c7,oneUpStore:aF.b},f2="openInOfficeOnlineCommand";function f3(a,b){return fQ(a.extension)?b?K.rz(bw.lb,fQ(a.extension)):K.rz(bw.cb,fQ(a.extension)):b?bw.db:bw.sb}let f4=new K.v7({name:"OpenInOfficeOnlineCommand",factory:{dependencies:f1,create:a=>({instance:{id:f2,automationId:f2,evaluateAction:a.actionProvider.evaluateAction,evaluateIconProps:a=>fY(a.extension),evaluateCommandName:a=>f3(a),evaluateTitle:a=>f3(a,!0)}})}});var f5=c(692),f6=c(693);function f7(a){let b=new K.G7;if(a.item&&a.item.urls&&a.item.urls[bz.b.immersiveReaderUrl]){let b=a.item.urls[bz.b.immersiveReaderUrl],{getImmersiveReaderContext:c}=(0,f5.a)({url:b,qosName:"OneUpLightSpeed.OpenInImmersiveReader.GetReaderOptions"}),d=new K.G7;if(c){let b=new bp.a({name:"OneUpLightSpeed.OpenInImmersiveReader.Launch"});return(0,f6.a)({getImmersiveReaderContext:c,options:{onExit:()=>{d.resolve(),a.onClose&&a.onClose()}}}).then(()=>(a.onRender&&a.onRender(),d.promise.then(()=>{b.end({resultType:bp.b.Success})}).catch(c=>{b.end({resultType:bp.b.Failure,extraData:{error:c.message,stack:c.stack,extension:a.item.extension,fileSize:a.item.size}}),a.onError&&a.onError(c)}))).catch(c=>{b.end({resultType:bp.b.Failure,extraData:{error:c.message,stack:c.stack,extension:a.item.extension,fileSize:a.item.size}}),a.onError&&a.onError(c)})}a.onError&&a.onError({name:"IM.MissingReaderContext",message:"IM context options missing"})}else a.onError&&a.onError({name:"IM.ItemMissingProps",message:"Item missing required properties"});return b.promise}let f8=new K.v7({name:"ShowImmersiveReader",factory:{dependencies:{},create:a=>({instance:{showImmersiveReader:f7}})}});var f9=c(694);let ga="OpenInImmersiveReaderAction",gb=[".docx",".txt",".html"],gc={getExecutor:f8.async.lazy,pageContext:an.a,oneUpStore:aF.b,oneUpStateStore:a2.f},gd=new K.v7({name:"OpenInImmersiveReaderAction",factory:{dependencies:gc,create:a=>({instance:{evaluateAction:b=>{let{item:c}=b;return{isAvailable:!!c.extension&&!!c.size&&!!(c.urls&&c.urls[bz.b.immersiveReaderUrl])&&-1!==gb.indexOf(c.extension)&&(0,f9.a)(c.size),id:ga,onExecute:async()=>{let d=await a.getExecutor(),e=new bV.b,f={...b,onClose:()=>{},onRender:a=>{e.complete()},onError:b=>{b.name=`IMLaunchFailure.${b.name}`,a.oneUpStateStore.updateErrorState(ga,{errorType:aV.d.actionError,error:b,item:c}),e.error(b)}};try{await d.showImmersiveReader(f)}catch(a){}return e.getPromise()}}}}})}}),ge="openInImmersiveReaderCommand",gf=new K.v7({name:"OpenInImmersiveReaderCommand",factory:{dependencies:{actionProvider:gd},create:({actionProvider:a})=>({instance:{id:ge,name:bw.ab,title:bw.ib,automationId:ge,iconProps:{iconName:"ReadOutLoud"},evaluateAction:a.evaluateAction}})}}),gg={pageContext:an.a,oneUpStore:aF.b,oneUpStateStore:a2.f,getValidViewerTypesFromResource:aX.c},gh=new K.v7({name:"OpenInHtmlViewerAction",factory:{dependencies:gg,create:a=>({instance:{evaluateAction:b=>{let{getValidViewerTypes:c}=a.getValidViewerTypesFromResource,d=c(b.item),e=a.oneUpStateStore.getViewerState(b.item.key),f=!!e&&e.htmlMode===a2.b.edit;return{isAvailable:d===aX.a.Html&&f,id:"OpenInHtmlViewerAction",onExecute:async()=>(a.oneUpStateStore.updateViewerState("updateHtmlModeView",{key:b.item.key,options:{htmlMode:a2.b.view}}),{resultType:bp.b.Success})}}}})}}),gi="openInHtmlViewerCommand",gj=new K.v7({name:"OpenInHtmlViewerCommand",factory:{dependencies:{actionProvider:gh},create:({actionProvider:a})=>({instance:{id:gi,name:bw.nb,automationId:gi,iconProps:{iconName:"View"},evaluateAction:a.evaluateAction}})}}),gk={pageContext:an.a,oneUpStore:aF.b,oneUpStateStore:a2.f,getValidViewerTypesFromResource:aX.c},gl=new K.v7({name:"OpenInTextEditorAction",factory:{dependencies:gk,create:a=>({instance:{evaluateAction:b=>{let{getValidViewerTypes:c}=a.getValidViewerTypesFromResource,d=c(b.item),e=a.oneUpStateStore.getViewerState(b.item.key),f=e?.htmlMode===void 0||e?.htmlMode===a2.b.view;return{isAvailable:d===aX.a.Html&&f&&".msg"!==b.item.extension,id:"OpenInTextEditorAction",onExecute:async()=>(a.oneUpStateStore.updateViewerState("updateHtmlModeEdit",{key:b.item.key,options:{htmlMode:a2.b.edit}}),{resultType:bp.b.Success})}}}})}}),gm="openInTextEditorCommand",gn=new K.v7({name:"OpenInTextEditorCommand",factory:{dependencies:{actionProvider:gl},create:({actionProvider:a})=>({instance:{id:gm,name:bw.ub,automationId:gm,iconProps:{iconName:"Edit"},evaluateAction:a.evaluateAction}})}}),go=!K.Ov.isActivated("1cbefa0c-46a0-4a8e-90f8-0831761b38fb"),gp={navigation:ap.a,getValidViewerTypesFromResource:aX.c},gq={actionProvider:new K.v7({name:"OpenInStreamAction",factory:{dependencies:gp,create:a=>({instance:{evaluateAction:b=>{let{getValidViewerTypes:c}=a.getValidViewerTypesFromResource,d=c(b.item),e=b.item.openUrl,f=go&&(0,a6.b)(b.item.urls?.[bz.b.video])||!go,g=(d===aX.a.OnePlayerVideo||d===aX.a.OnePlayerAudio)&&f&&!!e,h=e?.indexOf("?"),i=`${e}${-1===h?"?web=1":"&web=1"}&referrer=OneUpViewer.web&referrerScenario=OpenFile.view`;return{isAvailable:g,id:"OpenInStreamAction",onExecute:async()=>(await a.navigation.navigateTo({url:i,frameId:"_blank"}),{resultType:bp.b.Success})}}}})}}),oneUpStore:aF.b},gr="openInStreamCommand";(0,H.fU)({icons:{OpenRegular:N.createElement("svg",{fill:"currentColor",width:"16",height:"16",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},N.createElement("path",{d:"M6 4a2 2 0 0 0-2 2v8c0 1.1.9 2 2 2h8a2 2 0 0 0 2-2v-2.5a.5.5 0 0 1 1 0V14a3 3 0 0 1-3 3H6a3 3 0 0 1-3-3V6a3 3 0 0 1 3-3h2.5a.5.5 0 0 1 0 1H6Zm5-.5c0-.28.22-.5.5-.5h5c.28 0 .5.22.5.5v5a.5.5 0 0 1-1 0V4.7l-4.15 4.15a.5.5 0 0 1-.7-.7L15.29 4H11.5a.5.5 0 0 1-.5-.5Z"}))}});let gs=new K.v7({name:"OpenInStreamCommand",factory:{dependencies:gq,create:({actionProvider:a})=>({instance:{id:gr,name:bw.tb,title:bw.tb,automationId:gr,evaluateAction:a.evaluateAction,iconProps:{iconName:"OpenRegular",className:aW.h}}})}});var gt=c(175),gu=c(36);let gv={oneUpStateStore:a2.f,pageContext:an.a,fileHandlerHelper:et.a},gw=new K.v7({name:"OpenInFileHandleCommand",factory:{dependencies:gv,create:a=>({instance:function(b){let c=[],d=b||a.oneUpStateStore.getFileHandlerOptions();if(d){let b=d.data.actions.open;for(let d=0;d<b.length;d++){let e=function(b){let c={imageProps:{src:b.handler.appIcon?.svg,title:b.handler.actionMenuDisplayName,imageFit:gt.b.contain}},d=b.handler.actionMenuDisplayName||b.displayName;return{id:"fileHandlerOpen",name:d,title:b.handler.actionMenuDisplayName,automationId:"fileHandlerOpen",iconProps:c,extraData:{handlerName:d},evaluateAction:c=>{let e=c.item;return{isAvailable:function(a,b,c){let d=a.file,e=a.folder,f=a.file&&a.file.extensions||void 0;if(c)return!!e;if(d&&b){let a="."!==b.charAt(0)?"."+b:b;return!f||-1!==f.indexOf(a.toLowerCase())||-1!==f.indexOf("*")||-1!==f.indexOf(".*")}return!1}(b.availableOn,c.item.extension,!1),id:`fileHandlerOpenAction-${d}`,onExecute:async()=>{let d,f,g=Number(a.pageContext.webTemplate)===cD.b.mySite,h=(0,a4.Ic)()?g?"OneDrive":"SharePoint":"OneUp",i={cultureName:a.pageContext.currentUICultureName||a.pageContext.currentCultureName||"en-US",client:h,domainHint:"organizations",userId:a.pageContext.userLoginName},j=function(a){let b=window.open(a.url||"","_blank");return b&&(b.opener=null),b||void 0}({}),k=!!b.handler.isPromoted;try{d=await a.fileHandlerHelper.getFileHandlerItemUrl(c.item,b,k)}catch(a){f=a}if(d&&d.length>0){let c={...i,appId:b.handler.appId,items:JSON.stringify(d)};if(j&&j.document)return j.opener=null,(0,eu.a)({url:b.url,postdata:c,document:j.document}),{resultType:gu.a.Success};{let b=(0,aV.i)("No target window available to invoke File Handler");throw a.oneUpStateStore.updateErrorState("openFileHandlerAction",{errorType:aV.d.actionError,error:b,item:e}),b}}{let b=f||(0,aV.i)("unknown error calling getFileHandlerItemUrl");throw a.oneUpStateStore.updateErrorState("openFileHandlerAction",{errorType:aV.d.actionError,error:b,item:e}),b}}}}}}(b[d]);c.push(e)}}return c}})}});var gx=c(695),gy=c(696),gz=c(102),gA=c(420);let gB={oneUpStore:aF.b,navigation:ap.a,pageContext:an.a,clientName:gA.a.optional},gC=new K.v7({name:"EditInClipchampAction",factory:{dependencies:gB,create:a=>({instance:{evaluateAction:b=>{var c,d;let e,f,g,h,i,j=a.oneUpStore.getOneUpProperties(),k=j?.parentItem,l=!!b.item&&!!b.item.key&&!!a.pageContext&&(c=b.item,d=a.pageContext,e=d?.canUserUseClipchamp??!1,f=(0,a4.$b)({ODB:1344}),g=(0,a4.$b)({ODB:61399}),h=(d&&d.listBaseTemplate===gz.a.webPageLibrary)??!1,i=bq.a.hasItemPermission(c,bq.a.insertListItems),(0,gx.b)(c.extension??"",!0)&&i&&f&&!h&&(e||g)),m=(0,gx.a)(k?.graph,a.pageContext.webAbsoluteUrl,{referrer:a.clientName||"OneUp",referrerScenario:"EditInClipchamp",video:b.item?.graph});return{isAvailable:l,id:"EditInClipchampAction",onExecute:async()=>((0,gy.a)(m,{forceInSameWindow:!1}),{resultType:bp.b.Success})}}}})}});var gD=c(697),gE=c(698);let gF={actionProvider:gC,oneUpStore:aF.b},gG="editInClipchampCommand",gH=new K.v7({name:"EditInClipchampCommand",factory:{dependencies:gF,create:({actionProvider:a})=>{let b=K.lU.isFeatureEnabled(a4.a)?gE.a:gD.a;return{instance:{id:gG,name:bw.A,title:bw.A,automationId:gG,evaluateAction:a.evaluateAction,iconProps:{imageProps:{src:b,styles:{root:{width:"16px",height:"16px",display:"flex !important"}}}}}}}}}),gI=new K.v7({name:"OpenInAppDataSourceAsync.key",loader:new K.dE(()=>c.e(63).then(c.bind(c,860)).then(a=>a.openInAppDataSourceKey))}),gJ=async a=>{let b=await a.resources.consumeAsync(gI);await b.openInApp(a.item,a.pageContexts)},gK=new K.v7({name:"OpenInAppActionExecutor",factory:{dependencies:{},create:a=>({instance:{executeOpenInApp:gJ}})}}),gL="OpenInAppAction",gM={oneUpStore:aF.b,platform:aC.a,oneUpStateStore:a2.f,itemUrlHelper:ax.c,getValidViewerTypesFromResource:aX.c,getExecutor:gK.async.lazy,resources:K.m3},gN={actionProvider:new K.v7({name:"OpenInAppAction",factory:{dependencies:gM,create:a=>({instance:{evaluateAction:b=>{var c,d,e;let f=(c=b.item,d=a.platform,e=a.getValidViewerTypesFromResource.getValidViewerTypes(b.item),!!(d.isWindows||d.isWinPhone||d.isAndroid||d.isIOS||d.isMac)&&!!c&&e!==aX.a.Copilot&&!!bq.a.hasItemPermission(c,bq.a.openItems)&&!c.appMap&&c.itemStatus!==br.b.ConditionalAccessBlocked&&(e!==aX.a.MSPdf&&e!==aX.a.Pdf&&e!==aX.a.Photo||!(bq.a.hasItemPermission(c,bq.a.insertListItems)&&bq.a.hasItemPermission(c,bq.a.editListItems)))),g=a.oneUpStore.getOneUpProperties();return{isAvailable:f,id:gL,onExecute:async()=>{let{focusItem:b,parentItem:c,focusItemSet:d}=g;if(g&&d&&d.length&&b&&c){let c=await a.getExecutor();return await c.executeOpenInApp({item:b,pageContexts:g.pageContexts,resources:a.resources}),{resultType:bp.b.Success}}{let c=(0,aV.i)("no parent view/item");throw a.oneUpStateStore.updateErrorState(gL,{errorType:aV.d.actionError,error:c,item:b}),c}}}}}})}}),oneUpStore:aF.b},gO="OpenInAppCommand",gP=new K.v7({name:"OpenInAppCommand",factory:{dependencies:gN,create:a=>({instance:{id:gO,name:bw.eb,title:bw.eb,automationId:gO,iconProps:{iconName:"OpenInNewWindow"},evaluateAction:a.actionProvider.evaluateAction}})}});var gQ=c(193);let gR={openInOfficeClientCommand:f0,openInOfficeOnlineCommand:f4,openInImmersiveReaderCommand:gf,openInHtmlViewerCommand:gj,openInTextEditorCommand:gn,openInStreamCommand:gs,openInFileHandlerCommands:gw,editInClipchampCommand:gH,openInAppCommand:gP,oneUpStateStore:a2.f},gS="openCommandGroup",gT=new K.v7({name:"OpenGroupCommand",factory:{dependencies:gR,create:a=>({instance:function(){let{openInOfficeClientCommand:b,openInImmersiveReaderCommand:c,openInOfficeOnlineCommand:d,openInTextEditorCommand:e,openInHtmlViewerCommand:f,openInStreamCommand:g,editInClipchampCommand:h,openInAppCommand:i}=a,j=a.openInFileHandlerCommands();return{id:gS,name:bw.$,automationId:gS,subCommands:[b,d,e,f,c,g,...j,h,i],evaluateAction:b=>({isAvailable:!a.oneUpStateStore.currentAppState.deletedKeys?.has(b.item.key)}),buttonStyles:(0,gQ.a)(),evaluateIconProps:a=>fY(a.extension)||{iconName:"OpenInNewWindow"}}}})}});var gU=c(489);let gV=new K.v7({name:"OnPickCopyFileAsync.key",loader:new K.dE(()=>Promise.all([c.e("ondemand.resx"),c.e(61)]).then(c.bind(c,861)).then(a=>a.onPickCopyFileKey))}),gW=(0,bA.a)(async()=>(await Promise.all([c.e("ondemand.resx"),c.e(22)]).then(c.bind(c,767))).Sdk80FilePickerHostModal);function gX(a){let b=new K.G7;return a.onRender(N.createElement(gY,a)),b.promise}function gY(a){let b=(0,ar.c)(),c=`${a.pageContext.webAbsoluteUrl}/${a.pageContext.layoutsUrl}/FilePicker.aspx`,d={title:bw.o,selection:{mode:"pick"},commands:{pick:{label:bw.n}},typesAndSources:{mode:"folders"},entry:{sharePoint:{byPath:{web:a.web,list:a.list,folder:a.folder}}}},e=(0,aT.a)(b=>(a.onClose(),Promise.resolve())),f=(0,aT.a)(a=>Promise.resolve()),g=(0,aT.a)(c=>{let d=new bp.a({name:"OneUpCopyToOnPick"}),e=b.consumeAsync(gV);return a.onClose(),e.then(b=>{b(c,a.folder).then(()=>d.end({resultType:bp.b.Success})).catch(a=>{d.end({resultType:bp.b.Failure,error:a})})}).catch(a=>{d.end({resultType:bp.b.Failure,error:a})}),Promise.resolve()});return N.createElement(gW,{pickerPageUrl:c,app:a.clientName,scenario:"MoveCopy",options:d,onPick:g,onClose:e,onLoad:f})}let gZ={getExecutor:new K.v7({name:"ShowFilePicker",factory:{dependencies:{},create:a=>({instance:{showFilePicker:gX}})}}).async.lazy,pageContext:an.a,clientName:gA.a.optional,oneUpStateStore:a2.f,itemUrlHelper:ax.c,oneUpStore:aF.b},g$=new K.v7({name:"CopyToAction",factory:{dependencies:gZ,create:a=>({instance:{evaluateAction:b=>{var c;return{isAvailable:!((c=b.item).itemStatus===br.b.ConditionalAccessBlocked||c.itemStatus===br.b.ConditionalAccessViewOnly||!bG.a&&(0,bF.c)(c.extension)||!bq.a.hasItemPermission(c,bq.a.openItems)||c.isRootFolder||c.lifeCycleStatus?.isMalwareDetected),id:"copyToAction",onExecute:async()=>{a.oneUpStateStore.updateModalState("CopyToCommand",{showModal:!0});let c=await a.getExecutor(),d=a.itemUrlHelper.getItemUrlParts(b.item.key),e=a.oneUpStore.parentItem?a.itemUrlHelper.getItemUrlParts(a.oneUpStore.parentItem.key):void 0,f=d.fullListUrl,g=d.fullWebUrl,h=e?.fullItemUrl,i={pageContext:a.pageContext,clientName:a.clientName||"OneUp",onClose:()=>{a.oneUpStateStore.updateModalState("CopyToCommand",{showModal:!1})},onRender:b=>{a.oneUpStateStore.updateModalState("CopyToCommand",{showModal:!0,content:b})},list:f,web:g,folder:h};return await c.showFilePicker(i),{resultType:bp.b.Success}}}}}})}}),g_="copyToCommand",g0=new K.v7({name:"CopyToCommand",factory:{dependencies:{actionProvider:g$},create:({actionProvider:a})=>({instance:{id:g_,name:bw.o,title:bw.p,automationId:g_,iconProps:{iconName:"Copy"},evaluateAction:a.evaluateAction}})}});var g1=c(699);let g2=new K.v7({name:"DeleteActionExecutor.key",loader:new K.dE(()=>Promise.all([c.e("ondemand.resx"),c.e(14)]).then(c.bind(c,862)).then(a=>a.deleteActionExecutorKey))}),g3="DeleteAction",g4={pageContext:an.a,oneUpStore:aF.b,navigation:ap.a,platform:aC.a,oneUpStateStore:a2.f,getExecutor:g2.async.lazy,navigateToItem:eV},g5=new K.v7({name:"DeleteAction",factory:{dependencies:g4,create:a=>({instance:{evaluateAction:b=>{var c;let d=(c=b.item,bq.a.hasItemPermission(c,bq.a.deleteListItems)&&(bG.a||!(0,bF.c)(c.extension))),e=a.oneUpStore.getOneUpProperties();return{isAvailable:d,id:g3,onExecute:async()=>{let{focusItem:c,parentItem:d,focusItemSet:f,currentIndex:g,list:h}=e;if(e&&f&&f.length&&c&&d){let i={parentKey:d.key,items:[b.item],deletionType:g1.a.Recycle,allowUndo:!1,emptyRecycleBin:!1,listId:h?.list?.id,overrideLock:!0,enforceETag:!1},j=d;j=void 0!==g&&g+1<f.length?f[g+1]:g&&g-1>=0?f[g-1]:d,(await a.getExecutor()).executeDelete({deleteItemsContext:i,item:b.item}).then(async b=>{if(b){let b=a.oneUpStateStore.currentAppState.deletedKeys;b?b.set(c.key,!0):(b=new Map).set(c.key,!0),a.oneUpStateStore.updateDeletedKeysState("DeleteAction",b),j.key===d.key?(await (0,K.uo)(5e3),await a.navigateToItem({item:j,options:{urlType:"focus"}})):await a.navigateToItem({item:j,options:{parentItem:e.parentItem,urlType:"focus"}})}return{resultType:bp.b.Success}}).catch(b=>{throw a.oneUpStateStore.updateErrorState("delete action",{errorType:aV.d.actionError,error:b,item:c}),b})}else{let b=(0,aV.i)("no parent view/item");throw a.oneUpStateStore.updateErrorState(g3,{errorType:aV.d.actionError,error:b,item:c}),b}}}}}})}}),g6="deleteCommand",g7=new K.v7({name:"DeleteCommand",factory:{dependencies:{actionProvider:g5},create:({actionProvider:a})=>({instance:{id:g6,name:bw.r,title:bw.s,automationId:g6,iconProps:{iconName:"Delete"},evaluateAction:a.evaluateAction}})}}),g8={actionProvider:c(394).b,oneUpStateStore:a2.f},g9="annotateCommand",ha=new K.v7({name:"AnnotateCommand",factory:{dependencies:g8,create:({actionProvider:a,oneUpStateStore:b})=>({instance:{id:g9,automationId:g9,name:bw.e,iconProps:{iconName:"InkingTool"},evaluateTitle:a=>b.currentAppState.annotationViewerState.isActive?bw.U:bw.Pb,evaluateAction:a.evaluateAction}})}});var hb=c(700),hc=c(701);let hd={openCommentsPaneActionAsync:eI.a.async,oneUpStateStore:a2.f},he={actionProvider:new K.v7({name:"OnClickCommentsButtonAction",factory:{dependencies:hd,create:a=>({instance:{evaluateAction:b=>{let c=a.oneUpStateStore.currentAppState.deletedKeys?.has(b.item.key);return{id:"onClickCommentsButtonAction",isAvailable:(0,hb.a)(b.item)&&!c,onExecute:async()=>{if(a.oneUpStateStore.currentAppState.rightPane.type===a2.e.commentsPane)a.oneUpStateStore.updateRightPaneState("onClickCommentsButton",{type:a2.e.none}),(0,hc.b)(hc.a.CloseCommentsFromCommandBar,b.item.extension);else{let c=await a.openCommentsPaneActionAsync();await c.evaluateAction({item:b.item,isAnnotateAction:!1}),(0,hc.b)(hc.a.OpenCommentsFromCommandBar,b.item.extension)}}}}}})}}),oneUpStateStore:a2.f},hf="commentCommand",hg=new K.v7({name:"CommentsCommand",factory:{dependencies:he,create:({actionProvider:a,oneUpStateStore:b})=>({instance:{id:hf,automationId:hf,buttonStyles:(0,gQ.a)(),iconProps:{iconName:"Comment"},evaluateTitle:a=>b.currentAppState.rightPane.type===a2.e.commentsPane?bw.V:bw.Tb,evaluateAction:a.evaluateAction}})}});var hh=c(702),hi=c(703),hj=c(704),hk=c(705),hl=c(706),hm=c(707),hn=c(221);function ho(a,b,c,d,e,f){return!!b&&!!(!c&&!b.isExternalGuestUser&&a?.extension?.toLowerCase()===".pdf"&&e?.()&&!f&&!d&&cK(b)&&function(a){if(!a)return!1;switch(a){case"ag08":case"ag09":case"chn":case"dod":case"gcch":case"gcc":default:return!1;case"edog":case"spdf":case"prodbubble":case"prod":return!0}}(b.cloudType?.toLowerCase()))}let hp=(0,bA.a)(async()=>(await Promise.all([c.e("ondemand.resx"),c.e(58)]).then(c.bind(c,863))).OneUpSigningRequestOrchestrator),hq=a=>!!a&&a.viewerVisiblity===a2.a.On,hr={oneUpStore:aF.b,oneUpStateStore:a2.f,pageContext:an.a,pdfHelper:b0.b,identityDataSource:b3.resourceKey,itemUrlHelper:ax.c,platformDetection:aC.a},hs=(a,b)=>({item:c})=>{var d,e,f;let g,h,i,j,{oneUpStore:k,oneUpStateStore:l,pageContext:m,pdfHelper:n,platformDetection:o,identityDataSource:p}=a,q=hq(l.currentAppState.annotationViewerState),r=l.currentAppState.viewerStates?.get(c.key)?.pdfViewerStates,s=`create_${b}RequestAction`,t=k.focusItem??c,u=bL({item:t,appLevelPagecontext:a.pageContext,itemUrlHelper:a.itemUrlHelper,remoteWebPageContexts:a.oneUpStore.pageContexts});return{isAvailable:(d=r?.isPdfPasswordProtected||r?.isPdfMip,e=()=>!!t&&n.isMsPdfViewerAvailable(t),f=o.isMobile,h=(g=!!hn.c||!!m?.isSyntexESignatureEnabled)&&!!(m?.isSyntexPAYGEnabled&&m?.syntexEsignatureThirdPartyEnabledProviders?.some(a=>a===cF.b.Adobe)),i=g&&!!(m?.isSyntexPAYGEnabled&&m?.syntexEsignatureThirdPartyEnabledProviders?.some(a=>a===cF.b.Docusign)),(j=ho({extension:t?.extension},m,q,d,e,f))&&b===cF.a.Adobe?h:!!j&&b===cF.a.Docusign&&i),id:s,onExecute:async()=>{l.updateESignDataState(s,{isCreateSidePanelActive:!1});let a=await p.getOAuthSessionToken({endPoint:(a=>{switch(a&&a.cloudType?.toLowerCase()){case"prod":case"prodbubble":case"ag08":case"ag09":case"chn":case"dod":case"gcch":case"gcc":return"396ef0b6-ae1c-4404-86ce-0a869d4d2987";default:return"9471276c-aa67-4dd2-bde2-291a033f3c3c"}})(m),apiQosName:"create3PESignRequestAction"}),c=await p.getSharePointToken({webAbsoluteUrl:m.webAbsoluteUrl,disallowSelfIssuedToken:!0,apiQosName:"create3PESignRequestAction"}),d={provider:b,item:{name:t.displayName,driveId:t.graph?.driveId,openUrl:t.openUrl,size:t.size,permissions:t.permissions,policies:{canDownload:u,isSigned:r?.isSigned}},sessionToken:{...a,correlationId:a.correlationId??cI()},spSessionToken:{...c,correlationId:c.correlationId??cI()}};return l.updateModalState(s,{showModal:!0,content:N.createElement(hp,{key:d.sessionToken.correlationId,...d})}),{resultType:gu.a.Success}}}},ht=new K.v7({name:"create3PESignRequestAction",factory:{dependencies:hr,create:a=>({instance:{evaluateAction:hs(a,cF.a.Adobe)}})}}),hu=new K.v7({name:"create3PESignRequestAction",factory:{dependencies:hr,create:a=>({instance:{evaluateAction:hs(a,cF.a.Docusign)}})}});var hv=c(383);let hw={oneUpStore:aF.b,oneUpStateStore:a2.f,pageContext:an.a,platformDetection:aC.a,pdfHelper:b0.b},hx=async(a,b,c)=>{try{let d=a.listId?a.listId.replace(/^\{|\}$/g,""):"",e=new hv.a({pageContext:a,getParentListId:()=>d,itemProvider:{invalidateItem:function(){}}}),f=await e.getSharingInformation(b),g=c.currentAppState.eSignData?.isCreateSidePanelActive;c.updateESignDataState("ToggleESign",{isCreateSidePanelActive:g,canAddExistingExternalUser:f.canAddExistingExternalPrincipal,canAddNewExternalUser:f.canAddExternalPrincipal})}catch(a){}},hy={syntexSignActionProvider:new K.v7({name:"createSyntexSignRequestAction",factory:{dependencies:hw,create:a=>({instance:{evaluateAction:({item:b})=>{let{oneUpStateStore:c,oneUpStore:d,pageContext:e,platformDetection:f,pdfHelper:g}=a,h=hq(c.currentAppState.annotationViewerState),i=c.currentAppState.viewerStates?.get(b.key)?.pdfViewerStates;return{id:"toggleESignAction",isAvailable:ho(d.focusItem,e,h,i?.isPdfPasswordProtected||i?.isPdfMip,()=>!!d.focusItem&&g.isMsPdfViewerAvailable(d.focusItem),f.isMobile)&&cJ(e),isDisabled:cG.l&&!i?.isOpened,onExecute:async()=>{let a=!c.currentAppState.eSignData?.isCreateSidePanelActive;return c.updateESignDataState("ToggleESign",{isCreateSidePanelActive:a}),a&&cG.i&&hx(e,b,c),{resultType:gu.a.Success}}}}}})}}),adobeSignActionProvider:ht,docuSignActionProvider:hu,pageContext:an.a},hz=new K.v7({name:"ToggleESignCommand",factory:{dependencies:hy,create:({syntexSignActionProvider:a,adobeSignActionProvider:b,docuSignActionProvider:c,pageContext:d})=>{var e,f;let g=function(a){let{isSyntexESignatureEnabled:b,syntexEsignatureThirdPartyEnabledProviders:c}=a,d=c?.filter(a=>a===cF.b.Adobe||a===cF.b.Docusign)||[];return(b?[cH]:[]).concat(d)}(d),h=cL(),i=cM(),j=(e=hh.a,f=hi.a,(0,cG.d)()?e:f),k=[{id:"GetSyntexSignatures",name:h,title:i,automationId:"GetSyntexSignatures",groupHeader:bw.E,iconProps:{imageProps:{src:j||hi.a}},evaluateAction:a.evaluateAction},{id:"GetAdobeSignatures",name:bw.J,title:bw.K,automationId:"GetAdobeSignatures",groupHeader:bw.E,iconProps:{imageProps:{src:hj.a}},evaluateAction:b.evaluateAction},{id:"GetDocusignSignatures",name:bw.L,title:bw.M,automationId:"GetDocusignSignatures",groupHeader:bw.E,iconProps:{imageProps:{src:hk.a}},evaluateAction:c.evaluateAction}],l=window.matchMedia&&window.matchMedia("(-ms-high-contrast: active)").matches||window.matchMedia&&window.matchMedia("(forced-colors: active)").matches,m=g.length>1,{commandName:n,commandTitle:o}=1!==g.length?{commandName:bw.N,commandTitle:bw.O}:({[cH]:{commandName:cL(),commandTitle:cM()},[cF.b.Adobe]:{commandName:bw.J,commandTitle:bw.K},[cF.b.Docusign]:{commandName:bw.L,commandTitle:bw.M}})[g[0]];return{instance:{id:"GetSignatures",name:n,title:o,automationId:"GetSignatures",iconProps:{imageProps:{src:l?hm.a:hl.a}},evaluateAction:({[cH]:a.evaluateAction,[cF.b.Adobe]:b.evaluateAction,[cF.b.Docusign]:c.evaluateAction})[g[0]]||a.evaluateAction,subCommands:m?k:[],buttonStyles:m?{root:{".ms-Icon":{margin:"0 2px"}},flexContainer:{padding:"0 6px"}}:void 0}}}}});var hA=c(74);let hB={actionProvider:(0,a4.$b)({ODB:61495})&&!hA.n?.isAnonymousGuestUser?cV:bu},hC="printCommand",hD=new K.v7({name:"PrintCommand",factory:{dependencies:hB,create:({actionProvider:a})=>({instance:{id:hC,name:bw.Ib,title:bw.xb,automationId:hC,iconProps:{iconName:"Print"},evaluateAction:a.evaluateAction,properties:{"aria-label":`${bw.xb}, ${bw.$b}`}}})}});var hE=c(708),hF=c(709);let hG={oneUpStateStore:a2.f},hH=new K.v7({name:"OutlineAction",factory:{dependencies:hG,create:a=>({instance:{evaluateAction:b=>{let{oneUpStateStore:c}=a,d=c.currentAppState.viewerStates?.get(b.item.key)?.pdfViewerStates,e=d?.outlineVisibility,f=c.currentAppState.annotationViewerState;return{isAvailable:!!e,id:"PdfOutline",isDisabled:!d?.isOpened,onExecute:async()=>{c.updateViewerState("outlineActionUpdateIsOutlineVisible",{key:b.item.key,options:{pdfViewerStates:{outlineVisibility:e===bh.b.Hidden?bh.b.Focus:bh.b.Hidden}}}),e===bh.b.Hidden&&f?.isActive&&c.toggleAnnotationViewerVisiblity("outlineActionHideAnnotationViewer")}}}}})}});var hI=c(134);let hJ={actionProvider:hH,oneUpStateStore:a2.f},hK="pdfOutlineCommand",hL=new K.v7({name:"PdfOutlineCommand",factory:{dependencies:hJ,create:({actionProvider:a,oneUpStateStore:b})=>((0,hI.d)(),{instance:{id:hK,automationId:hK,title:bw.Sb,name:bw.Db,evaluateIconProps:a=>b.currentAppState.viewerStates?.get(a.key)?.pdfViewerStates?.outlineVisibility===bh.b.Hidden?{iconName:"TextBulletListSquare"}:{iconName:"TextBulletListSquareFill"},evaluateAction:a.evaluateAction}})}}),hM={getExecutor:fh.async.lazy,oneUpStateStore:a2.f},hN=new K.v7({name:"onClickVersionHistoryAction",factory:{dependencies:hM,create:a=>({instance:{evaluateAction:b=>({isAvailable:bG.a||!(0,bF.c)(b.item.extension),id:"openVersionHistoryAction",onExecute:async()=>{if(a.oneUpStateStore.currentAppState.rightPane.type!==a2.e.versionHistory)return(await a.getExecutor()).executeOpenVersionHistory({item:b.item});a.oneUpStateStore.updateRightPaneState("closeVersionHistory",{type:a2.e.none})}})}})}}),hO="VersionHistoryCommand",hP=new K.v7({name:"VersionHistoryCommand",factory:{dependencies:{actionProvider:hN},create:({actionProvider:a})=>({instance:{id:hO,name:bw.jb,title:bw.Vb,ariaLabel:bw.jb+", "+bw.Vb,properties:{"aria-label":`${bw.jb}, ${bw.Vb}`},automationId:hO,iconProps:{iconName:"StackIndicator"},evaluateAction:a.evaluateAction}})}}),hQ=new K.v7({name:"EmbedDialogExecutor.key",loader:new K.dE(()=>Promise.all([c.e("ondemand.resx"),c.e(16)]).then(c.bind(c,864)).then(a=>a.embedDialogExecutorKey))}),hR="EmbedAction",hS={pageContext:an.a,oneUpStore:aF.b,navigation:ap.a,resources:K.m3,platform:aC.a,oneUpStateStore:a2.f,getExecutor:hQ.async.lazy,getValidViewerTypesFromResource:aX.c},hT=new K.v7({name:"EmbedAction",factory:{dependencies:hS,create:a=>({instance:{evaluateAction:b=>{var c;let d=!!(c=b.item)&&5!==c.queryType&&13!==c.queryType&&(!c.lifeCycleStatus||!c.lifeCycleStatus.isMalwareDetected)&&(!c||c.type!==bx.a.Folder)&&a.getValidViewerTypesFromResource.getValidViewerTypes(c)!==aX.a.Copilot,e=a.oneUpStore.getOneUpProperties();return{isAvailable:d,id:hR,onExecute:async()=>{let{focusItem:c,parentItem:d,focusItemSet:f,list:g}=e;if(e&&f&&f.length&&c&&d&&g){let c=await a.getExecutor();return await c.executeEmbedDialog({item:b.item}),{resultType:bp.b.Success}}{let b=(0,aV.i)("no parent view/item");throw a.oneUpStateStore.updateErrorState(hR,{errorType:aV.d.actionError,error:b,item:c}),b}}}}}})}}),hU="embedCommand",hV=new K.v7({name:"EmbedCommand",factory:{dependencies:{actionProvider:hT},create:({actionProvider:a})=>({instance:{id:hU,name:bw.C,title:bw.D,automationId:hU,iconProps:{iconName:"Embed"},evaluateAction:a.evaluateAction}})}}),hW={pageContext:an.a,navigation:ap.a},hX={actionProvider:new K.v7({name:"ViewOriginalImageAction",factory:{dependencies:hW,create:a=>({instance:{evaluateAction:b=>{var c,d,e;let f,g=(c=b.item,(f=c.photo?.originalUrl)&&f.replace(/#/g,"%23"));return{isAvailable:!!g&&(d=b.item,!(e=a.pageContext).blockDownloadsExperienceEnabled&&!e.viewOnlyExperienceEnabled&&bq.b.hasItemPermission(d,bq.b.openItems)),id:"ViewOriginalImageAction",onExecute:async()=>g?(await a.navigation.navigateTo({url:g,frameId:"_blank"}),{resultType:bp.b.Success}):{resultType:bp.b.Failure}}}}})}}),oneUpStore:aF.b},hY="viewOriginalImageCommand",hZ=new K.v7({name:"ViewOriginalImageCommand",factory:{dependencies:hX,create:({actionProvider:a})=>({instance:{id:hY,name:bw.zb,title:bw.zb,automationId:hY,iconProps:{iconName:"Picture"},evaluateAction:a.evaluateAction,properties:{"aria-label":`${bw.zb}, ${bw.$b}`}}})}}),h$=new K.v7({name:"RequestMoreAccessAction",factory:{dependencies:{},create:()=>({instance:{evaluateAction:()=>({isAvailable:!0,id:"RequestMoreAccessAction",onExecute:()=>{}})}})}}),h_={actionProvider:c(391).a},h0="editRequestMoreAccessCommand",h1={actionProvider:h$,editRequestMoreAccessCommand:new K.v7({name:"EditRequestMoreAccessCommand",factory:{dependencies:h_,create:({actionProvider:a})=>({instance:{id:h0,name:bw.Cb,automationId:h0,iconProps:{iconName:"Lock"},evaluateAction:a.evaluateAction}})}}),oneUpStore:aF.b},h2="requestMoreAccessCommand",h3=new K.v7({name:"RequestMoreAccessCommand",factory:{dependencies:h1,create:({oneUpStore:a,actionProvider:b,editRequestMoreAccessCommand:c})=>{let{label:d,icon:e}=(a=>{switch(a){case eH.a.none:return{label:bw.Y,icon:""};case eH.a.review:return{label:bw.Ob,icon:"Feedback"};case eH.a.view:case eH.a.restrictedview:return{label:bw.Gb,icon:"View"};default:return{label:bw.Y,icon:""}}})((0,eG.b)(a.focusItem?.permissions));return{instance:{id:h2,automationId:h2,buttonStyles:(0,gQ.a)(),iconProps:{iconName:e},subCommands:[c],evaluateAction:b.evaluateAction,evaluateCommandName:()=>d}}}}});var h4=c(710),h5=c(711);let h6={oneUpStateStore:a2.f,resources:K.m3,oneUpStore:aF.b,pageContext:an.a},h7=new K.v7({name:"FeedbackAction",factory:{dependencies:h6,create:a=>({instance:{evaluateAction:b=>{let{resources:e,pageContext:f}=a,g=f.isAnonymousGuestUser||f.isExternalGuestUser||f.isEmailAuthenticationGuestUser;return{isAvailable:(0,a4.zc)()?a.oneUpStateStore.currentAppState.isFeedbackEnabled||!1:!g,id:"Feedback",isDisabled:!1,onExecute:async()=>{if(d||f){let g=await Promise.all([c.e("ondemand.resx"),c.e(52)]).then(c.bind(c,770));if(!(0,a4.zc)())return(async()=>{let a=g.getInitializationStatus();return a.isInitialized&&void 0!==a.isAvailable?a.isAvailable:(await g.initOneUpFeedback(b.item,e,d||f)).isAvailable})().then(c=>c?g.showOneUpFeedback(b.item,e,d||f).then(()=>({resultType:bp.b.Success})).catch(c=>(a.oneUpStateStore.updateErrorState("feedbackAction.showOneUpFeedback",{errorType:aV.d.actionError,error:c,item:b.item}),a.oneUpStateStore.updateToastState("updateToast",{visible:!0,actionStatus:fI.ToastActionStatus.error,displayText:h5.a,toastKey:`${b.item.key}_feedback`,actionButtons:void 0}),c instanceof K.lM&&c.isExpected)?{resultType:bp.b.ExpectedFailure}:{resultType:bp.b.Failure}):(a.oneUpStateStore.updateToastState("updateToast",{visible:!0,actionStatus:fI.ToastActionStatus.error,displayText:h5.a,toastKey:`${b.item.key}_feedback`,actionButtons:void 0}),{resultType:bp.b.ExpectedFailure})).catch(c=>(a.oneUpStateStore.updateErrorState("feedbackAction.initOneUpFeedback",{errorType:aV.d.actionError,error:c,item:b.item}),a.oneUpStateStore.updateToastState("updateToast",{visible:!0,actionStatus:fI.ToastActionStatus.error,displayText:h5.a,toastKey:`${b.item.key}_feedback`,actionButtons:void 0}),{resultType:bp.b.Failure}));if((0,a4.zc)())return g.showOneUpFeedback(b.item,e,d||f).then(()=>({resultType:bp.b.Success})).catch(c=>(a.oneUpStateStore.updateErrorState("feedbackAction.showOneUpFeedback",{errorType:aV.d.actionError,error:c,item:b.item}),c instanceof K.lM&&c.isExpected)?{resultType:bp.b.ExpectedFailure}:{resultType:bp.b.Failure})}else{let c=(0,aV.i)("FeedbackAction: missing pagecontext");return a.oneUpStateStore.updateErrorState("feedbackAction.onExecute",{errorType:aV.d.actionError,error:c,item:b.item}),{resultType:bp.b.Failure}}}}}}})}}),h8=!1,h9=()=>{h8||((0,H.fU)({icons:{QuestionCircleRegular:N.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",display:"block",className:"helpGroupIcons"},N.createElement("g",{id:"Fluent-icon"},N.createElement("path",{id:"Shape",d:"M10 2C14.4183 2 18 5.58172 18 10C18 14.4183 14.4183 18 10 18C5.58172 18 2 14.4183 2 10C2 5.58172 5.58172 2 10 2ZM10 3C6.13401 3 3 6.13401 3 10C3 13.866 6.13401 17 10 17C13.866 17 17 13.866 17 10C17 6.13401 13.866 3 10 3ZM10 13.5C10.4142 13.5 10.75 13.8358 10.75 14.25C10.75 14.6642 10.4142 15 10 15C9.58579 15 9.25 14.6642 9.25 14.25C9.25 13.8358 9.58579 13.5 10 13.5ZM10 5.5C11.3807 5.5 12.5 6.61929 12.5 8C12.5 8.72959 12.1848 9.40774 11.6513 9.8771L11.4967 10.0024L11.2782 10.1655L11.1906 10.2372C11.1348 10.2851 11.0835 10.3337 11.0346 10.3859C10.6963 10.7464 10.5 11.2422 10.5 12C10.5 12.2761 10.2761 12.5 10 12.5C9.72386 12.5 9.5 12.2761 9.5 12C9.5 10.988 9.79312 10.2475 10.3054 9.70162C10.4165 9.5832 10.532 9.47988 10.6609 9.37874L10.9076 9.19439L11.0256 9.09468C11.325 8.81435 11.5 8.42206 11.5 8C11.5 7.17157 10.8284 6.5 10 6.5C9.17157 6.5 8.5 7.17157 8.5 8C8.5 8.27614 8.27614 8.5 8 8.5C7.72386 8.5 7.5 8.27614 7.5 8C7.5 6.61929 8.61929 5.5 10 5.5Z",fill:"#F3F2F1"}))),PersonFeedbackRegular:N.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",display:"block",className:"helpGroupIcons"},N.createElement("g",{id:"Fluent-icon"},N.createElement("path",{id:"Shape",d:"M10.5 12C11.3284 12 12 12.6716 12 13.5V14C12 15.9714 10.1405 18 7 18C3.85951 18 2 15.9714 2 14V13.5C2 12.6716 2.67157 12 3.5 12H10.5ZM10.5 13H3.5C3.22386 13 3 13.2239 3 13.5V14C3 15.4376 4.43216 17 7 17C9.56784 17 11 15.4376 11 14V13.5C11 13.2239 10.7761 13 10.5 13ZM7 5.5C8.51878 5.5 9.75 6.73122 9.75 8.25C9.75 9.76878 8.51878 11 7 11C5.48122 11 4.25 9.76878 4.25 8.25C4.25 6.73122 5.48122 5.5 7 5.5ZM16 2C17.0544 2 17.9182 2.81588 17.9945 3.85074L18 4V6C18 7.05436 17.1841 7.91817 16.1493 7.99451L16 8H14.499L13.301 9.59979C12.7716 10.306 11.6965 10.0199 11.5243 9.22426L11.5066 9.11264L11.5008 9L11.5 7.935L11.4224 7.91532C10.697 7.69685 10.1452 7.07753 10.0246 6.3148L10.0055 6.14926L10 6V4C10 2.94564 10.8159 2.08183 11.8507 2.00549L12 2H16ZM7 6.5C6.0335 6.5 5.25 7.2835 5.25 8.25C5.25 9.2165 6.0335 10 7 10C7.9665 10 8.75 9.2165 8.75 8.25C8.75 7.2835 7.9665 6.5 7 6.5ZM16 3H12C11.4872 3 11.0645 3.38604 11.0067 3.88338L11 4V6C11 6.51284 11.386 6.93551 11.8834 6.99327L12 7H12.5008V9L14 7H16C16.5128 7 16.9355 6.61396 16.9933 6.11662L17 6V4C17 3.48716 16.614 3.06449 16.1166 3.00673L16 3Z",fill:"#F3F2F1"}))),LearningAppRegular:N.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",display:"block",className:"helpGroupIcons"},N.createElement("g",{id:"Fluent-icon"},N.createElement("path",{id:"Shape",d:"M6 3H14C14.5523 3 15 3.44772 15 4V9.02242C15.3434 9.05337 15.6777 9.11588 16 9.20703V4C16 2.89543 15.1046 2 14 2H6C4.89543 2 4 2.89543 4 4V16C4 17.1046 4.89543 18 6 18H10.2572C10.0035 17.6929 9.78261 17.3578 9.59971 17H6C5.44772 17 5 16.5523 5 16H9.20703C9.11588 15.6777 9.05337 15.3434 9.02242 15H5V4C5 3.44772 5.44772 3 6 3ZM7 4C6.44772 4 6 4.44772 6 5V6C6 6.55228 6.44772 7 7 7H13C13.5523 7 14 6.55228 14 6V5C14 4.44772 13.5523 4 13 4H7ZM13 5V6H7V5H13ZM19 14.5C19 16.9853 16.9853 19 14.5 19C12.0147 19 10 16.9853 10 14.5C10 12.0147 12.0147 10 14.5 10C16.9853 10 19 12.0147 19 14.5ZM14.0203 12.534C13.9423 12.4811 13.8559 12.4546 13.7609 12.4546C13.6948 12.4546 13.6321 12.4687 13.5728 12.4969C13.5134 12.5234 13.4617 12.5596 13.4177 12.6054C13.3736 12.6513 13.338 12.7051 13.3108 12.7668C13.2854 12.8286 13.2727 12.8938 13.2727 12.9626V16.0374C13.2727 16.1045 13.2854 16.1689 13.3108 16.2306C13.338 16.2924 13.3736 16.347 13.4177 16.3947C13.4634 16.4405 13.516 16.4776 13.5753 16.5058C13.6346 16.5323 13.6965 16.5455 13.7609 16.5455C13.8101 16.5455 13.8559 16.5384 13.8983 16.5243C13.9423 16.5102 13.9856 16.489 14.028 16.4608L16.3242 14.8943C16.3937 14.8485 16.448 14.7867 16.4869 14.7091C16.5259 14.6315 16.5454 14.5503 16.5454 14.4656C16.5454 14.3774 16.5251 14.2963 16.4844 14.2222C16.4437 14.1463 16.3878 14.0855 16.3166 14.0396L14.0203 12.534Z",fill:"#F3F2F1"})))}}),h8=!0)},ia="feedbackCommand",ib=new K.v7({name:"FeedbackCommand",factory:{dependencies:{actionProvider:h7},create:({actionProvider:a})=>(h9(),{instance:{id:ia,automationId:ia,title:bw.H,name:bw.H,iconProps:{iconName:"PersonFeedbackRegular"},evaluateAction:a.evaluateAction}})}}),ic={oneUpStateStore:a2.f,getValidViewerTypesFromResource:aX.c},id=new K.v7({name:"TutorialFreAction",factory:{dependencies:ic,create:a=>({instance:{evaluateAction:b=>{let{oneUpStateStore:c,getValidViewerTypesFromResource:d}=a,e=d.getValidViewerTypes(b.item),f=c.currentAppState.isOneUpFreOpen,g=c.currentAppState.viewerStates?.get(b.item.key)?.pdfViewerStates,h=f;return(0,a4.$b)(a4.Ub)&&(h=!!f||e===aX.a.MSPdf&&!g?.isOpened),{isAvailable:!0,id:"TutorialFre",isDisabled:h,onExecute:async()=>{f||a.oneUpStateStore.updateOneUpShellFreIsOpen("tutorialFreAction",!0)}}}}})}}),ie="tutorialFreCommand",ig=new K.v7({name:"TutorialFreCommand",factory:{dependencies:{actionProvider:id},create:({actionProvider:a})=>(h9(),{instance:{id:ie,automationId:ie,title:bw.Rb,name:bw.Rb,iconProps:{iconName:"LearningAppRegular"},evaluateAction:a.evaluateAction}})}}),ih="helpCommandGroup",ii=a=>({isAvailable:!0}),ij=new K.v7({name:"HelpGroupCommand",factory:{dependencies:{feedbackCommand:ib,tutorialFreCommand:ig},create:a=>{let{feedbackCommand:b,tutorialFreCommand:c}=a;return h9(),{instance:{id:ih,name:bw.T,title:bw.T,automationId:ih,subCommands:[b,c],evaluateAction:ii,iconProps:{iconName:"QuestionCircleRegular"}}}}}});var ik=c(712);let il=!1;var im=c(392);let io={oneUpStore:aF.b,oneUpStateStore:a2.f,pageContext:an.a,resources:K.m3,getExecutor:im.a.async.lazy},ip=new K.v7({name:"DownloadRequestAction",factory:{dependencies:io,create:a=>({instance:{evaluateAction:(({oneUpStore:a,oneUpStateStore:b,pageContext:c,resources:d,getExecutor:e})=>()=>{let f=(0,eG.b)(a.focusItem?.permissions);return{isAvailable:!c.isAnonymousGuestUser&&f===eH.a.restrictedview,id:"DownloadRequestAction",onExecute:async()=>{let g=a.getOneUpProperties();if(g&&f){let a=await e();await a.showRequestMoreAccessDialog({item:g.focusItem,pageContext:c,itemRole:f,requestRole:eH.a.view,resources:d,onClose:()=>{b.updateModalState("downloadRequestCommand",{showModal:!1,content:void 0})},onRender:a=>{b.updateModalState("downloadRequestCommand",{showModal:!0,content:a})}})}}}})(a)}})}});var iq=c(713);let ir="downloadRequestMoreAccessCommand",is=({onClick:a,dismissMenu:b})=>{let c=(0,H.kF)(),d=N.useCallback(()=>{a(),b(void 0,!0)},[]),e=N.useCallback(()=>{b(void 0,!0)},[]);return N.createElement("div",{id:"RequestDownload-container",style:{display:"flex",flexDirection:"row",padding:"8px",backgroundColor:"#292827"}},N.createElement(ed.a,{iconName:"InfoSolid",styles:{root:{paddingRight:"8px",paddingTop:"8px",color:"white"}}}),N.createElement("div",{style:{display:"flex",flexDirection:"column",paddingRight:"20px",paddingTop:"5px"}},N.createElement("div",{id:"RequestDownload-title",style:{fontWeight:600,color:"white"}},bw.y),N.createElement("div",null,N.createElement(iq.a,{id:"RequestDownload-button",styles:{root:{padding:"7px 0px",height:"auto",color:"#2899F5"},rootHovered:{textDecoration:"underline"},label:{margin:"0"}},onClick:d,ariaLabel:`${bw.y} ${bw.Cb}`},bw.Cb))),N.createElement(c2.a,{id:"RequestDownload-cancel",onClick:e,iconProps:{iconName:"Cancel"},styles:{root:{color:c.palette.white}},ariaLabel:bw.h}))},it=new K.v7({name:"DownloadRequestCommand",factory:{dependencies:{actionProvider:ip},create:({actionProvider:a})=>({instance:{id:ir,name:bw.w,automationId:ir,iconProps:{iconName:"Feedback"},contextualMenuStyles:{title:{},root:{backgroundColor:"#292827"},list:{padding:"0"},header:{},container:{},subComponentStyles:{menuItem:{},callout:{calloutMain:{backgroundColor:"#292827"}}}},evaluateAction:a.evaluateAction,evaluateRenderMenuList:a=>(b,c)=>N.createElement(is,{onClick:a,item:b,dismissMenu:c})}})}}),iu=new K.v7({name:"BlockDownloadAction",factory:{dependencies:{},create:()=>({instance:{evaluateAction:()=>({isAvailable:!0,id:"BlockDownloadAction",onExecute:()=>{}})}})}}),iv="blockDownloadCommand",iw=new K.v7({name:"BlockDownloadCommand",factory:{dependencies:{blockDownloadActionProvider:iu,downloadRequestMoreAccessCommand:it},create:({blockDownloadActionProvider:a,downloadRequestMoreAccessCommand:b})=>{let c={id:iv,name:bw.f,title:bw.g,automationId:iv,subCommands:[b],buttonStyles:{menuIcon:{display:"none"}},iconProps:{iconName:"BlockDownload"},evaluateAction:a.evaluateAction};return il||((0,H.fU)({icons:{BlockDownload:N.createElement("svg",{width:"16",height:"16",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},N.createElement("path",{d:"M3.28034 2.21968C2.98745 1.92678 2.51257 1.92677 2.21968 2.21966C1.92678 2.51255 1.92677 2.98743 2.21966 3.28032L10.9993 12.0602L10.999 16.4329L7.27997 12.7192L7.1958 12.6467C6.90204 12.429 6.48539 12.4535 6.21931 12.72C5.92661 13.0131 5.92694 13.4879 6.22003 13.7806L11.2235 18.7772L11.3076 18.8498C11.6012 19.0673 12.0176 19.043 12.2837 18.7769L15.0001 16.0611L20.7194 21.7805C21.0123 22.0734 21.4872 22.0734 21.7801 21.7805C22.073 21.4876 22.073 21.0127 21.7801 20.7198L3.28034 2.21968ZM13.9393 15.0002L12.499 16.4399L12.4992 13.5601L13.9393 15.0002ZM17.1218 13.9399L16.0611 12.8792L16.2208 12.7196C16.4871 12.4533 16.9038 12.4291 17.1974 12.647L17.2815 12.7197C17.5477 12.986 17.5719 13.4026 17.354 13.6962L17.2814 13.7803L17.1218 13.9399ZM10.9996 7.81764L12.4995 9.31756L12.5 2.75488L12.4932 2.65311C12.4435 2.28704 12.1297 2.00488 11.75 2.00488L11.6482 2.01173C11.2822 2.06139 11 2.37519 11 2.75488L10.9996 7.81764ZM18.2498 20.4999C18.664 20.4998 19 20.8355 19 21.2497C19 21.6639 18.6644 21.9998 18.2502 21.9999L5.25022 22.0037C4.836 22.0038 4.5 21.6681 4.5 21.2539C4.5 20.8397 4.83557 20.5038 5.24978 20.5037L18.2498 20.4999Z",fill:"currentColor"}))}}),il=!0),{instance:c}}}}),ix="EditInAppAction",iy={oneUpStore:aF.b,platform:aC.a,oneUpStateStore:a2.f,itemUrlHelper:ax.c,getValidViewerTypesFromResource:aX.c,resources:K.m3,getExecutor:gK.async.lazy},iz={actionProvider:new K.v7({name:"EditInAppAction",factory:{dependencies:iy,create:a=>({instance:{evaluateAction:b=>{let c=function(a,b,c){if(!(b.isWindows||b.isMac||(0,cu.d)()&&(b.isWinPhone||b.isAndroid||b.isIOS))||!a||c===aX.a.Copilot)return!1;let d=!!bq.a.hasItemPermission(a,bq.a.openItems);return(c===aX.a.MSPdf||c===aX.a.Pdf||c===aX.a.Photo)&&d&&!a.appMap&&bq.a.hasItemPermission(a,bq.a.insertListItems)&&bq.a.hasItemPermission(a,bq.a.editListItems)}(b.item,a.platform,a.getValidViewerTypesFromResource.getValidViewerTypes(b.item)),d=a.oneUpStore.getOneUpProperties();return{isAvailable:c,id:ix,onExecute:async()=>{let{focusItem:b,parentItem:c,focusItemSet:e}=d;if(d&&e&&e.length&&b&&c){let c=await a.getExecutor();return await c.executeOpenInApp({item:b,pageContexts:d.pageContexts,resources:a.resources}),{resultType:bp.b.Success}}{let c=(0,aV.i)("no parent view/item");throw a.oneUpStateStore.updateErrorState(ix,{errorType:aV.d.actionError,error:c,item:b}),c}}}}}})}}),oneUpStore:aF.b},iA="EditInAppCommand",iB=new K.v7({name:"EditInAppCommand",factory:{dependencies:iz,create:a=>({instance:{id:iA,name:bw.eb,title:bw.eb,automationId:iA,iconProps:{iconName:"OpenInNewWindow"},evaluateAction:a.actionProvider.evaluateAction}})}}),iC=new K.v7({name:"isImageEditableInOneUp.key",factory:new K.Uo(()=>!0)}),iD={oneUpStateStore:a2.f,getValidViewerTypesFromResource:aX.c,pdfViewerHelper:b0.b,isImageEditable:iC},iE=new K.v7({name:"EditAction",factory:{dependencies:iD,create:a=>({instance:{evaluateAction:b=>{let{getValidViewerTypes:c}=a.getValidViewerTypesFromResource,d=c(b.item),e=a.oneUpStateStore.currentAppState.deletedKeys?.has(b.item.key),f=d===aX.a.Photo&&bq.a.hasItemPermission(b.item,bq.a.editListItems)&&a.isImageEditable()&&!e,g=a.oneUpStateStore.currentAppState,h=g.eSignData?.isCreateSidePanelActive||g.annotationViewerState?.isActive;if(d===aX.a.MSPdf){let c=g.viewerStates?.get(b.item.key)?.pdfViewerStates;f=a.pdfViewerHelper.isPdfEditAvailable(b.item)&&a.pdfViewerHelper.isPdfEditable(b.item)&&!c?.isPdfMip&&!h&&!!c?.isOpened&&(c?.isAnnotAllowed??!0)}return{isAvailable:f,id:"EditAction",onExecute:async()=>{a.oneUpStateStore.currentAppState.rightPane.type!==a2.e.none&&a.oneUpStateStore.updateRightPaneState("closeRightPane",{type:a2.e.none,content:void 0}),d===aX.a.MSPdf?a.oneUpStateStore.updatePdfState("updatePdfAppMode",bh.a.Edit):a.oneUpStateStore.updateImageState("openImageEditor",a2.c.edit)}}}}})}}),iF="editSplitCommand",iG=K.Ov.isActivated("cf60fb7c-d5d8-4232-9286-0ee6464b542a","07/11/2024","Refine style of the edit split button when no subcommands are available"),iH={splitButtonMenuButton:{width:"24px !important"},label:{textOverflow:"ellipsis",overflow:"hidden"},flexContainer:{padding:"0px 8px !important"}},iI=new K.v7({name:"EditSplitCommand",factory:{dependencies:{editInClipchampCommand:gH,editInAppCommand:iB,actionProvider:iE},create:a=>{let{editInClipchampCommand:b,editInAppCommand:c,actionProvider:d}=a,e=[b,c];return{instance:{id:iF,name:bw.z,automationId:iF,subCommands:e,evaluateAction:d.evaluateAction,isSplit:!0,splitButtonAriaLabel:bw.B,title:bw.z,...!iG?{evaluateButtonStyles:a=>e.some(b=>b.evaluateAction({item:a}).isAvailable)?iH:(0,gQ.a)()}:{buttonStyles:iH},iconProps:{iconName:"Edit"},properties:{"aria-roledescription":bw.Ub}}}}}}),iJ=new K.v7({name:"SyntexTranslateExecutor.key",loader:new K.dE(()=>Promise.all([c.e("ondemand.resx"),c.e(78)]).then(c.bind(c,866)).then(a=>a.translateActionExecutorKey))});var iK=c(715);let iL=K.Ov.isActivated("0b19576b-e1ee-476a-9abd-e85702207850","09/19/2024","Enabling translation command in Syntex Content Center Libraries"),iM={oneUpStateStore:a2.f,getExecutor:iJ.async.lazy,oneUpStore:aF.b,pageContext:an.a},iN=new K.v7({name:"SyntexTranslateAction",factory:{dependencies:iM,create:a=>({instance:{evaluateAction:b=>{let{pageContext:c}=a,d=a.oneUpStore.getOneUpProperties(),e=d?.focusItem,f=e?.extension??"",g=!1,h=c?.listBaseTemplate===gz.a.documentLibrary,i=c?.listBaseTemplate===gz.a.contentCenterPrimeLibrary||c?.listBaseTemplate===gz.a.contentCenterSampleLibrary;Number(c?.webTemplate)===cD.b.mySite?g=!!c?.isSyntexPAYGEnabled&&!!c?.isODBSyntexTranslationEnabled&&(0,a4.$b)(a4.Y)&&(0,iK.a)(f):(h||!iL&&i)&&(g=!!c?.isSyntexPAYGEnabled&&!!c?.isSyntexTranslationEnabled&&(0,a4.$b)(a4.Y)&&(0,iK.a)(f));let j=c?.listPermsMask,k=!!j&&bq.b.hasPermission(j,bq.b.manageLists);return{isAvailable:g&&k,id:"syntexTranslateAction",onExecute:async()=>{if(e)try{let b=await a.getExecutor();return await b.showTranslationDialog({item:e,pageContext:c,isSPDocLib:h||i,onRender:b=>{a.oneUpStateStore.updateModalState("syntexTranslateCommand",{showModal:!0,content:b})},onClose:()=>{a.oneUpStateStore.updateModalState("syntexTranslateCommand",{showModal:!1,content:void 0})}}),{resultType:gu.a.Success}}catch(a){return{resultType:gu.a.Failure,exception:a}}}}}}})}}),iO="syntexTranslateCommand",iP=new K.v7({name:"SyntexTranslateCommand",factory:{dependencies:{actionProvider:iN},create:({actionProvider:a})=>({instance:{id:iO,name:bw.Fb,title:bw.Hb,automationId:iO,iconProps:{iconName:"MicrosoftTranslatorLogo"},evaluateAction:a.evaluateAction}})}}),iQ=!K.Ov.isActivated("e4f01914-f051-4eb2-8366-597bdb8113f3"),iR={openInfoPaneActionAsync:ff.async,oneUpStateStore:a2.f},iS=new K.v7({name:"OnClickInfoButtonAction",factory:{dependencies:iR,create:a=>({instance:{evaluateAction:b=>({isAvailable:!0,id:"onClickInfoButtonAction",onExecute:async()=>{if(a.oneUpStateStore.currentAppState.rightPane.type===a2.e.detailPane)a.oneUpStateStore.updateRightPaneState("onClickInfoButton",{type:a2.e.none});else{let c=(await a.openInfoPaneActionAsync()).evaluateAction({item:b.item});if(c.isAvailable&&c.onExecute)await c.onExecute({qosEvent:new bp.a({name:"openInfoPane"})});else throw Error("openInfoPaneAction is not available")}}})}})}}),iT="InfoPaneCommand",iU=new K.v7({name:"InfoPaneCommand",factory:{dependencies:{actionProvider:iS},create:({actionProvider:a})=>({instance:{id:iT,name:bw.W,title:bw.X,ariaLabel:bw.W+", "+bw.X,properties:{"aria-label":`${bw.W}, ${bw.X}`},automationId:iT,iconProps:{iconName:"Info"},evaluateAction:a.evaluateAction}})}});var iV=c(716);let iW={openAboutThisCopilotPaneActionAsync:fg.async,oneUpStateStore:a2.f},iX=new K.v7({name:"OnClickAboutThisCopilotButtonAction",factory:{dependencies:iW,create:a=>({instance:{evaluateAction:({item:b})=>{let c=b.extension||"";return{isAvailable:(0,iV.a)(c),id:"onClickAboutThisCopilotButtonAction",onExecute:async()=>{if(a.oneUpStateStore.currentAppState.rightPane.type===a2.e.copilotDetailPane)a.oneUpStateStore.updateRightPaneState("onClickAboutThisCopilotButton",{type:a2.e.none});else{let c=(await a.openAboutThisCopilotPaneActionAsync()).evaluateAction({item:b});if(c.isAvailable&&c.onExecute)await c.onExecute({qosEvent:new bp.a({name:"openAboutThisCopilotPane"})});else throw Error("openAboutThisCopilotPaneAction is not available")}}}}}})}}),iY="AboutThisCopilotPaneCommand",iZ=new K.v7({name:"AboutThisCopilotPaneCommand",factory:{dependencies:{actionProvider:iX},create:({actionProvider:a})=>({instance:{id:iY,name:bw.a,title:bw.b,ariaLabel:bw.a+", "+bw.b,properties:{"aria-label":`${bw.a}, ${bw.b}`},automationId:iY,evaluateAction:a.evaluateAction,iconProps:{iconName:"info"}}})}});var i$=c(372);let i_="infoPaneCommandGroup",i0=a=>({isAvailable:!0}),i1=new K.v7({name:"InfoGroupCommand",factory:{dependencies:{openInfoPaneCommand:iU,openAboutThisCopilotPaneCommand:iZ},create:a=>{let{openInfoPaneCommand:b,openAboutThisCopilotPaneCommand:c}=a;return{instance:{id:i_,name:bw.W,title:bw.X,ariaLabel:bw.W+", "+bw.X,properties:{"aria-label":`${bw.W}, ${bw.X}`},automationId:i_,iconProps:{iconName:"Info"},evaluateAction:i0,isFlatten:!0,subCommands:[c,b],buttonStyles:(()=>{let{palette:a,semanticColors:b}=cN.b,c=`${b.buttonBackground} !important`,d={background:(0,a4.xc)()?c:"transparent !important",padding:"0px",margin:"4px 2px",color:a.black,height:"32px",width:"auto",border:"none",".ms-Button-menuIcon":{marginTop:"2px",color:a.black},".ms-Button-flexContainer":{backgroundColor:"transparent !important",alignItems:"center",justifyContent:"center",padding:"0px 4px"}};return(0,i$.a)(d)})()}}}}});var i2=c(717),i3=c(718);let i4=!K.Ov.isActivated("e716b6d4-f575-4940-bc25-37eee28d93a","04/15/2024","Display translate command in 1-up viewer"),i5={oneUpStore:aF.b,oneUpStateStore:a2.f,pageContext:an.a,dividerCommand:fp,infoPaneGroupCommand:i1,closeCommand:fy,downloadCommand:bN,favoriteCommand:fP,blockDownloadCommand:iw,openGroupCommand:gT,editSplitCommand:iI,saveCommand:gU.saveCommandKey,copyToCommand:g0,deleteCommand:g7,annotateCommand:ha,commentsCommand:hg,toggleESignCommand:hz,printCommand:hD,pdfExtractCommand:hE.a,pdfMergeCommand:hF.a,pdfEncryptCommand:i2.a,pdfOutlineCommand:hL,pdfCompressCommand:i3.a,openVersionHistoryCommand:hP,embedCommand:hV,viewOriginalImageCommand:hZ,openCopilotPaneCommand:ew.a,requestMoreAccessCommand:h3,presenceCommand:h4.a,shareGroupCommand:ik.a,translateCommand:iP,helpCommandGroup:ij,canOpenCopilot:cX.a},i6=new K.v7({name:"GenerateOneUpCommandBarWorkingSet",factory:{dependencies:i5,create:a=>{let{oneUpStore:b,oneUpStateStore:c,pageContext:d,dividerCommand:e,infoPaneGroupCommand:f,closeCommand:g,downloadCommand:h,favoriteCommand:i,blockDownloadCommand:j,openGroupCommand:k,editSplitCommand:l,saveCommand:m,copyToCommand:n,deleteCommand:o,annotateCommand:p,commentsCommand:q,printCommand:r,toggleESignCommand:s,pdfExtractCommand:t,pdfMergeCommand:u,pdfEncryptCommand:v,pdfOutlineCommand:w,pdfCompressCommand:x,openVersionHistoryCommand:y,embedCommand:z,viewOriginalImageCommand:A,openCopilotPaneCommand:B,requestMoreAccessCommand:C,presenceCommand:D,shareGroupCommand:E,translateCommand:F,helpCommandGroup:G,canOpenCopilot:H}=a;return{instance:{generateWorkingSets:function(){return{main:this.generateMainWorkingSet(),far:this.generateFarWorkingSet(),overflow:this.generateOverflowWorkingSet()}},generateMainWorkingSet:function(){let a=[],d=!!(c.currentAppState.deletedKeys&&c.currentAppState.deletedKeys.get(b.focusItem?.key||""));return c.currentAppState.isPublishToWebNavIdSet||d||((0,a4.$b)(a4.J)?a.push(m,w,e,h):a.push(m,h),a.push(i),(0,e5.d)()&&a.push(j),a.push(o,e,p,s,t,u,v,x,f)),a},generateOverflowWorkingSet:function(){let a=[],d=!!(c.currentAppState.deletedKeys&&c.currentAppState.deletedKeys.get(b.focusItem?.key||""));return c.currentAppState.isPublishToWebNavIdSet||d||(i4&&a.push(F),a.push(n,r,A,z,y),(0,a4.$b)(a4.Eb)&&a.push(G)),a},generateFarWorkingSet:function(){let a=[],e=!!(c.currentAppState.deletedKeys&&c.currentAppState.deletedKeys.get(b.focusItem?.key||""));if(!c.currentAppState.isPublishToWebNavIdSet)if(e)a.push(g);else{let{hidePeoplePreviewingFiles:e}=d;(!iQ||!e&&!c.state.currentState.siteHidePeoplePreviewingFiles)&&(0,a4.$b)(a4.j)&&a.push(D),(0,a4.$b)(a4.z)&&a.push(q),(0,a4.db)()?b.focusItem&&H.isCopilotSupportedForItem(b.focusItem)&&!(0,e5.c)(d)&&a.push(B):(0,e5.c)(d)||a.push(B),(0,e5.d)()&&a.push(C),a.push(k(),l,E,g)}return a}}}}}}),i7=new K.v7({name:"FileHandlerCommandsWorkingSetOverrideFunc",factory:{dependencies:{generateOneUpCommandBarWorkingSet:i6},create:a=>({instance:{read:()=>()=>a.generateOneUpCommandBarWorkingSet.generateWorkingSets()}})}}),i8={oneUpStore:aF.b,generateOneUpCommandBarWorkingSet:i6,fileHandlerCommandWorkingSetOverrideFunc:i7},i9=new K.v7({name:"OneUpCommandBarManager",factory:{dependencies:i8,create:a=>{let b=a.generateOneUpCommandBarWorkingSet.generateWorkingSets(),c=a.oneUpStore.focusItem?new fu({item:a.oneUpStore.focusItem,showCommands:!0,workingSet:b}):void 0;return(0,a4.Ab)()&&c?.addWorkingSetOverride(a.fileHandlerCommandWorkingSetOverrideFunc),{instance:c,disposable:c}}}});var ja=c(724),jb=c(719);(0,H.ZW)([{rawString:".OneUpNonInteractiveCommandWrapper_d7f8e809{justify-content:center;align-items:center;line-height:40px;font-size:16px;display:flex;flex-wrap:nowrap}.OneUpNonInteractiveCommandSpan_d7f8e809{display:contents;justify-content:center;align-items:center}.OneUpNonInteractiveCommand_d7f8e809{cursor:default;color:"},{theme:"black",defaultValue:"#000"},{rawString:";vertical-align:top;line-height:40px}.OneUpNonInteractiveCommandNewDesign_d7f8e809{cursor:default;color:#fff;vertical-align:top;line-height:40px}.OneUpNonInteractiveIconNewDesign_d7f8e809{margin:0 4px;color:#fff}.OneUpNonInteractiveTitleIcon_d7f8e809{margin:0 6px}"}]);let jc="OneUpNonInteractiveCommandWrapper_d7f8e809",jd=({icon:a})=>{let b=(0,db.a)();return(0,hI.b)(),O().createElement(c3.a,{content:bw.mb},O().createElement(ed.a,{style:{color:b.semanticColors.messageText,margin:"8px"},iconName:"lock"===a?"PdfEncryptLock":"PdfEncryptUnlock"}))},je=()=>a=>O().createElement("div",{className:jc,role:"menuitem",id:a.id,"aria-label":a.ariaLabel,tabIndex:-1,"aria-disabled":!0},a.iconProps?.iconName?O().createElement("span",{className:"OneUpNonInteractiveCommandSpan_d7f8e809"},O().createElement(ed.a,{className:"OneUpNonInteractiveIconNewDesign_d7f8e809",iconName:a.iconProps.iconName})):O().createElement(O().Fragment,null));var jf=c(89),jg=c(378),jh=c(239);let ji=K.Ov.isActivated("675a5397-4561-4df2-a9d8-cb730d9c9b88"),jj=K.Ov.isActivated("f40289e8-e08d-43e8-b00b-47201fb0c49e"),jk=!K.Ov.isActivated("3ABC5518-5FF8-4C10-BE93-F6A2D40DB92B"),jl=K.Ov.isActivated("fed7ca62-8042-44fa-b153-8d99d0e75d25");function jm(a){let{command:b,onClickQos:c,onClickCustomerPromise:d,computeVeto:e}=a;if(b.action.onExecute){let a=b.action.onExecute({qosEvent:c});a&&a.then(a=>{let b=a||{resultType:bp.b.Success};c.end(b),d?.end(b)}).catch(a=>{let f=new K.lM({code:"OneUpCommandException",innerError:a,extraData:{commandId:b.id}}),g=(0,cA.a)(f);c.end(g),d&&jr(f,d,g,e)})}else{let a=new K.lM({code:"NoAvailableAction",extraData:{commandId:b.id}});c.end((0,cA.a)(a)),d?.end((0,cA.a)(a))}}function jn(a,b,c,d){let{startSchema:e,computeVeto:f}=a.action.customerPromise||{},g=`OneUpLightSpeed.commandInvoked.${a.id}`,h=new bp.a({name:g,extraData:{extention:b.extension,viewer:b.viewer,...c}}),i=new ct.a({scenario:g,perfGoalInMs:aV.b,...e||{},extraData:{extention:b.extension,viewer:b.viewer,...e?.extraData||{},...c}});b.commandName=a?.id||a?.name||a?.title||"UnknownCmdBar",(0,ei.g)(`${ei.c}.${ei.a}`,b);let j={command:a,onClickQos:h,onClickCustomerPromise:i,computeVeto:f,fallbackErrorMsg:"Unhandled exception executing an action"};try{"CloseAction"===a.action.id&&a.action.isAvailable&&d?d().then(()=>{jm(j)}).catch(()=>{}):jm(j)}catch(c){let a=new K.lM({code:"commandExecutionError",innerError:c}),b=(0,cA.a)(a);h.end(b),i&&jr(a,i,b,f)}}function jo(a,b,c,d){let e=[];if(a&&a.length>0)for(let f=0;f<a.length;f++){let g=!!d||!a[f].name,h=!!(a[f].isSplit&&a[f].subCommands&&a[f].subCommands?.length)||void 0,i={key:a[f].id,id:a[f].id,iconOnly:g,iconProps:a[f].iconProps,text:a[f].name,title:g?void 0:a[f].title,disabled:a[f].action.isDisabled,onRender:a[f].onRender,onClick:()=>jn(a[f],b,a[f]?.extraData,c),buttonStyles:a[f].buttonStyles,split:h,splitButtonAriaLabel:a[f].splitButtonAriaLabel,"data-automation-id":a[f].automationId||a[f].action.id,ariaLabel:a[f].properties?.["aria-label"]||a[f].title||a[f].name,data:{automationid:a[f].automationId||a[f].action.id,"aria-label":a[f].properties?.["aria-label"]||a[f].title||a[f].name},tooltipHostProps:{content:a[f].title||a[f].name},...a[f]?.properties};i.iconProps={...i.iconProps,style:{...i.iconProps?.style,color:"inherit"}};let j=a[f].subCommands;if(j&&j.length>0){let c=function(a,b){let c,d,e=[],f={};for(let g=0;g<a.length;g++){let h={key:a[g].id,iconProps:a[g].iconProps,text:a[g].name,title:a[g].title,disabled:a[g].action.isDisabled,onRender:a[g].onRender,onClick:()=>jn(a[g],b,a[g]?.extraData),"data-automation-id":a[g].automationId||a[g].action.id,ariaLabel:a[g].properties?.["aria-label"]||a[g].title||a[g].name},i=a[g].evaluateRenderMenuList;i&&(h.onRender=i(()=>jn(a[g],b,a[g]?.extraData))),c=a[g].contextualMenuStyles,(d=a[g].groupHeader)&&!f[d]&&(e.push({key:d,itemType:2,text:d}),f[d]=!0),e.push(h)}return{items:e,styles:c,ariaLabel:d}}(j,b);jk&&a[f].isFlatten&&1===j.length?i.onClick=c.items[0].onClick:i.subMenuProps=c}e.push(i)}return e}function jp(a,b){if(a.renderedInOverflow||b<1)return N.createElement(N.Fragment,null);{let b=jg.a,c=(0,jf.a)(je(),b);return N.createElement(c,a)}}function jq(a,b,c,d){a.calcDisplaySet(b.focusItem,b.parentItem);let e=a.displaySet,f=[],g=[];return(e&&e.main&&e.main.length>0&&(f=jo(e.main,c,void 0,!0)),e&&e.overflow&&e.overflow.length>0&&(g=jo(e.overflow,c)),e&&e.far&&e.far.length>0)?{main:f,overflow:g,far:jo(e.far,c,d)}:{main:f,overflow:g,far:[]}}function jr(a,b,c,d){let e=(0,jh.a)(a,{computeVeto:d,qosEndSchema:c});b.end(e)}let js=a=>N.createElement(c3.a,{content:bw._},N.createElement(jg.a,a));function jt(a){let b=(0,ar.c)(),d=b.consume(aF.b),e=N.useContext(ei.d),{getValidViewerTypes:f}=N.useRef(b.consume(aX.c)).current,[g,h]=N.useState(d.getOneUpProperties()),[i,j]=N.useState(!0),[k,l]=N.useState(!0),m=N.useRef(void 0),n=N.useCallback(()=>{if(g){let b={extension:g.focusItem.extension||"",viewer:f(g.focusItem),...e},c=m.current?jq(m.current,g,b,a.onCloseCallback):void 0;if(c)return c}return{main:[],overflow:[],far:[]}},[g,m]),o=N.useCallback(()=>n(),[n]),p=N.useCallback(()=>n().main,[n]),q=N.useCallback(()=>n().overflow,[n]),r=p(),[s,t]=N.useState(r),u=q(),[v,w]=N.useState(u),[x,y]=N.useState(()=>{if(g){let b={extension:g.focusItem.extension||"Unknown",viewer:f(g.focusItem),...e},c=m.current?jq(m.current,g,b,a.onCloseCallback):void 0;if(c)return c.far}return[]}),z=N.useCallback(()=>{if((0,a4.$b)(a4.J)){let a;(a=[],s.forEach((b,c)=>{b.id===fn&&a.push(c)}),a).forEach(a=>{let b=s[a];s[a]={...b,key:`${b.key}_${a}`,iconOnly:!0,disabled:!0,ariaLabel:bw.v,commandBarButtonAs:je(),onRender:b=>jp(b,a)}})}else{let a=s.map(a=>a.key).indexOf(fn);if(a>-1){let b=s[a];b={...b,iconOnly:!0,disabled:!0,ariaLabel:bw.v,commandBarButtonAs:je(),onRender:b=>jp(b,a)},s[a]=b}}return[s,x]},[s,x]),A=(0,aT.a)((a,b)=>{if(a&&b){let c=b.get(a);if(c){j(void 0===c.showMainCommands||c.showMainCommands),l(void 0===c.showTitle||c.showTitle);let a=o();t(a.main),w(a.overflow),y(a.far)}else j(!0),l(!0)}else j(!0),l(!0)}),[B]=(0,a2.g)("currentState",a=>a),{rightPane:C,viewerStates:D,isOneUpFreOpen:E,eSignData:F,annotationViewerState:G,isFocusItemFavorited:I,isFeedbackEnabled:J,isUniversalPrintLicenseValid:K,isPdfPaidFeaturesEnabled:L,fileHandlerOptions:M}=B||{},P=B?.renamedKeyInFastOneUp===g?.focusItem.key,Q=C?.type;N.useEffect(()=>{A(g?.focusItem.key,D)},[D,E,g,A]),N.useEffect(()=>{let a=n();t(a.main),w(a.overflow),y(a.far)},[F,G,n]),N.useEffect(()=>{y(n().far)},[Q]),N.useEffect(()=>{if(g?.focusItem){let a=n();t(a.main),(0,a4.$b)(a4.Eb)&&w(a.overflow)}},[I,J]),N.useEffect(()=>{g?.focusItem&&(0,a4.$b)({ODB:61495})&&t(n().main)},[K]),N.useEffect(()=>{g?.focusItem&&t(n().main)},[L]),N.useEffect(()=>{g?.focusItem&&(0,a4.$b)(a4.w)&&t(n().main)},[P]),N.useEffect(()=>{M&&((0,a4.Ab)()&&m.current&&m.current.updateWorkingSetOverride({publisher:"fileHandlerData"}),y(n().far))},[M,n,b]),N.useEffect(()=>()=>{(0,a4.$b)(a4.Eb)&&(async()=>{let a=await Promise.all([c.e("ondemand.resx"),c.e(52)]).then(c.bind(c,770));await a.dispose()})().then(()=>{}).catch(()=>{})},[]);let R=D?.get(g?.focusItem.key||"")?.pdfViewerStates,S=b.consume(a2.f),T=!(0,a4.Rc)()&&S.currentAppState.isPublishToWebNavIdSet,U=S.currentAppState.deletedKeys?.get(d.focusItem?.key||"")||!1,V=N.useMemo(()=>{if(!g||!k)return[];{let a=(0,a4.$b)(a4.G)&&R?.isPdfPasswordProtected&&!T?R?.isOpened?"unlock":"lock":"none";return[function(a,b="none",d,e,f,g){let h=f?a.name:a.displayName,i=!1;if(h)if(ji)h.length>23&&(h=h?.replace(/(.{21}).+(\..+)/,"$1...$2"),i=!0);else{let a=Array.from(h);if(a&&a.length>23){let b=Math.floor(11.5),c=a.slice(0,b).join(""),d=a.slice(a.length-b).join("");h=`${c}...${d}`,i=!0}}if(!jj&&(0,a4.$b)({ODB:62312})&&!f&&!g&&(bG.a||!(0,bF.c)(a.extension))){let f=(0,bA.a)(async()=>(await Promise.all([c.e("ondemand.resx"),c.e(56)]).then(c.bind(c,854))).OneUpRename);return{key:"title",id:"titleCommand",title:i?a.displayName:void 0,iconProps:{iconName:a.iconName},onRender:()=>N.createElement("div",{style:{paddingBottom:"0px",marginInline:"60px",display:"flex",alignItems:"center"}},N.createElement(f,{item:a,engagementContext:d,activeViewer:e}),"none"!==b&&N.createElement(jd,{icon:b})),data:{automationid:"titleCommand"}}}return{key:"title",id:"titleCommand",text:h,title:i?a.displayName:void 0,iconProps:f?{}:{iconName:a.iconName},icon:b,item:a,commandBarButtonAs:a=>{let b=O().createElement(jb.a,{className:(0,H.oG)("OneUpNonInteractiveCommandNewDesign_d7f8e809","OneUpCommandBarTitle")},a.text),c="OneUpNonInteractiveTitleIcon_d7f8e809";return O().createElement("div",{className:(0,H.oG)(jc,"OneUpCommandBarTitleWrapper"),style:"none"!==a.icon?{transform:"translateX(13px)"}:void 0,role:"menuitem"},O().useMemo(()=>a.iconProps?.iconName?O().createElement(di,{item:void 0,iconName:a.iconProps.iconName,desiredSize:17,iconSize:32,fileExtention:"svg",className:c,iconFieldAriaLabel:bw.ic}):O().createElement(O().Fragment,null),[c,a.iconProps?.iconName]),a.title?O().createElement(c3.a,{content:a.title},b):b,"none"!==a.icon&&O().createElement(jd,{icon:a.icon}))},data:{automationid:"titleCommand"}}}(g.focusItem,a,e,f(g.focusItem),T,U)]}},[g?.focusItem,R]);(0,eT.b)({updateOneUpStatus:function(c){if("update"in c.detail&&c.detail.update&&"publisher"in c.detail){let d=c.detail.update;m.current||(m.current=b.consume(i9));let g={extension:d.focusItem.extension||"Unknown",viewer:f(d.focusItem),...e},i=m.current?jq(m.current,d,g,a.onCloseCallback):void 0;h(d),i?.main&&(t(i.main),i?.overflow&&w(i.overflow)),i?.far&&y(i.far)}}},aF.a.oneUpItemCacheUpdate);let W=z(),X={id:"oneupCommandBarOverflow","data-automationid":"overflowButton",menuProps:{items:[],id:"oneupCommandBarOverflowMenu",isBeakVisible:!1},"aria-label":bw._},Y=cN.b;Y.semanticColors&&(Y.semanticColors.menuBackground=cN.b.palette?.white);let Z=S.currentAppState.isTeamsFileScenario;return jl||!Z?N.createElement(fm,{id:"OneUpCommandBar",items:i&&W?W[0]:[],overflowItems:i?v:[],middleItems:V,farItems:W?W[1]:[],overflowButtonProps:X,overflowButtonAs:js,styles:{root:{overflowY:"hidden"}},...(0,a4.ob)()?{role:"navigation"}:{}}):N.createElement(ja.a,{theme:Y},N.createElement(fm,{id:"OneUpCommandBar",items:i&&W?W[0]:[],overflowItems:i?v:[],middleItems:V,farItems:W?W[1]:[],overflowButtonProps:X,overflowButtonAs:js,styles:{root:{overflowY:"hidden"}}}))}(0,H.ZW)([{rawString:".reatOneUpToast_b10aa152{position:absolute;bottom:12px;left:50%;transform:translate(-50%,0)}"}]);let ju=(0,bA.a)(async()=>(await c.e(59).then(c.bind(c,776))).ToastComponent),jv=a=>{let b,c,{toastData:d}=a;return d?N.createElement("div",{className:"reatOneUpToast_b10aa152","data-automation-id":"ReactOneUpToastContainer"},(b=[],c=0,d.forEach((a,d)=>{b.push(N.createElement(ju,{index:c++,visible:a.visible,actionStatus:a.actionStatus,displayText:a.displayText,toastKey:a.toastKey,actionButtons:a.actionButtons,doNotAutoDismiss:a.doNotAutoDismiss}))}),b)):N.createElement(N.Fragment,null)};var jw=c(379);let jx=!K.Ov.isActivated("1A9C038A-B822-46F4-AC48-2FAEAD75481C"),jy=!K.Ov.isActivated("058098C5-2E70-4392-980F-D2B0F0E85353"),jz=!K.Ov.isActivated("f1644fe0-2fcc-46cd-a4a6-ceeafb02c981"),jA=!K.Ov.isActivated("afcbc616-7fc3-4064-b02e-bd2ab3bf06c8"),jB=!K.Ov.isActivated("E27E48F4-D876-454E-82F9-6578775F9FD7"),jC=N.lazy(()=>c.e(68).then(c.bind(c,848))),jD=N.lazy(()=>Promise.all([c.e("ondemand.resx"),c.e(24)]).then(c.bind(c,849))),jE="publishView";function jF(){let[a]=(0,a2.g)("currentState",a=>a.modal);return a&&a?.showModal?N.createElement("div",{id:"OneUpModalContainer"},a.content):N.createElement(N.Fragment,null)}function jG(){let a=(0,eT.a)(),[b]=(0,a2.g)("currentState",a=>a),d=N.useMemo(()=>{if(!b)return!0;let c=b.imageMode!==a2.c.edit&&b.pdfAppMode!==bh.a.Edit&&b.pdfAppMode!==bh.a.Esign&&b.pdfAppMode!==bh.a.Extract;return jB&&c&&(c=!(b.navMode===a2.d.single&&(0,bF.c)(a?.focusItem.extension))),c},[b,a]),[e]=(0,a2.g)("currentState",a=>a.toast),[f]=(0,a2.g)("currentState",a=>a.errorState);(0,jw.b)(),function(){let a=(0,ar.c)(),b=(0,eT.a)(a=>a?.focusItem),[c]=(0,a2.g)("currentState",a=>a?.pdfCopilotAction),[d]=(0,a2.g)("currentState",a=>a?.fabCopilotAction),e=a.consume(a2.f);O().useEffect(()=>{let f,g,h;if(jx){if(b&&(c?.prompt||d?.prompt)){let c=e?.currentAppState?.rightPane?.type===a2.e.copilotPane,d=a.consume(fi.a),i=d?.evaluateAction({item:b});h=i?.isAvailable,f=c?a=>{}:i?.onExecute,g="autoCopilotAction"}if(h&&f){let a=new bp.a({name:`OneUpLightSpeed.CopilotActionExecutorInvoked.${g||"unknownAction"}`}),b="Unhandled exception executing copilot action";try{let c=f({qosEvent:a});c&&c.then(b=>{let c=b||{resultType:bp.b.Success};a.end(c)}).catch(c=>{let d=c||Error(b);a.end((0,cA.a)(d))})}catch(d){let c=d||Error(b);a.end((0,cA.a)(c))}}}},[c,d])}();let g=(0,ei.h)(),h=window.matchMedia("(prefers-reduced-motion: reduce)"),i=!h||h.matches?0:300,j=aW.k,k=aW.l,[l,m]=N.useState(""),[n,o]=N.useState(!0),[p,q]=N.useState(!1),r=(0,ar.c)(),s=r.consume(ap.a),t=r.consume(fv.a),u=r.consume(dG.a),v=r.consume(fy),w=N.useRef(null),x=N.useRef(!1),y=!1;(0,a4.Wb)()&&bP.k&&(y=r.consume(bP.k.optional)||!1);let z=N.useCallback(b=>!b&&(0,dH.b)({navigation:s,saveAction:u,focusItem:a?.focusItem})?Promise.resolve():(m(k),new Promise(function(a){setTimeout(a,i)})),[s,u,a]),A=(0,aT.a)(b=>{if(a.focusItem&&"Escape"===b.key&&"Escape"===b.key&&a?.parentItem){let b=new bp.a({name:`OneUpLightSpeed.commandInvoked.${v.id}`});if(jy){let c=t.evaluateAction({item:a.focusItem});z().then(()=>{c.onExecute({qosEvent:b})?.then(a=>{let c=a||{resultType:bp.b.Success};b.end(c)}).catch(a=>{b.end((0,cA.a)(a))})}).catch(()=>{})}else t.evaluateAction({item:a.focusItem}).onExecute({qosEvent:b})?.then(a=>{let c=a||{resultType:bp.b.Success};b.end(c)}).catch(a=>{b.end((0,cA.a)(a))})}}),B=(0,aT.a)(async(a,b)=>{if(ff){let c=(await r.consumeAsync(ff)).evaluateAction({item:a});c.isAvailable&&c.onExecute&&await c.onExecute({qosEvent:b})}});return N.useEffect(()=>{if((0,a4.Wb)()&&y&&w&&w.current&&a&&a.focusItem&&!p){let b=new bp.a({name:`OneUpLightSpeed.commandInvoked.${iU.id}`});B(a.focusItem,b).then(a=>{let c=a||{resultType:bp.b.Success};b.end(c),q(!0)}).catch(a=>{b.end((0,cA.a)(a))})}},[a,w,w.current,B,y]),N.useEffect(()=>{w&&w.current&&a&&(w.current?.focus(),w.current.addEventListener("keydown",A))},[w,w.current,A]),N.useEffect(()=>{setTimeout(()=>m(j),10)},[]),N.useEffect(()=>{if((0,a4.zc)()){let b=r.consume(an.a);if((0,a4.$b)(a4.Eb)&&a?.focusItem&&!x.current&&!b.isAnonymousGuestUser){let d=r.consume(aF.b),e=r.consume(a2.f),f=d.getOneUpProperties(),g=new fF.b({context:b}),{id:h,listurl:i}=(0,K.pW)(a?.focusItem.key),j=g.getUrlParts({listUrl:i,path:h}),k={webAbsoluteUrl:j.fullWebUrl,listUrl:j.serverRelativeListUrl},l=f?.pageContexts?.get(k);(async()=>{let d=await Promise.all([c.e("ondemand.resx"),c.e(52)]).then(c.bind(c,770)),e=d.getInitializationStatus();return e.isInitialized&&void 0!==e.isAvailable?e.isAvailable:(await d.initOneUpFeedback(a?.focusItem,r,l||b)).isAvailable})().then(a=>{e.setIsFeedbackEnabled("feedbackAction",a),x.current=!0}).catch(()=>{e.setIsFeedbackEnabled("feedbackAction",!1),x.current=!0})}}},[a]),N.useEffect(()=>{if(!(0,a4.Rc)()){let a=s.viewParams[bb.b.navParamKey],b=r.consume(a2.f);try{a&&(a===jE||atob(a)===jE)&&b.updateIsPublishToWebNavIdSet("OneUpRoot",!0)}catch(a){b.updateIsPublishToWebNavIdSet("OneUpRoot",!1)}}},[]),N.useEffect(()=>{if(jA){let a=new URL(window.location.href.toLowerCase());a&&a.searchParams.has("app")&&"teamsfile"===a.searchParams.get("app").toLocaleLowerCase()&&-1!==a.pathname.indexOf("/_layouts/15/filebrowser.aspx")&&r.consume(a2.f).updateIsTeamsFileScenaro("OneUpRoot",!0)}},[]),N.useEffect(()=>{async function a(){let a=await r.consumeAsync(cS.a),b=await a.hasValidLicenseCached();r.consume(a2.f).updateIsUniversalPrintLicenseValidState("fastOneUpAdapter",b)}!(0,a4.Tc)()&&jz&&a().catch(a=>{})},[]),N.useEffect(()=>{l===k&&setTimeout(()=>o(!1),i)},[l]),N.useEffect(()=>{f&&f.errorType===aV.d.rldsApiError&&o(!1)},[f]),N.createElement(N.Fragment,null,n&&N.createElement("div",{id:"oneUpRoot",...(0,a4.uc)()&&{"data-suppresskeyboardbinding":"true"},className:(0,H.oG)(aW.B,l),ref:w},N.createElement(ei.d.Provider,{value:g},d&&N.createElement(jt,{onCloseCallback:z}),N.createElement("div",{className:(0,H.oG)(d?aW.E:aW.D,aW.C)},N.createElement(fd,{closeCallback:z}),N.createElement(fk,null),e&&N.createElement(jv,{toastData:e})),N.createElement(jF,null),(0,a4.$b)(a4.Wc)&&N.createElement("div",null,N.createElement(N.Suspense,{fallback:N.createElement(N.Fragment,null)},N.createElement(jC,null))),((0,a4.$b)(a4.Kc)||(0,a4.$b)(a4.Eb))&&N.createElement("div",null,N.createElement(N.Suspense,{fallback:N.createElement(N.Fragment,null)},N.createElement(jD,null))))))}var jH=c(165);let jI={isFastOneUp:bP.j.optional,pageContext:an.a},jJ=new K.v7({name:"OneUpBootCustomerPromiseFunctionsKey",factory:{dependencies:jI,create:a=>{let b,c=a.pageContext,d=(0,jH.b)(c)?.toLowerCase()||"unknown";return{instance:{newBootCustomerPromise:function(e){void 0===b&&(b=new ct.a({scenario:"OneUpLightSpeed.Boot",perfGoalInMs:aV.a,pillar:"View",extraData:{oneUpRenderingMode:a.isFastOneUp?aV.e.fastOneUp:aV.e.inlineOneUpFirstPage,Ring:d,correlationId:c?.CorrelationId,...e}}))},reportBootCXPSuccess:function(a){b?.end({resultType:bp.b.Success,extraData:{...a}}),b=void 0},reportBootCXPFailure:function(a){var c;let{errorType:d,error:e}=a.rawError,f=(0,cA.a)(e),g="string"==typeof(c=f.resultCode||"Unknown")?c.split(",").join("_"):JSON.stringify(c),h="FastOneUp-NoRowData"===g&&(0,a4.bb)()?bp.b.ExpectedFailure:f.resultType;b?.end({resultType:h,errorCode:g,extraData:{errorType:d,rawError:e,...f.extraData}}),b=void 0}}}}}});function jK(){let a=(0,ar.c)(),[b]=(0,a2.g)("currentState",a=>a.errorState),[c,d]=N.useState(!1),e=(0,eT.a)(),f=(0,ei.h)();(0,N.useEffect)(()=>{let b=a.consume(jJ);e?.focusItem&&(b.reportBootCXPSuccess({engagementContext:f}),a.consume(aU.b).newLoadingCustomerPromise(e.focusItem,f))},[e?.focusItem.key,a]),(0,N.useEffect)(()=>{let c=a.consume(jJ),e=a.consume(aU.b);b?.errorType===aV.d.viewerInitLoadingError&&e.reportLoadingCXPFailure({rawError:b}),b?.errorType===aV.d.rldsApiError&&(c.reportBootCXPFailure({rawError:b}),d(!0)),b?.errorType===aV.d.rldsApiErrorNoAccess&&(c.reportBootCXPFailure({rawError:b}),d(!0)),b?.errorType===aV.d.processOneUpItemError&&c.reportBootCXPFailure({rawError:b})},[b,a]);let g=b?.error?.message;return g||(g=b?.errorType===aV.d.rldsApiErrorNoAccess?eS.o:eS.n),c&&b?N.createElement("div",null,N.createElement(es,{errorTitle:g})):N.createElement(N.Fragment,null)}var jL=c(732);function jM(){(0,aq.f)("OneUpLightSpeed");let a=(0,ar.c)(),b=a.consume(aC.a),c=a.consume(an.a),d=b.isSafari&&b.isMobile,e=(0,aT.a)((b,c)=>{let d={errorType:aV.d.reactRenderError,error:b.name?b:Error("ReactRenderError"),extraData:{info:c.toString(),error:b.toString()}};a.consume(aU.b).reportLoadingCXPFailure({rawError:d})}),f=cN.b;K.Ov.isActivated("662e8b03-bcd7-47a7-9520-1f9801974b7b")||(0,e5.a)(c);let g="100vh";g=K.Ov.isActivated("28a7c449-3563-4201-b8a9-60840b5f6222")?d?"100%":"100vh":"100dvh";let h=!K.Ov.isActivated("3cf1a381-4d99-4581-870e-fca14d0a3884"),i={height:h?`${g} !important`:g,width:h?"100vw !important":"100vw",maxWidth:h?"unset !important":"unset",maxHeight:h?"unset !important":"unset",minHeight:h?"unset !important":"unset",borderRadius:h?"0px !important":"0px"},j=!K.Ov.isActivated("d231628a-6f44-4d6f-a8a0-6e4c58723989");i={...i,background:f.semanticColors.bodyBackground,...j?{overflow:"hidden"}:{}};let k=!K.Ov.isActivated("f91e6032-6933-42ff-b732-5f0af7c73f1c"),l="";k&&(l=`OneUpModalSizing ${d?"OneUpSafariMobile":""}`);let m={...f,components:jL.a};return N.createElement(ja.a,{theme:m},N.createElement(aS.a,{componentName:"OneUpLightSpeed",onError:e},N.createElement(aR.a,{className:`${aW.s} ${l}`,allowTouchBodyScroll:!0,isOpen:!0,focusTrapZoneProps:{firstFocusableTarget:`#${fc}`},layerProps:{eventBubblingEnabled:!0},styles:{main:i,layer:{zIndex:1e3,...!K.Ov.isActivated("88516ad7-7d40-471b-b1e1-009af064cab4")?{"&.fui-DialogSurface__backdrop":{zIndex:"auto"}}:{}}}},N.createElement(jK,null),N.createElement(jG,null),N.createElement("div",{id:"oneupFeedbackHostNode"}))))}var jN=c(222),jO=c(750),jP=c(751);let jQ=K.Ov.isActivated("3C8E1B8A-96C9-4AC3-ACAA-0A79AA85F566"),jR={ITEMSVIEWDEMO:"ItemsViewDemo",LISTALLITEMS:"ListAllItems",LISTSHOME:"ListsHome","ODB WEB":"ODB Web",ONEDRIVELTI:"OneDriveLti",SPARTANLIST:"SpartanList","SPLIST WEB":"SPList Web",TEAMS:"Teams",TEAMSLIST:"Teams.List",TEAMSFILE:"Teams.File",TEAMSPAGE:"Teams.Page",YAMMER:"Yammer"},jS={LISTS:"Lists"};for(let a of["Word","Excel","PowerPoint","OneNote","Visio"]){let b=`WACHost.${a}`;for(let c of(jR[b.toUpperCase()]=b,["Teams"])){let b=`${c}.UnifiedUiHost.${a}`;jR[b.toUpperCase()]=b}}var jT=c(223),jU=c(195),jV=c(752),jW=c(139);function jX(a){let b=jY(a);return(0,jV.a)(a.pageContext,b)}function jY(a){let{manifest:b,version:c}=(0,jN.a)(),{pageContext:d,clientName:e,ashaProduct:f}=a,g=Number(d.webTemplate)===cD.a.mySite;return{Product:f||(g?"Files":"Lists"),Manifest:b,Version:c,ClientName:e}}var jZ=c(490);function j$(a){if(a.spPageContext){let b={...function(a){let b,{viewParams:c,onGetContext:d}=a,e=c.app,f=c.scenario;if(e){let a=jR[e.toUpperCase()]||!K.Ov.isActivated("B750D979-8389-4419-9DFE-79EAE5360404","05/03/2022","Allow all host-provided app values")&&e||"Unknown";b={...c,app:a}}if(!jQ&&f){let a=jS[f.toUpperCase()]||f||"Unknown";b={...b||c,scenario:a}}let g=b?{...a,viewParams:b}:a,h=(0,jP.a)(g);return d?d({context:h,viewParams:g.viewParams}):h}({viewParams:a.viewParams,clientName:a.clientName}),...a.context||{}};if(a.initDefaultHandler)if((0,a4.jc)()){let c;c=a.isODB?(0,jO.a)({sourceName:"oneup-lightspeed",tokens:jU.a,initOneDS:!0,pageContext:a.spPageContext,context:b}):{workload:"ODC",sourceName:"oneup-lightspeed",tokens:jZ.a,initOneDS:!0,pageContext:a.spPageContext,context:b},(0,jN.b)(c)}else(0,jN.b)((0,jO.a)({sourceName:"oneup-lightspeed",tokens:jU.a,initOneDS:!0,pageContext:a.spPageContext,context:b}));f&&"dispose"in f&&f?.dispose();let d=a.isODB?jU.a:jZ.a,e=(0,a4.jc)()?a.clientName.replace(/\s/g,""):`${a.clientName}-${a.viewParams[bb.b.queryTypeParamKey]}`,{handler:g}=function(a){let b,{ariaEnvironment:d}=(0,jN.a)(),{pageContext:e,initOneDS:f,tokens:g,resultTypeWhenUnload:h=bp.b.ExpectedFailure}=a,i=Number(e.webTemplate)===cD.a.mySite;b=g?"prod"===d?g.prod:g.ppe:"prod"===d?i?jU.a.prod:jU.b.prod:i?jU.a.ppe:jU.b.ppe;let j=a.customerPromiseManager||(0,jW.a)(),k=a=>{let b;if(!K.Ov.isActivated("eefb75d1-f6be-4415-b145-774162263bac","03/20/2024","unload veto")&&"unload"===(b={resultType:h,...h===bp.b.ExpectedFailure||h===bp.b.Failure?{errorCode:"unload"}:{}}).errorCode)switch(a?.data.pillar){case"Create":b.veto="unload (create)";break;case"Boot":b.veto="unload (boot)";break;case"View":b.veto="unload (view)";break;case"Edit":b.veto="unload (edit)";break;case"Delete":b.veto="unload (delete)";break;case"Share":b.veto="unload (share)";break;case"Freshness":b.veto="unload (freshness)";break;case"Social":b.veto="unload (social)";break;case"Upload":b.veto="unload (upload)";break;case"Search":b.veto="unload (search)"}a.end(!K.Ov.isActivated("eefb75d1-f6be-4415-b145-774162263bac","03/20/2024","unload veto")&&b?b:{resultType:h,...h===bp.b.ExpectedFailure||h===bp.b.Failure?{errorCode:"unload"}:{}})};if(j.addOnBeforeUnloadHandler(k),f){let c=K.Ov.isActivated("f63f9172-c9f8-444d-b40c-80ac8c57e939","08/05/2025","fix telemetry missing field")?jX(a):{...jX(a),...a.context},{oneDsCollectorUrl:d}=e,f=new jT.a({sourceName:"odsp-spo",tenantToken:b,context:{context:c,oneDsCollectorUrl:d}});return f.attach(j),{dispose:()=>{j.removeOnBeforeUnloadHandler(k),f.dispose()},handler:f}}{let d=jY(a),f=(0,jV.b)({ariaLoader:()=>c.e(2).then(c.t.bind(c,213,23)),pageContext:e,customerContext:d,tenantToken:b}),g=f.attach(j);return{dispose:()=>{j.removeOnBeforeUnloadHandler(k),g()},handler:f}}}({pageContext:a.spPageContext,clientName:e,initOneDS:!0,customerPromiseManager:(0,bU.a)(),tokens:(0,a4.jc)()?d:jU.a,ashaProduct:a.ashaProduct,context:b});f=g}}(0,bU.a)();let j_=new K.v7({name:"initTelemetryHandlerODB",factory:{dependencies:{},create:()=>({instance:function(a){j$({...a,isODB:!0})}})}}),j0=new K.v7({name:"initTelemetryHandlerODC",factory:{dependencies:{},create:()=>({instance:function(a){j$({...a,isODB:!1})}})}});var j1=c(753),j2=c(754),j3=c(428),j4=c(755);let j5=(0,bA.a)(async()=>(await Promise.all([c.e("ondemand.resx"),c.e(69)]).then(c.bind(c,779))).OnePlayerHost2),j6=new K.v7({name:"fluent2Theme.key.Fluent2Theme",factory:new K.Uo({})});var j7=c(756);let j8=new K.v7({name:"oneDriveFluent2Theme.key.Fluent2Theme",factory:{dependencies:{},create:()=>({instance:(0,j7.a)({semanticColors:{bodyBackground:j7.b.neutralLighterAlt}})})}}),j9=new K.v7({name:"DeferredSetupTasks.key",loader:new K.dE(()=>c.e(13).then(c.bind(c,867)).then(a=>a.resourceKey))});var ka=c(757),kb=c(758),kc=c(76);let kd=(0,K.hl)("FileHandlerResourceKeys",kb.a,{pageContext:an.a}),ke={fileHandlerService:(0,K.hl)("FileHandlerResourceKeys",ka.a,{dataRequestor:kc.a,localFileHandlerProvider:kd}),oneUpStateStore:a2.f,pageContext:an.a,itemUrlHelper:ax.c},kf={oneUpFileHandlerProvider:new K.v7({name:"OneUpFileHandlerProvider",factory:{dependencies:ke,create:a=>({instance:{getFileHandlerDataThruAPI:async function(){if((0,a4.Vb)())return await a.fileHandlerService.getFileHandlerData({includePromotedApp:!0});{let b=new bc.a(a.pageContext.webAbsoluteUrl).authority+"/_api/v2.0",c=window.location.protocol+"//"+window.location.host,d=!b.startsWith(c),e=new bp.a({name:"OneUpFileHandlerProvider.getFileHandlerDataWCookieQos"});return d?(e.end({resultType:bp.b.Failure,extraData:{isCrossDomain:!0}}),await a.fileHandlerService.getFileHandlerData({includePromotedApp:!0})):(e.end({resultType:bp.b.Success,extraData:{isCrossDomain:!1}}),await a.fileHandlerService.getFileHandlerData({includePromotedApp:!0,allowCookies:!0}))}},getFileHandlerDataThruLocalStorage:function(){if("localStorage"in window){let a=this.getFileHandlerCacheKey();if(localStorage.getItem(a))return JSON.parse(localStorage.getItem(a)||"")}},isCacheDataValid:function(a){return Date.now()-a.lastModified<864e5},getFileHandlerEndpoint:function(){return new bc.a(a.pageContext.webAbsoluteUrl).authority+"/_api/v2.0"},getFileHandlerCacheKey:function(){return`fileHandlerCache_${JSON.stringify({endpoint:this.getFileHandlerEndpoint(),driveId:""})}`},setDataToLocalStorage:function(a){if("localStorage"in window)try{let b=this.getFileHandlerCacheKey();localStorage.setItem(b,JSON.stringify(a))}catch(a){}},getFileHandlerData:async function(){let b=a.oneUpStateStore.getFileHandlerOptions();if(!(b&&this.isCacheDataValid(b))){let b=this.getFileHandlerDataThruLocalStorage();if(b&&this.isCacheDataValid(b))a.oneUpStateStore.updateFileHandlerOptions("oneUpFileHandlerProvider",b);else{let b=await this.getFileHandlerDataThruAPI();if(b){let c={data:b,lastModified:Date.now(),signature:{driveId:"",endpoint:this.getFileHandlerEndpoint(),includePromotedApp:!0}};this.setDataToLocalStorage(c),a.oneUpStateStore.updateFileHandlerOptions("oneUpFileHandlerProvider",c)}}}}}})}}),oneUpStateStore:a2.f},kg=new K.v7({name:"GetFileHandlerData",factory:{dependencies:kf,create:a=>({instance:{getFileHandlerDataForOneUp:async function(){let b=a.oneUpStateStore.getFileHandlerOptions();if(!(b&&a.oneUpFileHandlerProvider.isCacheDataValid(b))){let b=a.oneUpFileHandlerProvider.getFileHandlerDataThruLocalStorage();if(b&&a.oneUpFileHandlerProvider.isCacheDataValid(b))a.oneUpStateStore.updateFileHandlerOptions("oneUpFileHandlerProvider",b);else{let b=await a.oneUpFileHandlerProvider.getFileHandlerDataThruAPI();if(b){let c={data:b,lastModified:Date.now(),signature:{driveId:"",endpoint:a.oneUpFileHandlerProvider.getFileHandlerEndpoint(),includePromotedApp:!0}};a.oneUpFileHandlerProvider.setDataToLocalStorage(c),a.oneUpStateStore.updateFileHandlerOptions("oneUpFileHandlerProvider",c)}}}}}})}}),kh={urlDataSource:au.a},ki=new K.v7({name:"isImageEditableInOneUp",factory:{dependencies:kh,create:a=>({instance:()=>a.urlDataSource.getQueryType()!==fC.a.AllMyPhotos})}}),kj=new K.v7({name:"onRenderOnePlayerHost",loader:new K.dE(()=>Promise.all([c.e("ondemand.resx"),c.e(69)]).then(c.bind(c,868)).then(a=>a.onRenderOnePlayerHostKey))});var kk=c(471);let kl=new K.v7({name:"getOneUpOnePlayerResources",loader:new K.dE(()=>Promise.all([c.e("ondemand.resx"),c.e(69)]).then(c.bind(c,869)).then(a=>a.getOneUpOnePlayerResourcesKey))});var km=c(214);let kn={pageContext:an.a,navigation:ap.a},ko=new K.v7({name:"AshaHelper",factory:{dependencies:kn,create:a=>({instance:{getASHAProductName:function(){let b=a.navigation.viewParams;return(0,km.a)(b)===fC.a.AllMyPhotos?"Photos":Number(a.pageContext.webTemplate)===cD.b.mySite?"Files":"SPO DocLib"}}})}});var kp=c(39),kq=c(28),kr=c(112),ks=c(149),kt=c(440);let ku=!K.Ov.isActivated("161ECFEB-0432-4461-9D28-59BBD8F39736"),kv=!K.Ov.isActivated("4FAF036B-29E5-4843-9B7E-DA4E5A096385"),kw=!K.Ov.isActivated("4C047AB0-4D52-4003-8597-7338AAC6B082"),kx={ODB:61546},ky={ODB:-61546};var kz=c(491);let kA=!K.Ov.isActivated("F43F2BEB-1389-4846-9CC0-85E9A4DB7950");var kB=c(137),kC=c(407);let kD=new K.v7({name:"PushNotifierAsync.key",loader:new K.dE(()=>c.e(19).then(c.bind(c,870)).then(a=>a.pushNotifierKey))}),kE={ODB:61767},kF=function(a){let{appPageContext:b}=a,c=(0,kq.a)(kE)||!!(b&&1===(0,kp.c)(90244,b));return kF=()=>c,c},kG=new K.G7;new K.G7,window.DeferredListDataComplete=()=>{kG.resolve()},(window.g_payload&&window.g_listData||window._spOneDrivePageDataCache)&&kG.resolve();let kH=window._spPageContextInfo;kH&&kH.webAbsoluteUrl&&(Number(kH.webTemplate)!==cD.b.mySite||kH.listUrl||(kH.listUrl=`${new dX.a(kH.webAbsoluteUrl).path}/Documents`),K.Ov.isActivated("3AA8AB74-14AD-4975-AE22-56608B8E8025","11/07/2022","Stop freezing Page Context globally to support MondoPrefetch")&&Object.freeze(kH));var kI=c(143),kJ=c(492),kK=c(163);let kL={pageContext:an.a},kM=new K.v7({name:"accountTypeODB",factory:{dependencies:kL,create:a=>({instance:a.pageContext.isAnonymousGuestUser?"BusinessAnonymous":"Business"})}});var kN=c(393);let kO=new K.v7({name:"isPdfPremiumFeaturesEnabledODB",factory:{dependencies:{},create:()=>({instance:!0})}}),kP=new K.v7({name:"getIsPdfPaidFeaturesEnabledODB",factory:{dependencies:{},create:()=>({instance:()=>Promise.resolve(!0)})}});var kQ=c(759),kR=c(760);let kS=new K.v7({name:"getOneUpFabCommands",factory:{dependencies:{oneUpStateStore:a2.f},create:a=>{function b(b){return{id:b,name:b,action:async()=>{a.oneUpStateStore.updateFabCopilotAction("fabClicked",b)}}}return{instance:a=>{let c=b(kQ.l),d=b(kQ.b),e=b(kQ.d),f=b(kR.x),g=b(kQ.e),h=b(kR.E),i=b(kR.D),j=b(kQ.g);switch(a){case aX.a.MSPdf:case aX.a.TextFile:case aX.a.Html:case aX.a.WAC:return[c,d,e];case aX.a.Photo:case aX.a.Image360:return[f,g,h];case aX.a.OnePlayerVideo:return[i,j,e];default:return[]}}}}}});var kT=c(453);let kU={ODB:62713},kV={ODB:61698},kW=!K.Ov.isActivated("4eebbc5c-6021-4270-8ca5-d266dfce8e99"),kX=new K.v7({name:"isBizChatEnabledForODB",factory:{dependencies:{},create:()=>{let a=(0,kq.a)(kU)&&(0,kq.a)(kV);return{instance:()=>kW&&a}}}}),kY={ODB:62716},kZ={ODB:61698},k$=!K.Ov.isActivated("63557ebd-0ea5-4a7f-85d6-ac8896e8e2b9"),k_=new K.v7({name:"isBizChatEnabledForSPList",factory:{dependencies:{},create:()=>{let a=(0,kq.a)(kY)&&(0,kq.a)(kZ);return{instance:()=>k$&&a}}}}),k0=K.Ov.isActivated("522c147a-a792-48d2-9a26-aa1720532889"),k1=K.Ov.isActivated("d0c1f2b3-4e5f-6a7b-8c9d-e0f1a2b3c4d5"),k2=!K.Ov.isActivated("11aaa868-80fc-41cf-b2df-8f66ddcfe134"),k3=K.Ov.isActivated("371d515c-de3d-45d6-b573-c655e6b005b6"),k4=!K.Ov.isActivated("77af712f-b482-4d33-be57-59733f90bb6f");var k5=c(142),k6=c(106);let k7=new K.v7({name:"isCopilotEnabledOnSite",factory:{dependencies:{pageContext:an.a},create:({pageContext:a})=>({instance:function(){let b=!0;return!K.Ov.isActivated("44d3c708-0bb8-444d-8457-4b05f3853ba7","11/20/2023","enables the msit site disallow list logic")&&((0,kq.a)({ODB:61346})?b=!0:(b=0===(0,kp.c)(90214,a))||new bp.a({name:"CopilotDisabledOnSite_OD_90214"}).end({resultType:bp.b.Success})),(0,k6.a)().availability.isSiteAllowed=b,b}})}}),k8={ODB:60732},k9={ODB:61701},la={isUserCopilotLicensed:eB.a,isCopilotEnabledOnSite:k7},lb=new K.v7({name:"areCopilotForODBRequirementsMet",factory:{dependencies:la,create:({isUserCopilotLicensed:a,isCopilotEnabledOnSite:b})=>{let c=b(),d=a()&&c;return{instance:()=>d}}}}),lc=new K.v7({name:"ECSDataSource.key",loader:new K.dE(()=>c.e(15).then(c.bind(c,871)).then(a=>a.ecsDataSourceKey))}),ld={ODB:61598};function le(){let a=K.lU.isFeatureEnabled(ld);return(0,k6.a)().availability.enableCopilotMochaSegmentation=a,a}function lf(a){return`mocha_${a}`}let lg=!1,lh={pageContext:an.a,getECSDataSource:lc.async.lazy},li=new K.v7({name:"isMochaBypassEnabled",factory:{dependencies:lh,create:({pageContext:a,getECSDataSource:b})=>{let c=!1;if(le()){let d,e,f=a.aadUserId||"";d=(0,k6.a)(),e=window.localStorage?.getItem(lf(f))==="true",d.availability.aadUserId=f,d.availability.isUserInMochaSegmentation=e,c=e,le()&&!lg&&f&&(lg=!0,b().then(a=>a.getECSSMochaSegmentation()).then(a=>{let b=lf(f);window.localStorage?.setItem(b,a.toString())}))}return{instance:()=>c}}}}),lj=new K.v7({name:"isCopilotFullEnabledForODB",factory:{dependencies:{areCopilotForODBRequirementsMet:lb,isMochaBypassEnabled:li},create:({areCopilotForODBRequirementsMet:a,isMochaBypassEnabled:b})=>{let c=a(),d=(0,kq.a)(k8),e=(0,k6.a)();return e.availability.isFoRFlightEnabled=d||e.availability.isFoRFlightEnabled,e.availability.isFullFlightEnabled=d,d||(d=b()),e.availability.isCopilotEnabled=c&&d,{instance:()=>c&&d}}}}),lk={ODB:61840},ll=new K.v7({name:"isCopilotLiteEnabledForODB",factory:{dependencies:{areCopilotForODBRequirementsMet:lb,isMochaBypassEnabled:li},create:({areCopilotForODBRequirementsMet:a,isMochaBypassEnabled:b})=>{let c=a(),d=(0,kq.a)(k9),e=(0,k6.a)();e.availability.isFoRFlightEnabled=d||e.availability.isFoRFlightEnabled,e.availability.isLiteFlightEnabled=d;let f=(0,kq.a)(lk);return e.availability.isBypasLiteFlightEnabled=f,!d&&f&&(d=b()),e.availability.isCopilotLiteEnabled=c&&d,{instance:()=>c&&d}}}});var lm=c(238);let ln=new K.v7({name:"isCopilotEnabledForODB",factory:{dependencies:{isCopilotFullEnabled:lj,isCopilotLiteEnabled:ll},create:({isCopilotFullEnabled:a,isCopilotLiteEnabled:b})=>{let c=a(),d=b(),e=(0,k6.a)();return(0,lm.a)(e.availability),(0,lm.b)(c||d,"OneDriveForBusiness",()=>"Licensed"),{instance:()=>c||d}}}}),lo={pageContext:an.a},lp=new K.v7({name:"fastOneUpClientNameODB",factory:{dependencies:lo,create:a=>({instance:Number(a.pageContext.webTemplate)===cD.b.mySite?"ODB Web":"SPList Web"})}}),lq=!K.Ov.isActivated("f65de8fd-cc35-4c71-9753-cdc3b55291e1"),lr=K.Ov.isActivated("d0c1f2b3-4e5f-6a7b-8c9d-e0f1a2b3c4d5"),ls=!K.Ov.isActivated("5A28CF1B-7403-40BC-A9DD-0AFCEA3C6DF5"),lt={oneUpStore:aF.b,oneUpStateStore:a2.f,dividerCommand:fp,infoPaneGroupCommand:i1,closeCommand:fy,downloadCommand:bN,openGroupCommand:gT,editSplitCommand:iI,saveCommand:gU.saveCommandKey,copyToCommand:g0,deleteCommand:g7,openVersionHistoryCommand:hP,viewOriginalImageCommand:hZ,shareGroupCommand:ik.a,pdfOutlineCommand:hL,pdfExtractCommand:hE.a,pdfMergeCommand:hF.a,pdfEncryptCommand:i2.a,pdfCompressCommand:i3.a,openCopilotPaneCommand:ew.a,pageContext:an.a,canOpenCopilot:cX.a},lu=new K.v7({name:"GenerateConsumerOneUpCommandBarWorkingSet",factory:{dependencies:lt,create:a=>{let{oneUpStore:b,oneUpStateStore:c,dividerCommand:d,infoPaneGroupCommand:e,closeCommand:f,downloadCommand:g,openGroupCommand:h,editSplitCommand:i,saveCommand:j,copyToCommand:k,deleteCommand:l,openVersionHistoryCommand:m,viewOriginalImageCommand:n,shareGroupCommand:o,pdfOutlineCommand:p,pdfExtractCommand:q,pdfMergeCommand:r,pdfEncryptCommand:s,pdfCompressCommand:t,openCopilotPaneCommand:u,canOpenCopilot:v}=a;return{instance:{generateWorkingSets:function(){return{main:this.generateMainWorkingSet(),far:this.generateFarWorkingSet(),overflow:this.generateOverflowWorkingSet()}},generateMainWorkingSet:function(){let a=[],f=!!(c.currentAppState.deletedKeys&&c.currentAppState.deletedKeys.get(b.focusItem?.key||""));return c.currentAppState.isPublishToWebNavIdSet||f||(a.push(j),(0,a4.$b)(a4.J)&&a.push(p,d),a.push(g,l,d,q,r,s,t,e)),a},generateOverflowWorkingSet:function(){let a=[],d=!!(c.currentAppState.deletedKeys&&c.currentAppState.deletedKeys.get(b.focusItem?.key||""));return c.currentAppState.isPublishToWebNavIdSet||d||a.push(k,n,m),a},generateFarWorkingSet:function(){let d=[],e=!!(c.currentAppState.deletedKeys&&c.currentAppState.deletedKeys.get(b.focusItem?.key||""));return c.currentAppState.isPublishToWebNavIdSet||(e?d.push(f):((0,a4.db)()?b.focusItem&&v.isCopilotSupportedForItem(b.focusItem)&&!(0,e5.c)(a.pageContext)&&d.push(u):(0,e5.c)(a.pageContext)||d.push(u),d.push(h(),i,...ls?[o]:[],f))),d}}}}}}),lv=new K.v7({name:"getConsumerTextContentFallbackAsync",loader:new K.dE(()=>c.e(25).then(c.bind(c,872)).then(a=>a.resourceKey))}),lw={pageContext:an.a},lx=new K.v7({name:"accountTypeODC",factory:{dependencies:lw,create:a=>({instance:a.pageContext.isAnonymousGuestUser?"ConsumerAnonymous":"ConsumerOnSPO"})}}),ly=new K.v7({name:"isPdfPremiumFeaturesEnabledODC",factory:{dependencies:{},create:()=>({instance:!1})}}),lz=new K.v7("storageInfoProvider");var lA=c(762),lB=c(761);let lC=new K.v7({name:"getIsPdfPaidFeaturesEnabledODC",factory:{dependencies:{getStorageInfoDataProvider:lz.async},create:({getStorageInfoDataProvider:a})=>({instance:async()=>{let b=!0,c=await a();if(c.getStorageInfoData){let a=await c.getStorageInfoData({cachingStrategy:lA.a.bypassCache,cacheTimeoutTime:lB.c});if(a){let{entitlements:c}=a;b=!c?.some(a=>"PaidPlan"===a.entitlementType)}}return(0,a4.$b)(a4.Q)&&!b}})}}),lD=new K.v7({name:"getOneUpFabCommandsODC",factory:{dependencies:{oneUpStateStore:a2.f},create:a=>{function b(b){return{id:b,name:b,action:async()=>{a.oneUpStateStore.updateFabCopilotAction("fabClicked",b)}}}return{instance:a=>[b(kQ.l),b(kQ.b),b(kQ.j)]}}}}),lE=K.Ov.isActivated("B0AE7992-3B5D-40B0-A5BD-D316B9AD56BA"),lF=!K.Ov.isActivated("A6C39EC2-C951-45F4-AF81-86FAABEC4E4E"),lG=!K.Ov.isActivated("A6C39EC2-C951-45F4-AF81-86FAABEC4E4E"),lH=K.Ov.isActivated("d0c1f2b3-4e5f-6a7b-8c9d-e0f1a2b3c4d5"),lI=K.Ov.isActivated("371d515c-de3d-45d6-b573-c655e6b005b6"),lJ=!K.Ov.isActivated("01e1e3da-b6fd-410e-9e9d-25ff6461668a");var lK=c(763);let lL=new K.v7({name:"copilotAppName",factory:{dependencies:{},create:()=>({instance:"OneDriveConsumer"})}});var lM=c(240),lN=c(212),lO=c(158);let lP={isUserCopilotLicensed:eB.a,navigation:ap.a},lQ={ODB:62221},lR=!K.Ov.isActivated("3C442122-33B1-4FBE-A17D-426F4F3FC733"),lS=new K.v7({name:"isCopilotLiteEnabledForODC",factory:{dependencies:lP,create:a=>{var b;let c=(0,kq.a)(lQ),d=(b=a.navigation.viewParams,e||(e=b)),f=(0,k6.a)();return f.availability.isFoRFlightEnabled=c||f.availability.isFoRFlightEnabled,f.availability.isLiteFlightEnabled=c,{instance:()=>{let b;return(a.isUserCopilotLicensed()||lR&&(b=d[lO.a],(0,lN.j)(b)))&&c}}}}}),lT=new K.v7({name:"isCopilotEnabledForODC",factory:{dependencies:{isCopilotLiteEnabled:lS},create:({isCopilotLiteEnabled:a})=>({instance:()=>a()})}});var lU=c(472);let lV=new K.v7({name:"isUserCopilotLicensed",factory:{dependencies:{pageContext:an.a.optional},create:({pageContext:a})=>({instance:()=>{let b=!1,c=(0,k6.a)();return window.sessionStorage.getItem("_isRunningTABTest")?(c.availability.isLicenseCheckBypassed=!0,b=!0):b=(0,lU.a)(),c.availability.isLicensed=b,c.availability.siteSubscriptionId=a?.siteSubscriptionId,b}})}});var lW=c(441);let lX={pageContext:an.a},lY=new K.v7({name:"consumerChatODSPPageUrl",factory:{dependencies:lX,create:a=>({instance:`https://onedrive.live.com${a.pageContext.webServerRelativeUrl}/_layouts/15/chat.aspx`})}}),lZ=!K.Ov.isActivated("0DD08BDF-F41D-4F67-B6B2-034637158393"),l$=new K.v7({name:"copilotFeedbackProps.async",loader:new K.dE(()=>Promise.all([c.e("ondemand.resx"),c.e(8)]).then(c.bind(c,783)).then(a=>a.copilotFeedbackPropsKey))}),l_=new K.v7({name:"fastOneUpClientNameODC",factory:{dependencies:{},create:()=>({instance:"ODC Web"})}});var l0=c(764),l1=c(473);let l2=!K.Ov.isActivated("648e2f9f-7a2d-4791-9dc2-19d6267dc003"),l3=K.Ov.isActivated("d0c1f2b3-4e5f-6a7b-8c9d-e0f1a2b3c4d5"),l4=K.Ov.isActivated("371d515c-de3d-45d6-b573-c655e6b005b6");K.Ov.isActivated("6E2C0B42-5F94-4F6E-90E6-422D3EE2D0C9");let l5=new K.v7({name:"storageInfoDataManagerAsyncKey",loader:new K.dE(()=>Promise.all([c.e("plt.preact"),c.e(77)]).then(c.bind(c,874)).then(a=>a.StorageInfoDataManagerKey))});var l6=c(454),l7=c(145);(0,P.a)(),performance.mark("EUPL.AppStart");let l8=new K.ny({owner:"ODBOneUpLightSpeed",useFactoriesOnKeys:!0}),l9=window._spPageContextInfo,ma=l8.consume(b_),mb=ma.getOneUpRumoneLogger({});l8.expose(an.a,l9);let{pack:mc,prefetchConfig:md}=!kH||(0,kI.a)(kH)?{pack:(h=new K.NX,l4||h.addAsync(lz,new K.dE(async()=>{let{StorageInfoDataProviderKey:a}=await c.e(7).then(c.bind(c,782));return a})),h.addFromPack(((i=new K.NX).add(fB.a,!1),lE||i.addAlias(i6,lu),lF&&i.addAlias(bP.d,lv),lG&&i.add(a9.b,!1),lH||(i.addAlias(bP.g,j0),i.addAlias(bP.a,lx)),lI?i.addAlias(bP.l,ly):i.addAlias(cY,lC),lJ&&i.addAlias(bP.c,lD),i)),h.addFromPack(((j=new K.NX).addAlias(k5.a,lT),j.addAlias(lM.a,lS),j.addAlias(eB.a,lV),j.addAlias(lW.a,lY),lZ&&j.addAsync(l$,new K.dE(async()=>{let{odcCopilotFeedbackPropsKey:a}=await Promise.all([c.e("ondemand.resx"),c.e(42)]).then(c.bind(c,873));return a})),j)),l2&&h.addAlias(lK.a,lL),l3||(h.addAlias(bP.g,j0),h.addAlias(bP.b,l_)),l0.a&&h.add(l1.a,!0),h),prefetchConfig:{disableUpdatePathForShortUrl:!kF({appPageContext:kH}),prettyPathMap:kJ.a}}:{pack:((k=new K.NX).addFromPack((l=new K.NX,k0||l.add(kK.a,!0),k1||(l.addAlias(bP.g,j_),l.addAlias(bP.a,kM)),k2&&l.add(kN.a,!0),k3?l.addAlias(bP.l,kO):l.addAlias(cY,kP),k4&&l.addAlias(bP.c,kS),m=Number(kH?.webTemplate)===cD.b.mySite||Number(kH?.webTemplate)===cD.b.mySiteHost,k$&&m?l.addAlias(kT.a,kX):kW&&!m&&l.addAlias(kT.a,k_),l)),lq&&k.addAlias(k5.a,ln),lr||(k.addAlias(bP.g,j_),k.addAlias(bP.b,lp)),k),prefetchConfig:{disableUpdatePathForShortUrl:!1,prettyPathMap:kt.a}},{disableUpdatePathForShortUrl:me,prettyPathMap:mf}=md,mg=function(a){let{spPageContext:b,disableUpdatePathForShortUrl:c}=a;if(!g){var d;let f=window.g_oneUpPathAndQueryString;if(f){let a=new URL(f);if(K.Ov.isActivated("0ba2b5b5-4709-4098-8d6e-08b7bb9ceafd"))a.searchParams&&a.searchParams.get("ga")&&window.history.replaceState({reason:"OneUpServerSideTransfer"},"OneUpServerSideTransfer",f);else if(a.searchParams&&a.searchParams.get("ga")){let b=()=>{try{window.history.replaceState({reason:"OneUpServerSideTransfer"},"OneUpServerSideTransfer",f)}catch(a){}};b(),window.location.href.toString()!==a.toString()&&b()}}let h=(b?.serverRequestPath?.toLowerCase().includes("onedrive.aspx")||kA&&b?.serverRequestPath?.toLowerCase().includes("odc.aspx"))&&function(a){let{disableUpdatePathForShortUrl:b,platformDetection:c,spPageContext:d}=a;if(!d||!d.isMySiteOwner||(0,kr.a)(d)||c.isPWA)return!1;if(!b&&(0,kq.a)(kx)){if(location.pathname.toLowerCase().includes("onedrive.aspx"))return history.replaceState(null,"",`/${location.search}${location.hash}`),!0;if(!kv)return!0;if(kw){let b=ku?a.prettyPathMap:kt.a;if(b.isPathEligibleForPrettyPaths(location.pathname))return!0;let c=b.getPrettySegmentFromOcdiPathWithRoutingKey({pathname:location.pathname,routingKey:d.routingKey});if(void 0!==c)return history.replaceState(null,"",`/${c}${location.search}${location.hash}`),!0}else{let a=location.pathname.split("/");if(2===a.length&&""===a[0]&&void 0!==ks.a[a[1]])return!0;if(d.routingKey&&(2===a.length||3===a.length)&&""===a[0]&&a[1]===d.routingKey&&(void 0===a[2]||void 0!==ks.a[a[2]]))return history.replaceState(null,"",`/${a[2]||""}${location.search}${location.hash}`),!0}return!1}return(0,kq.a)(ky)&&"/"===location.pathname&&history.replaceState(null,"",`${d.webServerRelativeUrl}/_layouts/15/onedrive.aspx${location.search}${location.hash}`),!1}({disableUpdatePathForShortUrl:c,platformDetection:new K.Ey,spPageContext:b,prettyPathMap:a.prettyPathMap})?ku?a.prettyPathMap:kt.a:void 0;d=(g=new kz.a({prettyPathMap:h})).viewParams,e||(e=d),g.updateViewParams({},{ignoreHistory:!0})}return g}({spPageContext:l9,disableUpdatePathForShortUrl:me,prettyPathMap:mf});l8.expose(ap.a,mg),l8.exposeFromPack(mc);let mh=l8.consume(bP.b),mi=l8.consume(bP.a),mj=l8.consume(ko).getASHAProductName();l8.consume(bP.g)({clientName:`OneUpLightSpeed-fastOneUp-${mh}`,viewParams:mg.viewParams,spPageContext:l9,initDefaultHandler:!0,ashaProduct:mj,context:{AccountType:mi}});let mk=l8.consume(jJ);mk.newBootCustomerPromise({clientName:mh,view:(n=mg.viewParams[bb.b.queryTypeParamKey])?`view=${n}`:"",hidePeoplePreviewingFiles:l9.hidePeoplePreviewingFiles}),mb.initRumoneLogger(),(0,a4.rc)()&&(0,kp.b)(90198,l9);let ml=a=>{let b;l8.consumeAsync(j9).then(a=>{a.setupDeferredComponents(l8)});let c=mg.viewParams.ga,d=!!window.g_oneUpPathAndQueryString,e=(0,K.pW)(window.location.search.substring(1)),f={viewerName:a.viewer,isShareLinkRedeeming:void 0!==c,extension:a.extension||"unknown",fileSizeRange:a.fileSizeRange,isCrossList:a.isCrossList,isFluentV9:(0,kC.a)(),isFromSyncClientAutoOpen:!!e[bb.b.action],...a.extraData};b=(0,a4.Lb)()?(0,cs.a)(f):f;let g={oneupScenario:1,endTime:Date.now(),pageTransType:bR.a.fullPageLoad,userClickTime:NaN,embedStartLoadingTime:void 0,clientId:mh,viewerStartTime:bY(a.viewer),breakDownData:a.euplBreakDownData,isFastOneUp:!0,isLightSpeed:!0,isServerSideTransfer:d,...b,diagnosticInfo:b,...a.extraPerfData};aq.f("EUPL.glass"),mb.logRumonePerformance(g,a=>{l8.consume(a2.f).updatePerfButtonState("FastOneUp-OnSlideLoaded",a)}),l8.consume(aU.b).reportLoadingCXPSuccess({extraData:{...b,diagnosticInfo:b}})},mm=a=>{let b=ma.getOneUpRumoneLogger({loggerName:"fullPage"}),c=!!window.g_oneUpPathAndQueryString;b.initRumoneLogger(),b.logRumonePerformance({oneupScenario:1,endTime:Date.now(),pageTransType:bR.a.fullPageLoad,userClickTime:NaN,embedStartLoadingTime:void 0,clientId:mh,viewerStartTime:bY(a.viewer),breakDownData:a.euplBreakDownData,isFastOneUp:!0,isLightSpeed:!0,isServerSideTransfer:c,viewerName:a.viewer,extension:a.extension||"unknown",fileSizeRange:a.fileSizeRange,isCrossList:a.isCrossList,isFullPageLogging:!0,isFluentV9:(0,kC.a)(),...a.extraPerfData})};function mn(){try{(0,am.b)(l8),mp(l8),(!iQ||!l9.hidePeoplePreviewingFiles)&&(0,a4.$b)(a4.j)&&l8.consumeAsync(kD)}catch(a){l8.consume(a2.f).updateErrorState("fastOneUpAdapterException",{errorType:aV.d.rldsApiError,error:a,item:void 0})}aq.f("EUPL.BeforeWaitForDomReady"),(0,as.a)(()=>{aq.f("EUPL.AfterWaitForDomReady");try{let a=document.getElementById("od-oneup");a&&document.body.removeChild(a),(a=document.createElement("div")).setAttribute("id","od-oneup"),document.body.appendChild(a);let b=N.createElement(ar.a,{resources:l8},N.createElement(jM,null));al.a(b,document.getElementById("od-oneup"))}catch(a){mk.reportBootCXPFailure({rawError:{errorType:aV.d.processOneUpItemError,error:new K.lM({code:"fastOneUp-initizationException",innerError:a})}})}}).catch(a=>{console.log("dom error: ",a)})}function mo(a){try{if(l9){try{let b=window&&"true"===window.localStorage.getItem("isODBDarkMode");a.expose(bP.i,b)}catch(a){}a.exposeFactory(at.a,new K.zO(aM)),a.exposeFactory(au.a,new K.zO(ce.a)),a.exposeFactory(aP.a,new K.zO(aQ)),a.exposeFactory(aN.a,new K.zO(aO)),a.expose(bP.j,!0),a.expose(bP.o,ml),a.expose(bP.n,mm);let b=function(){if(f&&"dispose"in f)return f}();if(b?.updateContext({product:mj}),a.exposeFactory(gA.a,new K.zO(bP.b)),K.Ov.isActivated("B34E3F01-04D5-4161-9629-4B783CA48830","01/23/2024","Customize image editing in one up")||a.exposeFactory(iC,new K.zO(ki)),bE.a){let b;b=async()=>{let[{resourceKey:b},{downloadDataSourceKey:d},{legacyGraphDataSourceKey:e},{resourceKey:f},{isOnePlayerEnabledResourceKey:g}]=await Promise.all([Promise.all([c.e("ondemand.resx"),c.e(69)]).then(c.bind(c,780)),Promise.all([c.e("ondemand.resx"),c.e(69)]).then(c.bind(c,480)),Promise.all([c.e("ondemand.resx"),c.e(69)]).then(c.bind(c,244)),Promise.resolve().then(c.bind(c,46)),Promise.all([c.e("ondemand.resx"),c.e(69)]).then(c.bind(c,781))]);a.exposeFactory(j3.f,new K.zO(b)),a.exposeFactory(j3.a,new K.zO(d)),a.exposeFactory(j3.b,new K.zO(e)),a.exposeFactory(j3.e,new K.zO(ce.a)),a.exposeFactory(j3.c,new K.zO(f)),a.exposeFactory(j4.a,new K.zO(g))},a.expose(j2.a,b),a.expose(j1.b,j5)}else{let b;a.exposeFromPack(((b=new K.NX).addAlias(kk.a,kl),b.addAlias(j1.a,kj),b))}l9.webTemplate===cD.b.mySite.toString()&&a.exposeFactory(j6,new K.zO(j8)),K.Ov.isActivated("9b559192-7d10-466a-a1be-da381f30568a","09/04/2024","aterentiev - enable OCV feedback for copilot viewer")||a.exposeFactory(kB.a,new K.zO(b3.resourceKey)),K.Ov.isActivated("534bb451-0390-4c4a-927c-ec97a617fd7d","10/25/2024","bentsai - enable host theme resource key")||a.expose(bP.f,(0,H.kF)()),K.Ov.isActivated("74cf6df0-5727-4b29-a71c-d85fea84ae5a","04/02/2025","bentsai - enable alwaysUseTokenFetcherForVroomKey resource key")||a.expose(ao.a,!0)}else mk.reportBootCXPFailure({rawError:{errorType:aV.d.processOneUpItemError,error:new K.lM({code:"fastOneUp-NoPageContext"})}});if(a4.hb()&&(0,kI.a)(l9))return l8.exposeAsync(l7.a,new K.dE(async()=>{let{consumerResourceKey:a}=await Promise.all([c.e("ondemand.resx"),c.e(6)]).then(c.bind(c,785));return a})),a.exposeFactory(l6.a,new K.zO(kc.a)),a.consumeAsync(l5).then(a=>a.initialize())}catch(a){mk.reportBootCXPFailure({rawError:{errorType:aV.d.processOneUpItemError,error:new K.lM({code:"fastOneUp-initResourcesException",innerError:a})}})}return Promise.resolve()}async function mp(a){let b=a.consume(kg);await b.getFileHandlerDataForOneUp()}a4.hb()?mo(l8).then(()=>{mn()}):(mo(l8),mn())}
,,(a,b,c)=>{"use strict";var d,e,f,g,h={passive:!0,capture:!0},i=new Date,j=function(a,b){d||(d=b,e=a,f=new Date,m(removeEventListener),k())},k=function(){if(e>=0&&e<f-i){var a={entryType:"first-input",name:d.type,target:d.target,cancelable:d.cancelable,startTime:d.timeStamp,processingStart:d.timeStamp+e};g.forEach(function(b){b(a)}),g=[]}},l=function(a){if(a.cancelable){var b,c,d,e=(a.timeStamp>1e12?new Date:performance.now())-a.timeStamp;"pointerdown"==a.type?(b=function(){j(e,a),d()},c=function(){d()},d=function(){removeEventListener("pointerup",b,h),removeEventListener("pointercancel",c,h)},addEventListener("pointerup",b,h),addEventListener("pointercancel",c,h)):j(e,a)}},m=function(a){["mousedown","keydown","touchstart","pointerdown"].forEach(function(b){return a(b,l,h)})}}
,,,(a,b,c)=>{"use strict";c.r(b),c.d(b,{default:()=>n,downloadDataSourceKey:()=>o});var d=c(557),e=c("odsp.util_126"),f=c(884);function g(a){if(void 0!==a)return a}var h=c(15),i=c(6),j=c(46),k=c(2),l=c(302),m=c(4);class n{getDownloadUrl(a,b={}){return this._common.getDownloadUrl(g(a),g(void 0),b)}getItemClassicDownloadLink(a){return this._itemUrlHelper.getItemUrlParts(a.key).fullItemUrl+"?avcmd=1"}downloadItems(a){let b=a.items[0],c=this._itemUrlHelper.getItemUrlParts(b.key);return this.getDownloadRequestParameters(b,0).then(a=>{let b=this._getDownloadIframe();if(window.document.body.appendChild(b),!(0,m.wc)()&&c.isCrossDomain&&a.token&&b&&b.contentDocument)(0,l.a)({url:a.url,postdata:{access_token:a.token},document:b.contentDocument}),setTimeout(function(){window.document.body.removeChild(b)},2e4);else{window.document.body.removeChild(b);let c=this._initIframe(a.url);setTimeout(function(){window.document.body.removeChild(c)},2e4)}})}getItemContents(a){return this.getDownloadRequestParameters(a,2).then(a=>{let b=a.headers,c=b&&b.Authorization,d=c&&c.slice(7);return this._dataRequestor.getData({url:a.url,method:"GET",noRedirect:!0,qosName:"ItemDataSource.getItemContents",responseType:"blob",needsRequestDigest:!1,authToken:d})})}getDownloadRequestParameters(a,b,c){let d=this._itemUrlHelper.getItemUrlParts(a.key),e=new i.a(d.normalizedItemUrl);return d.isCrossDomain?this._identityDataSource.getSharePointToken({webAbsoluteUrl:d.fullWebUrl||e.authority,apiQosName:"DownloadDataSource"}).then(c=>{let f=c.accessToken;return this.getDownloadUrl(a,{downloadType:b,authToken:f,webAbsoluteUrl:d.fullWebUrl||e.authority}).then(a=>({url:a,headers:{Authorization:`bearer ${f}`},token:f}))}):this.getDownloadUrl(a,{downloadType:b,webAbsoluteUrl:d.fullWebUrl||e.authority}).then(a=>({url:a,withCredentials:!0}))}_initIframe(a){let b=document.createElement("iframe");return b.src=a,b.style.display="none",window.document.body.appendChild(b),b}_getDownloadIframe(a=Math.random()){let b=document.createElement("iframe");return b.id="od-download-iframe"+a,b.name=b.id,b.hidden=!0,b}constructor(a,b){this._common=new d.a(b.pageContext),this._dataRequestor=new b.dataRequestorType({}),this._itemUrlHelper=b.itemUrlHelper,this._identityDataSource=b.identityDataSource}}let o=(0,e.hl)("DownloadDataSource",n,{dataRequestorType:f.b,pageContext:k.a,itemUrlHelper:h.c,identityDataSource:j.resourceKey})}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>a8});var d=c("tslib_533"),e=c(183),f=c(309),g=c(888),h=c("react-lib"),i=c.n(h),j=c(408),k=c(430),l=c(207),m=c(447),n=c("fui.util_178");(0,n.ZW)([{rawString:".root_58dd2d21{width:100%;height:100%;position:relative;overflow:hidden}"}]);var o=c(595),p=c(410),q=c(37),r=c(73),s=c(343),t=c(66),u=c(85),v=c(64),w=c(417),x=c(33),y=c(131),z=c(69),A=c(53),B=c(339),C=c(203),D=c(86),E=c(571),F=c("fui.core_517"),G={display:"flex",alignItems:"center"},H=(0,n.gV)(function(a,b){var c=a.palette,e={root:{height:44,flexShrink:0,padding:"0 14px",backgroundColor:a.semanticColors.menuBackground,border:"".concat(1,"px solid ").concat(c.neutralLight),boxSizing:"content-box",overflow:"hidden"},center:(0,d.q5)((0,d.q5)({},G),{justifyContent:"center",padding:"0 15px","@media (max-width: 460px)":{display:"none"}})};return(0,F.Akq)(e,b)}),I=(0,d.q5)((0,d.q5)({},G),{flexBasis:"33.3%"}),J=(0,d.q5)((0,d.q5)({},G),{justifyContent:"flex-end",flexBasis:"33.3%"}),K=function(a){var b=a.leftItems,c=a.centerItems,d=a.rightItems,e=a.styles,f=H((0,D.a)(),e);return h.createElement(E.a,{horizontal:!0,styles:{root:f.root}},h.createElement(E.a.Item,{style:I,grow:!0},void 0===b?[]:b),h.createElement(E.a.Item,{styles:{root:f.center},grow:!0},void 0===c?[]:c),h.createElement(E.a.Item,{style:J,grow:!0},void 0===d?[]:d))},L=c(315),M=i().memo(function(a){var b=a.disabled,c=a.text,d=a.role,e=a.onClick,f=(0,j.c)(),g=(0,D.a)(),h=g.semanticColors,k=i().useCallback(function(){e(),u.a.logEngagement({name:"SaveChanges",actionGesture:"Click"})},[e]);return i().createElement(L.a,{role:d,text:c||f.get("save"),title:f.get("saveTooltip"),disabled:b,theme:g,onClick:k,styles:{label:{whiteSpace:"nowrap",textOverflow:"ellipsis"},rootDisabled:{color:h.buttonTextDisabled,borderColor:h.buttonBackgroundHovered,borderWidth:"1px",borderStyle:"solid"}}})}),N=c(173),O=i().memo(function(a){var b=a.disabled,c=a.onClick,d=(0,j.c)(),e=(0,D.a)(),f=i().useCallback(function(){c(),u.a.logEngagement({name:"DiscardChanges",actionGesture:"Click"})},[c]);return i().createElement(N.a,{text:d.get("discard"),title:d.get("discardTooltip"),ariaLabel:d.get("discardAria"),disabled:b,theme:e,onClick:f})}),P=c(584),Q=c(334),R=c(335),S={isBlocking:!0,isModeless:!0,styles:{main:{"@media (min-width: 640px)":{width:480,maxWidth:480},minWidth:320}},layerProps:{styles:{root:{zIndex:15e5}}}},T=function(a){var b=a.hidden,c=a.contentTitle,d=a.contentSubText,e=a.children,f=a.onDismiss,g=(0,D.a)();return i().createElement(P.a,{hidden:b,theme:g,dialogContentProps:{type:Q.a.normal,title:c,subText:d},modalProps:S,onDismiss:f},i().createElement(R.a,null,e))},U=function(a){var b=a.hidden,c=a.onSave,d=a.onDiscard,e=a.onDismiss,f=(0,j.c)();return i().createElement(T,{hidden:b,contentTitle:f.get("unsavedChangesTitle"),contentSubText:f.get("unsavedChangesMessage"),onDismiss:e},i().createElement(M,{onClick:c}),i().createElement(O,{onClick:d}))},V=function(a){var b=a.hidden,c=a.onSave,d=a.onDiscard,e=a.onDismiss,f=(0,j.c)();return i().createElement(T,{hidden:b,contentTitle:f.get("versionChangeTitle"),contentSubText:f.get("versionChangeMessage"),onDismiss:e},i().createElement(M,{onClick:c}),i().createElement(O,{onClick:d}))};(0,n.ZW)([{rawString:"html[dir=ltr] .saveBtn_00e42b0f{padding-left:16px}html[dir=rtl] .saveBtn_00e42b0f{padding-right:16px}.fileHeader_00e42b0f{display:-webkit-box;display:-ms-flexbox;display:flex;-ms-flex-wrap:nowrap;flex-wrap:nowrap;text-align:center;padding:10px}.fileHeader_00e42b0f>*{padding:0 4px}.fileHeader_00e42b0f .fileTitle_00e42b0f{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;max-width:200px;line-height:1}.fileHeader_00e42b0f .fileTitle_00e42b0f>div{white-space:nowrap}.fileHeader_00e42b0f .fileTitle_00e42b0f .fileName_00e42b0f{overflow:hidden;text-overflow:ellipsis}html[dir=ltr] .fileHeader_00e42b0f .fileTitle_00e42b0f .fileName_00e42b0f{margin-right:4px}html[dir=rtl] .fileHeader_00e42b0f .fileTitle_00e42b0f .fileName_00e42b0f{margin-left:4px}.closeButton_00e42b0f{color:inherit}"}]);var W=function(a){void 0===a&&(a="");var b=a.match(/^([^\\]*)\.(\w+)$/);return b?b[2]:".pdf"},X=h.lazy(function(){return c.e(29).then(c.bind(c,768)).then(function(a){return{default:a.InkingToolbarNext}})}),Y=h.lazy(function(){return c.e(40).then(c.bind(c,806)).then(function(a){return{default:a.UndoRedoButtons}})}),Z=h.forwardRef(function(a,b){var c=a.hasEdits,e=a.filename,f=a.allowUnloadPageWithEdits,g=a.inkingToolbarProps,i=a.onSave,k=a.onClose,l=a.onDiscard,m=a.isFileVersionChanged,n=(0,d.pM)(h.useState(!1),2),o=n[0],p=n[1],s=(0,d.pM)(h.useState(!1),2),v=s[0],D=s[1],E=(0,j.c)(),F=(0,w.b)(),G=F.pdfViewer,H=F.annotMode,I=(0,C.a)(function(){c?p(!0):k()});h.useEffect(function(){var a=function(a){c&&!f&&(a.preventDefault(),a.returnValue=!1)};return window.addEventListener("beforeunload",a),function(){return window.removeEventListener("beforeunload",a)}},[f,c]),h.useImperativeHandle(b,function(){return{close:I}},[I]),h.useEffect(function(){var a=function(a){return(0,d.yv)(void 0,void 0,void 0,function(){return(0,d.SO)(this,function(b){return(a.ctrlKey||a.metaKey)&&"s"===a.key.toLowerCase()&&(u.a.logEngagement({name:"ExitEditMode",actionGesture:"Shortcut",extraData:{hasEdits:c}}),a.preventDefault(),I()),[2]})})};return window.addEventListener("keydown",a),function(){window.removeEventListener("keydown",a)}},[I,c]);var J=(0,C.a)(function(){u.a.logEngagement({name:"ExitEditMode",actionGesture:"Click",extraData:{hasEdits:c}}),I()}),L=(0,C.a)(function(){null==G||G.triggerInkDrying(),window.setTimeout(function(){J()},200)}),N=h.useCallback(function(){return(0,d.yv)(void 0,void 0,void 0,function(){var a,b,c,e;return(0,d.SO)(this,function(d){switch(d.label){case 0:p(!1),d.label=1;case 1:return d.trys.push([1,3,,4]),[4,null==m?void 0:m()];case 2:return a=d.sent(),[3,4];case 3:return c=(null==(b=d.sent())?void 0:b.message)||JSON.stringify(b),e=new t.c(void 0,"Fail to check file version when saving, reason: ".concat(c)),u.a.logError(e.toCaughtError()),[3,4];case 4:return a?D(!0):i(),[2]}})})},[m,i]),O=(0,C.a)(function(){var a;(null==(a=q.a.features)?void 0:a.enableEnhancedInk)&&(H===r.a.Ink||H===r.a.Highlight||H===r.a.PointErase)?L():J()}),P=h.useCallback(function(){p(!1),l(),k()},[k,l]),Q=h.useCallback(function(){p(!1)},[]),R=h.useCallback(function(){D(!1)},[]),S=h.useMemo(function(){var a;return(0,d.lt)([h.createElement("div",{key:"Save",className:"saveBtn_00e42b0f"},h.createElement(M,{role:"menuitem",disabled:!c,text:E.get("saveChanges"),onClick:N}))],(0,d.pM)((null==(a=q.a.features)?void 0:a.enableUndoRedo)?[h.createElement(h.Suspense,{fallback:h.createElement("div",null),key:"UndoRedoButtons"},h.createElement(Y,null))]:[]),!1)},[c,E,N]),T=E.get("fileHeaderSuffixInEditMode"),Z=h.useMemo(function(){return g?[h.createElement(h.Suspense,{fallback:h.createElement("div",null),key:"inkingToolbar"},h.createElement(X,(0,d.q5)({key:(null==g?void 0:g.defaultToolType)||"",actionScenario:"PdfAnnotationNext",isHorizontal:!0},g)))]:[h.createElement("div",{key:"FileHeader",className:"fileHeader_00e42b0f",tabIndex:0,"aria-label":"".concat(e,", ").concat(T),"data-is-focusable":!0},h.createElement(x.a,(0,d.q5)({},(0,B.a)({extension:W(e),size:16}))),h.createElement("div",{className:"fileTitle_00e42b0f"},h.createElement("div",{className:"fileName_00e42b0f"},e),h.createElement("div",null,"- ".concat(T))))]},[T,e,g]),$=h.useMemo(function(){return[h.createElement(y.a,{key:"Cancel",iconProps:{iconName:"Cancel"},title:E.get("exitEditTooltip"),role:"menuitem",onClick:O,className:"closeButton_00e42b0f"})]},[E,O]),_=h.useMemo(function(){return g?{center:{"@media (max-width: 460px)":{display:"flex"}}}:void 0},[g]);return h.createElement("div",{role:"menubar"},h.createElement(z.a,{shouldResetActiveElementWhenTabFromZone:!0,handleTabKey:A.b.none,direction:A.a.horizontal},h.createElement(K,{leftItems:S,centerItems:Z,rightItems:$,styles:_})),h.createElement(U,{hidden:!o,onSave:N,onDiscard:P,onDismiss:Q}),h.createElement(V,{hidden:!v,onSave:i,onDiscard:P,onDismiss:R}))});Z.displayName="EditCommandBar";var $=c(327),_=i().memo(function(a){var b=a.disabled,c=a.onClick,d=(0,j.c)(),e=(0,D.a)(),f=i().useCallback(function(){c(),u.a.logEngagement({name:"DoExtract",actionGesture:"Click"})},[c]);return i().createElement(L.a,{text:d.get("doExtract"),title:d.get("doExtractTooltip"),ariaLabel:d.get("doExtractAria"),disabled:b,theme:e,onClick:f})});(0,n.ZW)([{rawString:"html[dir=ltr] .saveBtn_edd24649{padding-left:16px}html[dir=rtl] .saveBtn_edd24649{padding-right:16px}.title_edd24649{display:inline-block;max-width:200px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.rightDivider_edd24649{height:16px;margin:0 20px}.selectionCounter_edd24649{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.closeButton_edd24649{color:inherit}"}]);let aa="closeButton_edd24649";var ab=h.forwardRef(function(a,b){var c=a.onSave,e=a.onClose,f=a.viewerRef,g=(0,j.c)(),i=(0,d.pM)(h.useState([]),2),l=i[0],m=i[1],n=(0,k.c)(),o=h.useMemo(function(){return l.filter(function(a){return a}).length},[l]),p=o>0;h.useEffect(function(){return n.setMode("Select"),n.subscribe(function(a){m(a)}),function(){var a;null==(a=n.unsubscribe)||a.call(n)}},[n]),h.useEffect(function(){var a=function(a){p&&(a.preventDefault(),a.returnValue=!1)};return window.addEventListener("beforeunload",a),function(){return window.removeEventListener("beforeunload",a)}},[p]);var q=h.useCallback(function(){var a;null==(a=n.resetPageSelection)||a.call(n),u.a.logEngagement({name:"DiscardExtractSelections",actionGesture:"Click"})},[n]),r=h.useCallback(function(){var a;null==(a=n.resetPageSelection)||a.call(n),n.toggle(!1),e(),u.a.logEngagement({name:"CancelExtract",actionGesture:"Click"})},[e,n]),s=h.useCallback(function(){return(0,d.yv)(void 0,void 0,void 0,function(){var a,b,e,g,h;return(0,d.SO)(this,function(d){return(a=null==(h=null==(g=f.current)?void 0:g.getViewer())?void 0:h.extract,n&&a&&0!==(b=(null==l?void 0:l.map(function(a,b){return a?b:null}).filter(function(a){return null!==a}))||[]).length)?(e=function(){return a(b)},[2,null==c?void 0:c(e,r)]):[2]})})},[c,r,l,n,f]);h.useImperativeHandle(b,function(){return{close:r}},[r]);var t=h.useMemo(function(){return[h.createElement("div",{key:"Save",className:"saveBtn_edd24649"},h.createElement(_,{disabled:!p,onClick:s}))]},[p,s]),v=h.useMemo(function(){return[h.createElement("div",{key:"Title",className:"title_edd24649"},g.get("extractCommandBarTitle"))]},[g]),w=h.useMemo(function(){return[h.createElement("div",{key:"Discard",className:"selectionCounter_edd24649"},h.createElement(y.a,{className:aa,iconProps:{iconName:"Cancel"},ariaLabel:g.get("clearExtractAria",[o]),title:g.get("clearExtractTooltip"),role:"button",onClick:q,disabled:0===o}),h.createElement("span",{style:{marginLeft:"6px"}},o," selected")),h.createElement($.a,{key:"Divider",className:"rightDivider_edd24649"}),h.createElement(y.a,{key:"Cancel",className:aa,iconProps:{iconName:"Cancel"},ariaLabel:g.get("exitExtractAria"),title:g.get("exitExtractTooltip"),role:"button",onClick:r})]},[g,r,q,o]);return h.createElement(K,{leftItems:t,centerItems:v,rightItems:w})}),ac=c(411),ad=c(218),ae=c(58),af=c(92),ag=c(341),ah=c(415),ai=c(345);(0,n.ZW)([{rawString:".spinner_c7f02c9d{position:absolute;left:50%;-webkit-transform:translate(-50%, 0);transform:translate(-50%, 0);bottom:17px;max-width:50%;padding:12px 15px;border-radius:33px;z-index:99}"}]);var aj=function(){var a=(0,ah.b)().contentViewer,b=(0,D.a)();return h.createElement(ai.a,{styles:{root:{backgroundColor:b.semanticColors.menuBackground},circle:{animationDuration:"0.7s",minWidth:20},label:{display:"inline-block",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:b.palette.neutralPrimary,padding:"0 2px"}},className:"spinner_c7f02c9d",label:a.getFilename(),labelPosition:"right"})};(0,n.ZW)([{rawString:".root_72829470{height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.mainWrapper_72829470{position:relative;-webkit-box-flex:1;-ms-flex:1;flex:1}.saveModal_72829470{position:absolute;bottom:0;width:100%;height:100%;background:rgba(0,0,0,.2)}.main_72829470{position:relative;height:100%}"}]);var ak=c(427),al=c(338),am={root:{position:"fixed",top:0,left:0,width:"100%",height:"100%",backgroundColor:"rgba(0,0,0,0.5)"}},an=function(){return(0,m.c)().isVisible?i().createElement(al.a,{styles:am}):i().createElement(i().Fragment,null)};(0,n.ZW)([{rawString:".bottomToolArea_7516adf3{position:fixed;left:50%;-webkit-transform:translate(-50%, 0);transform:translate(-50%, 0);bottom:17px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;gap:16px;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.placeBottomToolOnTop_7516adf3{z-index:99}.inkBar_7516adf3{position:absolute;top:50%;-webkit-transform:translate(0, -50%);transform:translate(0, -50%)}html[dir=ltr] .inkBar_7516adf3{left:20px}html[dir=rtl] .inkBar_7516adf3{right:20px}.topArea_7516adf3{position:absolute;left:50%;-webkit-transform:translate(-50%, 0);transform:translate(-50%, 0);top:0px;width:100%}"}]);var ao=function(a){var b=a.expected,c=a.onDownload,e=a.onOpenInBrowser,f=a.enableDownload,g=a.enableOpenInBrowser,i=(0,d.pM)(h.useState(!0),2),k=i[0],l=i[1],m=(0,j.c)(),n=(0,D.a)(),o=h.useCallback(function(){l(!1)},[]),p=h.useCallback(function(){null==c||c(),o()},[c,o]),q=h.useCallback(function(){null==e||e(),o()},[e,o]);return h.createElement(P.a,{hidden:!k,minWidth:480,theme:n,dialogContentProps:{type:Q.a.normal,title:b?m.get("mipUnsupportedTitle"):m.get("mipErrorTitle"),subText:b?m.get("mipUnsupportedMessage"):m.get("mipErrorMessage")},modalProps:{isBlocking:!0,isModeless:b,layerProps:{styles:{root:{zIndex:15e5}}}},onDismiss:o},h.createElement(R.a,null,h.createElement(N.a,{onClick:p,text:m.get("download"),disabled:!f||!c}),h.createElement(L.a,{onClick:q,text:m.get("openInBrowser"),disabled:!g||!e})))},ap=c(313),aq=c(88),ar=c(593),as=c(184),at={background:"#323130",runningIcon:"#FAF9F8",successIcon:"#54B054",errorIcon:"#F1707B",infoIcon:"#EDEBE9",link:"#71ADE2",text:"#EDEBE9",hoveredButtonBackground:"#484644",barColor:"#FAF8F8",barBackground:"#605E5C"},au={background:"#F3F2F1",runningIcon:"#292827",successIcon:"#54B054",errorIcon:"#F1707B",infoIcon:"#292827",link:"#71ADE2",text:"#292827",hoveredButtonBackground:"#EDEBE9",barColor:"#292827",barBackground:"#A19F9D"};(0,n.ZW)([{rawString:".wrapper_9c898eca{padding:0 10px;z-index:99;width:352px;border-radius:4px;display:block;overflow:hidden;-webkit-transform-origin:center;transform-origin:center;will-change:transform;-webkit-transition:opacity 300ms ease,-webkit-transform 300ms ease;transition:opacity 300ms ease,-webkit-transform 300ms ease;transition:transform 300ms ease,opacity 300ms ease;transition:transform 300ms ease,opacity 300ms ease,-webkit-transform 300ms ease;-webkit-animation:tooltipShow_9c898eca 300ms ease 1;animation:tooltipShow_9c898eca 300ms ease 1}.hidden_9c898eca{-webkit-transition:opacity 300ms ease,-webkit-transform 300ms ease;transition:opacity 300ms ease,-webkit-transform 300ms ease;transition:transform 300ms ease,opacity 300ms ease;transition:transform 300ms ease,opacity 300ms ease,-webkit-transform 300ms ease;-webkit-animation:tooltipHide_9c898eca 300ms ease forwards 1;animation:tooltipHide_9c898eca 300ms ease forwards 1}.displayNone_9c898eca{display:none}@-webkit-keyframes rotating_9c898eca{from{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes rotating_9c898eca{from{-webkit-transform:rotate(0deg);transform:rotate(0deg)}to{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}.rotate_9c898eca{-webkit-animation:rotating_9c898eca 1s linear infinite;animation:rotating_9c898eca 1s linear infinite}.toastInfo_9c898eca{gap:8px;padding:6px 4px}.toastLeadIconContainer_9c898eca,.toastPostIconContainer_9c898eca{width:24px;height:30px;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}.toastLeadIconContainer_9c898eca{font-size:16px}.toastPostIconContainer_9c898eca{font-size:14px;cursor:pointer;border-radius:5px}.toastText_9c898eca{padding:4px 0}@-webkit-keyframes tooltipShow_9c898eca{from{opacity:0;-webkit-transform:translate3d(0, 100%, 0);transform:translate3d(0, 100%, 0)}}@keyframes tooltipShow_9c898eca{from{opacity:0;-webkit-transform:translate3d(0, 100%, 0);transform:translate3d(0, 100%, 0)}}@-webkit-keyframes tooltipHide_9c898eca{to{opacity:0;-webkit-transform:translateY(100%);transform:translateY(100%)}}@keyframes tooltipHide_9c898eca{to{opacity:0;-webkit-transform:translateY(100%);transform:translateY(100%)}}"}]);var av=function(a,b,c){switch(a){case l.b.Error:return{iconName:"StatusErrorFull",iconButtonName:"clear",iconColor:b.errorIcon};case l.b.Success:return{iconName:"SkypeCircleCheck",iconButtonName:"clear",iconColor:b.successIcon};case l.b.Info:return{iconName:c||"Info",iconButtonName:"clear",iconColor:b.infoIcon};case l.b.Running:default:return{iconName:"SyncStatusSolid",iconButtonName:"FullScreen",iconColor:b.runningIcon}}},aw=h.memo(function(a){var b=a.darkMode,c=void 0!==b&&b,e=(0,l.d)(),f=(0,l.c)(),g=f.type,i=f.text,k=f.link,m=f.linkText,p=f.percentComplete,q=f.infoIconName,r=f.shouldAutoFocus,s=void 0===r||r,t=f.disableAutoHide,u=void 0!==t&&t,v=f.onClickButton,w=h.useMemo(function(){return c?au:at},[c]),x=h.useMemo(function(){return av(g,w,q)},[w,q,g]),z=x.iconName,A=x.iconButtonName,B=x.iconColor,C=h.useRef(l.b.Hidden),D=(0,d.pM)(h.useState(g===l.b.Hidden),2),F=D[0],G=D[1],H=h.useRef(null),I=(0,j.c)(),J=(g===l.b.Success||g===l.b.Error)&&k&&m,K=h.useCallback(function(){setTimeout(function(){e({type:l.b.Hidden})},5e3)},[e]);h.useEffect(function(){C.current!==l.b.Running||g!==l.b.Success||u?C.current!==l.b.Hidden&&g===l.b.Hidden?setTimeout(function(){G(!0)},500):C.current===l.b.Hidden&&g!==l.b.Hidden&&(G(!1),g!==l.b.Info&&(g!==l.b.Success||u)||K()):K(),C.current=g},[K,u,F,g]),h.useEffect(function(){var a;F||(s&&g!==l.b.Info&&g!==l.b.Hidden&&(null==(a=H.current)||a.focus()),ag.a.read(i))},[F,s,i,g]);var L=h.useMemo(function(){return{root:{width:24,height:24},icon:{color:w.text,width:14,height:14,fontSize:14},rootHovered:{backgroundColor:w.hoveredButtonBackground},rootPressed:{backgroundColor:w.hoveredButtonBackground},rootExpanded:{backgroundColor:w.hoveredButtonBackground}}},[w.hoveredButtonBackground,w.text]);return h.createElement("div",{style:{background:w.background,color:w.text},className:(0,n.oG)("wrapper_9c898eca",g===l.b.Hidden&&"hidden_9c898eca",F&&"displayNone_9c898eca"),tabIndex:0,"data-is-focusable":!0,ref:H},h.createElement(E.a,{className:"toastInfo_9c898eca",horizontal:!0,horizontalAlign:"space-between",verticalAlign:"start"},h.createElement(ap.a,{className:(0,n.oG)("toastLeadIconContainer_9c898eca",g===l.b.Running&&"rotate_9c898eca")},h.createElement(aq.a,{style:{color:B},"aria-label":g,iconName:z})),h.createElement(ap.a,{grow:!0,className:"toastText_9c898eca"},h.createElement(E.a,null,h.createElement(ap.a,null,h.createElement(ar.a,{style:{color:w.text}},i)),J&&h.createElement(ap.a,null,h.createElement(as.a,{style:{color:w.link},href:k,target:"_blank"},m)))),h.createElement(ap.a,{className:"toastPostIconContainer_9c898eca"},v&&h.createElement(y.a,{onClick:v,styles:L,iconProps:{iconName:A},"aria-label":"clear"===A?I.get("closeButtonAria"):void 0}))),g===l.b.Running&&h.createElement(o.a,{styles:{itemProgress:{paddingTop:0,paddingBottom:4},progressBar:{background:p?w.barColor:"linear-gradient(to right, ".concat(w.barBackground," 0%, ").concat(w.barColor," 50%, ").concat(w.barBackground," 100%)")},progressTrack:{backgroundColor:w.barBackground}},percentComplete:p,ariaValueText:""}))}),ax=c(346),ay=function(a){var b=a.semanticColors.menuIcon,c={backgroundColor:a.semanticColors.menuItemBackgroundHovered,color:b};return{root:{backgroundColor:a.semanticColors.menuBackground,color:b},rootHovered:c,rootPressed:c,rootExpanded:c}},az={root:{verticalAlign:"baseline",display:"inline-block"}};(0,n.ZW)([{rawString:".toolIcon_66e857e6{height:0;padding:15px 20px;margin:calc(7px) 0;border-radius:5px}.menuIcon_66e857e6{height:0;padding:15px calc(8px);margin:calc(7px) 0}"}]);let aA="toolIcon_66e857e6";var aB=function(a){var b=(0,D.a)(),c=(0,ah.b)().contentViewer,e=h.useCallback(function(){var a=c.getViewer();a?a.focus():document.activeElement instanceof HTMLButtonElement&&document.activeElement.blur()},[c]);return a.hidden?h.createElement(h.Fragment,null):h.createElement(ax.a,{content:a.tooltip,styles:az},h.createElement(y.a,(0,d.q5)({},a,{iconProps:{iconName:a.iconName},className:aA,styles:ay(b),onMouseUp:e})))},aC=c(52),aD=function(){return null},aE=function(a){var b=a.iconName,c=a.tooltip,e=a.items,g=a.defaultCheckedKey,i=a.uncheckAll,j=a.onClickMenuItem,k=a.onOpen,l=a.onDismiss,m=(0,d.pM)(h.useState([]),2),o=m[0],p=m[1],q=(0,d.pM)(h.useState(""),2),r=q[0],s=q[1],t=(0,D.a)();return h.useEffect(function(){var a=[],b=function(a,b){var c,f;if(b){var g=void 0;try{for(var h=(0,d.BW)(e),i=h.next();!i.done;i=h.next()){var k=i.value;if(k.key===b.key){g=k.value;break}}}catch(a){c={error:a}}finally{try{i&&!i.done&&(f=h.return)&&f.call(h)}finally{if(c)throw c.error}}null==j||j.call(void 0,g),s(b.key)}};e.forEach(function(c){a.push({key:c.key,text:c.text,canCheck:!0,checked:c.key===r,onClick:b})}),p(a)},[e,r,j]),h.useEffect(function(){s(g||"")},[g]),h.useEffect(function(){i&&s("")},[i]),h.createElement(ax.a,{content:c,styles:az},h.createElement(y.a,(0,d.q5)({},a,{iconProps:{iconName:b},className:(0,n.oG)(aA,"menuIcon_66e857e6"),styles:ay(t),persistMenu:!0,menuProps:{shouldFocusOnMount:!0,shouldFocusOnContainer:!0,items:o,focusZoneProps:{handleTabKey:0},directionalHint:(0,f.a)()?aC.a.topRightEdge:aC.a.topLeftEdge,directionalHintFixed:!0,styles:{root:{".ms-ContextualMenu-itemText":{flexGrow:0}}},onMenuOpened:k,onMenuDismissed:l},onRenderMenuIcon:aD})))},aF=c(450);(0,n.ZW)([{rawString:".root_d244541c{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:0 10px;white-space:nowrap;font-size:14px;bottom:calc(61px);border-radius:21px 21px 0 0;border-bottom:1px solid}@media(max-width: 400px){.root_d244541c{border-radius:0}}.keyword_d244541c{display:inline-table;border-collapse:separate;border-spacing:8px}.keyword_d244541c input{display:table-cell;width:100%;text-indent:5px}html[dir=ltr] .keyword_d244541c input{padding-left:4px}html[dir=rtl] .keyword_d244541c input{padding-right:4px}html[dir=ltr] .keyword_d244541c input{padding-right:2px}html[dir=rtl] .keyword_d244541c input{padding-left:2px}html[dir=ltr] .keyword_d244541c input{text-align:left}html[dir=rtl] .keyword_d244541c input{text-align:right}.keyword_d244541c input:focus{border:1px solid var(--search-focus-border-color) !important}.keyword_d244541c .result_d244541c{display:table-cell;text-align:center}html[dir=ltr] .keyword_d244541c .result_d244541c{padding-left:10px}html[dir=rtl] .keyword_d244541c .result_d244541c{padding-right:10px}"}]);var aG=function(a){var b=a.width,c=(0,d.pM)(h.useState(0),2),e=c[0],f=c[1],g=(0,d.pM)(h.useState(0),2),i=g[0],k=g[1],l=(0,d.pM)(h.useState(""),2),m=l[0],n=l[1],o=h.useRef(!1),p=(0,ah.b)().contentViewer.getViewer(),q=(0,j.c)(),r=(0,D.a)();h.useEffect(function(){return function(){null==p||p.stopSearch()}},[p]);var s=h.useCallback(function(a){f(0),k(0);var b=0,c=0;null==p||p.startSearch(a,void 0,void 0,{onHitIndexUpdate:function(d){-1===d?null==p||p.goToNextSearchResult(!0):(k(d),c&&ag.a.read(q.get("searchIndex",[a,d+1,b])))},onTotalResultUpdate:function(d,e){f(d),b=d,c=e,ag.a.read(q.get("searchTotalCount",[a,d]))}})},[q,p]),t=h.useCallback(function(a){var b=a.target.value;n(b),o.current||s(b)},[s]),u=h.useCallback(function(){o.current=!0},[]),v=h.useCallback(function(){o.current=!1,s(m)},[m,s]),w=h.useCallback(function(a){void 0===a&&(a=!0),null==p||p.goToNextSearchResult(a)},[p]),x=h.useCallback(function(){w(!1)},[w]),y=h.useCallback(function(){w(!1)},[w]),z=h.useCallback(function(){w(!0)},[w]);return h.createElement("div",{className:"root_d244541c",style:{backgroundColor:r.semanticColors.menuBackground,borderBottomColor:r.semanticColors.menuDivider},role:"menubar"},h.createElement(aF.a,{autoFocusOnInput:!0,rootProps:{className:"keyword_d244541c",style:{color:r.semanticColors.disabledText,width:b?"".concat(b-100,"px"):"auto","--search-focus-border-color":r.semanticColors.messageLink},role:"menuitem","aria-label":q.get("searchQueryAria")},inputProps:{type:"text",value:m,placeholder:q.get("searchInputPlaceholder"),maxLength:100,role:"textbox","aria-label":q.get("searchInputAria"),onChange:t,onCompositionStart:u,onCompositionUpdate:u,onCompositionEnd:v},onEnterWhenFocused:w,onShiftEnterWhenFocused:x},h.createElement("div",{className:"result_d244541c",style:e?{color:r.semanticColors.menuItemText}:void 0,"aria-label":e?q.get("searchResultAria",[i+1,e]):q.get("noSearchResultAria")},h.createElement("span",null,e?i+1:0),"/",h.createElement("span",null,e))),h.createElement(aB,{iconName:"ChevronLeft",tooltip:q.get("previousTooltip"),role:"menuitem",ariaLabel:q.get("previousResultCommandAria"),onClick:y}),h.createElement(aB,{iconName:"ChevronRight",tooltip:q.get("nextTooltip"),role:"menuitem",ariaLabel:q.get("nextResultCommandAria"),onClick:z}))};(0,n.ZW)([{rawString:".root_d8a579b8{display:-webkit-inline-box;display:-ms-inline-flexbox;display:inline-flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;padding:0 10px;white-space:nowrap;font-size:14px;-webkit-box-shadow:inset 0px .6px 1.8px rgba(0,0,0,.1),0px 3.2px 7.2px rgba(0,0,0,.13);box-shadow:inset 0px .6px 1.8px rgba(0,0,0,.1),0px 3.2px 7.2px rgba(0,0,0,.13);border-radius:33px}@media(max-width: 400px){.root_d8a579b8{border-radius:12px}}.toolBarContent_d8a579b8{overflow:auto;max-width:80vw}.fadeOut_d8a579b8{visibility:hidden;opacity:0;-webkit-transition:visibility 0s linear 300ms,opacity 300ms;transition:visibility 0s linear 300ms,opacity 300ms}.fadeIn_d8a579b8{visibility:visible;opacity:1;-webkit-transition:visibility 0s linear 0s,opacity 150ms;transition:visibility 0s linear 0s,opacity 150ms}.pagination_d8a579b8{display:inline-table}html[dir=ltr] .pagination_d8a579b8{margin-left:10px}html[dir=rtl] .pagination_d8a579b8{margin-right:10px}html[dir=ltr] .pagination_d8a579b8{padding-right:10px}html[dir=rtl] .pagination_d8a579b8{padding-left:10px}.pagination_d8a579b8 input{display:table-cell;width:30px;padding:0 2px;text-align:center}.pagination_d8a579b8 .status_d8a579b8{display:table-cell;text-align:center}.slash_d8a579b8{padding:0 5px}.expanded_d8a579b8{border-radius:0 0 21px 21px;-webkit-box-shadow:none;box-shadow:none}@media(max-width: 400px){.expanded_d8a579b8{border-radius:0}}.shadowBox_d8a579b8{-webkit-box-shadow:inset 0px .6px 1.8px rgba(0,0,0,.1),0px 3.2px 7.2px rgba(0,0,0,.13);box-shadow:inset 0px .6px 1.8px rgba(0,0,0,.1),0px 3.2px 7.2px rgba(0,0,0,.13);border-radius:21px}"}]);let aH="toolBarContent_d8a579b8";var aI=/^[0-9\b]+$/,aJ=[.5,.75,1,1.25,1.5,2,3,4],aK={height:"16px",margin:"14px 10px"},aL=function(a){a.stopPropagation()},aM=function(a){a.currentTarget.select()},aN=h.forwardRef(function(a,b){var c=a.visible,e=a.searchBarVisible,f=a.disableSearch,g=a.currentIndex,i=a.showPrint,k=a.showOpenInNewWindow,l=a.dataAttributes,m=a.defaultScale,o=a.onAutoHide,p=a.onOpenInNewWindow,q=a.onSearchToggle,s=a.onPrint,t=(0,d.pM)(h.useState(0),2),v=t[0],w=t[1],x=(0,d.pM)(h.useState(!1),2),y=x[0],B=x[1],C=h.useRef(null),E=h.useRef(),F=h.useRef(!1),G=h.useRef(!1),H=h.useRef(!1),I=h.useRef(null),J=h.useRef(null),K=(0,ah.b)().contentViewer.getViewer(),L=(0,j.c)(),M=(0,D.a)(),N=h.useCallback(function(){E.current&&window.clearTimeout(E.current)},[]),O=h.useCallback(function(){G.current||F.current||H.current||e||(N(),E.current=window.setTimeout(function(){o()},4e3))},[o,e,N]),P=h.useCallback(function(){K&&(v>=0&&v<K.pageCount?(K.goToPage(v),u.a.logEngagement({name:"GoToCertainPage",actionGesture:"Click",extraData:{pageIndex:v}})):w(g))},[v,K,g]);h.useEffect(function(){return c&&O(),function(){N()}},[c,O,N]),h.useEffect(function(){w(g)},[g]),h.useImperativeHandle(b,function(){return{focus:function(){window.setTimeout(function(){var a;null==(a=I.current)||a.focus()})},uncheckZoomMenu:function(){B(!0)}}},[]);var Q=h.useCallback(function(){F.current=!0,N()},[N]),R=h.useCallback(function(){F.current=!1,O()},[O]),S=h.useCallback(function(){G.current=!0,N()},[N]),T=h.useCallback(function(){G.current=!1,O()},[O]),U=h.useCallback(function(a){void 0===a&&(a=!0);var b=a?g+1:g-1;null==K||K.goToPage(b),u.a.logEngagement({name:a?"GoToNextPage":"GoToPreviousPage",actionGesture:"Click"})},[g,K]),V=h.useCallback(function(){P()},[P]),W=h.useCallback(function(a){var b=a.target.value;b?aI.test(b)&&w(parseInt(b,10)-1):w(-1)},[]),X=h.useCallback(function(a){"Enter"===a.key&&P()},[P]),Y=h.useCallback(function(a){null==K||K.zoom(a),B(!1),u.a.logEngagement({name:"SelectZoomOption",actionGesture:"Click",extraData:{zoomOption:a}})},[K]),Z=h.useCallback(function(){var a=[],b=0;return a.push({key:"".concat(b++),text:L.get("zoomPageFitSize"),value:r.i.FitSize}),a.push({key:"".concat(b++),text:L.get("zoomPageFitWidth"),value:r.i.FitWidth}),aJ.forEach(function(c){a.push({key:"".concat(b++),text:"".concat(100*c,"%"),value:c})}),a},[L]),_=h.useCallback(function(){var a="number"==typeof m?"".concat(100*m,"%"):"",b=(null==K?void 0:K.zoomOpt)||a,c=Z().find(function(a){return a.value===b});return c?c.key:""},[m,Z,K]),aa=h.useCallback(function(){H.current=!0,N(),u.a.logEngagement({name:"OpenZoomMenu",actionGesture:"Click"})},[N]),ab=h.useCallback(function(){H.current=!1,O()},[O]),ac=h.useCallback(function(){null==K||K.rotate(),u.a.logEngagement({name:"Rotate",actionGesture:"Click"})},[K]),ad=h.useCallback(function(){null==p||p(),u.a.logEngagement({name:"OpenInNewWindow",actionGesture:"Click"})},[p]),ae=h.useCallback(function(){null==q||q(),N(),u.a.logEngagement({name:"ToggleSearchBar",actionGesture:"Toggle"})},[q,N]),af=h.useCallback(function(){var a;if(I.current&&C.current){var b=null==(a=C.current)?void 0:a.scrollWidth,c=getComputedStyle(I.current),d=c.paddingLeft,e=c.paddingRight;return b+parseInt(d)+parseInt(e)}return 0},[]),ag=h.useCallback(function(){U(!1)},[U]),ai=h.useCallback(function(){U(!0)},[U]);return h.createElement("div",(0,d.q5)({},l,{className:e?"shadowBox_d8a579b8":""}),h.createElement("div",{className:e?aH:""},e&&h.createElement(z.a,{direction:A.a.horizontal,shouldResetActiveElementWhenTabFromZone:!0,handleTabKey:A.b.all},h.createElement(aG,{width:af()})),h.createElement(z.a,{shouldResetActiveElementWhenTabFromZone:!0,handleTabKey:A.b.all,direction:A.a.horizontal},h.createElement("div",{className:(0,n.oG)("root_d8a579b8",c?"fadeIn_d8a579b8":"fadeOut_d8a579b8",e?"expanded_d8a579b8":""),style:{backgroundColor:M.semanticColors.menuBackground},ref:I,tabIndex:0,role:"menubar",onMouseEnter:Q,onMouseLeave:R,onClick:aL,onMouseDown:aL,onMouseMove:aL,onFocus:S,onBlur:T},h.createElement("div",{className:e?"":aH},h.createElement("div",{ref:C},h.createElement(aB,{iconName:"ChevronUp",tooltip:L.get("previousPageTooltip"),role:"menuitem",ariaLabel:L.get("upCommandAria"),onClick:ag}),h.createElement(aB,{iconName:"ChevronDown",tooltip:L.get("nextPageTooltip"),role:"menuitem",ariaLabel:L.get("downCommandAria"),onClick:ai}),h.createElement(aF.a,{rootProps:{className:"pagination_d8a579b8",role:"menuitem","aria-label":L.get("pageNumberAria",[g+1,(null==K?void 0:K.pageCount)||1]),style:{color:M.semanticColors.menuItemText}},inputProps:{type:"text",value:v>=0?v+1:"",autoComplete:"off","aria-label":L.get("pageInputAria",[(null==K?void 0:K.pageCount)||1]),onFocus:aM,onBlur:V,onChange:W,onKeyDown:X},outerRef:J},h.createElement("div",{className:"status_d8a579b8"},h.createElement("span",{className:"slash_d8a579b8"},"/"),h.createElement("span",null,(null==K?void 0:K.pageCount)||1))),h.createElement($.a,{styles:{divider:aK}}),h.createElement(aE,{iconName:"ZoomIn",tooltip:L.get("zoomTooltip"),role:"menuitem",ariaLabel:L.get("zoomCommandAria"),items:Z(),defaultCheckedKey:_(),uncheckAll:y,onClickMenuItem:Y,onOpen:aa,onDismiss:ab}),h.createElement(aB,{iconName:"Rotate",tooltip:L.get("rotateTooltip"),role:"menuitem",ariaLabel:L.get("rotateCommandAria"),onClick:ac}),!f&&h.createElement(aB,{iconName:"Search",tooltip:L.get("searchTooltip"),role:"menuitem",ariaLabel:e?L.get("closeSearchCommandAria"):L.get("searchCommandAria"),"aria-expanded":e,onClick:ae}),i&&k&&h.createElement($.a,{styles:{divider:aK}}),h.createElement(aB,{iconName:"Print",tooltip:L.get("printLabel"),role:"menuitem",ariaLabel:L.get("printLabel"),onClick:s,hidden:!i}),h.createElement(aB,{iconName:"OpenInNewTab",tooltip:L.get("openInNewWindowTooltip"),role:"menuitem",ariaLabel:L.get("openInNewWindowCommandAria"),onClick:ad,hidden:!k})))))))});aN.defaultProps={defaultScale:r.i.FitSize};var aO=c(79),aP=h.lazy(function(){return c.e(79).then(c.bind(c,827)).then(function(a){return{default:a.ThumbnailView}})}),aQ=h.lazy(function(){return c.e(34).then(c.bind(c,828)).then(function(a){return{default:a.MipNeedPermissionDialog}})}),aR=h.lazy(function(){return c.e(37).then(c.bind(c,829)).then(function(a){return{default:a.EncryptDialog}})}),aS=h.lazy(function(){return c.e(31).then(c.bind(c,830)).then(function(a){return{default:a.CompressDialog}})}),aT=h.lazy(function(){return c.e(38).then(c.bind(c,831)).then(function(a){return{default:a.PrintDialog}})}),aU=h.lazy(function(){return c.e(34).then(c.bind(c,832)).then(function(a){return{default:a.PermissionBanner}})}),aV=h.lazy(function(){return c.e(87).then(c.bind(c,833)).then(function(a){return{default:a.WatermarkWrapper}})}),aW=function(a){return h.createElement(h.Suspense,{fallback:h.createElement("div",null)},h.createElement(aV,(0,d.q5)({},a)))},aX=h.memo(h.forwardRef(function(a,b){var c,e,f,g,i,j=a.enableToolbar,m=a.enableThumbnailView,o=a.enableToast,p=a.enableOpenMip,q=a.mode,r=a.mipDialogProps,s=a.encryptDialogProps,t=a.compressDialogProps,u=a.annotParams,v=a.annotBarStrings,w=a.resetWatermarkAnnotParams,x=a.execSelect,y=a.toolbarProps,z=a.darkMode,A=a.mipAuthFailed,B=void 0!==A&&A,C=a.enablePrint,D=a.discardEdits,E=(0,d.pM)(h.useState(!1),2),F=E[0],G=E[1],H=(0,d.pM)(h.useState(!1),2),I=H[0],J=H[1],K=(0,d.pM)(h.useState(!1),2),L=K[0],M=K[1],N=(0,d.pM)(h.useState(!1),2),O=N[0],P=N[1],Q=(0,d.pM)(h.useState(!1),2),R=Q[0],S=Q[1],T=(0,k.b)(),U=(0,k.c)(),V=(0,l.d)(),W=h.useRef(null),X=(0,ah.b)().contentViewer.getViewer();h.useEffect(function(){T({toggle:function(a){null!=a?J(a):J(function(a){return!a})}})},[T]);var Y=h.useCallback(function(a,b){G(!0),null==X||X.print(a,b,{onPrintEnd:function(){window.setTimeout(function(){G(!1)})}})},[X]),Z=h.useCallback(function(){G(!1),null==X||X.cancelPrint()},[X]);h.useImperativeHandle(b,function(){return{print:function(a,b){return(0,d.yv)(void 0,void 0,void 0,function(){return(0,d.SO)(this,function(c){return C&&Y(a,b),[2]})})},getThumbnailView:function(){return U},getToolbar:function(){return W.current||{}},getToastOperation:function(){return V}}},[C,Y,U,V]);var $=h.useCallback(function(a){S(a)},[S]);return h.useEffect(function(){(null==X?void 0:X.isMip)&&!X.isMipDecrypted&&(P(B),M(!B))},[B,X]),h.createElement("div",null,m&&h.createElement(h.Suspense,{fallback:h.createElement("div",null)},h.createElement(aP,{visible:!!I})),(null==(c=ak.a.features)?void 0:c.enableWatermark)&&h.createElement(an,null),h.createElement("div",{className:(0,n.oG)("bottomToolArea_7516adf3",y.shouldPlaceToolbarOnTop&&"placeBottomToolOnTop_7516adf3")},j&&h.createElement(aN,(0,d.q5)({ref:W},y,{onPrint:Y})),o&&h.createElement(aw,{darkMode:void 0!==z&&z})),h.createElement("div",{className:(0,n.oG)("topArea_7516adf3")},X&&q===aO.a.View&&h.createElement(h.Suspense,{fallback:h.createElement("div",null)},h.createElement(aU,{pdfViewer:X}))),L&&h.createElement(ao,(0,d.q5)({},r||{},{expected:!p})),O&&h.createElement(h.Suspense,{fallback:h.createElement("div",null)},h.createElement(aQ,null)),(C||y.showPrint)&&h.createElement(h.Suspense,{fallback:h.createElement("div",null)},h.createElement(aT,{hidden:!F,onCancelPrint:Z})),(null==(e=ak.a.features)?void 0:e.enableEncrypt)&&s&&s.encryptVisible&&h.createElement(h.Suspense,{fallback:h.createElement("div",null)},h.createElement(aR,(0,d.q5)({},s))),(null==(f=ak.a.features)?void 0:f.enableWatermark)&&((null==(g=null==u?void 0:u.inkAttributes)?void 0:g.watermark)||R)&&h.createElement(aW,{annotParams:u,annotBarStrings:v,resetWatermarkAnnotParams:w,execSelect:x,onHoldOnWatermark:$,discardEdits:D}),(null==(i=ak.a.features)?void 0:i.enableCompress)&&t&&t.compressVisible&&h.createElement(h.Suspense,{fallback:h.createElement("div",null)},h.createElement(aS,(0,d.q5)({},t))))}));aX.displayName="PdfViewerControls",(0,n.ZW)([{rawString:".enterPanel_c6d49072{position:absolute;left:50%;-webkit-transform:translate(-50%, 0);transform:translate(-50%, 0);top:50%;-webkit-transform:translate(-50%, -50%);transform:translate(-50%, -50%);text-align:center}.prompt_c6d49072{margin-bottom:10px;font-size:16px}"}]);var aY=h.lazy(function(){return c.e(37).then(c.bind(c,773)).then(function(a){return{default:a.PasswordDialog}})}),aZ=function(){var a=(0,d.pM)(h.useState(!1),2),b=a[0],c=a[1],e=(0,ah.b)().contentViewer,f=(0,j.c)(),g=h.useCallback(function(){c(!0)},[]),i=h.useCallback(function(){c(!1)},[]);return h.createElement("div",{className:"enterPanel_c6d49072"},h.createElement("div",{className:"prompt_c6d49072"},f.get("needsPasswordLabel",[e.getFilename()])),h.createElement(L.a,{onClick:g,text:f.get("enterPassword")}),b&&h.createElement(h.Suspense,{fallback:h.createElement("div",null)},h.createElement(aY,{onClose:i})))},a$=c(451),a_=h.lazy(function(){return Promise.all([c.e("odsp.react.lib"),c.e(28)]).then(c.bind(c,807)).then(function(a){return{default:a.FreeTextContainer}})}),a0=h.lazy(function(){return c.e(35).then(c.bind(c,808)).then(function(a){return{default:a.Outline}})}),a1=h.lazy(function(){return c.e(36).then(c.bind(c,809)).then(function(a){return{default:a.Outline}})}),a2=h.memo(h.forwardRef(function(a,b){var c,e,f,g,i,k,m,n,o,p=a.mode,s=void 0===p?aO.a.View:p,t=a.defaultScale,v=void 0===t?r.i.FitSize:t,x=a.showLoadingSpinner,y=a.disableSearch,z=a.enableToolbar,A=void 0===z||z,B=a.enableGripperContextualMenu,C=a.enableToast,E=a.darkMode,F=a.enableEdit,G=void 0!==F&&F,H=a.enableProgressiveLoading,I=a.annotParams,J=a.hasAnnotationPermission,K=a.contentViewerRef,L=a.controlsRef,M=a.outlineProps,N=a.onNeedPassword,O=a.onDocumentLoaded,P=a.onCurrentPageChanged,Q=a.onScaleChanged,R=a.onFontLoading,S=(0,d.pM)(h.useState(!1),2),T=S[0],U=S[1],V=(0,d.pM)(h.useState(!1),2),W=V[0],X=V[1],Y=(0,d.pM)(h.useState(!1),2),Z=Y[0],$=Y[1],_=(0,d.pM)(h.useState(!1),2),aa=_[0],ab=_[1],ai=(0,d.pM)(h.useState(!1),2),ak=ai[0],al=ai[1],am=(0,d.pM)(h.useState(0),2),an=am[0],ao=am[1],ap=(0,d.pM)(h.useState(A),2),aq=ap[0],ar=ap[1],as=(0,d.pM)(h.useState(!1),2),at=as[0],au=as[1],av=(0,d.pM)(h.useState(void 0),2),aw=av[0],ax=av[1],ay=(0,j.c)(),az=(0,D.a)(),aA=(0,w.b)().eventBus,aB=(null==(c=q.a.features)?void 0:c.enableFreeText)&&G&&J,aC=h.useCallback(function(a){!Z&&Math.sqrt(Math.pow(a.movementX,2)+Math.pow(a.movementY,2))>30&&$(!0)},[Z]);h.useImperativeHandle(b,function(){return{getEventHandlers:function(){return{onMouseMove:aC}}}},[aC]);var aD=h.useCallback(function(a){return(0,d.yv)(void 0,void 0,void 0,function(){var b,c,e,f,g;return(0,d.SO)(this,function(d){switch(d.label){case 0:if(!(a.altKey&&"T"===a.key.toUpperCase()))return[3,1];return $(!0),null==(e=null==(b=L.current)?void 0:(c=b.getToolbar()).focus)||e.call(c),[3,4];case 1:if(!((null==I?void 0:I.mode)===r.a.FreeText&&a.altKey&&a.ctrlKey&&"F"===a.key.toUpperCase()))return[3,3];return[4,null==(g=null==(f=K.current)?void 0:f.getViewer())?void 0:g.addFreeText()];case 2:return d.sent(),[3,4];case 3:!af.a.isActivated("EnableSearchShortcut")&&(a.ctrlKey||a.metaKey)&&"F"===a.key.toUpperCase()&&(a.preventDefault(),$(!0),ab(!0),u.a.logEngagement({name:"OpenSearchBar",actionGesture:"Shortcut"})),d.label=4;case 4:return[2]}})})},[I,K,L]),aE=h.useCallback(function(){aa||$(function(a){return!a})},[aa]),aF=h.useCallback(function(){null==N||N(),U(!0)},[N]),aG=h.useCallback(function(a){var b,c,d=null==(b=K.current)?void 0:b.getViewer();if(!af.a.isActivated("ControllOutlineDefaultOn")&&a.hasOutline)try{var e=null==d?void 0:d.getDocumentLeftToViewport();a&&(a.isOutlineDefaultOff=a.pageCount<15||void 0!==e&&e<320||a$.a.getBooleanItem(ae.t))}catch(a){}null==O||O(a),X(!0),$(!0),U(!1),al(a.isPrintAllowed),d&&(ag.a.read(ay.get("displayInfo",[d.getCurrentPageIndex()+1,d.scale,d.rotation])),(null==(c=q.a.features)?void 0:c.enableOutline)&&(a.hasOutline?d.getOutlineData().then(function(a){a&&ax({outlineData:a,initialPageIndex:d.getCurrentPageIndex()})}).catch(function(){ax({outlineData:[],initialPageIndex:d.getCurrentPageIndex()})}):ax({outlineData:[],initialPageIndex:d.getCurrentPageIndex()})))},[O,K,ay]),aH=h.useCallback(function(){au(!0)},[]);h.useEffect(function(){ar(!!A&&W)},[A,W]),h.useEffect(function(){if(H){var a,b=null==(a=L.current)?void 0:a.getToastOperation();W&&(null==b||b({type:l.b.Success,text:ay.get("previewToastFinishedText"),link:"",linkText:"",onClickClose:function(){b({type:l.b.Hidden})}}))}},[H,W,L]);var aI=h.useCallback(function(a){null==R||R(a);var b,c=null==(b=L.current)?void 0:b.getToastOperation();a?null==c||c({type:l.b.Running,text:ay.get("loadingFontToast"),onClickExpand:function(){c({type:l.b.Hidden})}}):null==c||c({type:l.b.Success,text:ay.get("fontAlreadyLoadedToast"),link:"",linkText:"",onClickClose:function(){c({type:l.b.Hidden})}})},[R,L,ay]),aJ=h.useCallback(function(a){null==P||P(a),ao(a)},[P]),aK=h.useCallback(function(a,b){var c,d,e;null==Q||Q(a),b||null==(e=null==(c=L.current)?void 0:(d=c.getToolbar()).uncheckZoomMenu)||e.call(d)},[Q,L]),aL=h.useCallback(function(){$(!1)},[]),aM=h.useCallback(function(){aA.dispatch(aO.c.MetadataUpdated)},[aA]),aN=h.useMemo(function(){var b;return b=a.annotBarStrings,function(a){return h.createElement(ac.a,{strings:b},h.createElement(h.Suspense,{fallback:h.createElement("div",null)},h.createElement(a_,(0,d.q5)({},a))))}},[a.annotBarStrings]);return h.createElement("div",{className:"main_72829470",style:{color:az.palette.neutralPrimary},onMouseMove:aC,onClick:aE,onKeyDown:aD},(null==(e=q.a.features)?void 0:e.enableOutline)&&K.current&&s===aO.a.View&&aw&&((null==(f=q.a.features)?void 0:f.enableOutlineNext)?h.createElement(ah.a,{contentViewer:K.current,docLoaded:W},h.createElement(h.Suspense,{fallback:h.createElement("div",null)},h.createElement(a0,(0,d.q5)({},M,{outlineInfo:aw,goToPage:null==(i=null==(g=K.current)?void 0:g.getViewer())?void 0:i.goToPage})))):aw.outlineData.length>0&&h.createElement(h.Suspense,{fallback:h.createElement("div",null)},h.createElement(a1,(0,d.q5)({},M,{outlineInfo:aw,goToPage:null==(m=null==(k=K.current)?void 0:k.getViewer())?void 0:m.goToPage})))),h.createElement(ad.a,(0,d.q5)({},a,{ref:K,localeStrings:a.contentStrings,enableEdit:G,enableGripperContextualMenu:void 0===B||B,isRootFocusable:!1,annotParams:I,ariaHidden:s===aO.a.Extract,onNeedPassword:aF,onDocumentLoaded:aG,onCurrentPageChanged:aJ,onScaleChanged:aK,freeTextContainer:aB&&aN||void 0,onMipAuthFailed:aH,onMetadataUpdated:aM,onFontLoading:aI})),K.current&&h.createElement(ah.a,{contentViewer:K.current,docLoaded:W},W?h.createElement(aX,{ref:L,enableToolbar:aq,enableThumbnailView:a.enableThumbnailView,enableToast:void 0===C||C,enableOpenMip:a.enableOpenMip,mode:s,annotParams:a.annotParams,annotBarStrings:a.annotBarStrings,resetWatermarkAnnotParams:a.resetWatermarkAnnotParams,execSelect:a.execSelect,darkMode:void 0!==E&&E,mipAuthFailed:at,toolbarProps:{visible:Z,searchBarVisible:aa,disableSearch:void 0!==y&&y,currentIndex:an,defaultScale:v,onAutoHide:aL,showPrint:ak&&a.showPrint,showOpenInNewWindow:a.showOpenInNewWindow,shouldPlaceToolbarOnTop:a.shouldPlaceToolbarOnTop,dataAttributes:a.toolbarAttributes,onOpenInNewWindow:a.onOpenInNewWindow,onSearchToggle:function(){return ab(!aa)}},mipDialogProps:a.mipDialogProps,inkingToolbarProps:a.inkingToolbarProps,encryptDialogProps:a.encryptDialogProps,compressDialogProps:a.compressDialogProps,discardEdits:null==(o=null==(n=K.current)?void 0:n.getViewer())?void 0:o.discardEdits}):T?h.createElement(aZ,null):void 0===x||x?h.createElement(aj,null):void 0))}));a2.displayName="PdfViewerAppMain";var a3=function(a){switch(a){case p.b.FreeText:return r.a.FreeText;case p.b.Pen:return r.a.Ink;case p.b.Highlighter:return r.a.Highlight;case p.b.Watermark:return r.a.None;case p.b.Eraser:return r.a.Erase;case p.b.PointEraser:return r.a.PointErase;default:return r.a.None}},a4=function(a){var b=a.tool,c=a.color,d=a.thickness,e=a.watermark;return{width:(2*(null!=d?d:3)+5)/5*(b===p.b.Highlighter?10:1),color:{hex:null!=c?c:"#1f1f1f",alpha:b===p.b.Highlighter?.3:1},watermark:e?{name:e.name||"",action:e.action||p.c.Unknown}:void 0}},a5=h.memo(function(a){var b,c=a.mode,e=a.filename,f=a.height,g=a.shouldExitEditModeAfterSave,i=void 0===g||g,m=a.allowUnloadPageWithEdits,n=a.mainRef,x=a.contentViewerRef,y=a.enableEdit,z=a.onDocumentLoaded,A=a.onEditStateChanged,B=a.execSave,C=a.updateMode,D=a.isFileVersionChanged,E=a.isPaidFeaturesEnabled,F=void 0===E||E,G=a.execExtract,H=a.onExitEditMode,I=(0,d.pM)(h.useState(!1),2),J=I[0],K=I[1],L=(0,d.pM)(h.useState(!1),2),M=L[0],N=L[1],O=(0,d.pM)(h.useState(!1),2),P=O[0],Q=O[1],R=(0,d.pM)(h.useState(),2),S=R[0],T=R[1],U=(0,d.pM)(h.useState(),2),V=U[0],W=U[1],X=(0,d.pM)(h.useState(!0),2),Y=X[0],$=X[1],_=(0,d.pM)(h.useState(!1),2),aa=_[0],ac=_[1],ad=h.useRef(),ae=(0,j.c)(),af=(0,k.c)(),ag=(0,l.d)(),ah=h.useRef(new s.a),ai=null==(b=x.current)?void 0:b.getViewer(),aj=h.useRef(null),ak=h.useRef(null),al=h.useMemo(function(){return ae.get("editToastText")},[ae]),am=h.useRef(null),an=a.inkingToolbarProps||{},ao=an.watermarkButtonId,ap=an.annotationMoreButtonId;h.useEffect(function(){var a=function(a){var b,c,d;"Escape"===a.key&&a.target instanceof Node&&(null==(b=aj.current)?void 0:b.contains(a.target))&&(null==(c=ak.current)||c.close(),null==(d=am.current)||d.close())};return window.addEventListener("keydown",a),function(){window.removeEventListener("keydown",a)}},[]);var aq=h.useCallback(function(){var a=aj.current;a&&!a.contains(document.activeElement)&&a.focus()},[]);h.useEffect(function(){c===aO.a.Extract&&(aq(),af.toggle(!0))},[c,af,aq]),h.useEffect(function(){var a=p.b.Display;c===aO.a.Edit?(aq(),W({mode:a3(a)})):W({mode:r.a.None}),T(a)},[c,aq]);var ar=h.useCallback(function(a){null==z||z(a),K(!0),$(a.isAnnotAllowed)},[z]),as=h.useCallback(function(a){var b=a.dirty,d=a.annotTypeOfLatestEdit;b!==M&&(null==A||A({dirty:b}),N(b)),b&&c===aO.a.View&&(null==C||C(aO.a.Edit),ag({type:l.b.Info,text:al,infoIconName:"EditSolid12",shouldAutoFocus:!1,onClickClose:function(){ag({type:l.b.Hidden})}}),ad.current=d)},[A,al,M,c,ag,C]),at=h.useCallback(function(){var a;null==(a=ah.current)||a.dispatch(aO.c.ExitEditMode),Q(!1),ad.current=void 0,H?H():null==C||C(aO.a.View)},[H,C]),au=h.useCallback(function(a){return(0,d.yv)(void 0,void 0,void 0,function(){var b;return(0,d.SO)(this,function(c){switch(c.label){case 0:if(!B)throw new t.c(t.b.UploadFileDataFailed,"Empty execSave callback from host");c.label=1;case 1:return c.trys.push([1,3,,4]),[4,B(a)];case 2:return[2,c.sent()];case 3:if((b=c.sent())instanceof t.c)throw b;throw new t.c(t.b.UploadFileDataFailed,(null==b?void 0:b.message)||JSON.stringify(b),null==b?void 0:b.isExpected);case 4:return[2]}})})},[B]),av=h.useCallback(function(){return(0,d.yv)(void 0,void 0,void 0,function(){var a,b,c,e,f,g,h,j,k;return(0,d.SO)(this,function(l){switch(l.label){case 0:N(!1),Q(!0),a=u.a.createScenario({name:v.a.DocumentSave}),l.label=1;case 1:return l.trys.push([1,5,,6]),[4,null==ai?void 0:ai.getCurrentFileData()];case 2:if(!(c=null==(b=l.sent())?void 0:b.byteLength))throw new t.c(t.b.GetPdfStreamFailed,0===c?"Empty file data":"Undefined file data");return Q(!1),i&&at(),[4,au(b)];case 3:return e=l.sent(),a.stop({extraData:(0,d.q5)({fileSize:c},(null==e?void 0:e.extraData)||{})}),g=(f=function(a){return!!a&&a.byteLength>0})(b)?b:null==e?void 0:e.fileData,h=function(a){return new t.c(void 0,"Fail to reload document after saving, reason: ".concat(a)).toCaughtError()},f(g)?null==ai||ai.reloadCurrentDocument(g).catch(function(a){u.a.logError(h(a.message))}):u.a.logError(h("No available file data")),[4,null==ai?void 0:ai.getTelemetryData()];case 4:return void 0!==(j=l.sent())&&u.a.logEngagement({name:"InteractWithForm",actionGesture:"Form",extraData:{telemetryExtraData:j}}),[3,6];case 5:var m;return k=(m=l.sent()||new t.c("Unknown"))instanceof t.c?m.toQosError():{isExpected:!!m.isExpected,error:m,code:m.code||m.name},a.fail(k),[3,6];case 6:return[2]}})})},[ai,i,au,at]),aw=h.useCallback(function(){return(0,d.yv)(void 0,void 0,void 0,function(){var a,b;return(0,d.SO)(this,function(c){switch(c.label){case 0:return c.trys.push([0,2,,3]),[4,null==ai?void 0:ai.discardEdits()];case 1:return c.sent(),[3,3];case 2:return b="string"==typeof(a=c.sent())?a:a.message,u.a.logError({error:{name:a.name,message:"Fail to discard, reason: ".concat(b),stack:a.stack}}),[3,3];case 3:return[2]}})})},[ai]),ax=h.useCallback(function(){null==C||C(aO.a.View)},[C]),ay=h.useCallback(function(){return(0,d.yv)(void 0,void 0,void 0,function(){var a,b;return(0,d.SO)(this,function(c){switch(c.label){case 0:return[4,null==(b=null==(a=x.current)?void 0:a.getViewer())?void 0:b.addFreeText()];case 1:return c.sent(),[2]}})})},[x]),az=h.useCallback(function(){return(0,d.yv)(void 0,void 0,void 0,function(){return(0,d.SO)(this,function(a){switch(a.label){case 0:return[4,null==ai?void 0:ai.getWatermarkInfos()];case 1:return[2,a.sent()||""]}})})},[ai]),aA=h.useCallback(function(a,b){W({mode:a3(a),inkAttributes:b?a4(b):null==V?void 0:V.inkAttributes})},[null==V?void 0:V.inkAttributes]),aB=h.useCallback(function(a){W({mode:null==V?void 0:V.mode,inkAttributes:a4(a)})},[V]),aC=h.useCallback(function(){var a;(null==(a=null==V?void 0:V.inkAttributes)?void 0:a.watermark)&&W((0,d.q5)((0,d.q5)({},V),{inkAttributes:(0,d.q5)((0,d.q5)({},V.inkAttributes),{watermark:void 0})}))},[V]),aD=h.useMemo(function(){var b,c,d;return{enableFreeText:null==(b=q.a.features)?void 0:b.enableFreeText,enableWatermark:(null==(c=q.a.features)?void 0:c.enableWatermark)&&F,enablePointEraser:null==(d=q.a.features)?void 0:d.enableEnhancedInk,localeStrings:a.annotBarStrings,defaultToolType:S,watermarkData:{buttonId:ao,getWatermarkInfos:az},annotationMoreButtonId:ap,onToolChange:aA,onInkingAttributesUpdate:aB,addNewFreeText:ay}},[a.annotBarStrings,F,S,ao,az,ap,aA,aB,ay]),aE=h.useCallback(function(){switch(c){case aO.a.Edit:return h.createElement(Z,{ref:ak,hasEdits:M,filename:e,allowUnloadPageWithEdits:m,inkingToolbarProps:y&&Y?aD:void 0,onSave:av,onClose:at,onDiscard:aw,isFileVersionChanged:D});case aO.a.Extract:return h.createElement(ab,{ref:am,viewerRef:x,onSave:G,onClose:ax});default:return}},[c,M,e,m,y,Y,aD,av,at,aw,D,x,G,ax]),aF=h.useMemo(function(){return J&&(c===aO.a.Edit||c===aO.a.Extract)},[J,c]),aG=h.useMemo(function(){return aF&&f?f-46:f},[f,aF]);return h.createElement(w.a,{eventBus:ah.current,pdfViewer:ai,annotMode:null==V?void 0:V.mode,showPermissionBanner:aa,setShowPermissionBanner:ac,isPaidFeaturesEnabled:F},h.createElement("div",{className:"root_72829470",ref:aj,tabIndex:0},aF&&aE(),P&&h.createElement(o.a,{styles:{itemProgress:{padding:0}}}),h.createElement("div",{className:"mainWrapper_72829470"},h.createElement(a2,(0,d.q5)({},a,{ref:n,height:aG,annotParams:V,resetWatermarkAnnotParams:aC,hasAnnotationPermission:Y,onDocumentLoaded:ar,onEditStateChanged:as})),P&&h.createElement("div",{className:"saveModal_72829470"}))))});a5.displayName="PdfViewerAppRenderer";var a6=h.forwardRef(function(a,b){var c=h.useRef(null),e=h.useRef(null),f=h.useRef(null);return h.useImperativeHandle(b,function(){return{getViewer:function(){var a;return(null==(a=e.current)?void 0:a.getViewer())||null},print:function(a,b){return(0,d.yv)(void 0,void 0,void 0,function(){var c;return(0,d.SO)(this,function(d){return[2,null==(c=f.current)?void 0:c.print(a,b)]})})},onMouseMove:function(a){var b;return null==(b=c.current)?void 0:b.getEventHandlers().onMouseMove(a)},getThumbnailView:function(){var a;return null==(a=f.current)?void 0:a.getThumbnailView()},getToastOperation:function(){var a;return null==(a=f.current)?void 0:a.getToastOperation()}}}),h.createElement(a5,(0,d.q5)({},a,{mainRef:c,contentViewerRef:e,controlsRef:f}))});a6.displayName="PdfViewerAppInner";var a7=h.forwardRef(function(a,b){var c,i=(c=a.localeStrings,h.useMemo(function(){return c?{appStrings:(0,d.q5)((0,d.q5)({},c.app||{}),c.annotBar||{}),contentStrings:c.content||{},annotBarStrings:c.annotBar||{}}:{appStrings:void 0,contentStrings:void 0,annotBarStrings:void 0}},[c])),n=i.appStrings,o=i.contentStrings,p=i.annotBarStrings,q=(0,d.pM)(h.useState(),2),r=q[0],s=q[1],t=h.useRef(!1);h.useEffect(function(){return t.current=!0,function(){t.current=!1}},[]),h.useEffect(function(){(0,d.yv)(void 0,void 0,void 0,function(){var a,b;return(0,d.SO)(this,function(c){switch(c.label){case 0:if(b=n)return[3,2];return[4,(0,j.b)()];case 1:b=c.sent(),c.label=2;case 2:return a=b,t.current&&s(a),[2]}})})},[n]);var u=(0,g.a)(a.theme,a.darkMode);return h.createElement(e.a,{className:"root_58dd2d21",theme:(0,d.q5)({rtl:(0,f.a)()},u)},h.createElement(j.a,{strings:r},h.createElement(k.a,null,h.createElement(m.a,null,h.createElement(l.a,null,h.createElement(a6,(0,d.q5)({},a,{contentStrings:o,annotBarStrings:p,ref:b})))))))});a7.displayName="PdfViewerAppWithoutKey";var a8=h.forwardRef(function(a,b){return h.createElement(a7,(0,d.q5)({key:a.url,ref:b},a))});a8.displayName="PdfViewerApp"}
,(a,b,c)=>{"use strict";var d,e,f,g;c.d(b,{a:()=>e,b:()=>d}),(f=d||(d={}))[f.ANSI=0]="ANSI",f[f.ChineseSimplified=1]="ChineseSimplified",f[f.ChineseTraditional=2]="ChineseTraditional",f[f.Japanese=3]="Japanese",f[f.Korean=4]="Korean",f[f.Thai=5]="Thai",(g=e||(e={})).NotFound="NotFound",g.LoadedOndemandSucceed="LoadedOndemandSucceed",g.LoadedOndemandFailed="LoadedOndemandFailed",g.LoadedRequiredSucceed="LoadedRequiredSucceed",g.LoadedRequiredFailed="LoadedRequiredFailed"}
,(a,b,c)=>{"use strict";a.exports=c(484)}
,(a,b,c)=>{"use strict";c(235);var d=c("react-lib"),e=60103;if(b.Fragment=60107,"function"==typeof Symbol&&Symbol.for){var f=Symbol.for;e=f("react.element"),b.Fragment=f("react.fragment")}var g=d.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,h=Object.prototype.hasOwnProperty,i={key:!0,ref:!0,__self:!0,__source:!0};function j(a,b,c){var d,f={},j=null,k=null;for(d in void 0!==c&&(j=""+c),void 0!==b.key&&(j=""+b.key),void 0!==b.ref&&(k=b.ref),b)h.call(b,d)&&!i.hasOwnProperty(d)&&(f[d]=b[d]);if(a&&a.defaultProps)for(d in b=a.defaultProps)void 0===f[d]&&(f[d]=b[d]);return{$$typeof:e,type:a,key:j,ref:k,props:f,_owner:g.current}}b.jsx=j,b.jsxs=j}
,,,,(a,b,c)=>{"use strict";var d,e;c.r(b),c.d(b,{ToastActionStatus:()=>d}),(e=d||(d={}))[e.none=0]="none",e[e.inProcess=1]="inProcess",e[e.succeed=2]="succeed",e[e.error=3]="error"}
,(a,b,c)=>{"use strict";c.r(b),c.d(b,{saveCommandKey:()=>h});var d=c("odsp.util_126"),e=c(43);let f={actionProvider:c(190).a},g="saveCommand",h=new d.v7({name:"SaveCommand",factory:{dependencies:f,create:({actionProvider:a})=>({instance:{id:g,name:e.wb,title:e.Eb,automationId:g,iconProps:{iconName:"Save"},evaluateAction:a.evaluateAction}})}})}
,,,,,,,,,,,,,,,,,,,,,,,,,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>O,b:()=>M});var d=c("odsp.util_126"),e=c(102),f=c(518),g=c(519),h=c(264),i=c(272),j=c(17),k=c(275),l=c(98),m=c(0),n=c(521),o=c(107),p=c(10);class q{add(a,b){this._pageContextMap.set(JSON.stringify(a),b)}get(a){return this._pageContextMap.get(JSON.stringify(a))}constructor(){this._pageContextMap=new Map}}var r=c(4),s=c(280),t=c(281),u=c(543),v=c(882),w=c(2),x=c(422),y=c(20),z=c(163),A=c(16),B=c(883),C=c(32),D=c(875),E=c(444),F=c(113),G=c(109),H=c(49);let I=!d.Ov.isActivated("cc69c4e8-4b22-45b5-9f19-caec58f399d7","04/30/2024","if url is not right, log url for ppe "),J=!d.Ov.isActivated("6FFC1444-F0D6-4B94-8C4C-53D14CEF8F27","04/23/2025","updates navigation mode to single"),K=!d.Ov.isActivated("99C2BC64-9842-43D9-B0F3-D6327A18FE6F"),L=!d.Ov.isActivated("c5c958a0-fc85-4bc1-845d-170f349071aa");function M(a){try{let{idViewParam:b,parentViewParam:c,parentViewViewParam:e,listUrlViewParam:g,viewViewParam:s,webAbsoluteUrl:t,fullListUrl:F,serverRelativeFocusItemUrl:M,serverRelativeParentUrl:O,listContext:T,pageContext:U,cidViewParam:V,parIdViewParam:W}=(0,u.a)(a),X=new m.a({name:o.h}),Y=!(0,r.Vc)()&&a.consume(z.a);if(!(0,r.dc)()&&V&&!Y){let b=a.consume(y.a);if(!(0,x.a)(V)&&b.viewParams&&!b.viewParams.ls){let a=new A.b(window.location.href);a.setQueryParameter("ls","true"),b.navigateTo({url:a.toString(),ignoreHistory:!0})}}(0,r.cc)()&&J&&a.consume(p.f).updateNavMode("fastOneUpAdapter",p.d.single);let Z=(c||e||!(0,r.dc)()&&(!Y&&V||W))&&(b||g||s),$=!!I&&U.cloudType?.toLowerCase()==="spdf";if(Z)if(t&&F){let c=a.consume(v.a),e=b?M:void 0,g=new m.a({name:o.l});c.getCurrentItem().then(async c=>{if((0,r.Zb)()&&c&&c.ListData&&c.ListData.Row){let b=!0;if(c.ListData.Row.length>0&&c.ListData.Row[0].PermMask){let a=E.a.fromHexString(c.ListData.Row[0].PermMask);b=C.a.hasPermission(a,C.a.viewListItems)}b&&0!==c.ListData.Row.length||a.consume(p.f).updateIsNoAccessScenarioState("fastOneUpAdapter",!0)}if(c&&c.ListData&&c.ListData.Row&&c.ListData.Row.length>0&&c.ListSchema){a.consume(l.a).setBaseInfo({data:c.ListSchema,allowCookies:!1});let o=c.PageContextInfo?JSON.parse(c.PageContextInfo):void 0;if(o&&a.consume(p.f).setSiteHidePeoplePreviewingFiles("fastOneUpAdapter",!!o?.hidePeoplePreviewingFiles),!e&&F){let b=N({spGetFocusItemResponse:c,webAbsoluteUrl:t,listFullUrl:F,listContext:T,parentFolderPath:O,resourceScope:a});a.consume(j.b).update({focusItem:b,parentItem:b,focusItemSet:[b],list:b,currentIndex:0},"fastOneUpRLDS"),X.end({resultType:m.b.Success})}else if(U){let e=V&&!Y?(0,n.a)({response:c,id:M,odcId:b,listContext:T,qosEvent:g}):(0,n.a)({response:c,id:M,listContext:T,qosEvent:g});if(e.resultType===m.b.Success)try{let b=(0,B.a)({spGetItemResponse:c,webAbsoluteUrl:t,listFullUrl:F,listContext:T,parentFolderPath:O,resourceScope:a,currentPageContext:o});if(b){let d=a.consume(j.b),e=c.ListData&&c.ListData.Row&&c.ListData.Row[0];e&&(Q(a,e).catch(a=>{}),P(a).catch(a=>{}));let g=function(a){let{resourceScope:b,focusItemResponse:c}=a,{webAbsoluteUrl:d,fullListUrl:e,isRootFolder:g,listContext:j,serverRelativeParentUrl:l}=(0,u.a)(b),m={key:"",isPlaceholder:!0},{ParentUniqueId:n}=c.ListData&&c.ListData.Row&&c.ListData.Row[0]||{},o={ID:"",Editor:[],UniqueId:n},p=b.consume(h.a);if(d&&e)if(g&&c){let a,b,g=(0,f.a)(c),h=p.processOneUpItem({itemFromServer:K?o:void 0,spItemIdentity:{listFullUrl:e,rootFolder:"",webAbsoluteUrl:d},listContext:j,mediaTransformListSchema:g}),{ListData:l}=c,{FolderPermissions:n}=l||{};n&&(a=(0,k.a)(n));let q="root",r=l&&l.Row&&l.Row[0];if(r&&r[".spItemUrl"]){let{driveId:a}=(0,i.a)(r[".spItemUrl"]);b=a}(m={...h,itemId:q,...b?{graph:{itemId:q,driveId:b,sessionToken:h.graph?.sessionToken,sessionTokenV21:h.graph?.sessionTokenV21}}:{},folder:{},...a?{permissions:a}:{}}).isPlaceholder=!1}else{let a=(0,f.a)(c);m={...p.processOneUpItem({itemFromServer:K?o:void 0,spItemIdentity:{itemId:"",listFullUrl:e,webAbsoluteUrl:d,rootFolder:l},listContext:j,mediaTransformListSchema:a}),isPlaceholder:!0}}return m}({resourceScope:a,focusItemResponse:c}),l=N({spGetFocusItemResponse:c,webAbsoluteUrl:t,listFullUrl:F,listContext:T,parentFolderPath:O,resourceScope:a}),n=d.pageContexts;if(o){let a={webAbsoluteUrl:o.webAbsoluteUrl,listUrl:o.listUrl};n?n.add(a,o):(n=new q).add(a,o)}let p=a.consume(w.a),s={focusItem:b,focusItemSet:[b],parentItem:g,list:l,currentIndex:0,appLevelPageContext:p,pageContexts:n};d.update(s,"fastOneUpRLDS"),(0,r.Fb)()&&!D.a&&(o?.listBaseType===1||o?.listBaseTemplate===101)&&(document.title=b?.name||"SharePoint"),X.end({resultType:m.b.Success})}else X.end({resultType:m.b.Failure,error:"missing focusItem"}),S(a,new d.lM({code:"FastOneUp-NoFocusItem"}))}catch(b){X.end({resultType:m.b.Failure,error:b.message}),S(a,new d.lM({code:"FastOneUp-getOneUpItemException",innerError:b}))}else X.end(e),g.end(e),S(a,new d.lM({code:e.resultCode,extraData:e.extraData}))}else{let b="noPageContext";X.end({resultType:m.b.Failure,error:b}),g.end({resultType:m.b.Failure,error:b}),S(a,new d.lM({code:"FastOneUp-noPageContext"}))}}else{let b="no Row Data from RLDS",e=(0,r.bb)()?m.b.ExpectedFailure:m.b.Failure;if(X.end({resultType:e,error:b}),g.end({resultType:e,error:b}),L&&c?.ListData?.Row){let b=0===c.ListData.Row.length,d=a.consume(y.a),e=d.viewParams[G.b],f="true"===d.viewParams[G.a];if((0,H.a)()&&b&&e&&!f&&window?.location?.href){let c=new m.a({name:"OneUplightSpeed.mainlinkRedirectWithNoRowData"}),f=await R(a,b,e);if(f){c.end({resultType:m.b.Success}),d.navigateTo({url:f});return}c.end({resultType:m.b.Failure})}}S(a,new d.lM({code:"FastOneUp-NoRowData"}))}L&&function(a){let b=a.consume(y.a);if("true"===b.viewParams[G.a]){let a={...b.viewParams};delete a[G.a],b.updateViewParams(a,{ignoreHistory:!0,clearOtherParams:!0,UNSAFE_suppressChangeEvent:!0})}}(a)}).catch(b=>{X.end({resultType:m.b.Failure,error:b.message}),g.end({resultType:m.b.Failure,error:b.message}),S(a,new d.lM({code:"FastOneUp-getSingleItemException",innerError:b}))})}else t?F||(X.end({resultType:m.b.Failure,error:"no listFullUrl"}),S(a,new d.lM({code:"FastOneUp-noListFullUrl"}))):(X.end({resultType:m.b.Failure,error:"no webAbsoluteUrl"}),S(a,new d.lM({code:"FastOneUp-noWebAbsoluteUrl"})));else X.end({resultType:m.b.Failure,error:"no id, parent, parentview or listurl"}),c||e?S(a,new d.lM({code:"FastOneUp-noIdOrListurl",extraData:{url:$?window.location.href:void 0}})):S(a,new d.lM({code:"FastOneUp-noParent",extraData:{url:$?window.location.href:void 0}}))}catch(b){S(a,new d.lM({code:"FastOneUp-useAdapterException",innerError:b}))}}function N(a){let{webAbsoluteUrl:b,listFullUrl:c,listContext:g,resourceScope:i,spGetFocusItemResponse:j}=a,l=j.ListData&&j.ListData.Row&&j.ListData.Row[0],m=i.consume(h.a),n=j&&(0,f.a)(j),o=l&&l.PermMask?(0,k.a)(l.PermMask):void 0;if(j&&o){let a={list:function(a){let{AllowGridMode:b,DisableGridEditing:c,ListTemplateType:f,BasePermissions:{ManageLists:g,ManagePersonalViews:h,OpenItems:i,UseClientIntegration:j}={},ListSchema:{DefaultItemOpen:k}={},ExcludeFromOfflineClient:l,WebExcludeFromOfflineClient:m,ListData:n,listBaseType:o,Flags2:p,MachineLearningCaptureEnabled:q,MachineLearningExperienceEnabled:r,AIBuilderEnabled:s,AIBuilderDefaultPowerAppsEnvironment:t,Color:u,Icon:v,ListUrl:w,listUrlDir:x}=a,y=w||x&&decodeURIComponent(x);return{id:(0,d.YR)(a.listName),title:a.ListTitle,flags2:p,machineLearningCaptureEnabled:q,machineLearningExperienceEnabled:r,aiBuilderEnabled:s,aiBuilderDefaultPowerAppsEnvironment:t,allowGridMode:"boolean"!=typeof b||b,allowCreateFolder:a.AllowCreateFolder,disableCommenting:"boolean"==typeof a.DisableCommenting&&a.DisableCommenting,disableGridEditing:"boolean"==typeof c&&c,enableMinorVersions:a.EnableMinorVersions,enableVersions:a.verEnabled,templateType:"string"==typeof f?Number(f):void 0,isDocumentLibrary:(0,e.b)(String(o)),isPromotedLinks:"string"==typeof f?(0,e.e)(f):void 0,isForceCheckout:a.isForceCheckout,isModerated:a.isModerated,enableRequestSignOff:a.EnableRequestSignOff,newWOPIDocumentEnabled:a.NewWOPIDocumentEnabled,newWOPIDocumentTypes:a.NewWOPIDocumentTypes,permissions:{manageLists:g,managePersonalViews:h,openItems:i,useClientIntegration:j},openInClient:"string"==typeof k?"0"===k:void 0,excludeFromOfflineClient:"boolean"==typeof l||"boolean"==typeof m?l||m:void 0,contentTypesEnabled:a.ContentTypesEnabled,metadataNavFeatureEnabled:a.metadataNavFeatureEnabled,canUserCreateMicrosoftForm:a.canUserCreateMicrosoftForm,itemCount:a.ListSchema&&a.ListSchema.ItemCount,rowLimit:n&&n.RowLimit,canShareLinkForNewDocument:a.CanShareLinkForNewDocument,enableAttachments:"true"===a.EnableAttachments,createdFromExcel:a.CreatedFromExcel,createdFromExisting:a.CreatedFromExisting,icon:"string"==typeof v?Number(v):void 0,color:"string"==typeof u?Number(u):void 0,lastItemModifiedTime:a.lastItemModifiedTime,tick:a.tick,modernListTemplateTypeId:a.ModernListTemplateTypeId,readSecurity:a.ListSchema&&a.ListSchema.ReadSecurity,listUrlDir:y,hasPendingBusinessAppMigration:a.hasPendingBusinessAppMigration,modernTemplatesInfo:void 0!==a.IsModernTemplateLinked?{containsTemplates:a.IsModernTemplateLinked,containsListExclusiveTemplates:a.HasListExclusiveModernTemplates||!1}:void 0}}(j),permissions:o,mediaTransform:n};return m.processOneUpListRootItem({spItemIdentity:{itemId:"",listFullUrl:c,rootFolder:"",webAbsoluteUrl:b},listContext:g,oneUpListInfo:a})}}function O(a){let b=new m.a({name:o.j}),c=a.consume(p.f);try{let d=a.consume(j.b),e=d.getOneUpProperties();if(e&&(!e.parentItem||e.parentItem.isPlaceholder)){let{webAbsoluteUrl:f,fullListUrl:h,serverRelativeParentUrl:i,isRootFolder:j,listContext:k,pageContext:o}=(0,u.a)(a);i&&f&&h&&!j&&new g.a({pageContext:o,id:i,webAbsoluteUrl:f,listFullUrl:h,listContext:k}).getSingleItem(!0).then(g=>{if(g&&g.ListData&&g.ListData.Row&&g.ListData.Row.length>0&&g.ListSchema){if(a.consume(l.a).setBaseInfo({data:g.ListSchema,allowCookies:!1}),o&&(0,n.a)({response:g,id:i||"",listContext:k,qosEvent:b}))try{let b=(0,B.a)({spGetItemResponse:g,webAbsoluteUrl:f,listFullUrl:h,listContext:k,parentFolderPath:void 0,resourceScope:a});b&&(d.update({...e,parentItem:b},"fastOneUpRLDS"),c.updateParentPermissionValidity("ensureParentItem",!0))}catch(d){let a=d instanceof Error?d:Error(d);b.end({resultType:m.b.Failure,error:a.message}),c.updateParentPermissionValidity("ensureParentItem",!1)}}else b.end({resultType:m.b.Failure,error:"no Row Data from RLDS"}),c.updateParentPermissionValidity("ensureParentItem",!1)}).catch(a=>{b.end({resultType:m.b.Failure,error:a.message}),c.updateParentPermissionValidity("ensureParentItem",!1)})}}catch(d){let a=d instanceof Error?d:Error(d);b.end({resultType:m.b.Failure,error:a.message}),c.updateParentPermissionValidity("ensureParentItem",!1)}}async function P(a){if(a.consume(w.a).isAnonymousGuestUser||(0,r.Tc)())return;let b=await a.consumeAsync(t.a),c=await b.hasValidLicenseCached();a.consume(p.f).updateIsUniversalPrintLicenseValidState("fastOneUpAdapter",c)}async function Q(a,b){if(a.consume(s.a)){let d=new m.a({name:o.k});(async()=>await c.e(20).then(c.bind(c,788)).then(({favoritesDataManagerKey:c})=>{let e=a.consume(c);return e.populateFavorites().then(c=>{let f=b?.UniqueId;if(f&&-1!==f.indexOf("{")&&(f=f.replace("{","").replace("}","").toLowerCase()),d.end({resultType:m.b.Success}),c&&f){let b=e.isFavorited(f);return a.consume(p.f).setIsFocusItemFavorited("fastoneUpAdapater",b),b}}).catch(a=>{d.end({resultType:m.b.Failure,error:a.message,extraData:{rawError:a}})})}).catch(a=>{d.end({resultType:m.b.Failure,error:a.message,extraData:{rawError:a}})}))().catch(a=>{d.end({resultType:m.b.Failure,error:a.message,extraData:{rawError:a}})})}}async function R(a,b,c){try{if(b&&c&&window?.location?.href){let b=a.consume(F.a),{listItemUniqueId:d,siteUrl:e}=(await b.getItemBySharingLink(window.location.href)).sharepointIds||{};if(d&&e)return`${e}/_layouts/15/viewer.aspx?sourcedoc=${d}&${G.b}=${c}&${G.a}=true`}}catch(a){}}function S(a,b,c){let d=a.consume(p.f);(0,r.Zb)()&&d.currentAppState.isNoAccessScenario?d.updateErrorState("fastOneUpAdapterException",{errorType:o.d.rldsApiErrorNoAccess,error:b,item:void 0,extraData:c}):d.updateErrorState("fastOneUpAdapterException",{errorType:o.d.rldsApiError,error:b,item:void 0,extraData:c})}}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>e});let d=[".accessToken",".callerStack",".correlationId",".driveAccessToken",".driveAccessTokenV21",".driveAccessCode",".driveAccessCodeV21",".driveUrl",".mediaBaseUrl",".officeBundleGenerate",".officeBundleGetFragment",".pdfConversionUrl",".pushChannelBaseUrl",".thumbnailUrl",".transformUrl",".videoManifestUrl"];function e(a){let b={},c=a.ListSchema;if(c)for(let a of d){let d=c[a];d&&".mediaBaseUrl"===a&&(d=d.replace("https://media.cloudapp.net",window.__mediaBaseUrl||"https://northcentralus1-medias.svc.ms")),b[a]=d}return b}}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>n});var d,e,f=c(104),g=c(0),h=c(522),i=c(260),j=c(521),k=c(107),l=c(4),m=c(262);(d=e||(e={})).preload="preload",d.callRLDS="callRLDS";class n extends f.b{getSingleItem(a=!1){let b=new g.a({name:k.m,extraData:{...this._extraLoggingData}});if(!this._listContext)throw Error("no listContext");if(a||!window.g_listData)return this._racePrefetchAndRLDSAPI(b).then(a=>a.response);if(this._id){if((0,j.a)({response:window.g_listData,id:this._id,listContext:this._listContext,qosEvent:b,extraData:{isRace:!1}}).resultType===g.b.Success)return Promise.resolve(window.g_listData);{let a=new g.a({name:k.f,extraData:{...this._extraLoggingData}});return this._retriever.getItem(this._getContext(),this._listContext,{qosEvent:a,qosName:k.f})}}throw Error("noItemId")}_racePrefetchAndRLDSAPI(a){let b=new Promise((a,b)=>{window.DeferredListDataComplete=()=>{if(this._id&&window.g_listData)if((0,j.a)({response:window.g_listData,id:this._id,listContext:this._listContext}).resultType===g.b.Success)a({response:window.g_listData,type:"preload"});else throw Error("incorrect g_listData");else throw Error("no g_listData")}}),c=new g.a({name:k.n,extraData:{...this._extraLoggingData}});return Promise.race([b,this._retriever.getItem(this._getContext(),this._listContext,{qosEvent:c,qosName:k.n}).then(a=>({response:a,type:"callRLDS"}))]).then(b=>("preload"===b.type?a.end({resultType:g.b.Success,extraData:{isRace:!0}}):"callRLDS"===b.type&&a.end({resultType:g.b.Failure,extraData:{isRace:!0,reason:"callRLDAS wins"}}),b))}_getContext(){let a;if(!(0,l.dc)()&&this._odcId){let{itemId:b,itemUniqueId:c}=(0,m.a)(this._odcId);a=i.b({itemIds:this._getItemIds(c,b),itemRefs:void 0,pageSize:1,recurseInFolders:!0,requestMetaInfo:!0,requestCommentFlags:!0})}else a=this._id?i.b({sortField:void 0,itemIds:void 0,itemRefs:[this._id],isAscending:void 0,recurseInFolders:!0,requestMetaInfo:!0,requestCommentFlags:!0,pageSize:1}):i.b({itemIds:void 0,itemRefs:void 0,pageSize:0,recurseInFolders:!0,fieldNames:["File_x0020_Type","FileRef","FileLeafRef","Editor","Author","PrincipalCount","Title"]});return this._id?{parentKey:"",isOnePageNavigation:!1,skipServiceWorkerCache:!1,needSchema:!0,postDataContext:{disableAutoHyperlink:!1,isListDataRenderOptionChangeFeatureEnabled:!0,isSpotlightFeatureEnabled:!0,needClientSideComponentManifest:!1,needUpdatePageContext:!0,needsContentTypeOrder:!0,needsContentTypes:!1,needsForms:!1,needsGridInitInfo:!1,needsListAvailableContentTypes:!0,needsMountPoint:!0,needsParentInfo:!0,needsQuickLaunch:!1,needsSchema:!0,needsSpotlight:!0,needsViewMetadata:!0,renderCustomActions:!0,renderSpfxCustomActions:!1,preAuthorizedDownloadUrl:!0,requireDownloadUrlNoAuth:!0,viewXml:a}}:{parentKey:"",isOnePageNavigation:!1,skipServiceWorkerCache:!1,needSchema:!0,postDataContext:{isListDataRenderOptionChangeFeatureEnabled:!0,isSpotlightFeatureEnabled:!0,needsSchema:!0,needUpdatePageContext:!0,needsMountPoint:!0,requireFolderColoringFields:!0,viewXml:a}}}constructor(a){super({dataSourceName:"OneUpRLDS"},{pageContext:a.pageContext}),this._getItemIds=(a,b)=>a?[a]:b?[b]:void 0,this._id=a.id,this._odcId=a.odcId,this._retriever=new h.a({pageContext:a.pageContext}),this._listContext=a.listContext,this._extraLoggingData=a.extraLoggingData}}}
,,(a,b,c)=>{"use strict";c.d(b,{a:()=>h});var d=c(0),e=c(31),f=c(4),g=c(262);function h(a){let b,{response:c,id:h,odcId:i,listContext:j,qosEvent:k,extraData:l}=a;if(c&&c.ListData&&c.ListData.Row){let a=c.ListData.Row;if(1===a.length){let k,m,n=a[0],o=n.FileRef?.toLowerCase()===h.toLowerCase()&&c.ListUrl?.toLowerCase()===j?.listUrl?.toLowerCase();if(!(0,f.dc)()&&i){let{itemId:a,itemUniqueId:b}=(0,g.a)(i);k=!!b&&!!n.UniqueId&&e.a.normalizeLower(e.a.normalizeDashes(n.UniqueId,!1))===e.a.normalizeLower(e.a.normalizeDashes(b,!1)),m=!!a&&n.Id===a}b=o||k||m?{resultType:d.b.Success}:{resultType:d.b.Failure,resultCode:"idFileRefMismatch",extraData:{...l,serverFileRef:n.FileRef,fileId:h,serverlistUrl:c.ListUrl,fileListUrl:j?.listUrl}}}else b={resultType:d.b.Failure,resultCode:"wrongRowDataLength",extraData:{...l,rowDataLength:a.length}}}else b={resultType:d.b.Failure,resultCode:"noRowData",extraData:{...l}};return k?.end(b),b}}
,,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>d});let d="photosData"}
,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>f});var d=c(13),e=c("odsp.util_126");function f(a){let{oneUpProps:b,appPageContext:c,item:f}=a,g=new d.b({context:c}),{id:h,listurl:i}=(0,e.pW)(f.key),j=g.getUrlParts({listUrl:i,path:h}),k=j.fullWebUrl;if(k&&j.serverRelativeListUrl){let a={webAbsoluteUrl:k,listUrl:j.serverRelativeListUrl};return b?.pageContexts?.get(a)}}}
,(a,b,c)=>{"use strict";function d(){return window.$oneup||(window.$oneup={isDebugMode:!1,stores:{},debug:function(){return this.isDebugMode=!this.isDebugMode},attachStores:function(a){this.stores=Object.assign(this.stores,a)}}),window.$oneup}c.d(b,{a:()=>d})}
,,,,,,,,,,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>j});var d=c(15),e=c(22),f=c(20),g=c(2),h=c(6),i=c(4);function j(a){let b,c=a.consume(f.a),j=a.consume(g.a),k=c.viewParams,l=k[e.b.idParamKey],m=k[e.b.parentIdParamKey],n=k[e.b.parentQueryTypeParamKey],o=k[e.b.queryTypeParamKey],p=k[e.b.listUrlKey];if((0,i.gb)()&&window.g_oneUpPathAndQueryString){let a=new URL(window.g_oneUpPathAndQueryString);if(a.searchParams&&a.searchParams.get("ga")){let b=a.searchParams?.get("id");b&&(l=b),(b=a.searchParams?.get("parent"))&&(m=b),(b=a.searchParams?.get("parentview"))&&(n=b),(b=a.searchParams?.get("view"))&&(o=b),(b=a.searchParams?.get("listurl"))&&(p=b)}}let q=m,r=a.consume(d.c),s=r.getUrlParts({path:l,listUrl:p}),t=s.fullItemUrl?new h.a(s.fullItemUrl):void 0;q?b=r.getUrlParts({path:b,listUrl:p}).fullItemUrl:(b=t?`${t.authority}${t.segments.slice(0,-1).join("/")}`:void 0,q=r.getUrlParts({path:b,listUrl:p}).serverRelativeItemUrl);let u=r.getUrlParts({path:q,listUrl:p}),v=s.fullWebUrl,w=s.fullListUrl,x={listUrl:s.serverRelativeListUrl,needSchema:!0,urlParts:s},y=s.fullItemUrl,z=!(q=u.serverRelativeItemUrl!==u.serverRelativeListUrl&&u.fullItemUrl!==v&&"/"!==u.serverRelativeListUrl&&u.serverRelativeItemUrl||"")||!!q&&w===u.fullItemUrl;return{idViewParam:l,parentViewParam:m,parentViewViewParam:n,listUrlViewParam:p,viewViewParam:o,webAbsoluteUrl:v,fullListUrl:w,serverRelativeListUrl:s.serverRelativeListUrl,fullFocusItemUrl:y,serverRelativeFocusItemUrl:s.serverRelativeItemUrl,fullParentUrl:b,serverRelativeParentUrl:q,isRootFolder:z,listContext:x,pageContext:j,cidViewParam:k[e.b.cid],parIdViewParam:k.parId}}}
,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>e});var d=c(47);class e{getValue(a,b){let c=this._store.getValue(a);if(c?.expiration&&b<c.expiration)return c;this._store.remove(a)}setValue(a,b){b?b.expiration&&b.value&&this._store.setValue(a,b):this._store.remove(a)}constructor(a){const{userId:b,cachingType:c}=a;this._store=new d.a(`Identity.OAuth.${b}`,c)}}}
,,,,,,,,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>i,b:()=>l,c:()=>j});var d=c(48),e=c(9),f=c(23),g=c("odsp.util_126"),h=c(0);function i(a,b,c){return e.c.all([k(a),k(a,c)]).then(([a,c])=>{let d=c.length>a.length;return{text:d?a:c,mimeType:b,isSafeText:d||function(a){for(let c=0;c<a.length;c++){var b;if(!((b=a.charCodeAt(c))<127||m[b]))return!1}return!0}(c)}},a=>a.filter(a=>!e.c.isCanceled(a))[0]||a[0])}function j(a,b){return k(a).then(a=>({text:a,mimeType:b,isSafeText:!0}))}function k(a,b){let c=new d.b,e=new FileReader,f=new h.a({name:"FileContentHelper.parseFile"});return e.onload=()=>{c.complete(e.result||""),f.end({resultType:h.b.Success})},e.onerror=a=>{let b=new g.lM({code:"FileContentHelperParseBlobFailure",innerError:e.error,message:e.error?.message||"FileContentHelperParseBlobGenericFailure"});f.end({resultType:h.b.Failure,extraData:{error:b}})},e.readAsText(a,b),c.getPromise()}function l(a,b){return -1===b.search(/^http/)||b.lastIndexOf(":")===b.indexOf(":")&&0>b.indexOf("/content?format=")||b.indexOf(":/content?")>=0?b:`${b.indexOf("/content?format=")>=0?`${b}`:`${b}:/content?`}${(0,f.a)(a)}`}let m={130:1,132:1,133:1,134:1,135:1,137:1,139:1,145:1,146:1,147:1,148:1,149:1,150:1,151:1,153:1,155:1,160:1,166:1,167:1,169:1,171:1,172:1,173:1,174:1,176:1,177:1,181:1,182:1,183:1,187:1}}
,,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>e,b:()=>f});var d=c("odsp.util_126");let e={Modified:"modified",ExitEdit:"exitEdit"},f=new d.v7({name:"PdfEmbedHelper.key",loader:new d.dE(()=>c.e(66).then(c.bind(c,802)).then(a=>a.resourceKey))})}
,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>o,b:()=>p,c:()=>r,d:()=>q});var d=c("react-lib"),e=c.n(d),f=c(567),g=c(207),h=c(308),i=c(64),j=c(569),k=c(307),l=c(171),m=c("odsp.util_126"),n=c(117);let o=()=>e().useContext(f.a),p=()=>e().useContext(f.b),q=a=>{let b=e().useCallback((b,c)=>{let d=a?.current?.getToastOperation();d?.({type:g.b.Running,text:b,percentComplete:c/100})},[a]),c=e().useCallback((b,c,d=!1)=>{let e=a?.current?.getToastOperation();e?.({type:g.b.Success,text:b,link:c,linkText:l.g,disableAutoHide:d,onClickClose:()=>{e?.({type:g.b.Hidden})}})},[a]),d=e().useCallback(b=>{let c=a?.current?.getToastOperation();c?.({type:g.b.Error,text:b,onClickClose:()=>{c?.({type:g.b.Hidden})}})},[a]);return e().useCallback(async a=>{let e=0,f=0,g=new h.d({name:a.scenarioName});try{e=window.setInterval(()=>{if(100-f>10){f+=10,b(a.runningText,f);return}f=Math.floor((100-f)/4)+f,b(a.runningText,f)},200),a.telemetryHandler?.logQosStart(g),a.before?.();let d=await a.runner();clearInterval(e),c(a.successText,d,a.disableAutoHide),a.telemetryHandler?.logQosEnd(new h.c(g.payload.id,a.scenarioName,i.b.Succeed,{}))}catch(o){let b;clearInterval(e);let c=!1,f=a.failedText;o instanceof k.d&&o.type===k.c.ExceedsMaximumLength&&(c=!0,f=m.rz(l.w,o.url.length)),!(0,n.g)()&&o instanceof k.b&&void 0!==o.code&&(b=(0,j.a)(o.code),o.code===k.a.UnableFurtherCompression&&(f=l.x)),d(f),a.telemetryHandler?.logQosEnd(new h.c(g.payload.id,a.scenarioName,i.b.Fail,{isExpected:c,error:o,code:b}))}finally{a.after?.()}},[b,c,d])},r=a=>e().useCallback(async(b,c)=>{let d;if(!a)throw new k.b("Manipulator is not ready in PDF engine");let{newFileName:e,items:f}=b;(0,k.h)(e,f[0]);try{d=await c()}catch(a){throw new k.b(`Manipulator runtime error: ${a.message}`)}if(!d)throw new k.b("Manipulator is not ready in PDF engine");let[g,h]=d;if(0!==g)if((0,n.g)())throw new k.b(`Fail to manipulate PDF from PDF Parser, code=${g}`);else throw new k.b(`Fail to manipulate PDF from PDF Parser, code=${g}`,g);return a(new File([new Blob([h],{type:"application/pdf"})],`${e}.pdf`,{type:"application/pdf"}),f[0])},[a])}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>e,b:()=>f});var d=c("react-lib");let e=(0,d.createContext)(()=>{throw Error("closeFilePickerCtx call out of context scope")}),f=(0,d.createContext)(()=>{throw Error("confirmFilePickerCtx call out of context scope")})}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>f});var d,e=new Uint8Array(16);function f(){if(!d&&!(d="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return d(e)}}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>e});var d=new Map([[0,"Task_Success"],[1,"Task_Cancelled"],[2,"Task_Failed"],[3,"Wrong_Password"],[4,"Unsupported_Encryption_Algorithm"],[5,"Permission_Denied"],[6,"File_Corrupted"],[7,"Page_Index_Out_Of_Range"],[8,"Save_Path_Invalid"],[9,"File_With_XFA"],[10,"Unsupported_AcroForm_Pattern"],[11,"Unexpected_File_Size"],[12,"Invalid_Argument"],[13,"Unable_Further_Compression"]]);function e(a){return d.get(a)||"Unknown_".concat(a)}}
,,,,,,,,,,,,,,,,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>d});var d=function(){function a(){}return a.getTempAuthLogFields=function(a,b){if(!a)return{};var c=function(a){try{var b=new URL(a.toLowerCase()).searchParams,d=b.get("tempauth"),e=b.get("access_token"),f=b.get("docid");if(d&&"false"!==d||e&&"false"!==e)return!0;if(f)return c(decodeURI(f));return!1}catch(a){return}},d=c(a);return void 0!==d?{noTempAuth:!d,useToken:!!b}:{useToken:!!b}},a}()}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>f,b:()=>g});var d=c(84),e=c(342),f=function(a){var b=new d.a(a.origin.x,a.origin.y);return{image:a.image,origin:b.scale(1/(0,e.a)()),triggerType:a.triggerType}},g=function(a,b,c,e,f){return new d.b(a,b,c-a,e-b).scale(f||1)}}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>e});var d=c("tslib_533");let e=()=>(0,d.yv)(void 0,void 0,void 0,function*(){return Promise.all([c.e("odsp.react.lib"),c.e(28)]).then(c.bind(c,821))})}
,(a,b,c)=>{"use strict";var d,e;c.d(b,{a:()=>d}),(e=d||(d={})).Space=" ",e.Tab="Tab",e.Home="Home",e.Enter="Enter",e.End="End",e.ArrowUp="ArrowUp",e.ArrowDown="ArrowDown",e.ArrowLeft="ArrowLeft",e.ArrowRight="ArrowRight",e.Escape="Escape",e.Delete="Delete"}
,,,,,,,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>m,b:()=>l,c:()=>k});var d=c(118),e=c(289),f=c("odsp.util_126"),g=c(602),h=c(303);let i=!f.Ov.isActivated("e33725dc-ac48-468a-91e4-c333939ac75f"),j=/&(?:access_|proof)token=[^&]*/g;async function k(a){let b,{resources:c,thumbnailUrl:e,isRetry:j,forceRefresh:k=!1,isMeTA:m,isMeTATempAuthDeprecationEnabled:n}=a;if(!e)return{error:Error("ThumbnailUrl is empty")};if(m){let a=c.consume(h.a);b=await a({forceRefresh:k})}try{let a=await fetch(e||"",{headers:b,cache:i?"no-cache":void 0}),{status:h}=a;if(200===h)return{file:await a.blob()};{if((401===h||400===h)&&!j){let a=e;if(n||(a=await p(c,e)),a)return l({resources:c,thumbnailUrl:a,isRetry:!0,forceRefresh:!0,isMeTA:m,isMeTATempAuthDeprecationEnabled:n})}let{correlationId:b,errorCode:i,region:k}=(0,d.c)(a);return{error:new f.lM({isExpected:(0,g.a)(a),code:`${h.toString()}_${i||"UrlFetchException"}`,correlationId:b,extraData:{region:k}})}}}catch(a){return{error:a}}}async function l(a){let{file:b,error:c}=await k(a);return b?{blobUrl:URL.createObjectURL(b),error:c}:{error:c}}function m(a,b){let c="isExpected"in a?!!a.isExpected:void 0,d="correlationId"in a?a.correlationId:void 0,e=n(a),g=n(b),h=o(a),i=o(b);return new f.lM({isExpected:c,code:`${e}_${g}`,correlationId:d,extraData:{...h,...i}})}function n(a){return"code"in a?a.code:`${a.name}: ${a.message}`}function o(a){return"extraData"in a?a.extraData:void 0}async function p(a,b){try{let c=await a.consumeAsync(e.a),d=await c.refreshAuthToken();if(d){let{authToken:a,proofToken:c}=d;return b.replace(j,`&access_token=${a}${c?`&prooftoken=${c}`:""}`)}}catch(a){return}}}
,(a,b,c)=>{"use strict";function d(a){var b;return a.ok||(b=a.status)>=400&&b<500}c.d(b,{a:()=>d})}
,,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>f});var d=c(608),e=c("odsp.util_126");function f(a){let{item:b,currentPageContext:c,appPageContext:f}=a;if(b){let a=b.properties?.uniqueId,g=b.displayName;if(b.id&&a&&g){let h=(0,e.YR)(c?.siteId,!1)||(0,e.YR)(f.siteId,!1),i=(0,e.YR)(c?.webId,!1)||(0,e.YR)(f.webId,!1),j=(0,e.YR)(c?.listId,!1)||(0,e.YR)(f.listId,!1),k=[{id:b.id,name:g,sharepointIds:{siteId:h,webId:i,listId:j,listItemUniqueId:a}}],l=(0,d.a)(k);return l&&l[0]}}}}
,,,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>aj,b:()=>al,c:()=>ad,d:()=>ag,e:()=>ai,f:()=>ak,g:()=>ae,h:()=>af,i:()=>ah});let d=["top","right","bottom","left"],e=Math.min,f=Math.max,g=Math.round,h=a=>({x:a,y:a}),i={left:"right",right:"left",bottom:"top",top:"bottom"},j={start:"end",end:"start"};function k(a,b){return"function"==typeof a?a(b):a}function l(a){return a.split("-")[0]}function m(a){return a.split("-")[1]}function n(a){return"x"===a?"y":"x"}function o(a){return"y"===a?"height":"width"}function p(a){return["top","bottom"].includes(l(a))?"y":"x"}function q(a){return a.replace(/start|end/g,a=>j[a])}function r(a){return a.replace(/left|right|bottom|top/g,a=>i[a])}function s(a){return"number"!=typeof a?{top:0,right:0,bottom:0,left:0,...a}:{top:a,right:a,bottom:a,left:a}}function t(a){let{x:b,y:c,width:d,height:e}=a;return{width:d,height:e,top:c,left:b,right:b+d,bottom:c+e,x:b,y:c}}function u(a,b,c){let d,{reference:e,floating:f}=a,g=p(b),h=n(p(b)),i=o(h),j=l(b),k="y"===g,q=e.x+e.width/2-f.width/2,r=e.y+e.height/2-f.height/2,s=e[i]/2-f[i]/2;switch(j){case"top":d={x:q,y:e.y-f.height};break;case"bottom":d={x:q,y:e.y+e.height};break;case"right":d={x:e.x+e.width,y:r};break;case"left":d={x:e.x-f.width,y:r};break;default:d={x:e.x,y:e.y}}switch(m(b)){case"start":d[h]-=s*(c&&k?-1:1);break;case"end":d[h]+=s*(c&&k?-1:1)}return d}let v=async(a,b,c)=>{let{placement:d="bottom",strategy:e="absolute",middleware:f=[],platform:g}=c,h=f.filter(Boolean),i=await (null==g.isRTL?void 0:g.isRTL(b)),j=await g.getElementRects({reference:a,floating:b,strategy:e}),{x:k,y:l}=u(j,d,i),m=d,n={},o=0;for(let c=0;c<h.length;c++){let{name:f,fn:p}=h[c],{x:q,y:r,data:s,reset:t}=await p({x:k,y:l,initialPlacement:d,placement:m,strategy:e,middlewareData:n,rects:j,platform:g,elements:{reference:a,floating:b}});k=null!=q?q:k,l=null!=r?r:l,n={...n,[f]:{...n[f],...s}},t&&o<=50&&(o++,"object"==typeof t&&(t.placement&&(m=t.placement),t.rects&&(j=!0===t.rects?await g.getElementRects({reference:a,floating:b,strategy:e}):t.rects),{x:k,y:l}=u(j,m,i)),c=-1)}return{x:k,y:l,placement:m,strategy:e,middlewareData:n}};async function w(a,b){var c;void 0===b&&(b={});let{x:d,y:e,platform:f,rects:g,elements:h,strategy:i}=a,{boundary:j="clippingAncestors",rootBoundary:l="viewport",elementContext:m="floating",altBoundary:n=!1,padding:o=0}=k(b,a),p=s(o),q=h[n?"floating"===m?"reference":"floating":m],r=t(await f.getClippingRect({element:null==(c=await (null==f.isElement?void 0:f.isElement(q)))||c?q:q.contextElement||await (null==f.getDocumentElement?void 0:f.getDocumentElement(h.floating)),boundary:j,rootBoundary:l,strategy:i})),u="floating"===m?{...g.floating,x:d,y:e}:g.reference,v=await (null==f.getOffsetParent?void 0:f.getOffsetParent(h.floating)),w=await (null==f.isElement?void 0:f.isElement(v))&&await (null==f.getScale?void 0:f.getScale(v))||{x:1,y:1},x=t(f.convertOffsetParentRelativeRectToViewportRelativeRect?await f.convertOffsetParentRelativeRectToViewportRelativeRect({elements:h,rect:u,offsetParent:v,strategy:i}):u);return{top:(r.top-x.top+p.top)/w.y,bottom:(x.bottom-r.bottom+p.bottom)/w.y,left:(r.left-x.left+p.left)/w.x,right:(x.right-r.right+p.right)/w.x}}function x(a,b){return{top:a.top-b.height,right:a.right-b.width,bottom:a.bottom-b.height,left:a.left-b.width}}function y(a){return d.some(b=>a[b]>=0)}async function z(a,b){let{placement:c,platform:d,elements:e}=a,f=await (null==d.isRTL?void 0:d.isRTL(e.floating)),g=l(c),h=m(c),i="y"===p(c),j=["left","top"].includes(g)?-1:1,n=f&&i?-1:1,o=k(b,a),{mainAxis:q,crossAxis:r,alignmentAxis:s}="number"==typeof o?{mainAxis:o,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...o};return h&&"number"==typeof s&&(r="end"===h?-1*s:s),i?{x:r*n,y:q*j}:{x:q*j,y:r*n}}function A(){return"undefined"!=typeof window}function B(a){return E(a)?(a.nodeName||"").toLowerCase():"#document"}function C(a){var b;return(null==a||null==(b=a.ownerDocument)?void 0:b.defaultView)||window}function D(a){var b;return null==(b=(E(a)?a.ownerDocument:a.document)||window.document)?void 0:b.documentElement}function E(a){return!!A()&&(a instanceof Node||a instanceof C(a).Node)}function F(a){return!!A()&&(a instanceof Element||a instanceof C(a).Element)}function G(a){return!!A()&&(a instanceof HTMLElement||a instanceof C(a).HTMLElement)}function H(a){return!!A()&&"undefined"!=typeof ShadowRoot&&(a instanceof ShadowRoot||a instanceof C(a).ShadowRoot)}function I(a){let{overflow:b,overflowX:c,overflowY:d,display:e}=N(a);return/auto|scroll|overlay|hidden|clip/.test(b+d+c)&&!["inline","contents"].includes(e)}function J(a){return[":popover-open",":modal"].some(b=>{try{return a.matches(b)}catch(a){return!1}})}function K(a){let b=L(),c=F(a)?N(a):a;return["transform","translate","scale","rotate","perspective"].some(a=>!!c[a]&&"none"!==c[a])||!!c.containerType&&"normal"!==c.containerType||!b&&!!c.backdropFilter&&"none"!==c.backdropFilter||!b&&!!c.filter&&"none"!==c.filter||["transform","translate","scale","rotate","perspective","filter"].some(a=>(c.willChange||"").includes(a))||["paint","layout","strict","content"].some(a=>(c.contain||"").includes(a))}function L(){return"undefined"!=typeof CSS&&!!CSS.supports&&CSS.supports("-webkit-backdrop-filter","none")}function M(a){return["html","body","#document"].includes(B(a))}function N(a){return C(a).getComputedStyle(a)}function O(a){return F(a)?{scrollLeft:a.scrollLeft,scrollTop:a.scrollTop}:{scrollLeft:a.scrollX,scrollTop:a.scrollY}}function P(a){if("html"===B(a))return a;let b=a.assignedSlot||a.parentNode||H(a)&&a.host||D(a);return H(b)?b.host:b}function Q(a){return a.parent&&Object.getPrototypeOf(a.parent)?a.frameElement:null}function R(a){let b=N(a),c=parseFloat(b.width)||0,d=parseFloat(b.height)||0,e=G(a),f=e?a.offsetWidth:c,h=e?a.offsetHeight:d,i=g(c)!==f||g(d)!==h;return i&&(c=f,d=h),{width:c,height:d,$:i}}function S(a){return F(a)?a:a.contextElement}function T(a){let b=S(a);if(!G(b))return h(1);let c=b.getBoundingClientRect(),{width:d,height:e,$:f}=R(b),i=(f?g(c.width):c.width)/d,j=(f?g(c.height):c.height)/e;return i&&Number.isFinite(i)||(i=1),j&&Number.isFinite(j)||(j=1),{x:i,y:j}}let U=h(0);function V(a){let b=C(a);return L()&&b.visualViewport?{x:b.visualViewport.offsetLeft,y:b.visualViewport.offsetTop}:U}function W(a,b,c,d){var e;void 0===b&&(b=!1),void 0===c&&(c=!1);let f=a.getBoundingClientRect(),g=S(a),i=h(1);b&&(d?F(d)&&(i=T(d)):i=T(a));let j=(void 0===(e=c)&&(e=!1),d&&(!e||d===C(g))&&e)?V(g):h(0),k=(f.left+j.x)/i.x,l=(f.top+j.y)/i.y,m=f.width/i.x,n=f.height/i.y;if(g){let a=C(g),b=d&&F(d)?C(d):d,c=a,e=Q(c);for(;e&&d&&b!==c;){let a=T(e),b=e.getBoundingClientRect(),d=N(e),f=b.left+(e.clientLeft+parseFloat(d.paddingLeft))*a.x,g=b.top+(e.clientTop+parseFloat(d.paddingTop))*a.y;k*=a.x,l*=a.y,m*=a.x,n*=a.y,k+=f,l+=g,e=Q(c=C(e))}}return t({width:m,height:n,x:k,y:l})}function X(a,b){let c=O(a).scrollLeft;return b?b.left+c:W(D(a)).left+c}function Y(a,b,c){void 0===c&&(c=!1);let d=a.getBoundingClientRect();return{x:d.left+b.scrollLeft-(c?0:X(a,d)),y:d.top+b.scrollTop}}function Z(a,b,c){var d;let e;if("viewport"===b)e=function(a,b){let c=C(a),d=D(a),e=c.visualViewport,f=d.clientWidth,g=d.clientHeight,h=0,i=0;if(e){f=e.width,g=e.height;let a=L();(!a||a&&"fixed"===b)&&(h=e.offsetLeft,i=e.offsetTop)}return{width:f,height:g,x:h,y:i}}(a,c);else if("document"===b){let b,c,g,h,i,j,k;d=D(a),b=D(d),c=O(d),g=d.ownerDocument.body,h=f(b.scrollWidth,b.clientWidth,g.scrollWidth,g.clientWidth),i=f(b.scrollHeight,b.clientHeight,g.scrollHeight,g.clientHeight),j=-c.scrollLeft+X(d),k=-c.scrollTop,"rtl"===N(g).direction&&(j+=f(b.clientWidth,g.clientWidth)-h),e={width:h,height:i,x:j,y:k}}else if(F(b)){let a,d,f,g;d=(a=W(b,!0,"fixed"===c)).top+b.clientTop,f=a.left+b.clientLeft,g=G(b)?T(b):h(1),e={width:b.clientWidth*g.x,height:b.clientHeight*g.y,x:f*g.x,y:d*g.y}}else{let c=V(a);e={x:b.x-c.x,y:b.y-c.y,width:b.width,height:b.height}}return t(e)}function $(a){return"static"===N(a).position}function _(a,b){if(!G(a)||"fixed"===N(a).position)return null;if(b)return b(a);let c=a.offsetParent;return D(a)===c&&(c=c.ownerDocument.body),c}function aa(a,b){let c=C(a);if(J(a))return c;if(!G(a)){let b=P(a);for(;b&&!M(b);){if(F(b)&&!$(b))return b;b=P(b)}return c}let d=_(a,b);for(;d&&["table","td","th"].includes(B(d))&&$(d);)d=_(d,b);return d&&M(d)&&$(d)&&!K(d)?c:d||function(a){let b=P(a);for(;G(b)&&!M(b);){if(K(b))return b;if(J(b))break;b=P(b)}return null}(a)||c}let ab=async function(a){let b=this.getOffsetParent||aa,c=this.getDimensions,d=await c(a.floating);return{reference:function(a,b,c){let d=G(b),e=D(b),f="fixed"===c,g=W(a,!0,f,b),i={scrollLeft:0,scrollTop:0},j=h(0);if(d||!d&&!f)if(("body"!==B(b)||I(e))&&(i=O(b)),d){let a=W(b,!0,f,b);j.x=a.x+b.clientLeft,j.y=a.y+b.clientTop}else e&&(j.x=X(e));let k=!e||d||f?h(0):Y(e,i);return{x:g.left+i.scrollLeft-j.x-k.x,y:g.top+i.scrollTop-j.y-k.y,width:g.width,height:g.height}}(a.reference,await b(a.floating),a.strategy),floating:{x:0,y:0,width:d.width,height:d.height}}},ac={convertOffsetParentRelativeRectToViewportRelativeRect:function(a){let{elements:b,rect:c,offsetParent:d,strategy:e}=a,f="fixed"===e,g=D(d),i=!!b&&J(b.floating);if(d===g||i&&f)return c;let j={scrollLeft:0,scrollTop:0},k=h(1),l=h(0),m=G(d);if((m||!m&&!f)&&(("body"!==B(d)||I(g))&&(j=O(d)),G(d))){let a=W(d);k=T(d),l.x=a.x+d.clientLeft,l.y=a.y+d.clientTop}let n=!g||m||f?h(0):Y(g,j,!0);return{width:c.width*k.x,height:c.height*k.y,x:c.x*k.x-j.scrollLeft*k.x+l.x+n.x,y:c.y*k.y-j.scrollTop*k.y+l.y+n.y}},getDocumentElement:D,getClippingRect:function(a){let{element:b,boundary:c,rootBoundary:d,strategy:g}=a,h=[..."clippingAncestors"===c?J(b)?[]:function(a,b){let c=b.get(a);if(c)return c;let d=(function a(b,c,d){var e;void 0===c&&(c=[]),void 0===d&&(d=!0);let f=function a(b){let c=P(b);return M(c)?b.ownerDocument?b.ownerDocument.body:b.body:G(c)&&I(c)?c:a(c)}(b),g=f===(null==(e=b.ownerDocument)?void 0:e.body),h=C(f);if(g){let b=Q(h);return c.concat(h,h.visualViewport||[],I(f)?f:[],b&&d?a(b):[])}return c.concat(f,a(f,[],d))})(a,[],!1).filter(a=>F(a)&&"body"!==B(a)),e=null,f="fixed"===N(a).position,g=f?P(a):a;for(;F(g)&&!M(g);){let b=N(g),c=K(g);c||"fixed"!==b.position||(e=null),(f?!c&&!e:!c&&"static"===b.position&&!!e&&["absolute","fixed"].includes(e.position)||I(g)&&!c&&function a(b,c){let d=P(b);return!(d===c||!F(d)||M(d))&&("fixed"===N(d).position||a(d,c))}(a,g))?d=d.filter(a=>a!==g):e=b,g=P(g)}return b.set(a,d),d}(b,this._c):[].concat(c),d],i=h[0],j=h.reduce((a,c)=>{let d=Z(b,c,g);return a.top=f(d.top,a.top),a.right=e(d.right,a.right),a.bottom=e(d.bottom,a.bottom),a.left=f(d.left,a.left),a},Z(b,i,g));return{width:j.right-j.left,height:j.bottom-j.top,x:j.left,y:j.top}},getOffsetParent:aa,getElementRects:ab,getClientRects:function(a){return Array.from(a.getClientRects())},getDimensions:function(a){let{width:b,height:c}=R(a);return{width:b,height:c}},getScale:T,isElement:F,isRTL:function(a){return"rtl"===N(a).direction}},ad=w,ae=function(a){return void 0===a&&(a=0),{name:"offset",options:a,async fn(b){var c,d;let{x:e,y:f,placement:g,middlewareData:h}=b,i=await z(b,a);return g===(null==(c=h.offset)?void 0:c.placement)&&null!=(d=h.arrow)&&d.alignmentOffset?{}:{x:e+i.x,y:f+i.y,data:{...i,placement:g}}}}},af=function(a){return void 0===a&&(a={}),{name:"shift",options:a,async fn(b){let{x:c,y:d,placement:g}=b,{mainAxis:h=!0,crossAxis:i=!1,limiter:j={fn:a=>{let{x:b,y:c}=a;return{x:b,y:c}}},...m}=k(a,b),o={x:c,y:d},q=await w(b,m),r=p(l(g)),s=n(r),t=o[s],u=o[r];if(h){let a="y"===s?"top":"left",b="y"===s?"bottom":"right",c=t+q[a],d=t-q[b];t=f(c,e(t,d))}if(i){let a="y"===r?"top":"left",b="y"===r?"bottom":"right",c=u+q[a],d=u-q[b];u=f(c,e(u,d))}let v=j.fn({...b,[s]:t,[r]:u});return{...v,data:{x:v.x-c,y:v.y-d}}}}},ag=function(a){return void 0===a&&(a={}),{name:"flip",options:a,async fn(b){var c,d,e,f,g,h;let i,j,s,{placement:t,middlewareData:u,rects:v,initialPlacement:x,platform:y,elements:z}=b,{mainAxis:A=!0,crossAxis:B=!0,fallbackPlacements:C,fallbackStrategy:D="bestFit",fallbackAxisSideDirection:E="none",flipAlignment:F=!0,...G}=k(a,b);if(null!=(c=u.arrow)&&c.alignmentOffset)return{};let H=l(t),I=l(x)===x,J=await (null==y.isRTL?void 0:y.isRTL(z.floating)),K=C||(I||!F?[r(x)]:(i=r(x),[q(x),i,q(i)]));C||"none"===E||K.push(...(j=m(x),s=function(a,b,c){let d=["left","right"],e=["right","left"];switch(a){case"top":case"bottom":if(c)return b?e:d;return b?d:e;case"left":case"right":return b?["top","bottom"]:["bottom","top"];default:return[]}}(l(x),"start"===E,J),j&&(s=s.map(a=>a+"-"+j),F&&(s=s.concat(s.map(q)))),s));let L=[x,...K],M=await w(b,G),N=[],O=(null==(d=u.flip)?void 0:d.overflows)||[];if(A&&N.push(M[H]),B){let a,b,c,d,e=(void 0===(h=J)&&(h=!1),a=m(t),c=o(b=n(p(t))),d="x"===b?a===(h?"end":"start")?"right":"left":"start"===a?"bottom":"top",v.reference[c]>v.floating[c]&&(d=r(d)),[d,r(d)]);N.push(M[e[0]],M[e[1]])}if(O=[...O,{placement:t,overflows:N}],!N.every(a=>a<=0)){let a=((null==(e=u.flip)?void 0:e.index)||0)+1,b=L[a];if(b)return{data:{index:a,overflows:O},reset:{placement:b}};let c=null==(f=O.filter(a=>a.overflows[0]<=0).sort((a,b)=>a.overflows[1]-b.overflows[1])[0])?void 0:f.placement;if(!c)switch(D){case"bestFit":{let a=null==(g=O.map(a=>[a.placement,a.overflows.filter(a=>a>0).reduce((a,b)=>a+b,0)]).sort((a,b)=>a[1]-b[1])[0])?void 0:g[0];a&&(c=a);break}case"initialPlacement":c=x}if(t!==c)return{reset:{placement:c}}}return{}}}},ah=function(a){return void 0===a&&(a={}),{name:"size",options:a,async fn(b){let c,d,{placement:g,rects:h,platform:i,elements:j}=b,{apply:n=()=>{},...o}=k(a,b),q=await w(b,o),r=l(g),s=m(g),t="y"===p(g),{width:u,height:v}=h.floating;"top"===r||"bottom"===r?(c=r,d=s===(await (null==i.isRTL?void 0:i.isRTL(j.floating))?"start":"end")?"left":"right"):(d=r,c="end"===s?"top":"bottom");let x=v-q[c],y=u-q[d],z=!b.middlewareData.shift,A=x,B=y;if(t){let a=u-q.left-q.right;B=s||z?e(y,a):a}else{let a=v-q.top-q.bottom;A=s||z?e(x,a):a}if(z&&!s){let a=f(q.left,0),b=f(q.right,0),c=f(q.top,0),d=f(q.bottom,0);t?B=u-2*(0!==a||0!==b?a+b:f(q.left,q.right)):A=v-2*(0!==c||0!==d?c+d:f(q.top,q.bottom))}await n({...b,availableWidth:B,availableHeight:A});let C=await i.getDimensions(j.floating);return u!==C.width||v!==C.height?{reset:{rects:!0}}:{}}}},ai=function(a){return void 0===a&&(a={}),{name:"hide",options:a,async fn(b){let{rects:c}=b,{strategy:d="referenceHidden",...e}=k(a,b);switch(d){case"referenceHidden":{let a=x(await w(b,{...e,elementContext:"reference"}),c.reference);return{data:{referenceHiddenOffsets:a,referenceHidden:y(a)}}}case"escaped":{let a=x(await w(b,{...e,altBoundary:!0}),c.floating);return{data:{escapedOffsets:a,escaped:y(a)}}}default:return{}}}}},aj=a=>({name:"arrow",options:a,async fn(b){let{x:c,y:d,placement:g,rects:h,platform:i,elements:j,middlewareData:l}=b,{element:q,padding:r=0}=k(a,b)||{};if(null==q)return{};let t=s(r),u={x:c,y:d},v=n(p(g)),w=o(v),x=await i.getDimensions(q),y="y"===v,z=y?"clientHeight":"clientWidth",A=h.reference[w]+h.reference[v]-u[v]-h.floating[w],B=u[v]-h.reference[v],C=await (null==i.getOffsetParent?void 0:i.getOffsetParent(q)),D=C?C[z]:0;D&&await (null==i.isElement?void 0:i.isElement(C))||(D=j.floating[z]||h.floating[w]);let E=D/2-x[w]/2-1,F=e(t[y?"top":"left"],E),G=e(t[y?"bottom":"right"],E),H=D-x[w]-G,I=D/2-x[w]/2+(A/2-B/2),J=f(F,e(I,H)),K=!l.arrow&&null!=m(g)&&I!==J&&h.reference[w]/2-(I<F?F:G)-x[w]/2<0,L=K?I<F?I-F:I-H:0;return{[v]:u[v]+L,data:{[v]:J,centerOffset:I-J-L,...K&&{alignmentOffset:L}},reset:K}}}),ak=function(a){return void 0===a&&(a={}),{options:a,fn(b){let{x:c,y:d,placement:e,rects:f,middlewareData:g}=b,{offset:h=0,mainAxis:i=!0,crossAxis:j=!0}=k(a,b),m={x:c,y:d},o=p(e),q=n(o),r=m[q],s=m[o],t=k(h,b),u="number"==typeof t?{mainAxis:t,crossAxis:0}:{mainAxis:0,crossAxis:0,...t};if(i){let a="y"===q?"height":"width",b=f.reference[q]-f.floating[a]+u.mainAxis,c=f.reference[q]+f.reference[a]-u.mainAxis;r<b?r=b:r>c&&(r=c)}if(j){var v,w;let a="y"===q?"width":"height",b=["top","left"].includes(l(e)),c=f.reference[o]-f.floating[a]+(b&&(null==(v=g.offset)?void 0:v[o])||0)+(b?0:u.crossAxis),d=f.reference[o]+f.reference[a]+(b?0:(null==(w=g.offset)?void 0:w[o])||0)-(b?u.crossAxis:0);s<c?s=c:s>d&&(s=d)}return{[q]:r,[o]:s}}}},al=(a,b,c)=>{let d=new Map,e={platform:ac,...c},f={...e.platform,_c:d};return v(a,b,{...e,platform:f})}}
,,,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>i});var d=c("react-lib"),e=c(620),f=c("fui.util_178"),g=c("odsp.util_126"),h=c(621);function i(a){let b=a.allowInfectedFileDownload?e.c:e.f,c=(0,f.kF)();return d.createElement(h.a,null,g.Cb(b,d.createElement("a",{href:"https://go.microsoft.com/fwlink/?linkid=862871",target:"_blank",rel:"noreferrer"},d.createElement("span",{style:{color:c.palette.themePrimary}},e.e))))}}
,,,,,,,,,,,,,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>e});var d=c("odsp.util_126");let e=new d.v7({name:"SaveActionExecutor.key",loader:new d.dE(()=>c.e(72).then(c.bind(c,839)).then(a=>a.saveActionExecutorKey))})}
,,,,,,,,,,,,,,,,,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>u});var d=c(43),e=c("odsp.util_126"),f=c(4),g=c(238),h=c(17),i=c(2),j=c(371),k=c(10),l=c(142),m=c(192);let n={oneUpStateStore:k.f,getExecutor:j.a.async.lazy,oneUpStore:h.b,appPageContext:i.a,openCopilotPaneAction:m.a,isCopilotEnabled:l.a},o=new e.v7({name:"onClickCopilotPaneAction",factory:{dependencies:n,create:a=>({instance:{evaluateAction:b=>{let c=(0,f.$b)(f.h)&&a.isCopilotEnabled(),d=a.oneUpStateStore.currentAppState.rightPane.type===k.e.copilotPane;return((0,g.b)(c,"OneUp",()=>"Licensed"),d)?{isAvailable:!0,id:"closeCopilotPaneAction",onExecute:async()=>{a.oneUpStateStore.updateRightPaneState("closeCopilotPane",{type:k.e.none})}}:a.openCopilotPaneAction.evaluateAction({item:b.item})}}})}});var p=c(193),q=c(656);let r="CopilotPaneCommand",s=q.a,t=(0,p.a)(),u=new e.v7({name:"CopilotCommand",factory:{dependencies:{actionProvider:o},create:({actionProvider:a})=>({instance:{id:r,title:d.k,automationId:r,iconProps:{imageProps:{src:s}},evaluateAction:a.evaluateAction,buttonStyles:t}})}})}
,,,,,,,,,,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>E});var d=c("odsp.util_126"),e=c(20),f=c(0),g=c(22),h=c(23),i=c(17),j=c(10),k=c(292),l=c(82),m=c(4),n=c(140),o=c(190),p=c(360),q=c(15),r=c(49),s=c(526),t=c(379),u=c(144);let v=a=>g.b.driveIdParamKey in a||g.b.parentDriveIdParamKey in a,w=!d.Ov.isActivated("520D3434-B1DD-43EC-9350-065337C1E8E0"),x=!d.Ov.isActivated("550C51AB-F752-4034-84AE-9AFC2B9780E5"),y=!d.Ov.isActivated("6149D03E-B2BF-4691-8598-5FC674B09264"),z=!d.Ov.isActivated("2365740E-F7A0-4E9D-9BD3-2B690262624E"),A=d.Ov.isActivated("a5e1d64c-8940-4ce7-9446-9ba2565085ed"),B=!d.Ov.isActivated("5ca4278e-b244-4595-b3dd-fc470790798d"),C=d.Ov.isActivated("c8636355-f925-4b6c-932c-70b5008f78eb"),D={oneUpStore:i.b,navigation:e.a,oneUpStateStore:j.f,oneUpLoadingCustomerPromiseFunctions:k.b,saveAction:o.a,isFastOneUpKey:l.j.optional,itemUrlHelper:q.c},E=new d.v7({name:"CloseAction",factory:{dependencies:D,create:a=>({instance:{evaluateAction:(a=>{let{navigation:b,oneUpStore:c,oneUpStateStore:d,saveAction:e}=a;return i=>({isAvailable:!0,id:"CloseAction",onExecute:async()=>{(0,m._b)()&&(0,t.a)();let j=(0,p.b)({saveAction:e,navigation:b,focusItem:i.item}),{parentItem:l,parentStoreKey:o}=c.getOneUpProperties()||{};j||(c.clean(),d.clean());let q=a.navigation.viewParams?.parentview,D="",E={};q&&(E={...E,[g.b.queryTypeParamKey]:`${q}`}),o?o?.id&&(E={...E,[g.b.idParamKey]:`${o?.id}`}):E={...E,[g.b.idParamKey]:`${l?.id}`};let F={},G=l?.mainLinkInfo;B&&(0,r.a)()&&G?.ShareTokenString&&(void 0===q||parseInt(q,10)===u.a.Files)&&(F={[g.b.shareTokenKey]:G.ShareTokenString});let H=(c=>{let d={},e=b.viewParams;if(e){for(let a of Object.keys(e))if(a===g.b.queryParamKey||a===g.b.searchScopeKey||a===g.b.meetingIdKey||a===g.b.personIdKey||a===g.b.emailIdKey||a===g.b.pageParamKey||a===g.b.viewIdKey||a===g.b.queryTypeParamKey||g.c.test(a)||a===g.b.sortFieldKey||a===g.b.isAscendingKey||a===g.b.groupByKey||a===g.b.listUrlKey||a===s.a||w&&a===g.b.remoteItem)if(a===g.b.listUrlKey){let b=e[g.b.parentQueryTypeParamKey],c=(0,n.h)(e);b&&"0"!==b||c||(d[a]=e[a])}else d[a]=e[a];if(!(0,m.hc)()){let b=(0,n.c)({key:i.item.key,viewParams:e,defaultRootItemId:a.itemUrlHelper.getItemUrlParts("").serverRelativeItemUrl||""});z&&v(e)&&(delete b[g.b.driveIdParamKey],delete b[g.b.parentDriveIdParamKey]);let f=e[g.b.parentQueryTypeParamKey];c&&(!f||"0"===f)&&(!A&&e[g.b.webUrlKey]&&(b[g.b.webUrlKey]=e[g.b.webUrlKey]),!C&&e[g.b.routingKey]&&(b[g.b.routingKey]=e[g.b.routingKey])),delete b[g.b.idParamKey],x&&delete b[g.b.navModeKey],y&&f&&"0"!==f&&delete b[g.b.listUrlKey],d={...d,...b}}}return(0,r.a)()&&delete d[g.b.shareTokenKey],d})(!!G);return z&&v(b.viewParams)&&(delete E[g.b.idParamKey],delete H[g.b.idParamKey]),D=(0,h.a)({...E,...H,...F}),D=`${a.isFastOneUpKey?"?":"#"}${D}`,a.oneUpLoadingCustomerPromiseFunctions.reportLoadingCXPSuccess({navExtraData:{navigationOption:k.a.close}}),(0,m.gb)()&&window.g_oneUpPathAndQueryString&&(D=-1!==D.search("&view")?D.slice(0,D.search("&view")):D),a.navigation.navigateTo({url:D,ignoreHistory:!0}),{resultType:f.b.Success}}})})(a)}})}})}
,,,,,,,,,,,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>d});let d=!c("odsp.util_126").Ov.isActivated("5B291913-1DFD-4DEF-8B87-1AB526D8120B")}
,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>e});var d=c("fui.util_178");function e(){let a=(0,d.kF)();return{...a,palette:{...a.palette,neutralPrimary:"transparent",themeTertiary:"#0F6CBD",themeLight:"#115EA3",themeLighter:"#0F6CBD"}}}}
,,,,,,,,,,,,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>h,b:()=>g});var d=c(277),e=c(119),f=c(170);function g(a){let b=a&&a.replace(/^\./,"");return!!(b&&d.b[b])}function h(a){return!!a&&!!a.extension&&!g(a.extension)&&(f.a||!(0,e.c)(a.extension))}}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>e,b:()=>h});var d,e,f=c(21);let g="OneUpUniversalAnnotation.UACommentsPane";function h(a,b){f.a.logData({name:a,scenario:"OneUp Universal Annotation",isIntentional:!0,extraData:{itemType:b}})}(d=e||(e={}))[d.UACommentsPane=g]="UACommentsPane",d[d.OpenCommentsFromCommandBar=`${g}.OpenFromCommandBar`]="OpenCommentsFromCommandBar",d[d.CloseCommentsFromCommandBar=`${g}.CloseFromCommandBar`]="CloseCommentsFromCommandBar",d[d.DeleteComment=`${g}.DeleteComment`]="DeleteComment"}
,,,,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>p});var d=c("odsp.util_126"),e=c(51),f=c(10),g=c(79),h=c(394),i=c(135),j=c(117);let k={pdfViewerHelper:e.b,oneUpStateStore:f.f},l=new d.v7({name:"ExtractAction",factory:{dependencies:k,create:a=>({instance:{evaluateAction:b=>{let{pdfViewerHelper:c}=a,d=a.oneUpStateStore.currentAppState,e=d.viewerStates?.get(b.item.key)?.pdfViewerStates;return{isAvailable:!!d.isPdfPaidFeaturesEnabled&&c.isPdfExtractAvailable(b.item)&&c.isPdfEditable(b.item)&&!e?.isFileEncrypted&&!e?.isSigned&&!e?.isPdfMip,id:"PdfExtract",isDisabled:!e?.isOpened||i.l&&a.oneUpStateStore.getESignData().isCreateSidePanelActive,onExecute:async()=>{a.oneUpStateStore.state.currentState.annotationViewerState.viewerVisiblity===f.a.On&&a.oneUpStateStore.toggleAnnotationViewerVisiblity(h.a),(0,j.b)()||a.oneUpStateStore.currentAppState.rightPane.type===f.e.none||a.oneUpStateStore.updateRightPaneState("closeRightPaneForPdfExtract",{type:f.e.none,content:void 0}),a.oneUpStateStore.updatePdfState("updatePdfAppMode",g.a.Extract),a.oneUpStateStore.updateViewerState("updatePdfFilePickerMode",{key:b.item.key,options:{pdfViewerStates:{filePickerConfig:{mode:"close"}}}})}}}}})}});var m=c(43),n=c(134);let o="pdfExtractCommand",p=new d.v7({name:"PdfExtractCommand",factory:{dependencies:{actionProvider:l},create:({actionProvider:a})=>{let b={id:o,automationId:o,title:m.bb,name:m.gb,iconProps:{iconName:"PdfExtract"},evaluateAction:a.evaluateAction};return(0,n.c)(),{instance:b}}}})}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>k});var d=c("odsp.util_126"),e=c(51),f=c(10);let g={pdfViewerHelper:e.b,oneUpStateStore:f.f},h=new d.v7({name:"MergeAction",factory:{dependencies:g,create:a=>({instance:{evaluateAction:b=>{let{pdfViewerHelper:c}=a,d=a.oneUpStateStore.currentAppState,e=d.viewerStates?.get(b.item.key)?.pdfViewerStates;return{isAvailable:!!d.isPdfPaidFeaturesEnabled&&c.isPdfExtractAvailable(b.item)&&c.isPdfEditable(b.item)&&!e?.isFileEncrypted&&!e?.isSigned&&!e?.isPdfMip,id:"PdfMerge",isDisabled:!e?.isOpened,onExecute:async()=>{a.oneUpStateStore.updateViewerState("updatePdfFilePickerMode",{key:b.item.key,options:{pdfViewerStates:{filePickerConfig:{mode:"merge"}}}})}}}}})}});var i=c(43);let j="pdfMergeCommand",k=new d.v7({name:"PdfMergeCommand",factory:{dependencies:{actionProvider:h},create:({actionProvider:a})=>({instance:{id:j,automationId:j,title:i.vb,name:i.yb,iconProps:{iconName:"PdfMerge"},evaluateAction:a.evaluateAction}})}})}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>i});var d=c("react-lib"),e=c("odsp.util_126"),f=c(120);let g="presenceCommand";function h(a){return{id:g,isAvailable:!0,isDisabled:!0}}let i=new e.v7({name:"PresenceCommand",factory:{dependencies:{},create:()=>{let a=(0,f.a)(async()=>(await c.e(55).then(c.bind(c,865))).PresenceHeaderAsyncDeferred);return{instance:{id:g,automationId:g,onRender:b=>d.createElement(a,null),evaluateAction:h}}}}})}
,,(a,b,c)=>{"use strict";c.d(b,{a:()=>y});var d=c(43),e=c("odsp.util_126"),f=c(380);let g={actionProvider:f.d},h="shareCommand",i=new e.v7({name:"ShareCommand",factory:{dependencies:g,create:({actionProvider:a})=>({instance:{id:h,name:d.kb,title:d.Mb,automationId:h,iconProps:{iconName:"Share"},evaluateAction:a.evaluateAction}})}}),j={actionProvider:f.b},k="copyLinkCommand",l=new e.v7({name:"CopyCommand",factory:{dependencies:j,create:({actionProvider:a})=>({instance:{id:k,name:d.l,title:d.l,automationId:k,iconProps:{iconName:"Link"},evaluateAction:a.evaluateAction}})}}),m={actionProvider:f.c},n="manageAccessCommand",o=new e.v7({name:"ManageAccessCommand",factory:{dependencies:m,create:({actionProvider:a})=>({instance:{id:n,name:d.Z,title:d.Z,automationId:n,iconProps:{iconName:"Contact"},evaluateAction:a.evaluateAction}})}});var p=c(193);let q={actionProvider:f.a},r="addAgentToTeamsCommand",s=new e.v7({name:"AddAgentToTeamsCommand",factory:{dependencies:q,create:({actionProvider:a})=>({instance:{id:r,name:d.c,title:d.d,automationId:r,iconProps:{iconName:"Link"},evaluateAction:a.evaluateAction}})}});var t=c(4),u=c(119),v=c(170);let w="shareCommandGroup",x=a=>({isAvailable:v.a||!(0,u.c)(a.item.extension)}),y=new e.v7({name:"ShareGroupCommand",factory:{dependencies:{shareCommand:i,copyCommand:l,manageAccessCommand:o,addAgentToTeamsCommand:s},create:a=>{let{addAgentToTeamsCommand:b,shareCommand:c,copyCommand:e,manageAccessCommand:f}=a;return{instance:{id:w,name:d.kb,automationId:w,subCommands:(0,t.Ib)()?[b,c,e,f]:[c,e,f],evaluateAction:x,buttonStyles:(0,p.a)(),iconProps:{iconName:"Share"}}}}}})}
,,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>l});var d=c("odsp.util_126"),e=c(51),f=c(10);let g={pdfViewerHelper:e.b,oneUpStateStore:f.f},h=new d.v7({name:"EncryptAction",factory:{dependencies:g,create:a=>({instance:{evaluateAction:b=>{let{pdfViewerHelper:c}=a,d=a.oneUpStateStore.currentAppState,e=d.viewerStates?.get(b.item.key)?.pdfViewerStates;return{isAvailable:!!d.isPdfPaidFeaturesEnabled&&c.isPdfEncryptAvailable(b.item)&&c.isPdfEditable(b.item)&&!e?.isFileEncrypted&&!e?.isSigned&&!e?.isPdfMip,id:"Pdf",isDisabled:!e?.isOpened,onExecute:async()=>{a.oneUpStateStore.updateViewerState("updatePdfEncryptDialogVisibleState",{key:b.item.key,options:{pdfViewerStates:{pdfEncryptDialogVisible:!0}}})}}}}})}});var i=c(43),j=c(134);let k="pdfEncryptCommand",l=new d.v7({name:"PdfEncryptCommand",factory:{dependencies:{actionProvider:h},create:({actionProvider:a})=>{let b={id:k,automationId:k,title:i._b,name:i.hb,iconProps:{iconName:"PdfEncryptLock"},evaluateAction:a.evaluateAction};return(0,j.b)(),{instance:b}}}})}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>l});var d=c("odsp.util_126"),e=c(51),f=c(10);let g={pdfViewerHelper:e.b,oneUpStateStore:f.f},h=new d.v7({name:"CompressAction",factory:{dependencies:g,create:a=>({instance:{evaluateAction:b=>{let{pdfViewerHelper:c}=a,d=a.oneUpStateStore.currentAppState,e=d.viewerStates?.get(b.item.key)?.pdfViewerStates;return{isAvailable:!!d.isPdfPaidFeaturesEnabled&&c.isPdfCompressAvailable(b.item)&&c.isPdfEditable(b.item)&&!e?.isFileEncrypted&&!e?.isSigned&&!e?.isPdfMip,id:"PdfCompress",isDisabled:!e?.isOpened,onExecute:async()=>{a.oneUpStateStore.updateViewerState("updatePdfCompressDialogVisibleState",{key:b.item.key,options:{pdfViewerStates:{pdfCompressDialogVisible:!0}}})}}}}})}});var i=c(43),j=c(134);let k="pdfCompressCommand",l=new d.v7({name:"PdfCompressCommand",factory:{dependencies:{actionProvider:h},create:({actionProvider:a})=>{let b={id:k,automationId:k,title:i.fb,name:i.pb,iconProps:{iconName:"PdfCompress"},evaluateAction:a.evaluateAction};return(0,j.a)(),{instance:b}}}})}
,,,,,,,,,,,,,,(a,b,c)=>{"use strict";function d(a){return{backgroundColor:"transparent",".ms-Button-flexContainer":{backgroundColor:a}}}c.d(b,{a:()=>e});let e={...c(733).a,Pivot:{styles:function(a){let{linkFormat:b,theme:c}=a,{effects:d,semanticColors:e,palette:f}=c,g="tabs"===b,h={border:"2px solid transparent",borderRadius:d.roundedCorner4,height:"44px",lineHeight:"20px",marginRight:0,".ms-Fabric--isFocusVisible &:focus":{border:`2px solid ${e.focusBorder}`,borderRadius:d.roundedCorner4,inset:0,outline:"none"}},i={color:g?e.primaryButtonText:f.themePrimary};return{link:{...h,backgroundColor:"transparent","&:hover::before":{borderRadius:d.roundedCorner4,height:"3px",backgroundColor:g?"transparent":f.neutralQuaternary},"&:hover":{".ms-Pivot-icon":i}},icon:{height:"14px",width:"14px"},linkIsSelected:{...h,"&::before":{borderRadius:d.roundedCorner4,height:"3px"},".ms-Pivot-icon":i}}}},CommandBarButton:{styles:function(a){let{theme:b}=a,{semanticColors:c,effects:e}=b,f={borderRadius:0,borderTopRightRadius:e.roundedCorner6,borderBottomRightRadius:e.roundedCorner6},g={borderRadius:0,borderTopLeftRadius:e.roundedCorner6,borderBottomLeftRadius:e.roundedCorner6},h=function(a){let{effects:b,semanticColors:c}=a,d={borderRadius:0,borderTopRightRadius:b.roundedCorner6,borderBottomRightRadius:b.roundedCorner6},e={borderRadius:0,borderTopLeftRadius:b.roundedCorner6,borderBottomLeftRadius:b.roundedCorner6};return{splitButtonContainer:{borderRadius:b.roundedCorner6,color:c.buttonText,".ms-Button:first-child":{...e,height:"100%"},".ms-Button--primary:hover":{border:"none"}},splitButtonMenuButton:{...d,height:"100%",padding:"0px",width:20},splitButtonContainerFocused:{":focus::after":{inset:"0px",outline:"none",borderRadius:b.roundedCorner6,border:`2px solid ${c.focusBorder}`}},splitButtonMenuFocused:{":focus::after":{inset:"0px",outline:"none",border:`2px solid ${c.focusBorder}`,...d}},splitButtonDivider:{display:"none"},splitButtonDividerDisabled:{display:"none"}}}(b);return{root:{backgroundColor:"transparent",height:"100%",minWidth:"20px",padding:"0px",margin:"0px 2px",borderRadius:e.roundedCorner6,".ms-Fabric--isFocusVisible &:focus::after":{top:4,right:0,bottom:4,left:0,outline:"none",borderRadius:e.roundedCorner6,border:`2px solid ${c.focusBorder}`}},rootHovered:d(c.buttonBackgroundHovered),rootPressed:d(c.buttonBackgroundPressed),rootExpanded:{...d("transparent"),color:"inherit"},rootChecked:d(c.buttonBackgroundChecked),rootCheckedHovered:d(c.buttonBackgroundCheckedHovered),rootCheckedPressed:d(c.buttonBackgroundPressed),rootExpandedHovered:d(c.buttonBackgroundHovered),flexContainer:{height:32,width:32,paddingLeft:0,paddingRight:0,borderRadius:e.roundedCorner6},icon:{color:"inherit"},menuIcon:{color:"inherit",fontSize:"10px"},rootDisabled:{backgroundColor:"transparent"},textContainer:{height:16},...h,splitButtonContainer:{borderRadius:e.roundedCorner6,color:c.buttonText,".ms-Button:first-child":{".ms-Button-flexContainer":{...g,width:"auto",height:30,border:`1px solid ${c.buttonBorder}`,backgroundColor:c.buttonBackground},".ms-Button-textContainer":{width:"auto",minWidth:25,maxWidth:100,marginTop:2}}},splitButtonMenuButton:{...f,height:"100%",padding:"0px",width:20,marginLeft:"-2px",backgroundColor:"transparent",".ms-Button-flexContainer":{...f,height:32,width:32,paddingLeft:4,paddingRight:4},"&:hover":{backgroundColor:"transparent",".ms-Button-flexContainer":{backgroundColor:c.buttonBackgroundHovered}}},splitButtonContainerFocused:{":focus::after":{inset:"4px 0px",outline:"none",borderRadius:e.roundedCorner6,border:`2px solid ${c.focusBorder}`}},splitButtonMenuButtonExpanded:{backgroundColor:"transparent",".ms-Button-flexContainer":{backgroundColor:c.buttonBackgroundChecked},"&:hover":{backgroundColor:"transparent",".ms-Button-flexContainer":{backgroundColor:c.buttonBackgroundCheckedHovered}}},splitButtonFlexContainer:{borderTop:`1px solid ${c.buttonBorder}`,borderRight:`1px solid ${c.buttonBorder}`,borderBottom:`1px solid ${c.buttonBorder}`,backgroundColor:c.buttonBackground,height:"30px !important",width:"auto !important",".ms-Button-textContainer":{marginTop:2}}}}},TeachingBubble:{styles:a=>{let{theme:{palette:b}}=a;return{root:{color:b.black,backgroundColor:b.themePrimary},subText:{color:b.black},headline:{color:b.black},footer:{color:b.black,"& > .ms-StackItem":{display:"flex",flexDirection:"row-reverse"},"& > .ms-StackItem > .ms-Button:not(:first-child)":{margin:"0 15px 0 0"}},subComponentStyles:{callout:{borderRadius:"6px",beak:{borderRadius:0}}},primaryButton:{backgroundColor:b.black,color:b.white,borderColor:b.black,borderRadius:"4px",":hover":{borderColor:b.black,backgroundColor:b.black,color:b.white},":focus":{borderColor:b.black,backgroundColor:b.black,color:b.white}},secondaryButton:{borderColor:b.black,".ms-Button-label":{color:b.black},":hover":{borderColor:b.black,backgroundColor:b.themeSecondary}},closeButton:{backgroundColor:b.themePrimary,color:b.black,":hover":{backgroundColor:b.themeSecondary+"!important",color:b.black}}}}}}}
,,,,,,,,,,,,,,,,,,,(a,b,c)=>{"use strict";function d(a){let{viewParams:b,clientName:c}=a,{app:d,scenario:e}=b,f=!0;try{f=window.parent!==window.self||!!window.opener}catch{}let g=f?"Unknown":"Default";return{Scenario:e||g,ClientName:`${d?`${d}.`:""}${c}`}}function e(a){let{viewParams:b,clientName:c}=a;return c&&b?d({viewParams:b,clientName:c}).ClientName:c??b?.app}c.d(b,{a:()=>d,b:()=>e})}
,,(a,b,c)=>{"use strict";c.d(b,{a:()=>e,b:()=>f});var d=c("odsp.util_126");let e=new d.v7("onRenderOneUpPlayerHost"),f=new d.v7("OneUpPlayerHost")}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>d});let d=new(c("odsp.util_126")).v7("oneUpPlayerHostInitResourcesKey")}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>d});let d=new(c("odsp.util_126")).v7("oneUpOnePlayerEnabled")}
,,,,,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>d});let d=new(c("odsp.util_126")).v7({name:"copilotAppName",factory:{dependencies:{},create:()=>({instance:"OneUp"})}})}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>d});let d=!c("odsp.util_126").Ov.isActivated("CF5E8614-A7E0-4200-8C03-658ED1F6B731")}
,,,,,,,,,,,,,,,,,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>o,b:()=>k,c:()=>j,d:()=>f,e:()=>m,f:()=>l,g:()=>g,h:()=>i,i:()=>h,j:()=>n});var d=c("tslib_533"),e=c(37),f=function(){return(0,d.yv)(void 0,void 0,void 0,function(){return(0,d.SO)(this,function(a){switch(a.label){case 0:return[4,c.e(39).then(c.bind(c,810))];case 1:return[2,a.sent().PdfPrintService]}})})},g=function(){return(0,d.yv)(void 0,void 0,void 0,function(){return(0,d.SO)(this,function(a){switch(a.label){case 0:return[4,c.e(39).then(c.bind(c,811))];case 1:return[2,a.sent().PdfThumbnailService]}})})},h=function(){return(0,d.yv)(void 0,void 0,void 0,function(){return(0,d.SO)(this,function(a){switch(a.label){case 0:return[4,c.e(39).then(c.bind(c,812))];case 1:return[2,a.sent().PdfWatermarkService]}})})},i=function(){return(0,d.yv)(void 0,void 0,void 0,function(){return(0,d.SO)(this,function(a){switch(a.label){case 0:return[4,c.e(39).then(c.bind(c,813))];case 1:return[2,a.sent().PdfUndoRedoService]}})})},j=function(){return(0,d.yv)(void 0,void 0,void 0,function(){return(0,d.SO)(this,function(a){switch(a.label){case 0:return[4,c.e(39).then(c.bind(c,814))];case 1:return[2,a.sent().PdfNoteService]}})})},k=function(){return(0,d.yv)(void 0,void 0,void 0,function(){return(0,d.SO)(this,function(a){switch(a.label){case 0:return[4,c.e(39).then(c.bind(c,815))];case 1:return[2,a.sent().PdfDocumentLoaderByQueue]}})})},l=function(){return(0,d.yv)(void 0,void 0,void 0,function(){return(0,d.SO)(this,function(a){switch(a.label){case 0:return[4,c.e(39).then(c.bind(c,816))];case 1:return[2,a.sent().PdfRotateService]}})})},m=function(){return(0,d.yv)(void 0,void 0,void 0,function(){return(0,d.SO)(this,function(a){switch(a.label){case 0:return[4,c.e(39).then(c.bind(c,817))];case 1:return[2,a.sent().PdfProgressiveLoadingService]}})})},n=function(){return(0,d.yv)(void 0,void 0,void 0,function(){var a,b;return(0,d.SO)(this,function(d){switch(d.label){case 0:if(!(null==(b=e.a.features)?void 0:b.enableOptimizedPinch))return[3,2];return[4,c.e(39).then(c.bind(c,818))];case 1:return a=d.sent().Pinchable,[3,4];case 2:return[4,c.e(39).then(c.bind(c,819))];case 3:a=d.sent().Pinchable,d.label=4;case 4:return[2,a]}})})},o=function(){return(0,d.yv)(void 0,void 0,void 0,function(){return(0,d.SO)(this,function(a){switch(a.label){case 0:return[4,c.e(39).then(c.bind(c,820))];case 1:return[2,a.sent().FontProvider]}})})}}
,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,(a,b,c)=>{"use strict";c.d(b,{a:()=>p,b:()=>m,c:()=>u,d:()=>d,e:()=>i,f:()=>l,g:()=>n,h:()=>j,i:()=>t,j:()=>h,k:()=>g,l:()=>v,m:()=>r,n:()=>q,o:()=>s,p:()=>o,q:()=>k,r:()=>e,s:()=>f});let d="cid",e="sb",f="sd",g="mid",h="mcid",i="ft",j="ext",k="searchsessionid",l="df",m="beginDate",n="endDate",o="scope",p="authkey",q="redeem",r="v",s="resid",t="ithint",u="challengeToken",v="migratedtospo"}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>e,b:()=>d});let d="routeid",e="source"}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>d,b:()=>e,c:()=>f,d:()=>h,e:()=>g});let d="e",e="ga",f="gaS",g="web",h="lpmkr"}
,,(a,b,c)=>{"use strict";c.d(b,{a:()=>n});var d=c(20),e=c(50),f=c(13),g=c("odsp.util_126"),h=c(4),i=c(163),j=c(519),k=c(282),l=c(543);let m={resourceScope:g.m3,navigation:d.a,engagementContext:k.a},n=new g.v7({name:"ListItemRetrieverHelper",factory:{dependencies:m,create:({resourceScope:a,navigation:b,engagementContext:c})=>{let d=!(0,h.Vc)()&&a.consume(i.a);return{instance:{getCurrentItem:function(g){let{idViewParam:h,webAbsoluteUrl:i,fullListUrl:k,serverRelativeFocusItemUrl:m,listContext:n,pageContext:o,cidViewParam:p}=(0,l.a)(a),{isCrossList:q,isCrossDomain:r,geoRelation:s}=new e.a({},{pageContext:o}).getItemUrlParts(window.location.href),t=i&&k?{pageContext:o,id:h?m:void 0,odcId:p&&!d?h:void 0,webAbsoluteUrl:i,listFullUrl:k,listContext:n,extraLoggingData:{isCrossList:q,isCrossDomain:r,isCrossGeo:s!==f.a.sameGeo,correlationId:o.CorrelationId,engagementContext:c,isShareLinkRedeeming:void 0!==b.viewParams.ga}}:void 0;return t?new j.a(t).getSingleItem(g):Promise.resolve(void 0)}}}}}})}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>j});var d=c(518),e=c(264),f=c(49),g=c("odsp.util_126"),h=c(20),i=c(109);function j(a){let{webAbsoluteUrl:b,listFullUrl:c,listContext:j,parentFolderPath:k,resourceScope:l,spGetItemResponse:m,currentPageContext:n}=a,o=m.ListData&&m.ListData.Row&&m.ListData.Row[0];if(o){let a={itemId:o.ID,listFullUrl:c,rootFolder:"",webAbsoluteUrl:b},p=l.consume(e.a),q=(0,d.a)(m),r=p.processOneUpItem({itemFromServer:o,spItemIdentity:a,spParentItemIdentity:k?{itemId:"",listFullUrl:c,rootFolder:k,webAbsoluteUrl:b}:void 0,listContext:j,mediaTransformListSchema:q,currentPageContext:n});if((0,f.a)()&&!g.Ov.isActivated("ed059565-7fe3-4660-a1f5-22c2f82603ab")&&r.mainLinkInfo?.ShareTokenString)try{if(g.Ov.isActivated("64908735-0984-4d8c-aa05-82b89f293480")){let a=new URL(window.location.href);a.searchParams.get("share")?.trim()||(a.searchParams.set("share",r.mainLinkInfo.ShareTokenString),history.replaceState(null,"",a.href.toString()))}else{let a=l.consume(h.a);a.viewParams[i.b]||a.updateViewParams({[i.b]:r.mainLinkInfo.ShareTokenString})}}catch(a){}return r}}}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>i,b:()=>h});var d=c(59),e=c(2),f=c(99),g=c(216);let h=(0,c("odsp.util_126").Pd)("EE552769-5AF7-4A88-BE60-2DD724EC3769",d.b,{pageContext:e.a,offlineDetection:f.a,noRedirect:g.a}),i=d.b}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>d});let d=new(c("odsp.util_126")).v7("people")}
,,(a,b,c)=>{"use strict";function d(){return window.location!==window.parent.location}function e(){var a=window;return a.parent===a&&!a.opener&&void 0!==a.external&&("messageToHost"in a.external||"notify"in a.external)}c.d(b,{a:()=>d,b:()=>e})}
,(a,b,c)=>{"use strict";c.d(b,{a:()=>m,b:()=>f});var d=c("tslib_533"),e=c("fui.util_178"),f="#141414",g={neutralDark:"#201f1e",neutralLight:"#edebe9",neutralLighter:"#f3f2f1",neutralLighterAlt:"#faf9f8",neutralPrimary:"#323130",neutralTertiary:"#616161",neutralSecondary:"#605e5c",neutralQuaternaryAlt:"#8a8886",neutralQuaternary:"#d2d0ce",neutralSecondaryAlt:"#8a8886",themeDark:"#005a9e",themePrimary:"#0078d4",white:"#ffffff",themeLight:"#c7e0f4",themeTertiary:"#71afe5",themeLighter:"#deecf9"},h={bodyBackground:"#faf9f8",menuBackground:"#ffffff",menuItemBackgroundHovered:"#f3f2f1",menuItemBackgroundPressed:"#f3f2f1",menuDivider:"#c8c6c4",menuIcon:"#605e5c",menuItemText:"#323130",menuItemTextHovered:g.neutralDark,inputBackground:"#ffffff",inputBorder:"#bebbb8",inputText:"#323130",inputPlaceholderText:"#605e5c",primaryButtonBackgroundDisabled:g.neutralLighter,primaryButtonTextDisabled:g.neutralQuaternary,primaryButtonBackgroundPressed:g.themeDark,primaryButtonText:g.white,primaryButtonTextHovered:g.white,primaryButtonTextPressed:g.white,disabledText:g.neutralTertiary,bodySubtext:g.neutralSecondary,buttonBackgroundPressed:g.neutralLight,buttonBackgroundHovered:g.neutralLighter,buttonTextDisabled:g.neutralTertiary,buttonBorderDisabled:"#bdbdbd",cardStandoutBackground:"#ebf3fc",cardShadowHovered:"#b4d6fa",listText:"#242424",disabledBorder:"#707070",messageLink:"#115ea3",messageLinkHovered:"#0f548c",primaryButtonBorder:"#424242"},i={neutralDark:"#f3f2f1",neutralLight:"#292827",neutralLighter:"#252423",neutralLighterAlt:"#201f1e",neutralPrimary:"#f3f2f1",neutralTertiary:"#797775",neutralSecondary:"#a19f9d",neutralQuaternaryAlt:"#323130",neutralQuaternary:"#3b3a39",neutralSecondaryAlt:"#979693",themeDark:"#faf9f8",themePrimary:"#2899f5",white:"#1b1a19",themeLight:"#004c87",themeTertiary:"#0078D4",themeLighter:"#043862"},j={bodyBackground:"#201f1e",menuBackground:i.neutralLighter,menuItemBackgroundHovered:i.neutralQuaternaryAlt,menuItemBackgroundPressed:i.neutralQuaternary,menuDivider:"#BEBBB8",menuIcon:"#FFFFFF",menuItemText:"#F3F2F1",menuItemTextHovered:"#F3F2F1",inputBackground:"#292929",inputBorder:"#bebbb8",inputText:"#F3F2F1",inputPlaceholderText:"#999999",primaryButtonBackgroundDisabled:"#252423",primaryButtonTextDisabled:"#605E5C",primaryButtonBackgroundPressed:"#043862",primaryButtonText:"#FFFFFF",primaryButtonTextHovered:"#FFFFFF",primaryButtonTextPressed:"#FFFFFF",disabledText:"#A19F9D",bodySubtext:"#A19F9D",buttonBackgroundPressed:"#292827",buttonBackgroundHovered:"#424242",buttonTextDisabled:"#797775",buttonBorderDisabled:"#5C5C5C",cardStandoutBackground:"#082338",cardShadowHovered:"#0e4775",listText:"#ffffff",disabledBorder:"#999999",messageLink:"#479ef5",messageLinkHovered:"#62abf5",primaryButtonBorder:"#D6D6D6"},k=(0,e.es)({palette:g,semanticColors:h}),l=(0,e.es)({palette:i,semanticColors:j,isInverted:!0}),m=function(a,b){if(void 0===b&&(b=!1),!a)return b?l:k;var c=a.palette,f=a.semanticColors,m=(0,d.dc)(a,["palette","semanticColors"]),n=(0,d.q5)({palette:b?(0,d.q5)((0,d.q5)({},i),c):(0,d.q5)((0,d.q5)({},g),c),semanticColors:b?(0,d.q5)((0,d.q5)({},j),f):(0,d.q5)((0,d.q5)({},h),f),isInverted:(null==a?void 0:a.isInverted)||b},m);return(0,e.es)(n)}}
,,(a,b,c)=>{"use strict";c.d(b,{a:()=>d}),(0,c("fui.util_178").ZW)([{rawString:"#printContainer_08edcb3d{display:none}@media print{body{background:rgba(0,0,0,0)}body[data-pdfprinting]>*{display:none}body[data-pdfprinting]>#printContainer_08edcb3d{display:block;height:100%}body[data-pdfprinting]>#printContainer_08edcb3d>div{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:100%;height:100%;page-break-after:always;page-break-inside:avoid}body[data-pdfprinting]>#printContainer_08edcb3d>div img{max-width:100%;max-height:100%}}"}]);let d="printContainer_08edcb3d"}
],f={};function g(a){var b=f[a];if(void 0!==b)return b.exports;var c=f[a]={id:a,loaded:!1,exports:{}};return e[a].call(c.exports,c,c.exports,g),c.loaded=!0,c.exports}g.m=e;var h=document.currentScript,i=window,j=i.require,k=i.__launchpad;function l(a){var b=a&&a.indexOf("/",a.indexOf("://")+3)+1;return b?a.slice(0,b):a}var m=l(h&&h.src||j&&j.toUrl("")),n=l(i.__backupBaseUrl),o=j&&j.s&&j.s.contexts&&j.s.contexts._,p=i.__odspSriHashes;p&&0===Object.keys(p).length&&(p=void 0),g.amdO={},q=[],g.O=(a,b,c,d)=>{if(b){d=d||0;for(var e=q.length;e>0&&q[e-1][2]>d;e--)q[e]=q[e-1];q[e]=[b,c,d];return}for(var f=1/0,e=0;e<q.length;e++){for(var[b,c,d]=q[e],h=!0,i=0;i<b.length;i++)(!1&d||f>=d)&&Object.keys(g.O).every(a=>g.O[a](b[i]))?b.splice(i--,1):(h=!1,d<f&&(f=d));if(h){q.splice(e--,1);var j=c();void 0!==j&&(a=j)}}return a},g.n=a=>{var b=a&&a.__esModule?()=>a.default:()=>a;return g.d(b,{a:b}),b},s=Object.getPrototypeOf?a=>Object.getPrototypeOf(a):a=>a.__proto__,g.t=function(a,b){if(1&b&&(a=this(a)),8&b||"object"==typeof a&&a&&(4&b&&a.__esModule||16&b&&"function"==typeof a.then))return a;var c=Object.create(null);g.r(c);var d={};r=r||[null,s({}),s([]),s(s)];for(var e=2&b&&a;"object"==typeof e&&!~r.indexOf(e);e=s(e))Object.getOwnPropertyNames(e).forEach(b=>d[b]=()=>a[b]);return d.default=()=>a,g.d(c,d),c},g.d=(a,b)=>{for(var c in b)g.o(b,c)&&!g.o(a,c)&&Object.defineProperty(a,c,{enumerable:!0,get:b[c]})},g.f={},g.e=a=>Promise.all(Object.keys(g.f).reduce((b,c)=>(g.f[c](a,b),b),[])),g.u=a=>"odsp.1ds.lib"===a?"odsp.1ds.lib.js":(({"ondemand.resx":1,"odsp.1ds.lib":1})[a]?self.__odsp_culture+"/":"")+a+".js",g.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||Function("return this")()}catch(a){if("object"==typeof window)return window}}(),g.hmd=a=>((a=Object.create(a)).children||(a.children=[]),Object.defineProperty(a,"exports",{enumerable:!0,set:()=>{throw Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+a.id)}}),a),g.o=(a,b)=>Object.prototype.hasOwnProperty.call(a,b),t={},g.l=(a,b,c,d)=>{if(t[a])return void t[a].push(b);if(void 0!==c)for(var e,f,h=document.getElementsByTagName("script"),j=0;j<h.length;j++){var k=h[j];if(k.getAttribute("src")==a||k.getAttribute("data-webpack")=="__webpack_result__:"+c){e=k;break}}if(!e){f=!0,(e=document.createElement("script")).charset="utf-8",e.timeout=120,g.nc&&e.setAttribute("nonce",g.nc),e.setAttribute("data-webpack","__webpack_result__:"+c),e.setAttribute("fetchpriority","high"),e.src=a,0!==e.src.indexOf(window.location.origin+"/")&&(e.crossOrigin="anonymous");var l,m=(p&&(l=p[i.__odsp_culture+"/"+d]||p[d]||"sha256-Missing+Integrity+Hash+For+Script+Aborting="),l);m&&(e.integrity=m)}t[a]=[b];var n=(b,c)=>{e.onerror=e.onload=null,clearTimeout(o);var d=t[a];if(delete t[a],e.parentNode&&e.parentNode.removeChild(e),d&&d.forEach(a=>a(c)),b)return b(c)},o=setTimeout(n.bind(null,void 0,{type:"timeout",target:e}),12e4);e.onerror=n.bind(null,e.onerror),e.onload=n.bind(null,e.onload),f&&document.head.appendChild(e)},g.r=a=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(a,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(a,"__esModule",{value:!0})},g.nmd=a=>(a.paths=[],a.children||(a.children=[]),a),g.g.importScripts&&(u=g.g.location+"");var q,r,s,t,u,v=g.g.document;if(!u&&v&&(v.currentScript&&"SCRIPT"===v.currentScript.tagName.toUpperCase()&&(u=v.currentScript.src),!u)){var w=v.getElementsByTagName("script");if(w.length)for(var x=w.length-1;x>-1&&(!u||!/^http(s?):/.test(u));)u=w[x--].src}if(!u)throw Error("Automatic publicPath is not supported in this browser");g.p=u=u.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),g.b=document.baseURI||self.location.href,a={oneuplightspeedwebpack:0},g.f.j=(b,c)=>{var d=b.toString(),e=k&&k.getScriptUrl(d),f=o&&o.config.paths[d]&&o.nameToUrl(d),h=(k?e:f)||g.p+g.u(b);function j(b){var c=g.o(a,b)?a[b]:void 0;if(0!==c)if(c)return c;else{var d=new Promise((d,e)=>c=a[b]=[d,e]);c[2]=d,c[3]=h;var e=Error();return g.l(h,d=>{if(g.o(a,b)&&(0!==(c=a[b])&&(a[b]=void 0),c)){var f=d&&("load"===d.type?"missing":d.type),h=d&&d.target&&d.target.src;e.message="Loading chunk "+b+" failed.\n("+f+": "+h+")",e.loggableMessage={__isPrivacyDataWrapper:!0,_value:"Loading chunk "+b+" failed.\n("+f+": "+h+")",_type:"safe"},e.name="ChunkLoadError",e.type=f,e.request=h,e.chunkId=b,e.extraData={type:f,url:h,chunkId:b,qosName:"ChunkLoadError"},c[1](e)}},"chunk-"+b,b),c}}var l=j(b);l&&(k?c.push(l[2]):c.push(l[2].catch(function(a){var c=i.__integrityViolationCallBack;c&&c(a.request);var d=i.__swChunkLoadErrorHandler;d&&d(a.request);var e=l[3],f=n&&e.replace(m,n);if(f&&f!==e){h=f;var g=j(b);return g&&g[2]}return Promise.reject(a)})))},g.O.j=b=>0===a[b],b=(b,c)=>{var d,e,[f,h,i]=c,j=0;if(f.some(b=>0!==a[b])){for(d in h)g.o(h,d)&&(g.m[d]=h[d]);if(i)var k=i(g)}for(b&&b(c);j<f.length;j++)e=f[j],g.o(a,e)&&a[e]&&a[e][0](),a[e]=0;return g.O(k)},(c=self.odspNextWebpackJsonp=self.odspNextWebpackJsonp||[]).forEach(b.bind(null,0)),c.push=b.bind(null,c.push.bind(c)),(d=window.__launchpad)&&(g.l=(a,b,c,e)=>{d.loadScript(a,b,void 0,"anonymous",void 0,12e4,"utf-8")});var y=g.O(void 0,["odsp.react.lib","odsp.util","fui.util","tslib","fui.core","initial.resx","plt.office-ui-fabric-react","plt.odsp-common","plt.items-view"],()=>g(475));__webpack_result__=y=g.O(y)})(),define("oneuplightspeedwebpack",[],{});